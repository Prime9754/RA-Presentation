Starting private baseline training job for all 3 modalities...

=====================================================
Running OPG (36 experiments)...
Data: processed_datasets/opg_classification.csv
Output: ./results_opg
=====================================================
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
Warning: 'matplotlib' or 'seaborn' not found. Install them to generate plots.
================================================================================
Starting Baseline Experiment Runner
CSV File: processed_datasets/opg_classification.csv
Output Dir: ./results_opg
Epochs: 15, Batch Size: 8
Grid Search Parameters:
  Architectures: ['resnet50', 'efficientnet_b0']
  Sizes: ['224x224', '384x384']
  Learning Rates: ['1e-4', '5e-5', '1e-5']
  Dropouts: ['0.0']
  Seeds: ['42', '123', '999']
Total experiments: 36
================================================================================
Using device: cuda

================================================================================
STARTING RUN: arch=resnet50 size=224x224 lr=0.0001 drop=0.0 seed=42
================================================================================
Starting experiment: resnet50__224x224__lr-0.0001__drop-0.0__seed-42
Output directory: results_opg/resnet50__224x224__lr-0.0001__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 1.1207
  Epoch 0 [Batch 4/40]: Loss: 1.1109
  Epoch 0 [Batch 8/40]: Loss: 1.0930
  Epoch 0 [Batch 12/40]: Loss: 1.0503
  Epoch 0 [Batch 16/40]: Loss: 1.0291
  Epoch 0 [Batch 20/40]: Loss: 1.0147
  Epoch 0 [Batch 24/40]: Loss: 1.0488
  Epoch 0 [Batch 28/40]: Loss: 0.9655
  Epoch 0 [Batch 32/40]: Loss: 0.9996
  Epoch 0 [Batch 36/40]: Loss: 1.1658
  Epoch 0 Train Summary: Avg Loss: 1.0491, Accuracy: 0.3806
  Validation Summary: Avg Loss: 0.9663, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from inf to 0.9663. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 0.8775
  Epoch 1 [Batch 4/40]: Loss: 0.9229
  Epoch 1 [Batch 8/40]: Loss: 0.8978
  Epoch 1 [Batch 12/40]: Loss: 0.9817
  Epoch 1 [Batch 16/40]: Loss: 0.9317
  Epoch 1 [Batch 20/40]: Loss: 1.0555
  Epoch 1 [Batch 24/40]: Loss: 1.0050
  Epoch 1 [Batch 28/40]: Loss: 0.9611
  Epoch 1 [Batch 32/40]: Loss: 1.0677
  Epoch 1 [Batch 36/40]: Loss: 1.1682
  Epoch 1 Train Summary: Avg Loss: 0.9699, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9102, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9663 to 0.9102. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.0470
  Epoch 2 [Batch 4/40]: Loss: 0.9666
  Epoch 2 [Batch 8/40]: Loss: 1.1883
  Epoch 2 [Batch 12/40]: Loss: 0.6236
  Epoch 2 [Batch 16/40]: Loss: 0.8397
  Epoch 2 [Batch 20/40]: Loss: 0.8459
  Epoch 2 [Batch 24/40]: Loss: 0.8980
  Epoch 2 [Batch 28/40]: Loss: 1.1089
  Epoch 2 [Batch 32/40]: Loss: 1.1862
  Epoch 2 [Batch 36/40]: Loss: 0.9237
  Epoch 2 Train Summary: Avg Loss: 0.9540, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8371, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9102 to 0.8371. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 0.8529
  Epoch 3 [Batch 4/40]: Loss: 0.8099
  Epoch 3 [Batch 8/40]: Loss: 1.0105
  Epoch 3 [Batch 12/40]: Loss: 0.9019
  Epoch 3 [Batch 16/40]: Loss: 0.8892
  Epoch 3 [Batch 20/40]: Loss: 1.1386
  Epoch 3 [Batch 24/40]: Loss: 1.0877
  Epoch 3 [Batch 28/40]: Loss: 1.0003
  Epoch 3 [Batch 32/40]: Loss: 0.6640
  Epoch 3 [Batch 36/40]: Loss: 1.2033
  Epoch 3 Train Summary: Avg Loss: 0.9500, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8687, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 1.2760
  Epoch 4 [Batch 4/40]: Loss: 0.9780
  Epoch 4 [Batch 8/40]: Loss: 0.9441
  Epoch 4 [Batch 12/40]: Loss: 1.1852
  Epoch 4 [Batch 16/40]: Loss: 0.9401
  Epoch 4 [Batch 20/40]: Loss: 1.0016
  Epoch 4 [Batch 24/40]: Loss: 0.8887
  Epoch 4 [Batch 28/40]: Loss: 0.6819
  Epoch 4 [Batch 32/40]: Loss: 1.1581
  Epoch 4 [Batch 36/40]: Loss: 0.9287
  Epoch 4 Train Summary: Avg Loss: 0.9366, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8359, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8371 to 0.8359. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 1.0507
  Epoch 5 [Batch 4/40]: Loss: 0.9158
  Epoch 5 [Batch 8/40]: Loss: 0.9013
  Epoch 5 [Batch 12/40]: Loss: 0.8222
  Epoch 5 [Batch 16/40]: Loss: 0.6495
  Epoch 5 [Batch 20/40]: Loss: 0.9657
  Epoch 5 [Batch 24/40]: Loss: 0.8482
  Epoch 5 [Batch 28/40]: Loss: 0.9763
  Epoch 5 [Batch 32/40]: Loss: 0.8541
  Epoch 5 [Batch 36/40]: Loss: 0.5969
  Epoch 5 Train Summary: Avg Loss: 0.9208, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8702, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 1.1682
  Epoch 6 [Batch 4/40]: Loss: 1.1753
  Epoch 6 [Batch 8/40]: Loss: 0.7261
  Epoch 6 [Batch 12/40]: Loss: 1.1747
  Epoch 6 [Batch 16/40]: Loss: 0.8998
  Epoch 6 [Batch 20/40]: Loss: 0.6751
  Epoch 6 [Batch 24/40]: Loss: 0.8922
  Epoch 6 [Batch 28/40]: Loss: 1.1843
  Epoch 6 [Batch 32/40]: Loss: 0.9362
  Epoch 6 [Batch 36/40]: Loss: 0.6912
  Epoch 6 Train Summary: Avg Loss: 0.9069, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8625, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 1.6882
  Epoch 7 [Batch 4/40]: Loss: 0.7869
  Epoch 7 [Batch 8/40]: Loss: 1.1254
  Epoch 7 [Batch 12/40]: Loss: 0.8761
  Epoch 7 [Batch 16/40]: Loss: 0.9388
  Epoch 7 [Batch 20/40]: Loss: 0.8991
  Epoch 7 [Batch 24/40]: Loss: 0.8965
  Epoch 7 [Batch 28/40]: Loss: 0.7495
  Epoch 7 [Batch 32/40]: Loss: 0.9898
  Epoch 7 [Batch 36/40]: Loss: 0.8744
  Epoch 7 Train Summary: Avg Loss: 0.9224, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9350, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.7799
  Epoch 8 [Batch 4/40]: Loss: 1.0533
  Epoch 8 [Batch 8/40]: Loss: 0.8972
  Epoch 8 [Batch 12/40]: Loss: 0.9405
  Epoch 8 [Batch 16/40]: Loss: 0.8612
  Epoch 8 [Batch 20/40]: Loss: 0.8822
  Epoch 8 [Batch 24/40]: Loss: 1.1562
  Epoch 8 [Batch 28/40]: Loss: 0.6671
  Epoch 8 [Batch 32/40]: Loss: 0.7633
  Epoch 8 [Batch 36/40]: Loss: 1.3248
  Epoch 8 Train Summary: Avg Loss: 0.8971, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8713, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 1.1163
  Epoch 9 [Batch 4/40]: Loss: 1.1667
  Epoch 9 [Batch 8/40]: Loss: 0.8967
  Epoch 9 [Batch 12/40]: Loss: 1.0740
  Epoch 9 [Batch 16/40]: Loss: 1.0065
  Epoch 9 [Batch 20/40]: Loss: 1.0567
  Epoch 9 [Batch 24/40]: Loss: 0.6930
  Epoch 9 [Batch 28/40]: Loss: 0.7999
  Epoch 9 [Batch 32/40]: Loss: 0.6076
  Epoch 9 [Batch 36/40]: Loss: 0.7259
  Epoch 9 Train Summary: Avg Loss: 0.8841, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8524, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 1.0514
  Epoch 10 [Batch 4/40]: Loss: 0.9016
  Epoch 10 [Batch 8/40]: Loss: 0.7621
  Epoch 10 [Batch 12/40]: Loss: 0.9343
  Epoch 10 [Batch 16/40]: Loss: 0.8556
  Epoch 10 [Batch 20/40]: Loss: 0.7769
  Epoch 10 [Batch 24/40]: Loss: 0.5677
  Epoch 10 [Batch 28/40]: Loss: 0.8140
  Epoch 10 [Batch 32/40]: Loss: 0.8980
  Epoch 10 [Batch 36/40]: Loss: 1.1431
  Epoch 10 Train Summary: Avg Loss: 0.8611, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8976, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.7654
  Epoch 11 [Batch 4/40]: Loss: 1.0137
  Epoch 11 [Batch 8/40]: Loss: 1.0669
  Epoch 11 [Batch 12/40]: Loss: 0.5650
  Epoch 11 [Batch 16/40]: Loss: 1.1831
  Epoch 11 [Batch 20/40]: Loss: 0.9116
  Epoch 11 [Batch 24/40]: Loss: 0.8510
  Epoch 11 [Batch 28/40]: Loss: 1.0928
  Epoch 11 [Batch 32/40]: Loss: 0.9789
  Epoch 11 [Batch 36/40]: Loss: 0.8486
  Epoch 11 Train Summary: Avg Loss: 0.8566, Accuracy: 0.3368
  Validation Summary: Avg Loss: 0.8983, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.8563
  Epoch 12 [Batch 4/40]: Loss: 0.6078
  Epoch 12 [Batch 8/40]: Loss: 0.8114
  Epoch 12 [Batch 12/40]: Loss: 0.6167
  Epoch 12 [Batch 16/40]: Loss: 1.0580
  Epoch 12 [Batch 20/40]: Loss: 0.5924
  Epoch 12 [Batch 24/40]: Loss: 0.9054
  Epoch 12 [Batch 28/40]: Loss: 1.5133
  Epoch 12 [Batch 32/40]: Loss: 0.6826
  Epoch 12 [Batch 36/40]: Loss: 0.8157
  Epoch 12 Train Summary: Avg Loss: 0.8709, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8859, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.5052
  Epoch 13 [Batch 4/40]: Loss: 0.7938
  Epoch 13 [Batch 8/40]: Loss: 0.6621
  Epoch 13 [Batch 12/40]: Loss: 0.6968
  Epoch 13 [Batch 16/40]: Loss: 1.2822
  Epoch 13 [Batch 20/40]: Loss: 1.1837
  Epoch 13 [Batch 24/40]: Loss: 1.1998
  Epoch 13 [Batch 28/40]: Loss: 1.1240
  Epoch 13 [Batch 32/40]: Loss: 0.5909
  Epoch 13 [Batch 36/40]: Loss: 0.7612
  Epoch 13 Train Summary: Avg Loss: 0.8767, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8894, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 1.0509
  Epoch 14 [Batch 4/40]: Loss: 0.5731
  Epoch 14 [Batch 8/40]: Loss: 1.4636
  Epoch 14 [Batch 12/40]: Loss: 1.2026
  Epoch 14 [Batch 16/40]: Loss: 0.6193
  Epoch 14 [Batch 20/40]: Loss: 0.6920
  Epoch 14 [Batch 24/40]: Loss: 0.6571
  Epoch 14 [Batch 28/40]: Loss: 0.8800
  Epoch 14 [Batch 32/40]: Loss: 0.7988
  Epoch 14 [Batch 36/40]: Loss: 0.7379
  Epoch 14 Train Summary: Avg Loss: 0.8715, Accuracy: 0.3368
  Validation Summary: Avg Loss: 0.9526, Accuracy: 0.3333, F1 (Macro): 0.2462
Training finished in 4.09 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.8359, Accuracy: 0.3333, F1 (Macro): 0.2462
Final Best Model Stats: Acc: 0.3333, F1: 0.2462, Loss: 0.8359
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=0.0001 drop=0.0 seed=123
================================================================================
Starting experiment: resnet50__224x224__lr-0.0001__drop-0.0__seed-123
Output directory: results_opg/resnet50__224x224__lr-0.0001__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 1.1103
  Epoch 0 [Batch 4/40]: Loss: 1.0884
  Epoch 0 [Batch 8/40]: Loss: 1.0594
  Epoch 0 [Batch 12/40]: Loss: 1.0658
  Epoch 0 [Batch 16/40]: Loss: 1.0689
  Epoch 0 [Batch 20/40]: Loss: 1.0594
  Epoch 0 [Batch 24/40]: Loss: 0.9518
  Epoch 0 [Batch 28/40]: Loss: 1.0919
  Epoch 0 [Batch 32/40]: Loss: 1.0285
  Epoch 0 [Batch 36/40]: Loss: 0.9347
  Epoch 0 Train Summary: Avg Loss: 1.0375, Accuracy: 0.3628
  Validation Summary: Avg Loss: 0.9925, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from inf to 0.9925. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 1.1103
  Epoch 1 [Batch 4/40]: Loss: 1.0079
  Epoch 1 [Batch 8/40]: Loss: 1.1223
  Epoch 1 [Batch 12/40]: Loss: 1.0238
  Epoch 1 [Batch 16/40]: Loss: 1.1547
  Epoch 1 [Batch 20/40]: Loss: 1.0895
  Epoch 1 [Batch 24/40]: Loss: 0.9953
  Epoch 1 [Batch 28/40]: Loss: 0.8659
  Epoch 1 [Batch 32/40]: Loss: 0.9486
  Epoch 1 [Batch 36/40]: Loss: 0.8772
  Epoch 1 Train Summary: Avg Loss: 0.9659, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9274, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9925 to 0.9274. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.1087
  Epoch 2 [Batch 4/40]: Loss: 0.9221
  Epoch 2 [Batch 8/40]: Loss: 0.8839
  Epoch 2 [Batch 12/40]: Loss: 0.9779
  Epoch 2 [Batch 16/40]: Loss: 1.1700
  Epoch 2 [Batch 20/40]: Loss: 0.9825
  Epoch 2 [Batch 24/40]: Loss: 0.8120
  Epoch 2 [Batch 28/40]: Loss: 0.9192
  Epoch 2 [Batch 32/40]: Loss: 0.7950
  Epoch 2 [Batch 36/40]: Loss: 0.7733
  Epoch 2 Train Summary: Avg Loss: 0.9554, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9330, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 0.8459
  Epoch 3 [Batch 4/40]: Loss: 0.7816
  Epoch 3 [Batch 8/40]: Loss: 0.9786
  Epoch 3 [Batch 12/40]: Loss: 0.8667
  Epoch 3 [Batch 16/40]: Loss: 1.0443
  Epoch 3 [Batch 20/40]: Loss: 0.8612
  Epoch 3 [Batch 24/40]: Loss: 0.8746
  Epoch 3 [Batch 28/40]: Loss: 1.0601
  Epoch 3 [Batch 32/40]: Loss: 0.9903
  Epoch 3 [Batch 36/40]: Loss: 0.8660
  Epoch 3 Train Summary: Avg Loss: 0.9297, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8965, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9274 to 0.8965. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 0.6357
  Epoch 4 [Batch 4/40]: Loss: 0.7050
  Epoch 4 [Batch 8/40]: Loss: 0.9193
  Epoch 4 [Batch 12/40]: Loss: 1.1208
  Epoch 4 [Batch 16/40]: Loss: 0.9390
  Epoch 4 [Batch 20/40]: Loss: 1.1029
  Epoch 4 [Batch 24/40]: Loss: 0.9346
  Epoch 4 [Batch 28/40]: Loss: 1.1301
  Epoch 4 [Batch 32/40]: Loss: 0.9613
  Epoch 4 [Batch 36/40]: Loss: 0.7811
  Epoch 4 Train Summary: Avg Loss: 0.9440, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9039, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 1.0735
  Epoch 5 [Batch 4/40]: Loss: 0.8501
  Epoch 5 [Batch 8/40]: Loss: 0.8450
  Epoch 5 [Batch 12/40]: Loss: 1.3574
  Epoch 5 [Batch 16/40]: Loss: 0.7816
  Epoch 5 [Batch 20/40]: Loss: 0.6169
  Epoch 5 [Batch 24/40]: Loss: 0.9776
  Epoch 5 [Batch 28/40]: Loss: 0.7137
  Epoch 5 [Batch 32/40]: Loss: 0.9064
  Epoch 5 [Batch 36/40]: Loss: 0.8855
  Epoch 5 Train Summary: Avg Loss: 0.9333, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8906, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8965 to 0.8906. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 0.8784
  Epoch 6 [Batch 4/40]: Loss: 1.1770
  Epoch 6 [Batch 8/40]: Loss: 0.7207
  Epoch 6 [Batch 12/40]: Loss: 0.9139
  Epoch 6 [Batch 16/40]: Loss: 0.8676
  Epoch 6 [Batch 20/40]: Loss: 0.9920
  Epoch 6 [Batch 24/40]: Loss: 1.1711
  Epoch 6 [Batch 28/40]: Loss: 1.1721
  Epoch 6 [Batch 32/40]: Loss: 0.8430
  Epoch 6 [Batch 36/40]: Loss: 0.8585
  Epoch 6 Train Summary: Avg Loss: 0.9105, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8544, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8906 to 0.8544. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 1.1077
  Epoch 7 [Batch 4/40]: Loss: 0.9987
  Epoch 7 [Batch 8/40]: Loss: 0.9899
  Epoch 7 [Batch 12/40]: Loss: 1.1879
  Epoch 7 [Batch 16/40]: Loss: 0.7847
  Epoch 7 [Batch 20/40]: Loss: 0.9897
  Epoch 7 [Batch 24/40]: Loss: 0.9263
  Epoch 7 [Batch 28/40]: Loss: 0.6794
  Epoch 7 [Batch 32/40]: Loss: 0.8060
  Epoch 7 [Batch 36/40]: Loss: 0.6113
  Epoch 7 Train Summary: Avg Loss: 0.9319, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8687, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.6656
  Epoch 8 [Batch 4/40]: Loss: 1.0142
  Epoch 8 [Batch 8/40]: Loss: 0.6575
  Epoch 8 [Batch 12/40]: Loss: 0.8145
  Epoch 8 [Batch 16/40]: Loss: 0.5815
  Epoch 8 [Batch 20/40]: Loss: 1.0275
  Epoch 8 [Batch 24/40]: Loss: 0.6692
  Epoch 8 [Batch 28/40]: Loss: 0.9664
  Epoch 8 [Batch 32/40]: Loss: 0.9936
  Epoch 8 [Batch 36/40]: Loss: 0.5264
  Epoch 8 Train Summary: Avg Loss: 0.8979, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8704, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.7539
  Epoch 9 [Batch 4/40]: Loss: 1.0816
  Epoch 9 [Batch 8/40]: Loss: 0.7878
  Epoch 9 [Batch 12/40]: Loss: 1.1248
  Epoch 9 [Batch 16/40]: Loss: 0.8442
  Epoch 9 [Batch 20/40]: Loss: 0.8773
  Epoch 9 [Batch 24/40]: Loss: 1.1493
  Epoch 9 [Batch 28/40]: Loss: 0.6417
  Epoch 9 [Batch 32/40]: Loss: 0.9432
  Epoch 9 [Batch 36/40]: Loss: 0.6819
  Epoch 9 Train Summary: Avg Loss: 0.8874, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8746, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 1.1204
  Epoch 10 [Batch 4/40]: Loss: 0.8832
  Epoch 10 [Batch 8/40]: Loss: 0.9547
  Epoch 10 [Batch 12/40]: Loss: 0.7382
  Epoch 10 [Batch 16/40]: Loss: 0.8285
  Epoch 10 [Batch 20/40]: Loss: 1.0234
  Epoch 10 [Batch 24/40]: Loss: 0.6420
  Epoch 10 [Batch 28/40]: Loss: 1.0621
  Epoch 10 [Batch 32/40]: Loss: 1.5864
  Epoch 10 [Batch 36/40]: Loss: 0.9047
  Epoch 10 Train Summary: Avg Loss: 0.8813, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8715, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.6759
  Epoch 11 [Batch 4/40]: Loss: 0.7300
  Epoch 11 [Batch 8/40]: Loss: 0.8590
  Epoch 11 [Batch 12/40]: Loss: 0.8799
  Epoch 11 [Batch 16/40]: Loss: 0.8785
  Epoch 11 [Batch 20/40]: Loss: 0.8335
  Epoch 11 [Batch 24/40]: Loss: 0.8482
  Epoch 11 [Batch 28/40]: Loss: 0.7475
  Epoch 11 [Batch 32/40]: Loss: 0.6838
  Epoch 11 [Batch 36/40]: Loss: 0.8302
  Epoch 11 Train Summary: Avg Loss: 0.8634, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8758, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.7203
  Epoch 12 [Batch 4/40]: Loss: 0.9219
  Epoch 12 [Batch 8/40]: Loss: 0.6217
  Epoch 12 [Batch 12/40]: Loss: 1.3576
  Epoch 12 [Batch 16/40]: Loss: 0.6050
  Epoch 12 [Batch 20/40]: Loss: 0.7166
  Epoch 12 [Batch 24/40]: Loss: 0.8377
  Epoch 12 [Batch 28/40]: Loss: 0.8572
  Epoch 12 [Batch 32/40]: Loss: 0.8519
  Epoch 12 [Batch 36/40]: Loss: 0.7620
  Epoch 12 Train Summary: Avg Loss: 0.8558, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8199, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8544 to 0.8199. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 1.1128
  Epoch 13 [Batch 4/40]: Loss: 0.9700
  Epoch 13 [Batch 8/40]: Loss: 0.8865
  Epoch 13 [Batch 12/40]: Loss: 0.6563
  Epoch 13 [Batch 16/40]: Loss: 1.1129
  Epoch 13 [Batch 20/40]: Loss: 0.8292
  Epoch 13 [Batch 24/40]: Loss: 0.7600
  Epoch 13 [Batch 28/40]: Loss: 0.9863
  Epoch 13 [Batch 32/40]: Loss: 0.9480
  Epoch 13 [Batch 36/40]: Loss: 0.5280
  Epoch 13 Train Summary: Avg Loss: 0.8406, Accuracy: 0.3560
  Validation Summary: Avg Loss: 0.8106, Accuracy: 0.3333, F1 (Macro): 0.2500
  New best model! Val loss improved from 0.8199 to 0.8106. Saving...

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 1.0293
  Epoch 14 [Batch 4/40]: Loss: 1.1191
  Epoch 14 [Batch 8/40]: Loss: 0.7999
  Epoch 14 [Batch 12/40]: Loss: 1.1074
  Epoch 14 [Batch 16/40]: Loss: 1.0066
  Epoch 14 [Batch 20/40]: Loss: 0.9089
  Epoch 14 [Batch 24/40]: Loss: 0.9060
  Epoch 14 [Batch 28/40]: Loss: 0.6926
  Epoch 14 [Batch 32/40]: Loss: 0.8477
  Epoch 14 [Batch 36/40]: Loss: 0.5494
  Epoch 14 Train Summary: Avg Loss: 0.8252, Accuracy: 0.3404
  Validation Summary: Avg Loss: 0.8237, Accuracy: 0.3472, F1 (Macro): 0.2910
Training finished in 3.68 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.8106, Accuracy: 0.3333, F1 (Macro): 0.2500
Final Best Model Stats: Acc: 0.3333, F1: 0.2500, Loss: 0.8106
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=0.0001 drop=0.0 seed=999
================================================================================
Starting experiment: resnet50__224x224__lr-0.0001__drop-0.0__seed-999
Output directory: results_opg/resnet50__224x224__lr-0.0001__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 1.1933
  Epoch 0 [Batch 4/40]: Loss: 1.1228
  Epoch 0 [Batch 8/40]: Loss: 1.0969
  Epoch 0 [Batch 12/40]: Loss: 1.0855
  Epoch 0 [Batch 16/40]: Loss: 1.0984
  Epoch 0 [Batch 20/40]: Loss: 1.0676
  Epoch 0 [Batch 24/40]: Loss: 0.9838
  Epoch 0 [Batch 28/40]: Loss: 1.0122
  Epoch 0 [Batch 32/40]: Loss: 1.0306
  Epoch 0 [Batch 36/40]: Loss: 1.0087
  Epoch 0 Train Summary: Avg Loss: 1.0590, Accuracy: 0.3252
  Validation Summary: Avg Loss: 1.0213, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from inf to 1.0213. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 0.9865
  Epoch 1 [Batch 4/40]: Loss: 0.8942
  Epoch 1 [Batch 8/40]: Loss: 0.8641
  Epoch 1 [Batch 12/40]: Loss: 1.0324
  Epoch 1 [Batch 16/40]: Loss: 1.0563
  Epoch 1 [Batch 20/40]: Loss: 0.8932
  Epoch 1 [Batch 24/40]: Loss: 0.8785
  Epoch 1 [Batch 28/40]: Loss: 1.1651
  Epoch 1 [Batch 32/40]: Loss: 0.8565
  Epoch 1 [Batch 36/40]: Loss: 0.9820
  Epoch 1 Train Summary: Avg Loss: 0.9703, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9301, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0213 to 0.9301. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.2556
  Epoch 2 [Batch 4/40]: Loss: 0.9446
  Epoch 2 [Batch 8/40]: Loss: 0.8950
  Epoch 2 [Batch 12/40]: Loss: 0.8813
  Epoch 2 [Batch 16/40]: Loss: 0.9066
  Epoch 2 [Batch 20/40]: Loss: 1.0006
  Epoch 2 [Batch 24/40]: Loss: 0.9836
  Epoch 2 [Batch 28/40]: Loss: 1.0779
  Epoch 2 [Batch 32/40]: Loss: 1.0287
  Epoch 2 [Batch 36/40]: Loss: 1.1913
  Epoch 2 Train Summary: Avg Loss: 0.9444, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8771, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9301 to 0.8771. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 0.7480
  Epoch 3 [Batch 4/40]: Loss: 0.7540
  Epoch 3 [Batch 8/40]: Loss: 0.9113
  Epoch 3 [Batch 12/40]: Loss: 0.9433
  Epoch 3 [Batch 16/40]: Loss: 1.2168
  Epoch 3 [Batch 20/40]: Loss: 1.0110
  Epoch 3 [Batch 24/40]: Loss: 0.9966
  Epoch 3 [Batch 28/40]: Loss: 0.9865
  Epoch 3 [Batch 32/40]: Loss: 0.8648
  Epoch 3 [Batch 36/40]: Loss: 0.8427
  Epoch 3 Train Summary: Avg Loss: 0.9559, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8620, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8771 to 0.8620. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 1.0800
  Epoch 4 [Batch 4/40]: Loss: 0.5724
  Epoch 4 [Batch 8/40]: Loss: 0.9654
  Epoch 4 [Batch 12/40]: Loss: 1.2569
  Epoch 4 [Batch 16/40]: Loss: 0.7858
  Epoch 4 [Batch 20/40]: Loss: 1.0213
  Epoch 4 [Batch 24/40]: Loss: 1.1314
  Epoch 4 [Batch 28/40]: Loss: 0.9216
  Epoch 4 [Batch 32/40]: Loss: 0.8699
  Epoch 4 [Batch 36/40]: Loss: 0.9558
  Epoch 4 Train Summary: Avg Loss: 0.9276, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8473, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8620 to 0.8473. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 0.6137
  Epoch 5 [Batch 4/40]: Loss: 1.0903
  Epoch 5 [Batch 8/40]: Loss: 1.0272
  Epoch 5 [Batch 12/40]: Loss: 0.7655
  Epoch 5 [Batch 16/40]: Loss: 0.6567
  Epoch 5 [Batch 20/40]: Loss: 0.7083
  Epoch 5 [Batch 24/40]: Loss: 0.8565
  Epoch 5 [Batch 28/40]: Loss: 0.7205
  Epoch 5 [Batch 32/40]: Loss: 1.2016
  Epoch 5 [Batch 36/40]: Loss: 0.7272
  Epoch 5 Train Summary: Avg Loss: 0.9487, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8350, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8473 to 0.8350. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 1.1884
  Epoch 6 [Batch 4/40]: Loss: 0.9147
  Epoch 6 [Batch 8/40]: Loss: 0.6807
  Epoch 6 [Batch 12/40]: Loss: 0.9243
  Epoch 6 [Batch 16/40]: Loss: 0.7031
  Epoch 6 [Batch 20/40]: Loss: 1.2102
  Epoch 6 [Batch 24/40]: Loss: 1.0800
  Epoch 6 [Batch 28/40]: Loss: 0.6787
  Epoch 6 [Batch 32/40]: Loss: 0.9859
  Epoch 6 [Batch 36/40]: Loss: 1.2795
  Epoch 6 Train Summary: Avg Loss: 0.9234, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8686, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 0.9797
  Epoch 7 [Batch 4/40]: Loss: 0.8358
  Epoch 7 [Batch 8/40]: Loss: 0.9300
  Epoch 7 [Batch 12/40]: Loss: 1.1276
  Epoch 7 [Batch 16/40]: Loss: 0.7497
  Epoch 7 [Batch 20/40]: Loss: 0.9383
  Epoch 7 [Batch 24/40]: Loss: 1.0640
  Epoch 7 [Batch 28/40]: Loss: 0.7714
  Epoch 7 [Batch 32/40]: Loss: 0.7936
  Epoch 7 [Batch 36/40]: Loss: 0.7682
  Epoch 7 Train Summary: Avg Loss: 0.9057, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8466, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.9351
  Epoch 8 [Batch 4/40]: Loss: 0.9162
  Epoch 8 [Batch 8/40]: Loss: 0.7992
  Epoch 8 [Batch 12/40]: Loss: 1.0134
  Epoch 8 [Batch 16/40]: Loss: 1.1101
  Epoch 8 [Batch 20/40]: Loss: 1.1270
  Epoch 8 [Batch 24/40]: Loss: 0.9035
  Epoch 8 [Batch 28/40]: Loss: 0.6583
  Epoch 8 [Batch 32/40]: Loss: 1.0823
  Epoch 8 [Batch 36/40]: Loss: 0.6037
  Epoch 8 Train Summary: Avg Loss: 0.9046, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8255, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8350 to 0.8255. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.7708
  Epoch 9 [Batch 4/40]: Loss: 1.1361
  Epoch 9 [Batch 8/40]: Loss: 0.8809
  Epoch 9 [Batch 12/40]: Loss: 0.7339
  Epoch 9 [Batch 16/40]: Loss: 0.7258
  Epoch 9 [Batch 20/40]: Loss: 0.8331
  Epoch 9 [Batch 24/40]: Loss: 0.6207
  Epoch 9 [Batch 28/40]: Loss: 0.7210
  Epoch 9 [Batch 32/40]: Loss: 0.7282
  Epoch 9 [Batch 36/40]: Loss: 1.0734
  Epoch 9 Train Summary: Avg Loss: 0.9122, Accuracy: 0.3368
  Validation Summary: Avg Loss: 0.8068, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8255 to 0.8068. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 1.0576
  Epoch 10 [Batch 4/40]: Loss: 0.7325
  Epoch 10 [Batch 8/40]: Loss: 1.0783
  Epoch 10 [Batch 12/40]: Loss: 0.9593
  Epoch 10 [Batch 16/40]: Loss: 0.7018
  Epoch 10 [Batch 20/40]: Loss: 1.1027
  Epoch 10 [Batch 24/40]: Loss: 1.2019
  Epoch 10 [Batch 28/40]: Loss: 0.7019
  Epoch 10 [Batch 32/40]: Loss: 0.7226
  Epoch 10 [Batch 36/40]: Loss: 1.0071
  Epoch 10 Train Summary: Avg Loss: 0.9097, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.7874, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8068 to 0.7874. Saving...

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.8387
  Epoch 11 [Batch 4/40]: Loss: 0.9055
  Epoch 11 [Batch 8/40]: Loss: 0.6160
  Epoch 11 [Batch 12/40]: Loss: 0.7540
  Epoch 11 [Batch 16/40]: Loss: 1.1414
  Epoch 11 [Batch 20/40]: Loss: 1.1569
  Epoch 11 [Batch 24/40]: Loss: 0.7816
  Epoch 11 [Batch 28/40]: Loss: 0.8074
  Epoch 11 [Batch 32/40]: Loss: 1.0423
  Epoch 11 [Batch 36/40]: Loss: 0.9004
  Epoch 11 Train Summary: Avg Loss: 0.8653, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.7738, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.7874 to 0.7738. Saving...

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.8778
  Epoch 12 [Batch 4/40]: Loss: 0.8195
  Epoch 12 [Batch 8/40]: Loss: 1.2326
  Epoch 12 [Batch 12/40]: Loss: 0.8204
  Epoch 12 [Batch 16/40]: Loss: 0.6929
  Epoch 12 [Batch 20/40]: Loss: 0.7424
  Epoch 12 [Batch 24/40]: Loss: 0.9790
  Epoch 12 [Batch 28/40]: Loss: 1.6060
  Epoch 12 [Batch 32/40]: Loss: 0.8635
  Epoch 12 [Batch 36/40]: Loss: 1.1684
  Epoch 12 Train Summary: Avg Loss: 0.8604, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.7940, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.5397
  Epoch 13 [Batch 4/40]: Loss: 0.8360
  Epoch 13 [Batch 8/40]: Loss: 1.1808
  Epoch 13 [Batch 12/40]: Loss: 0.9858
  Epoch 13 [Batch 16/40]: Loss: 1.0225
  Epoch 13 [Batch 20/40]: Loss: 1.1165
  Epoch 13 [Batch 24/40]: Loss: 0.7113
  Epoch 13 [Batch 28/40]: Loss: 0.6819
  Epoch 13 [Batch 32/40]: Loss: 0.9948
  Epoch 13 [Batch 36/40]: Loss: 0.7657
  Epoch 13 Train Summary: Avg Loss: 0.8466, Accuracy: 0.3368
  Validation Summary: Avg Loss: 0.8466, Accuracy: 0.3194, F1 (Macro): 0.2473

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 0.9082
  Epoch 14 [Batch 4/40]: Loss: 0.7292
  Epoch 14 [Batch 8/40]: Loss: 0.8902
  Epoch 14 [Batch 12/40]: Loss: 1.0584
  Epoch 14 [Batch 16/40]: Loss: 0.9822
  Epoch 14 [Batch 20/40]: Loss: 0.6834
  Epoch 14 [Batch 24/40]: Loss: 0.9142
  Epoch 14 [Batch 28/40]: Loss: 0.7254
  Epoch 14 [Batch 32/40]: Loss: 0.9941
  Epoch 14 [Batch 36/40]: Loss: 0.6183
  Epoch 14 Train Summary: Avg Loss: 0.8259, Accuracy: 0.3560
  Validation Summary: Avg Loss: 0.8186, Accuracy: 0.4583, F1 (Macro): 0.4398
Training finished in 4.12 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.7738, Accuracy: 0.3333, F1 (Macro): 0.2462
Final Best Model Stats: Acc: 0.3333, F1: 0.2462, Loss: 0.7738
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=5e-05 drop=0.0 seed=42
================================================================================
Starting experiment: resnet50__224x224__lr-5e-05__drop-0.0__seed-42
Output directory: results_opg/resnet50__224x224__lr-5e-05__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 1.1207
  Epoch 0 [Batch 4/40]: Loss: 1.1284
  Epoch 0 [Batch 8/40]: Loss: 1.1195
  Epoch 0 [Batch 12/40]: Loss: 1.0975
  Epoch 0 [Batch 16/40]: Loss: 1.0782
  Epoch 0 [Batch 20/40]: Loss: 1.0541
  Epoch 0 [Batch 24/40]: Loss: 1.0912
  Epoch 0 [Batch 28/40]: Loss: 1.0319
  Epoch 0 [Batch 32/40]: Loss: 1.0500
  Epoch 0 [Batch 36/40]: Loss: 1.1190
  Epoch 0 Train Summary: Avg Loss: 1.0803, Accuracy: 0.3584
  Validation Summary: Avg Loss: 1.0362, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from inf to 1.0362. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 0.9756
  Epoch 1 [Batch 4/40]: Loss: 1.0228
  Epoch 1 [Batch 8/40]: Loss: 1.0063
  Epoch 1 [Batch 12/40]: Loss: 1.0355
  Epoch 1 [Batch 16/40]: Loss: 0.9900
  Epoch 1 [Batch 20/40]: Loss: 1.0304
  Epoch 1 [Batch 24/40]: Loss: 1.0092
  Epoch 1 [Batch 28/40]: Loss: 1.0178
  Epoch 1 [Batch 32/40]: Loss: 1.0795
  Epoch 1 [Batch 36/40]: Loss: 1.1077
  Epoch 1 Train Summary: Avg Loss: 1.0181, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9740, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0362 to 0.9740. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.0538
  Epoch 2 [Batch 4/40]: Loss: 1.0276
  Epoch 2 [Batch 8/40]: Loss: 1.1553
  Epoch 2 [Batch 12/40]: Loss: 0.7683
  Epoch 2 [Batch 16/40]: Loss: 0.9341
  Epoch 2 [Batch 20/40]: Loss: 0.9162
  Epoch 2 [Batch 24/40]: Loss: 0.9653
  Epoch 2 [Batch 28/40]: Loss: 1.0639
  Epoch 2 [Batch 32/40]: Loss: 1.0801
  Epoch 2 [Batch 36/40]: Loss: 0.9740
  Epoch 2 Train Summary: Avg Loss: 0.9872, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9225, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9740 to 0.9225. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 0.8966
  Epoch 3 [Batch 4/40]: Loss: 0.8940
  Epoch 3 [Batch 8/40]: Loss: 1.0142
  Epoch 3 [Batch 12/40]: Loss: 0.9175
  Epoch 3 [Batch 16/40]: Loss: 0.8775
  Epoch 3 [Batch 20/40]: Loss: 1.0925
  Epoch 3 [Batch 24/40]: Loss: 1.0865
  Epoch 3 [Batch 28/40]: Loss: 1.0128
  Epoch 3 [Batch 32/40]: Loss: 0.7327
  Epoch 3 [Batch 36/40]: Loss: 1.1334
  Epoch 3 Train Summary: Avg Loss: 0.9654, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8912, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9225 to 0.8912. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 1.1973
  Epoch 4 [Batch 4/40]: Loss: 1.0153
  Epoch 4 [Batch 8/40]: Loss: 0.9056
  Epoch 4 [Batch 12/40]: Loss: 1.1886
  Epoch 4 [Batch 16/40]: Loss: 0.8886
  Epoch 4 [Batch 20/40]: Loss: 0.9860
  Epoch 4 [Batch 24/40]: Loss: 0.9438
  Epoch 4 [Batch 28/40]: Loss: 0.7209
  Epoch 4 [Batch 32/40]: Loss: 1.1539
  Epoch 4 [Batch 36/40]: Loss: 1.0529
  Epoch 4 Train Summary: Avg Loss: 0.9545, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8589, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8912 to 0.8589. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 1.0545
  Epoch 5 [Batch 4/40]: Loss: 0.9796
  Epoch 5 [Batch 8/40]: Loss: 0.9773
  Epoch 5 [Batch 12/40]: Loss: 0.8671
  Epoch 5 [Batch 16/40]: Loss: 0.7197
  Epoch 5 [Batch 20/40]: Loss: 0.9864
  Epoch 5 [Batch 24/40]: Loss: 0.8468
  Epoch 5 [Batch 28/40]: Loss: 1.0141
  Epoch 5 [Batch 32/40]: Loss: 0.8690
  Epoch 5 [Batch 36/40]: Loss: 0.6069
  Epoch 5 Train Summary: Avg Loss: 0.9380, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8710, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 1.2108
  Epoch 6 [Batch 4/40]: Loss: 1.1172
  Epoch 6 [Batch 8/40]: Loss: 0.7536
  Epoch 6 [Batch 12/40]: Loss: 1.2003
  Epoch 6 [Batch 16/40]: Loss: 0.9672
  Epoch 6 [Batch 20/40]: Loss: 0.7265
  Epoch 6 [Batch 24/40]: Loss: 0.9221
  Epoch 6 [Batch 28/40]: Loss: 1.1328
  Epoch 6 [Batch 32/40]: Loss: 0.9391
  Epoch 6 [Batch 36/40]: Loss: 0.7237
  Epoch 6 Train Summary: Avg Loss: 0.9324, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8849, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 1.5783
  Epoch 7 [Batch 4/40]: Loss: 0.7518
  Epoch 7 [Batch 8/40]: Loss: 1.1149
  Epoch 7 [Batch 12/40]: Loss: 0.9062
  Epoch 7 [Batch 16/40]: Loss: 1.0445
  Epoch 7 [Batch 20/40]: Loss: 0.9075
  Epoch 7 [Batch 24/40]: Loss: 0.9354
  Epoch 7 [Batch 28/40]: Loss: 0.8003
  Epoch 7 [Batch 32/40]: Loss: 0.8984
  Epoch 7 [Batch 36/40]: Loss: 0.8963
  Epoch 7 Train Summary: Avg Loss: 0.9428, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9221, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.8217
  Epoch 8 [Batch 4/40]: Loss: 1.1296
  Epoch 8 [Batch 8/40]: Loss: 0.9129
  Epoch 8 [Batch 12/40]: Loss: 0.9578
  Epoch 8 [Batch 16/40]: Loss: 0.8679
  Epoch 8 [Batch 20/40]: Loss: 0.9454
  Epoch 8 [Batch 24/40]: Loss: 1.0546
  Epoch 8 [Batch 28/40]: Loss: 0.7135
  Epoch 8 [Batch 32/40]: Loss: 0.7838
  Epoch 8 [Batch 36/40]: Loss: 1.2610
  Epoch 8 Train Summary: Avg Loss: 0.9193, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8656, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 1.0198
  Epoch 9 [Batch 4/40]: Loss: 1.1500
  Epoch 9 [Batch 8/40]: Loss: 0.8573
  Epoch 9 [Batch 12/40]: Loss: 1.0047
  Epoch 9 [Batch 16/40]: Loss: 0.9712
  Epoch 9 [Batch 20/40]: Loss: 0.9825
  Epoch 9 [Batch 24/40]: Loss: 0.7625
  Epoch 9 [Batch 28/40]: Loss: 0.7735
  Epoch 9 [Batch 32/40]: Loss: 0.6470
  Epoch 9 [Batch 36/40]: Loss: 0.7452
  Epoch 9 Train Summary: Avg Loss: 0.9113, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8422, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8589 to 0.8422. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 1.0470
  Epoch 10 [Batch 4/40]: Loss: 0.8614
  Epoch 10 [Batch 8/40]: Loss: 0.8445
  Epoch 10 [Batch 12/40]: Loss: 0.9076
  Epoch 10 [Batch 16/40]: Loss: 0.9429
  Epoch 10 [Batch 20/40]: Loss: 0.8352
  Epoch 10 [Batch 24/40]: Loss: 0.6800
  Epoch 10 [Batch 28/40]: Loss: 0.8172
  Epoch 10 [Batch 32/40]: Loss: 0.8999
  Epoch 10 [Batch 36/40]: Loss: 0.9820
  Epoch 10 Train Summary: Avg Loss: 0.8963, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8398, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8422 to 0.8398. Saving...

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.8645
  Epoch 11 [Batch 4/40]: Loss: 0.9467
  Epoch 11 [Batch 8/40]: Loss: 1.0778
  Epoch 11 [Batch 12/40]: Loss: 0.6232
  Epoch 11 [Batch 16/40]: Loss: 1.1233
  Epoch 11 [Batch 20/40]: Loss: 0.9891
  Epoch 11 [Batch 24/40]: Loss: 0.8055
  Epoch 11 [Batch 28/40]: Loss: 1.0290
  Epoch 11 [Batch 32/40]: Loss: 1.0012
  Epoch 11 [Batch 36/40]: Loss: 0.9091
  Epoch 11 Train Summary: Avg Loss: 0.9034, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8466, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.8651
  Epoch 12 [Batch 4/40]: Loss: 0.6950
  Epoch 12 [Batch 8/40]: Loss: 0.9390
  Epoch 12 [Batch 12/40]: Loss: 0.6554
  Epoch 12 [Batch 16/40]: Loss: 1.1168
  Epoch 12 [Batch 20/40]: Loss: 0.6589
  Epoch 12 [Batch 24/40]: Loss: 0.9413
  Epoch 12 [Batch 28/40]: Loss: 1.5239
  Epoch 12 [Batch 32/40]: Loss: 0.7544
  Epoch 12 [Batch 36/40]: Loss: 0.8839
  Epoch 12 Train Summary: Avg Loss: 0.9115, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8108, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8398 to 0.8108. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.5375
  Epoch 13 [Batch 4/40]: Loss: 0.8184
  Epoch 13 [Batch 8/40]: Loss: 0.7459
  Epoch 13 [Batch 12/40]: Loss: 0.7273
  Epoch 13 [Batch 16/40]: Loss: 1.2637
  Epoch 13 [Batch 20/40]: Loss: 1.1224
  Epoch 13 [Batch 24/40]: Loss: 1.1787
  Epoch 13 [Batch 28/40]: Loss: 1.2339
  Epoch 13 [Batch 32/40]: Loss: 0.6273
  Epoch 13 [Batch 36/40]: Loss: 0.8825
  Epoch 13 Train Summary: Avg Loss: 0.9181, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8197, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 1.2196
  Epoch 14 [Batch 4/40]: Loss: 0.5804
  Epoch 14 [Batch 8/40]: Loss: 1.5079
  Epoch 14 [Batch 12/40]: Loss: 1.2032
  Epoch 14 [Batch 16/40]: Loss: 0.6461
  Epoch 14 [Batch 20/40]: Loss: 0.8204
  Epoch 14 [Batch 24/40]: Loss: 0.6904
  Epoch 14 [Batch 28/40]: Loss: 0.9535
  Epoch 14 [Batch 32/40]: Loss: 0.8523
  Epoch 14 [Batch 36/40]: Loss: 0.8505
  Epoch 14 Train Summary: Avg Loss: 0.9184, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8273, Accuracy: 0.3333, F1 (Macro): 0.2462
Training finished in 4.11 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.8108, Accuracy: 0.3333, F1 (Macro): 0.2462
Final Best Model Stats: Acc: 0.3333, F1: 0.2462, Loss: 0.8108
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=5e-05 drop=0.0 seed=123
================================================================================
Starting experiment: resnet50__224x224__lr-5e-05__drop-0.0__seed-123
Output directory: results_opg/resnet50__224x224__lr-5e-05__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 1.1103
  Epoch 0 [Batch 4/40]: Loss: 1.1068
  Epoch 0 [Batch 8/40]: Loss: 1.0670
  Epoch 0 [Batch 12/40]: Loss: 1.0649
  Epoch 0 [Batch 16/40]: Loss: 1.1019
  Epoch 0 [Batch 20/40]: Loss: 1.1017
  Epoch 0 [Batch 24/40]: Loss: 1.0240
  Epoch 0 [Batch 28/40]: Loss: 1.0843
  Epoch 0 [Batch 32/40]: Loss: 1.0600
  Epoch 0 [Batch 36/40]: Loss: 1.0004
  Epoch 0 Train Summary: Avg Loss: 1.0676, Accuracy: 0.2880
  Validation Summary: Avg Loss: 1.0335, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from inf to 1.0335. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 1.0869
  Epoch 1 [Batch 4/40]: Loss: 1.0691
  Epoch 1 [Batch 8/40]: Loss: 1.0786
  Epoch 1 [Batch 12/40]: Loss: 1.0238
  Epoch 1 [Batch 16/40]: Loss: 1.0964
  Epoch 1 [Batch 20/40]: Loss: 1.0630
  Epoch 1 [Batch 24/40]: Loss: 1.0197
  Epoch 1 [Batch 28/40]: Loss: 0.9476
  Epoch 1 [Batch 32/40]: Loss: 1.0020
  Epoch 1 [Batch 36/40]: Loss: 0.9485
  Epoch 1 Train Summary: Avg Loss: 1.0097, Accuracy: 0.3315
  Validation Summary: Avg Loss: 0.9784, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0335 to 0.9784. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.1111
  Epoch 2 [Batch 4/40]: Loss: 0.9498
  Epoch 2 [Batch 8/40]: Loss: 0.9448
  Epoch 2 [Batch 12/40]: Loss: 0.9900
  Epoch 2 [Batch 16/40]: Loss: 1.1222
  Epoch 2 [Batch 20/40]: Loss: 0.9834
  Epoch 2 [Batch 24/40]: Loss: 0.8772
  Epoch 2 [Batch 28/40]: Loss: 0.9418
  Epoch 2 [Batch 32/40]: Loss: 0.8823
  Epoch 2 [Batch 36/40]: Loss: 0.8641
  Epoch 2 Train Summary: Avg Loss: 0.9800, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9563, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9784 to 0.9563. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 0.9066
  Epoch 3 [Batch 4/40]: Loss: 0.8193
  Epoch 3 [Batch 8/40]: Loss: 1.0197
  Epoch 3 [Batch 12/40]: Loss: 0.8834
  Epoch 3 [Batch 16/40]: Loss: 1.0284
  Epoch 3 [Batch 20/40]: Loss: 0.8697
  Epoch 3 [Batch 24/40]: Loss: 0.9393
  Epoch 3 [Batch 28/40]: Loss: 1.0489
  Epoch 3 [Batch 32/40]: Loss: 0.9750
  Epoch 3 [Batch 36/40]: Loss: 0.9250
  Epoch 3 Train Summary: Avg Loss: 0.9598, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9138, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9563 to 0.9138. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 0.7431
  Epoch 4 [Batch 4/40]: Loss: 0.7442
  Epoch 4 [Batch 8/40]: Loss: 0.9220
  Epoch 4 [Batch 12/40]: Loss: 1.1147
  Epoch 4 [Batch 16/40]: Loss: 1.0103
  Epoch 4 [Batch 20/40]: Loss: 1.0546
  Epoch 4 [Batch 24/40]: Loss: 0.9504
  Epoch 4 [Batch 28/40]: Loss: 1.0572
  Epoch 4 [Batch 32/40]: Loss: 0.9586
  Epoch 4 [Batch 36/40]: Loss: 0.8337
  Epoch 4 Train Summary: Avg Loss: 0.9566, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9102, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9138 to 0.9102. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 1.0577
  Epoch 5 [Batch 4/40]: Loss: 0.8873
  Epoch 5 [Batch 8/40]: Loss: 0.8780
  Epoch 5 [Batch 12/40]: Loss: 1.2222
  Epoch 5 [Batch 16/40]: Loss: 0.8268
  Epoch 5 [Batch 20/40]: Loss: 0.6787
  Epoch 5 [Batch 24/40]: Loss: 0.9712
  Epoch 5 [Batch 28/40]: Loss: 0.8189
  Epoch 5 [Batch 32/40]: Loss: 0.9101
  Epoch 5 [Batch 36/40]: Loss: 0.9294
  Epoch 5 Train Summary: Avg Loss: 0.9552, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8951, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9102 to 0.8951. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 0.8490
  Epoch 6 [Batch 4/40]: Loss: 1.2142
  Epoch 6 [Batch 8/40]: Loss: 0.7659
  Epoch 6 [Batch 12/40]: Loss: 0.9578
  Epoch 6 [Batch 16/40]: Loss: 0.8991
  Epoch 6 [Batch 20/40]: Loss: 1.0407
  Epoch 6 [Batch 24/40]: Loss: 1.2314
  Epoch 6 [Batch 28/40]: Loss: 1.1825
  Epoch 6 [Batch 32/40]: Loss: 0.9016
  Epoch 6 [Batch 36/40]: Loss: 0.8653
  Epoch 6 Train Summary: Avg Loss: 0.9352, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8902, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8951 to 0.8902. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 1.0998
  Epoch 7 [Batch 4/40]: Loss: 1.0275
  Epoch 7 [Batch 8/40]: Loss: 0.9722
  Epoch 7 [Batch 12/40]: Loss: 1.1674
  Epoch 7 [Batch 16/40]: Loss: 0.8121
  Epoch 7 [Batch 20/40]: Loss: 1.0264
  Epoch 7 [Batch 24/40]: Loss: 0.8932
  Epoch 7 [Batch 28/40]: Loss: 0.7411
  Epoch 7 [Batch 32/40]: Loss: 0.8698
  Epoch 7 [Batch 36/40]: Loss: 0.6553
  Epoch 7 Train Summary: Avg Loss: 0.9562, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8816, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8902 to 0.8816. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.7517
  Epoch 8 [Batch 4/40]: Loss: 1.0451
  Epoch 8 [Batch 8/40]: Loss: 0.6659
  Epoch 8 [Batch 12/40]: Loss: 0.8423
  Epoch 8 [Batch 16/40]: Loss: 0.6199
  Epoch 8 [Batch 20/40]: Loss: 1.0175
  Epoch 8 [Batch 24/40]: Loss: 0.7208
  Epoch 8 [Batch 28/40]: Loss: 1.0034
  Epoch 8 [Batch 32/40]: Loss: 1.0837
  Epoch 8 [Batch 36/40]: Loss: 0.5523
  Epoch 8 Train Summary: Avg Loss: 0.9242, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8778, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8816 to 0.8778. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.8432
  Epoch 9 [Batch 4/40]: Loss: 1.0750
  Epoch 9 [Batch 8/40]: Loss: 0.8549
  Epoch 9 [Batch 12/40]: Loss: 1.0845
  Epoch 9 [Batch 16/40]: Loss: 0.8804
  Epoch 9 [Batch 20/40]: Loss: 0.9209
  Epoch 9 [Batch 24/40]: Loss: 1.1219
  Epoch 9 [Batch 28/40]: Loss: 0.7129
  Epoch 9 [Batch 32/40]: Loss: 1.0497
  Epoch 9 [Batch 36/40]: Loss: 0.7685
  Epoch 9 Train Summary: Avg Loss: 0.9218, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8681, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8778 to 0.8681. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 1.0612
  Epoch 10 [Batch 4/40]: Loss: 0.9486
  Epoch 10 [Batch 8/40]: Loss: 1.0732
  Epoch 10 [Batch 12/40]: Loss: 0.8202
  Epoch 10 [Batch 16/40]: Loss: 0.8156
  Epoch 10 [Batch 20/40]: Loss: 0.9597
  Epoch 10 [Batch 24/40]: Loss: 0.6982
  Epoch 10 [Batch 28/40]: Loss: 1.0565
  Epoch 10 [Batch 32/40]: Loss: 1.4882
  Epoch 10 [Batch 36/40]: Loss: 0.9572
  Epoch 10 Train Summary: Avg Loss: 0.9234, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8545, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8681 to 0.8545. Saving...

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.7385
  Epoch 11 [Batch 4/40]: Loss: 0.7622
  Epoch 11 [Batch 8/40]: Loss: 0.9244
  Epoch 11 [Batch 12/40]: Loss: 0.8859
  Epoch 11 [Batch 16/40]: Loss: 1.0275
  Epoch 11 [Batch 20/40]: Loss: 0.8887
  Epoch 11 [Batch 24/40]: Loss: 0.7749
  Epoch 11 [Batch 28/40]: Loss: 0.8528
  Epoch 11 [Batch 32/40]: Loss: 0.7404
  Epoch 11 [Batch 36/40]: Loss: 0.9079
  Epoch 11 Train Summary: Avg Loss: 0.9133, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8812, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.8431
  Epoch 12 [Batch 4/40]: Loss: 0.9330
  Epoch 12 [Batch 8/40]: Loss: 0.7288
  Epoch 12 [Batch 12/40]: Loss: 1.2117
  Epoch 12 [Batch 16/40]: Loss: 0.6132
  Epoch 12 [Batch 20/40]: Loss: 0.7895
  Epoch 12 [Batch 24/40]: Loss: 0.9767
  Epoch 12 [Batch 28/40]: Loss: 0.9201
  Epoch 12 [Batch 32/40]: Loss: 0.8823
  Epoch 12 [Batch 36/40]: Loss: 0.8245
  Epoch 12 Train Summary: Avg Loss: 0.9214, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8432, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8545 to 0.8432. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 1.2956
  Epoch 13 [Batch 4/40]: Loss: 1.1007
  Epoch 13 [Batch 8/40]: Loss: 0.9434
  Epoch 13 [Batch 12/40]: Loss: 0.7017
  Epoch 13 [Batch 16/40]: Loss: 1.1788
  Epoch 13 [Batch 20/40]: Loss: 0.8532
  Epoch 13 [Batch 24/40]: Loss: 0.8160
  Epoch 13 [Batch 28/40]: Loss: 0.9833
  Epoch 13 [Batch 32/40]: Loss: 1.0395
  Epoch 13 [Batch 36/40]: Loss: 0.6015
  Epoch 13 Train Summary: Avg Loss: 0.9024, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8096, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8432 to 0.8096. Saving...

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 1.1102
  Epoch 14 [Batch 4/40]: Loss: 1.1253
  Epoch 14 [Batch 8/40]: Loss: 0.9348
  Epoch 14 [Batch 12/40]: Loss: 1.1491
  Epoch 14 [Batch 16/40]: Loss: 1.0103
  Epoch 14 [Batch 20/40]: Loss: 0.9033
  Epoch 14 [Batch 24/40]: Loss: 1.0032
  Epoch 14 [Batch 28/40]: Loss: 0.7759
  Epoch 14 [Batch 32/40]: Loss: 0.8171
  Epoch 14 [Batch 36/40]: Loss: 0.6234
  Epoch 14 Train Summary: Avg Loss: 0.8961, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8021, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8096 to 0.8021. Saving...
Training finished in 4.32 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.8021, Accuracy: 0.3333, F1 (Macro): 0.2462
Final Best Model Stats: Acc: 0.3333, F1: 0.2462, Loss: 0.8021
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=5e-05 drop=0.0 seed=999
================================================================================
Starting experiment: resnet50__224x224__lr-5e-05__drop-0.0__seed-999
Output directory: results_opg/resnet50__224x224__lr-5e-05__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 1.1933
  Epoch 0 [Batch 4/40]: Loss: 1.1355
  Epoch 0 [Batch 8/40]: Loss: 1.1141
  Epoch 0 [Batch 12/40]: Loss: 1.1181
  Epoch 0 [Batch 16/40]: Loss: 1.0866
  Epoch 0 [Batch 20/40]: Loss: 1.1030
  Epoch 0 [Batch 24/40]: Loss: 1.0729
  Epoch 0 [Batch 28/40]: Loss: 1.0850
  Epoch 0 [Batch 32/40]: Loss: 1.0870
  Epoch 0 [Batch 36/40]: Loss: 1.0796
  Epoch 0 Train Summary: Avg Loss: 1.0930, Accuracy: 0.3399
  Validation Summary: Avg Loss: 1.0662, Accuracy: 0.3056, F1 (Macro): 0.2778
  New best model! Val loss improved from inf to 1.0662. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 1.0497
  Epoch 1 [Batch 4/40]: Loss: 1.0250
  Epoch 1 [Batch 8/40]: Loss: 0.9985
  Epoch 1 [Batch 12/40]: Loss: 1.0647
  Epoch 1 [Batch 16/40]: Loss: 1.0432
  Epoch 1 [Batch 20/40]: Loss: 0.9946
  Epoch 1 [Batch 24/40]: Loss: 0.9772
  Epoch 1 [Batch 28/40]: Loss: 1.1055
  Epoch 1 [Batch 32/40]: Loss: 0.9702
  Epoch 1 [Batch 36/40]: Loss: 1.0097
  Epoch 1 Train Summary: Avg Loss: 1.0255, Accuracy: 0.3309
  Validation Summary: Avg Loss: 0.9955, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0662 to 0.9955. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.1286
  Epoch 2 [Batch 4/40]: Loss: 1.0037
  Epoch 2 [Batch 8/40]: Loss: 0.9823
  Epoch 2 [Batch 12/40]: Loss: 0.9631
  Epoch 2 [Batch 16/40]: Loss: 0.9615
  Epoch 2 [Batch 20/40]: Loss: 1.0174
  Epoch 2 [Batch 24/40]: Loss: 1.0025
  Epoch 2 [Batch 28/40]: Loss: 1.0818
  Epoch 2 [Batch 32/40]: Loss: 1.0638
  Epoch 2 [Batch 36/40]: Loss: 1.1660
  Epoch 2 Train Summary: Avg Loss: 0.9822, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9476, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9955 to 0.9476. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 0.8332
  Epoch 3 [Batch 4/40]: Loss: 0.7973
  Epoch 3 [Batch 8/40]: Loss: 0.9306
  Epoch 3 [Batch 12/40]: Loss: 1.0125
  Epoch 3 [Batch 16/40]: Loss: 1.1221
  Epoch 3 [Batch 20/40]: Loss: 1.0121
  Epoch 3 [Batch 24/40]: Loss: 1.0091
  Epoch 3 [Batch 28/40]: Loss: 1.0150
  Epoch 3 [Batch 32/40]: Loss: 0.9107
  Epoch 3 [Batch 36/40]: Loss: 0.8389
  Epoch 3 Train Summary: Avg Loss: 0.9725, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8977, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9476 to 0.8977. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 1.0672
  Epoch 4 [Batch 4/40]: Loss: 0.6437
  Epoch 4 [Batch 8/40]: Loss: 1.0030
  Epoch 4 [Batch 12/40]: Loss: 1.1976
  Epoch 4 [Batch 16/40]: Loss: 0.8339
  Epoch 4 [Batch 20/40]: Loss: 1.0414
  Epoch 4 [Batch 24/40]: Loss: 1.1551
  Epoch 4 [Batch 28/40]: Loss: 0.9763
  Epoch 4 [Batch 32/40]: Loss: 0.8992
  Epoch 4 [Batch 36/40]: Loss: 0.9992
  Epoch 4 Train Summary: Avg Loss: 0.9504, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9224, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 0.7154
  Epoch 5 [Batch 4/40]: Loss: 1.0951
  Epoch 5 [Batch 8/40]: Loss: 1.0486
  Epoch 5 [Batch 12/40]: Loss: 0.7970
  Epoch 5 [Batch 16/40]: Loss: 0.7128
  Epoch 5 [Batch 20/40]: Loss: 0.7546
  Epoch 5 [Batch 24/40]: Loss: 0.9046
  Epoch 5 [Batch 28/40]: Loss: 0.7340
  Epoch 5 [Batch 32/40]: Loss: 1.0648
  Epoch 5 [Batch 36/40]: Loss: 0.7378
  Epoch 5 Train Summary: Avg Loss: 0.9610, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8781, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8977 to 0.8781. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 1.2063
  Epoch 6 [Batch 4/40]: Loss: 0.9704
  Epoch 6 [Batch 8/40]: Loss: 0.6802
  Epoch 6 [Batch 12/40]: Loss: 0.9332
  Epoch 6 [Batch 16/40]: Loss: 0.7384
  Epoch 6 [Batch 20/40]: Loss: 1.1992
  Epoch 6 [Batch 24/40]: Loss: 1.0393
  Epoch 6 [Batch 28/40]: Loss: 0.7275
  Epoch 6 [Batch 32/40]: Loss: 1.0193
  Epoch 6 [Batch 36/40]: Loss: 1.2793
  Epoch 6 Train Summary: Avg Loss: 0.9380, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9101, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 1.0370
  Epoch 7 [Batch 4/40]: Loss: 0.8873
  Epoch 7 [Batch 8/40]: Loss: 0.9499
  Epoch 7 [Batch 12/40]: Loss: 1.2050
  Epoch 7 [Batch 16/40]: Loss: 0.8049
  Epoch 7 [Batch 20/40]: Loss: 0.9089
  Epoch 7 [Batch 24/40]: Loss: 1.0505
  Epoch 7 [Batch 28/40]: Loss: 0.7907
  Epoch 7 [Batch 32/40]: Loss: 0.8255
  Epoch 7 [Batch 36/40]: Loss: 0.7923
  Epoch 7 Train Summary: Avg Loss: 0.9444, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9026, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.9675
  Epoch 8 [Batch 4/40]: Loss: 0.9377
  Epoch 8 [Batch 8/40]: Loss: 0.8496
  Epoch 8 [Batch 12/40]: Loss: 1.0017
  Epoch 8 [Batch 16/40]: Loss: 1.0878
  Epoch 8 [Batch 20/40]: Loss: 1.2341
  Epoch 8 [Batch 24/40]: Loss: 0.9378
  Epoch 8 [Batch 28/40]: Loss: 0.7142
  Epoch 8 [Batch 32/40]: Loss: 1.0052
  Epoch 8 [Batch 36/40]: Loss: 0.6143
  Epoch 8 Train Summary: Avg Loss: 0.9345, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8697, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8781 to 0.8697. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.7957
  Epoch 9 [Batch 4/40]: Loss: 1.1865
  Epoch 9 [Batch 8/40]: Loss: 0.8731
  Epoch 9 [Batch 12/40]: Loss: 0.8233
  Epoch 9 [Batch 16/40]: Loss: 0.7988
  Epoch 9 [Batch 20/40]: Loss: 0.9022
  Epoch 9 [Batch 24/40]: Loss: 0.6571
  Epoch 9 [Batch 28/40]: Loss: 0.7295
  Epoch 9 [Batch 32/40]: Loss: 0.7419
  Epoch 9 [Batch 36/40]: Loss: 1.0503
  Epoch 9 Train Summary: Avg Loss: 0.9374, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8861, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 1.0666
  Epoch 10 [Batch 4/40]: Loss: 0.8228
  Epoch 10 [Batch 8/40]: Loss: 1.1725
  Epoch 10 [Batch 12/40]: Loss: 1.0646
  Epoch 10 [Batch 16/40]: Loss: 0.7936
  Epoch 10 [Batch 20/40]: Loss: 1.1630
  Epoch 10 [Batch 24/40]: Loss: 1.2271
  Epoch 10 [Batch 28/40]: Loss: 0.7332
  Epoch 10 [Batch 32/40]: Loss: 0.8066
  Epoch 10 [Batch 36/40]: Loss: 1.0423
  Epoch 10 Train Summary: Avg Loss: 0.9550, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8773, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.8928
  Epoch 11 [Batch 4/40]: Loss: 0.9833
  Epoch 11 [Batch 8/40]: Loss: 0.6184
  Epoch 11 [Batch 12/40]: Loss: 0.8003
  Epoch 11 [Batch 16/40]: Loss: 1.3431
  Epoch 11 [Batch 20/40]: Loss: 1.1498
  Epoch 11 [Batch 24/40]: Loss: 0.8557
  Epoch 11 [Batch 28/40]: Loss: 0.8377
  Epoch 11 [Batch 32/40]: Loss: 1.0343
  Epoch 11 [Batch 36/40]: Loss: 0.9069
  Epoch 11 Train Summary: Avg Loss: 0.9130, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8746, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 1.0187
  Epoch 12 [Batch 4/40]: Loss: 0.7854
  Epoch 12 [Batch 8/40]: Loss: 1.1749
  Epoch 12 [Batch 12/40]: Loss: 0.8720
  Epoch 12 [Batch 16/40]: Loss: 0.7473
  Epoch 12 [Batch 20/40]: Loss: 0.8723
  Epoch 12 [Batch 24/40]: Loss: 0.9631
  Epoch 12 [Batch 28/40]: Loss: 1.5815
  Epoch 12 [Batch 32/40]: Loss: 0.9636
  Epoch 12 [Batch 36/40]: Loss: 1.0674
  Epoch 12 Train Summary: Avg Loss: 0.9218, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8476, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8697 to 0.8476. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.5964
  Epoch 13 [Batch 4/40]: Loss: 0.9050
  Epoch 13 [Batch 8/40]: Loss: 1.2480
  Epoch 13 [Batch 12/40]: Loss: 0.9599
  Epoch 13 [Batch 16/40]: Loss: 1.0353
  Epoch 13 [Batch 20/40]: Loss: 1.0780
  Epoch 13 [Batch 24/40]: Loss: 0.7179
  Epoch 13 [Batch 28/40]: Loss: 0.7878
  Epoch 13 [Batch 32/40]: Loss: 0.9937
  Epoch 13 [Batch 36/40]: Loss: 0.7748
  Epoch 13 Train Summary: Avg Loss: 0.9049, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8159, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8476 to 0.8159. Saving...

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 0.8522
  Epoch 14 [Batch 4/40]: Loss: 0.8574
  Epoch 14 [Batch 8/40]: Loss: 1.0376
  Epoch 14 [Batch 12/40]: Loss: 1.1886
  Epoch 14 [Batch 16/40]: Loss: 1.1381
  Epoch 14 [Batch 20/40]: Loss: 0.7618
  Epoch 14 [Batch 24/40]: Loss: 0.9730
  Epoch 14 [Batch 28/40]: Loss: 0.7511
  Epoch 14 [Batch 32/40]: Loss: 1.0642
  Epoch 14 [Batch 36/40]: Loss: 0.7262
  Epoch 14 Train Summary: Avg Loss: 0.9116, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8158, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8159 to 0.8158. Saving...
Training finished in 4.43 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.8158, Accuracy: 0.3333, F1 (Macro): 0.2462
Final Best Model Stats: Acc: 0.3333, F1: 0.2462, Loss: 0.8158
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=1e-05 drop=0.0 seed=42
================================================================================
Starting experiment: resnet50__224x224__lr-1e-05__drop-0.0__seed-42
Output directory: results_opg/resnet50__224x224__lr-1e-05__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 1.1207
  Epoch 0 [Batch 4/40]: Loss: 1.1409
  Epoch 0 [Batch 8/40]: Loss: 1.1380
  Epoch 0 [Batch 12/40]: Loss: 1.1328
  Epoch 0 [Batch 16/40]: Loss: 1.1184
  Epoch 0 [Batch 20/40]: Loss: 1.1125
  Epoch 0 [Batch 24/40]: Loss: 1.1222
  Epoch 0 [Batch 28/40]: Loss: 1.1054
  Epoch 0 [Batch 32/40]: Loss: 1.1297
  Epoch 0 [Batch 36/40]: Loss: 1.1106
  Epoch 0 Train Summary: Avg Loss: 1.1122, Accuracy: 0.3587
  Validation Summary: Avg Loss: 1.0955, Accuracy: 0.2361, F1 (Macro): 0.2229
  New best model! Val loss improved from inf to 1.0955. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 1.0723
  Epoch 1 [Batch 4/40]: Loss: 1.1076
  Epoch 1 [Batch 8/40]: Loss: 1.0987
  Epoch 1 [Batch 12/40]: Loss: 1.1026
  Epoch 1 [Batch 16/40]: Loss: 1.0956
  Epoch 1 [Batch 20/40]: Loss: 1.0821
  Epoch 1 [Batch 24/40]: Loss: 1.0922
  Epoch 1 [Batch 28/40]: Loss: 1.0952
  Epoch 1 [Batch 32/40]: Loss: 1.1036
  Epoch 1 [Batch 36/40]: Loss: 1.0902
  Epoch 1 Train Summary: Avg Loss: 1.0944, Accuracy: 0.3907
  Validation Summary: Avg Loss: 1.0806, Accuracy: 0.2917, F1 (Macro): 0.2667
  New best model! Val loss improved from 1.0955 to 1.0806. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.0936
  Epoch 2 [Batch 4/40]: Loss: 1.0900
  Epoch 2 [Batch 8/40]: Loss: 1.1077
  Epoch 2 [Batch 12/40]: Loss: 1.0551
  Epoch 2 [Batch 16/40]: Loss: 1.0769
  Epoch 2 [Batch 20/40]: Loss: 1.0591
  Epoch 2 [Batch 24/40]: Loss: 1.0910
  Epoch 2 [Batch 28/40]: Loss: 1.0910
  Epoch 2 [Batch 32/40]: Loss: 1.0816
  Epoch 2 [Batch 36/40]: Loss: 1.0839
  Epoch 2 Train Summary: Avg Loss: 1.0766, Accuracy: 0.4064
  Validation Summary: Avg Loss: 1.0642, Accuracy: 0.3056, F1 (Macro): 0.2328
  New best model! Val loss improved from 1.0806 to 1.0642. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 1.0659
  Epoch 3 [Batch 4/40]: Loss: 1.0392
  Epoch 3 [Batch 8/40]: Loss: 1.0830
  Epoch 3 [Batch 12/40]: Loss: 1.0586
  Epoch 3 [Batch 16/40]: Loss: 1.0629
  Epoch 3 [Batch 20/40]: Loss: 1.0723
  Epoch 3 [Batch 24/40]: Loss: 1.1035
  Epoch 3 [Batch 28/40]: Loss: 1.0780
  Epoch 3 [Batch 32/40]: Loss: 1.0265
  Epoch 3 [Batch 36/40]: Loss: 1.1055
  Epoch 3 Train Summary: Avg Loss: 1.0670, Accuracy: 0.3372
  Validation Summary: Avg Loss: 1.0532, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0642 to 1.0532. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 1.1135
  Epoch 4 [Batch 4/40]: Loss: 1.0946
  Epoch 4 [Batch 8/40]: Loss: 1.0443
  Epoch 4 [Batch 12/40]: Loss: 1.1126
  Epoch 4 [Batch 16/40]: Loss: 1.0414
  Epoch 4 [Batch 20/40]: Loss: 1.0640
  Epoch 4 [Batch 24/40]: Loss: 1.0487
  Epoch 4 [Batch 28/40]: Loss: 0.9839
  Epoch 4 [Batch 32/40]: Loss: 1.1093
  Epoch 4 [Batch 36/40]: Loss: 1.0524
  Epoch 4 Train Summary: Avg Loss: 1.0552, Accuracy: 0.3277
  Validation Summary: Avg Loss: 1.0432, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0532 to 1.0432. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 1.0701
  Epoch 5 [Batch 4/40]: Loss: 1.0674
  Epoch 5 [Batch 8/40]: Loss: 1.0426
  Epoch 5 [Batch 12/40]: Loss: 1.0523
  Epoch 5 [Batch 16/40]: Loss: 0.9978
  Epoch 5 [Batch 20/40]: Loss: 1.0736
  Epoch 5 [Batch 24/40]: Loss: 1.0225
  Epoch 5 [Batch 28/40]: Loss: 1.0703
  Epoch 5 [Batch 32/40]: Loss: 1.0066
  Epoch 5 [Batch 36/40]: Loss: 0.9526
  Epoch 5 Train Summary: Avg Loss: 1.0439, Accuracy: 0.3368
  Validation Summary: Avg Loss: 1.0107, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0432 to 1.0107. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 1.0892
  Epoch 6 [Batch 4/40]: Loss: 1.0877
  Epoch 6 [Batch 8/40]: Loss: 0.9831
  Epoch 6 [Batch 12/40]: Loss: 1.1382
  Epoch 6 [Batch 16/40]: Loss: 1.0625
  Epoch 6 [Batch 20/40]: Loss: 0.9378
  Epoch 6 [Batch 24/40]: Loss: 1.0118
  Epoch 6 [Batch 28/40]: Loss: 1.0859
  Epoch 6 [Batch 32/40]: Loss: 0.9958
  Epoch 6 [Batch 36/40]: Loss: 0.9490
  Epoch 6 Train Summary: Avg Loss: 1.0274, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9974, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0107 to 0.9974. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 1.1686
  Epoch 7 [Batch 4/40]: Loss: 0.9658
  Epoch 7 [Batch 8/40]: Loss: 1.0916
  Epoch 7 [Batch 12/40]: Loss: 1.0133
  Epoch 7 [Batch 16/40]: Loss: 1.0630
  Epoch 7 [Batch 20/40]: Loss: 1.0329
  Epoch 7 [Batch 24/40]: Loss: 1.0063
  Epoch 7 [Batch 28/40]: Loss: 0.9872
  Epoch 7 [Batch 32/40]: Loss: 1.0061
  Epoch 7 [Batch 36/40]: Loss: 1.0008
  Epoch 7 Train Summary: Avg Loss: 1.0222, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9882, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9974 to 0.9882. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 1.0186
  Epoch 8 [Batch 4/40]: Loss: 1.1033
  Epoch 8 [Batch 8/40]: Loss: 1.0322
  Epoch 8 [Batch 12/40]: Loss: 1.0806
  Epoch 8 [Batch 16/40]: Loss: 0.9974
  Epoch 8 [Batch 20/40]: Loss: 0.9892
  Epoch 8 [Batch 24/40]: Loss: 1.0458
  Epoch 8 [Batch 28/40]: Loss: 0.9340
  Epoch 8 [Batch 32/40]: Loss: 0.9772
  Epoch 8 [Batch 36/40]: Loss: 1.1476
  Epoch 8 Train Summary: Avg Loss: 1.0156, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0108, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 1.0169
  Epoch 9 [Batch 4/40]: Loss: 1.0677
  Epoch 9 [Batch 8/40]: Loss: 0.9808
  Epoch 9 [Batch 12/40]: Loss: 1.0542
  Epoch 9 [Batch 16/40]: Loss: 1.0595
  Epoch 9 [Batch 20/40]: Loss: 1.0375
  Epoch 9 [Batch 24/40]: Loss: 0.9500
  Epoch 9 [Batch 28/40]: Loss: 0.9543
  Epoch 9 [Batch 32/40]: Loss: 0.8822
  Epoch 9 [Batch 36/40]: Loss: 0.9453
  Epoch 9 Train Summary: Avg Loss: 0.9983, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9953, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 1.0597
  Epoch 10 [Batch 4/40]: Loss: 0.9437
  Epoch 10 [Batch 8/40]: Loss: 0.9456
  Epoch 10 [Batch 12/40]: Loss: 1.0166
  Epoch 10 [Batch 16/40]: Loss: 1.0224
  Epoch 10 [Batch 20/40]: Loss: 0.9361
  Epoch 10 [Batch 24/40]: Loss: 0.8732
  Epoch 10 [Batch 28/40]: Loss: 0.9332
  Epoch 10 [Batch 32/40]: Loss: 1.0155
  Epoch 10 [Batch 36/40]: Loss: 1.0126
  Epoch 10 Train Summary: Avg Loss: 0.9877, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9825, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9882 to 0.9825. Saving...

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.9680
  Epoch 11 [Batch 4/40]: Loss: 0.9328
  Epoch 11 [Batch 8/40]: Loss: 1.0439
  Epoch 11 [Batch 12/40]: Loss: 0.8221
  Epoch 11 [Batch 16/40]: Loss: 1.1024
  Epoch 11 [Batch 20/40]: Loss: 1.0232
  Epoch 11 [Batch 24/40]: Loss: 0.9182
  Epoch 11 [Batch 28/40]: Loss: 1.0474
  Epoch 11 [Batch 32/40]: Loss: 1.0823
  Epoch 11 [Batch 36/40]: Loss: 0.9733
  Epoch 11 Train Summary: Avg Loss: 0.9791, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9659, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9825 to 0.9659. Saving...

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 1.0229
  Epoch 12 [Batch 4/40]: Loss: 0.9005
  Epoch 12 [Batch 8/40]: Loss: 0.9997
  Epoch 12 [Batch 12/40]: Loss: 0.8660
  Epoch 12 [Batch 16/40]: Loss: 1.0988
  Epoch 12 [Batch 20/40]: Loss: 0.8409
  Epoch 12 [Batch 24/40]: Loss: 1.0048
  Epoch 12 [Batch 28/40]: Loss: 1.2684
  Epoch 12 [Batch 32/40]: Loss: 0.9421
  Epoch 12 [Batch 36/40]: Loss: 0.9532
  Epoch 12 Train Summary: Avg Loss: 0.9867, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9739, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.7684
  Epoch 13 [Batch 4/40]: Loss: 0.9141
  Epoch 13 [Batch 8/40]: Loss: 0.9260
  Epoch 13 [Batch 12/40]: Loss: 0.9325
  Epoch 13 [Batch 16/40]: Loss: 1.1371
  Epoch 13 [Batch 20/40]: Loss: 1.0856
  Epoch 13 [Batch 24/40]: Loss: 1.0863
  Epoch 13 [Batch 28/40]: Loss: 1.0945
  Epoch 13 [Batch 32/40]: Loss: 0.8272
  Epoch 13 [Batch 36/40]: Loss: 0.9349
  Epoch 13 Train Summary: Avg Loss: 0.9796, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9552, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9659 to 0.9552. Saving...

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 1.1589
  Epoch 14 [Batch 4/40]: Loss: 0.7864
  Epoch 14 [Batch 8/40]: Loss: 1.2482
  Epoch 14 [Batch 12/40]: Loss: 1.1380
  Epoch 14 [Batch 16/40]: Loss: 0.7978
  Epoch 14 [Batch 20/40]: Loss: 0.8924
  Epoch 14 [Batch 24/40]: Loss: 0.8224
  Epoch 14 [Batch 28/40]: Loss: 1.0008
  Epoch 14 [Batch 32/40]: Loss: 0.9104
  Epoch 14 [Batch 36/40]: Loss: 0.9586
  Epoch 14 Train Summary: Avg Loss: 0.9759, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9643, Accuracy: 0.3333, F1 (Macro): 0.2462
Training finished in 4.71 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.9552, Accuracy: 0.3333, F1 (Macro): 0.2462
Final Best Model Stats: Acc: 0.3333, F1: 0.2462, Loss: 0.9552
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=1e-05 drop=0.0 seed=123
================================================================================
Starting experiment: resnet50__224x224__lr-1e-05__drop-0.0__seed-123
Output directory: results_opg/resnet50__224x224__lr-1e-05__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 1.1103
  Epoch 0 [Batch 4/40]: Loss: 1.1127
  Epoch 0 [Batch 8/40]: Loss: 1.0836
  Epoch 0 [Batch 12/40]: Loss: 1.0723
  Epoch 0 [Batch 16/40]: Loss: 1.1020
  Epoch 0 [Batch 20/40]: Loss: 1.1164
  Epoch 0 [Batch 24/40]: Loss: 1.0944
  Epoch 0 [Batch 28/40]: Loss: 1.1083
  Epoch 0 [Batch 32/40]: Loss: 1.0826
  Epoch 0 [Batch 36/40]: Loss: 1.0630
  Epoch 0 Train Summary: Avg Loss: 1.0943, Accuracy: 0.2837
  Validation Summary: Avg Loss: 1.0803, Accuracy: 0.3750, F1 (Macro): 0.2671
  New best model! Val loss improved from inf to 1.0803. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 1.0767
  Epoch 1 [Batch 4/40]: Loss: 1.0895
  Epoch 1 [Batch 8/40]: Loss: 1.0826
  Epoch 1 [Batch 12/40]: Loss: 1.0531
  Epoch 1 [Batch 16/40]: Loss: 1.0950
  Epoch 1 [Batch 20/40]: Loss: 1.0939
  Epoch 1 [Batch 24/40]: Loss: 1.0710
  Epoch 1 [Batch 28/40]: Loss: 1.0720
  Epoch 1 [Batch 32/40]: Loss: 1.0704
  Epoch 1 [Batch 36/40]: Loss: 1.0812
  Epoch 1 Train Summary: Avg Loss: 1.0765, Accuracy: 0.3327
  Validation Summary: Avg Loss: 1.0723, Accuracy: 0.4167, F1 (Macro): 0.3274
  New best model! Val loss improved from 1.0803 to 1.0723. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.1086
  Epoch 2 [Batch 4/40]: Loss: 1.0429
  Epoch 2 [Batch 8/40]: Loss: 1.0658
  Epoch 2 [Batch 12/40]: Loss: 1.0642
  Epoch 2 [Batch 16/40]: Loss: 1.0713
  Epoch 2 [Batch 20/40]: Loss: 1.0620
  Epoch 2 [Batch 24/40]: Loss: 1.0335
  Epoch 2 [Batch 28/40]: Loss: 1.0603
  Epoch 2 [Batch 32/40]: Loss: 1.0395
  Epoch 2 [Batch 36/40]: Loss: 1.0308
  Epoch 2 Train Summary: Avg Loss: 1.0645, Accuracy: 0.3485
  Validation Summary: Avg Loss: 1.0610, Accuracy: 0.4722, F1 (Macro): 0.4245
  New best model! Val loss improved from 1.0723 to 1.0610. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 1.0484
  Epoch 3 [Batch 4/40]: Loss: 1.0110
  Epoch 3 [Batch 8/40]: Loss: 1.0594
  Epoch 3 [Batch 12/40]: Loss: 1.0254
  Epoch 3 [Batch 16/40]: Loss: 1.0821
  Epoch 3 [Batch 20/40]: Loss: 1.0223
  Epoch 3 [Batch 24/40]: Loss: 1.0568
  Epoch 3 [Batch 28/40]: Loss: 1.0558
  Epoch 3 [Batch 32/40]: Loss: 1.0564
  Epoch 3 [Batch 36/40]: Loss: 1.0187
  Epoch 3 Train Summary: Avg Loss: 1.0470, Accuracy: 0.3372
  Validation Summary: Avg Loss: 1.0443, Accuracy: 0.4444, F1 (Macro): 0.4240
  New best model! Val loss improved from 1.0610 to 1.0443. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 0.9870
  Epoch 4 [Batch 4/40]: Loss: 0.9968
  Epoch 4 [Batch 8/40]: Loss: 1.0418
  Epoch 4 [Batch 12/40]: Loss: 1.0639
  Epoch 4 [Batch 16/40]: Loss: 1.0576
  Epoch 4 [Batch 20/40]: Loss: 1.0749
  Epoch 4 [Batch 24/40]: Loss: 1.0261
  Epoch 4 [Batch 28/40]: Loss: 1.0463
  Epoch 4 [Batch 32/40]: Loss: 1.0371
  Epoch 4 [Batch 36/40]: Loss: 1.0033
  Epoch 4 Train Summary: Avg Loss: 1.0395, Accuracy: 0.3277
  Validation Summary: Avg Loss: 1.0394, Accuracy: 0.3611, F1 (Macro): 0.3013
  New best model! Val loss improved from 1.0443 to 1.0394. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 1.0961
  Epoch 5 [Batch 4/40]: Loss: 0.9927
  Epoch 5 [Batch 8/40]: Loss: 1.0230
  Epoch 5 [Batch 12/40]: Loss: 1.1490
  Epoch 5 [Batch 16/40]: Loss: 0.9944
  Epoch 5 [Batch 20/40]: Loss: 0.9473
  Epoch 5 [Batch 24/40]: Loss: 1.0317
  Epoch 5 [Batch 28/40]: Loss: 0.9767
  Epoch 5 [Batch 32/40]: Loss: 1.0205
  Epoch 5 [Batch 36/40]: Loss: 1.0288
  Epoch 5 Train Summary: Avg Loss: 1.0295, Accuracy: 0.3368
  Validation Summary: Avg Loss: 1.0343, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0394 to 1.0343. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 1.0199
  Epoch 6 [Batch 4/40]: Loss: 1.0888
  Epoch 6 [Batch 8/40]: Loss: 0.9786
  Epoch 6 [Batch 12/40]: Loss: 1.0307
  Epoch 6 [Batch 16/40]: Loss: 1.0298
  Epoch 6 [Batch 20/40]: Loss: 1.0448
  Epoch 6 [Batch 24/40]: Loss: 1.1221
  Epoch 6 [Batch 28/40]: Loss: 1.1058
  Epoch 6 [Batch 32/40]: Loss: 0.9855
  Epoch 6 [Batch 36/40]: Loss: 0.9673
  Epoch 6 Train Summary: Avg Loss: 1.0191, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0276, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0343 to 1.0276. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 1.0770
  Epoch 7 [Batch 4/40]: Loss: 1.0373
  Epoch 7 [Batch 8/40]: Loss: 1.0254
  Epoch 7 [Batch 12/40]: Loss: 1.1027
  Epoch 7 [Batch 16/40]: Loss: 0.9453
  Epoch 7 [Batch 20/40]: Loss: 1.0631
  Epoch 7 [Batch 24/40]: Loss: 0.9818
  Epoch 7 [Batch 28/40]: Loss: 0.9395
  Epoch 7 [Batch 32/40]: Loss: 1.0123
  Epoch 7 [Batch 36/40]: Loss: 0.8821
  Epoch 7 Train Summary: Avg Loss: 1.0180, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0083, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0276 to 1.0083. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.9122
  Epoch 8 [Batch 4/40]: Loss: 1.0667
  Epoch 8 [Batch 8/40]: Loss: 0.9077
  Epoch 8 [Batch 12/40]: Loss: 0.9790
  Epoch 8 [Batch 16/40]: Loss: 0.8657
  Epoch 8 [Batch 20/40]: Loss: 1.0186
  Epoch 8 [Batch 24/40]: Loss: 0.9187
  Epoch 8 [Batch 28/40]: Loss: 1.0293
  Epoch 8 [Batch 32/40]: Loss: 1.0581
  Epoch 8 [Batch 36/40]: Loss: 0.8370
  Epoch 8 Train Summary: Avg Loss: 1.0035, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0069, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0083 to 1.0069. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.9862
  Epoch 9 [Batch 4/40]: Loss: 1.1193
  Epoch 9 [Batch 8/40]: Loss: 0.9528
  Epoch 9 [Batch 12/40]: Loss: 1.0741
  Epoch 9 [Batch 16/40]: Loss: 0.9945
  Epoch 9 [Batch 20/40]: Loss: 0.9733
  Epoch 9 [Batch 24/40]: Loss: 1.0669
  Epoch 9 [Batch 28/40]: Loss: 0.8931
  Epoch 9 [Batch 32/40]: Loss: 1.0762
  Epoch 9 [Batch 36/40]: Loss: 0.9387
  Epoch 9 Train Summary: Avg Loss: 0.9907, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9916, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0069 to 0.9916. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 1.0575
  Epoch 10 [Batch 4/40]: Loss: 1.0000
  Epoch 10 [Batch 8/40]: Loss: 1.1182
  Epoch 10 [Batch 12/40]: Loss: 0.9763
  Epoch 10 [Batch 16/40]: Loss: 0.9156
  Epoch 10 [Batch 20/40]: Loss: 0.9985
  Epoch 10 [Batch 24/40]: Loss: 0.8717
  Epoch 10 [Batch 28/40]: Loss: 1.0460
  Epoch 10 [Batch 32/40]: Loss: 1.2178
  Epoch 10 [Batch 36/40]: Loss: 1.0090
  Epoch 10 Train Summary: Avg Loss: 0.9867, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9915, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9916 to 0.9915. Saving...

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.9071
  Epoch 11 [Batch 4/40]: Loss: 0.9134
  Epoch 11 [Batch 8/40]: Loss: 0.9897
  Epoch 11 [Batch 12/40]: Loss: 0.9541
  Epoch 11 [Batch 16/40]: Loss: 1.0439
  Epoch 11 [Batch 20/40]: Loss: 0.9594
  Epoch 11 [Batch 24/40]: Loss: 0.8977
  Epoch 11 [Batch 28/40]: Loss: 0.9797
  Epoch 11 [Batch 32/40]: Loss: 0.8602
  Epoch 11 [Batch 36/40]: Loss: 0.9903
  Epoch 11 Train Summary: Avg Loss: 0.9854, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9839, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9915 to 0.9839. Saving...

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.9885
  Epoch 12 [Batch 4/40]: Loss: 0.9573
  Epoch 12 [Batch 8/40]: Loss: 0.9168
  Epoch 12 [Batch 12/40]: Loss: 1.0892
  Epoch 12 [Batch 16/40]: Loss: 0.8349
  Epoch 12 [Batch 20/40]: Loss: 0.8329
  Epoch 12 [Batch 24/40]: Loss: 0.9717
  Epoch 12 [Batch 28/40]: Loss: 1.0093
  Epoch 12 [Batch 32/40]: Loss: 0.9536
  Epoch 12 [Batch 36/40]: Loss: 0.9513
  Epoch 12 Train Summary: Avg Loss: 0.9810, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9800, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9839 to 0.9800. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 1.2065
  Epoch 13 [Batch 4/40]: Loss: 1.0633
  Epoch 13 [Batch 8/40]: Loss: 1.0220
  Epoch 13 [Batch 12/40]: Loss: 0.8556
  Epoch 13 [Batch 16/40]: Loss: 1.1352
  Epoch 13 [Batch 20/40]: Loss: 0.9762
  Epoch 13 [Batch 24/40]: Loss: 0.9905
  Epoch 13 [Batch 28/40]: Loss: 1.0525
  Epoch 13 [Batch 32/40]: Loss: 1.0891
  Epoch 13 [Batch 36/40]: Loss: 0.7941
  Epoch 13 Train Summary: Avg Loss: 0.9703, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9848, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 1.0536
  Epoch 14 [Batch 4/40]: Loss: 1.1004
  Epoch 14 [Batch 8/40]: Loss: 1.0093
  Epoch 14 [Batch 12/40]: Loss: 1.0805
  Epoch 14 [Batch 16/40]: Loss: 1.0063
  Epoch 14 [Batch 20/40]: Loss: 0.9257
  Epoch 14 [Batch 24/40]: Loss: 1.0389
  Epoch 14 [Batch 28/40]: Loss: 0.9208
  Epoch 14 [Batch 32/40]: Loss: 0.9352
  Epoch 14 [Batch 36/40]: Loss: 0.8443
  Epoch 14 Train Summary: Avg Loss: 0.9662, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9634, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9800 to 0.9634. Saving...
Training finished in 4.74 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.9634, Accuracy: 0.3333, F1 (Macro): 0.2462
Final Best Model Stats: Acc: 0.3333, F1: 0.2462, Loss: 0.9634
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=1e-05 drop=0.0 seed=999
================================================================================
Starting experiment: resnet50__224x224__lr-1e-05__drop-0.0__seed-999
Output directory: results_opg/resnet50__224x224__lr-1e-05__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 1.1933
  Epoch 0 [Batch 4/40]: Loss: 1.1467
  Epoch 0 [Batch 8/40]: Loss: 1.1306
  Epoch 0 [Batch 12/40]: Loss: 1.1397
  Epoch 0 [Batch 16/40]: Loss: 1.0924
  Epoch 0 [Batch 20/40]: Loss: 1.1306
  Epoch 0 [Batch 24/40]: Loss: 1.1467
  Epoch 0 [Batch 28/40]: Loss: 1.1494
  Epoch 0 [Batch 32/40]: Loss: 1.1297
  Epoch 0 [Batch 36/40]: Loss: 1.1271
  Epoch 0 Train Summary: Avg Loss: 1.1271, Accuracy: 0.3691
  Validation Summary: Avg Loss: 1.1226, Accuracy: 0.3222, F1 (Macro): 0.1365
  New best model! Val loss improved from inf to 1.1226. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 1.0937
  Epoch 1 [Batch 4/40]: Loss: 1.1340
  Epoch 1 [Batch 8/40]: Loss: 1.1295
  Epoch 1 [Batch 12/40]: Loss: 1.1300
  Epoch 1 [Batch 16/40]: Loss: 1.0920
  Epoch 1 [Batch 20/40]: Loss: 1.1086
  Epoch 1 [Batch 24/40]: Loss: 1.0899
  Epoch 1 [Batch 28/40]: Loss: 1.1025
  Epoch 1 [Batch 32/40]: Loss: 1.1170
  Epoch 1 [Batch 36/40]: Loss: 1.0870
  Epoch 1 Train Summary: Avg Loss: 1.1108, Accuracy: 0.3265
  Validation Summary: Avg Loss: 1.1137, Accuracy: 0.3111, F1 (Macro): 0.1693
  New best model! Val loss improved from 1.1226 to 1.1137. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.0853
  Epoch 2 [Batch 4/40]: Loss: 1.0657
  Epoch 2 [Batch 8/40]: Loss: 1.0819
  Epoch 2 [Batch 12/40]: Loss: 1.0903
  Epoch 2 [Batch 16/40]: Loss: 1.0795
  Epoch 2 [Batch 20/40]: Loss: 1.0867
  Epoch 2 [Batch 24/40]: Loss: 1.0998
  Epoch 2 [Batch 28/40]: Loss: 1.0646
  Epoch 2 [Batch 32/40]: Loss: 1.0776
  Epoch 2 [Batch 36/40]: Loss: 1.0957
  Epoch 2 Train Summary: Avg Loss: 1.0928, Accuracy: 0.3415
  Validation Summary: Avg Loss: 1.0985, Accuracy: 0.4222, F1 (Macro): 0.3582
  New best model! Val loss improved from 1.1137 to 1.0985. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 1.1006
  Epoch 3 [Batch 4/40]: Loss: 1.0835
  Epoch 3 [Batch 8/40]: Loss: 1.0904
  Epoch 3 [Batch 12/40]: Loss: 1.0692
  Epoch 3 [Batch 16/40]: Loss: 1.0695
  Epoch 3 [Batch 20/40]: Loss: 1.0512
  Epoch 3 [Batch 24/40]: Loss: 1.0785
  Epoch 3 [Batch 28/40]: Loss: 1.0921
  Epoch 3 [Batch 32/40]: Loss: 1.0833
  Epoch 3 [Batch 36/40]: Loss: 1.0517
  Epoch 3 Train Summary: Avg Loss: 1.0800, Accuracy: 0.3562
  Validation Summary: Avg Loss: 1.0882, Accuracy: 0.3056, F1 (Macro): 0.2921
  New best model! Val loss improved from 1.0985 to 1.0882. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 1.0568
  Epoch 4 [Batch 4/40]: Loss: 1.0396
  Epoch 4 [Batch 8/40]: Loss: 1.0747
  Epoch 4 [Batch 12/40]: Loss: 1.0958
  Epoch 4 [Batch 16/40]: Loss: 1.0321
  Epoch 4 [Batch 20/40]: Loss: 1.0783
  Epoch 4 [Batch 24/40]: Loss: 1.0827
  Epoch 4 [Batch 28/40]: Loss: 1.0599
  Epoch 4 [Batch 32/40]: Loss: 1.0293
  Epoch 4 [Batch 36/40]: Loss: 1.0749
  Epoch 4 Train Summary: Avg Loss: 1.0637, Accuracy: 0.3273
  Validation Summary: Avg Loss: 1.0837, Accuracy: 0.3056, F1 (Macro): 0.2778
  New best model! Val loss improved from 1.0882 to 1.0837. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 1.0182
  Epoch 5 [Batch 4/40]: Loss: 1.0713
  Epoch 5 [Batch 8/40]: Loss: 1.0907
  Epoch 5 [Batch 12/40]: Loss: 1.0198
  Epoch 5 [Batch 16/40]: Loss: 1.0073
  Epoch 5 [Batch 20/40]: Loss: 1.0179
  Epoch 5 [Batch 24/40]: Loss: 1.0535
  Epoch 5 [Batch 28/40]: Loss: 0.9982
  Epoch 5 [Batch 32/40]: Loss: 1.0606
  Epoch 5 [Batch 36/40]: Loss: 0.9857
  Epoch 5 Train Summary: Avg Loss: 1.0528, Accuracy: 0.3415
  Validation Summary: Avg Loss: 1.0630, Accuracy: 0.3056, F1 (Macro): 0.2366
  New best model! Val loss improved from 1.0837 to 1.0630. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 1.0818
  Epoch 6 [Batch 4/40]: Loss: 1.0638
  Epoch 6 [Batch 8/40]: Loss: 0.9763
  Epoch 6 [Batch 12/40]: Loss: 1.0496
  Epoch 6 [Batch 16/40]: Loss: 1.0014
  Epoch 6 [Batch 20/40]: Loss: 1.0980
  Epoch 6 [Batch 24/40]: Loss: 1.0653
  Epoch 6 [Batch 28/40]: Loss: 0.9993
  Epoch 6 [Batch 32/40]: Loss: 1.0713
  Epoch 6 [Batch 36/40]: Loss: 1.1024
  Epoch 6 Train Summary: Avg Loss: 1.0413, Accuracy: 0.3439
  Validation Summary: Avg Loss: 1.0580, Accuracy: 0.3194, F1 (Macro): 0.2396
  New best model! Val loss improved from 1.0630 to 1.0580. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 1.0500
  Epoch 7 [Batch 4/40]: Loss: 1.0255
  Epoch 7 [Batch 8/40]: Loss: 1.0404
  Epoch 7 [Batch 12/40]: Loss: 1.1156
  Epoch 7 [Batch 16/40]: Loss: 0.9708
  Epoch 7 [Batch 20/40]: Loss: 0.9966
  Epoch 7 [Batch 24/40]: Loss: 1.0703
  Epoch 7 [Batch 28/40]: Loss: 1.0166
  Epoch 7 [Batch 32/40]: Loss: 0.9831
  Epoch 7 [Batch 36/40]: Loss: 0.9725
  Epoch 7 Train Summary: Avg Loss: 1.0288, Accuracy: 0.3315
  Validation Summary: Avg Loss: 1.0426, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0580 to 1.0426. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 1.0335
  Epoch 8 [Batch 4/40]: Loss: 1.0412
  Epoch 8 [Batch 8/40]: Loss: 0.9839
  Epoch 8 [Batch 12/40]: Loss: 1.0446
  Epoch 8 [Batch 16/40]: Loss: 1.0879
  Epoch 8 [Batch 20/40]: Loss: 1.1191
  Epoch 8 [Batch 24/40]: Loss: 1.0320
  Epoch 8 [Batch 28/40]: Loss: 0.9293
  Epoch 8 [Batch 32/40]: Loss: 1.0379
  Epoch 8 [Batch 36/40]: Loss: 0.8936
  Epoch 8 Train Summary: Avg Loss: 1.0208, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0263, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0426 to 1.0263. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.9715
  Epoch 9 [Batch 4/40]: Loss: 1.1004
  Epoch 9 [Batch 8/40]: Loss: 0.9798
  Epoch 9 [Batch 12/40]: Loss: 0.9750
  Epoch 9 [Batch 16/40]: Loss: 0.9786
  Epoch 9 [Batch 20/40]: Loss: 1.0003
  Epoch 9 [Batch 24/40]: Loss: 0.9084
  Epoch 9 [Batch 28/40]: Loss: 0.9289
  Epoch 9 [Batch 32/40]: Loss: 0.9500
  Epoch 9 [Batch 36/40]: Loss: 1.0543
  Epoch 9 Train Summary: Avg Loss: 1.0139, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0275, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 1.0607
  Epoch 10 [Batch 4/40]: Loss: 0.9364
  Epoch 10 [Batch 8/40]: Loss: 1.1052
  Epoch 10 [Batch 12/40]: Loss: 1.0680
  Epoch 10 [Batch 16/40]: Loss: 0.9408
  Epoch 10 [Batch 20/40]: Loss: 1.0974
  Epoch 10 [Batch 24/40]: Loss: 1.0929
  Epoch 10 [Batch 28/40]: Loss: 0.9157
  Epoch 10 [Batch 32/40]: Loss: 0.9469
  Epoch 10 [Batch 36/40]: Loss: 1.0110
  Epoch 10 Train Summary: Avg Loss: 1.0144, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0172, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0263 to 1.0172. Saving...

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.9727
  Epoch 11 [Batch 4/40]: Loss: 1.0237
  Epoch 11 [Batch 8/40]: Loss: 0.8848
  Epoch 11 [Batch 12/40]: Loss: 0.9385
  Epoch 11 [Batch 16/40]: Loss: 1.1721
  Epoch 11 [Batch 20/40]: Loss: 1.1319
  Epoch 11 [Batch 24/40]: Loss: 0.9910
  Epoch 11 [Batch 28/40]: Loss: 0.9311
  Epoch 11 [Batch 32/40]: Loss: 1.0467
  Epoch 11 [Batch 36/40]: Loss: 1.0003
  Epoch 11 Train Summary: Avg Loss: 0.9984, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0117, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0172 to 1.0117. Saving...

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 1.0126
  Epoch 12 [Batch 4/40]: Loss: 0.9218
  Epoch 12 [Batch 8/40]: Loss: 1.1140
  Epoch 12 [Batch 12/40]: Loss: 0.9760
  Epoch 12 [Batch 16/40]: Loss: 0.8792
  Epoch 12 [Batch 20/40]: Loss: 0.9815
  Epoch 12 [Batch 24/40]: Loss: 1.0496
  Epoch 12 [Batch 28/40]: Loss: 1.2847
  Epoch 12 [Batch 32/40]: Loss: 0.9867
  Epoch 12 [Batch 36/40]: Loss: 1.0397
  Epoch 12 Train Summary: Avg Loss: 0.9935, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0068, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0117 to 1.0068. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.8427
  Epoch 13 [Batch 4/40]: Loss: 0.9850
  Epoch 13 [Batch 8/40]: Loss: 1.1560
  Epoch 13 [Batch 12/40]: Loss: 0.9962
  Epoch 13 [Batch 16/40]: Loss: 1.0356
  Epoch 13 [Batch 20/40]: Loss: 1.0678
  Epoch 13 [Batch 24/40]: Loss: 0.8603
  Epoch 13 [Batch 28/40]: Loss: 0.8954
  Epoch 13 [Batch 32/40]: Loss: 1.0362
  Epoch 13 [Batch 36/40]: Loss: 0.8866
  Epoch 13 Train Summary: Avg Loss: 0.9769, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0032, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0068 to 1.0032. Saving...

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 0.9739
  Epoch 14 [Batch 4/40]: Loss: 0.9915
  Epoch 14 [Batch 8/40]: Loss: 1.0858
  Epoch 14 [Batch 12/40]: Loss: 1.1366
  Epoch 14 [Batch 16/40]: Loss: 1.1004
  Epoch 14 [Batch 20/40]: Loss: 0.8851
  Epoch 14 [Batch 24/40]: Loss: 1.0078
  Epoch 14 [Batch 28/40]: Loss: 0.9165
  Epoch 14 [Batch 32/40]: Loss: 1.0482
  Epoch 14 [Batch 36/40]: Loss: 0.8941
  Epoch 14 Train Summary: Avg Loss: 0.9818, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0055, Accuracy: 0.3333, F1 (Macro): 0.2462
Training finished in 5.01 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.0032, Accuracy: 0.3333, F1 (Macro): 0.2462
Final Best Model Stats: Acc: 0.3333, F1: 0.2462, Loss: 1.0032
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=0.0001 drop=0.0 seed=42
================================================================================
Starting experiment: resnet50__384x384__lr-0.0001__drop-0.0__seed-42
Output directory: results_opg/resnet50__384x384__lr-0.0001__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 1.1125
  Epoch 0 [Batch 4/40]: Loss: 1.1155
  Epoch 0 [Batch 8/40]: Loss: 1.0796
  Epoch 0 [Batch 12/40]: Loss: 1.0750
  Epoch 0 [Batch 16/40]: Loss: 1.0458
  Epoch 0 [Batch 20/40]: Loss: 1.0011
  Epoch 0 [Batch 24/40]: Loss: 1.0321
  Epoch 0 [Batch 28/40]: Loss: 0.9851
  Epoch 0 [Batch 32/40]: Loss: 0.9576
  Epoch 0 [Batch 36/40]: Loss: 1.1438
  Epoch 0 Train Summary: Avg Loss: 1.0518, Accuracy: 0.3740
  Validation Summary: Avg Loss: 0.9458, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from inf to 0.9458. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 0.8991
  Epoch 1 [Batch 4/40]: Loss: 0.9048
  Epoch 1 [Batch 8/40]: Loss: 0.9145
  Epoch 1 [Batch 12/40]: Loss: 0.9850
  Epoch 1 [Batch 16/40]: Loss: 0.9056
  Epoch 1 [Batch 20/40]: Loss: 1.0842
  Epoch 1 [Batch 24/40]: Loss: 0.9935
  Epoch 1 [Batch 28/40]: Loss: 0.9572
  Epoch 1 [Batch 32/40]: Loss: 1.0375
  Epoch 1 [Batch 36/40]: Loss: 1.2360
  Epoch 1 Train Summary: Avg Loss: 0.9695, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8869, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9458 to 0.8869. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.0933
  Epoch 2 [Batch 4/40]: Loss: 0.9607
  Epoch 2 [Batch 8/40]: Loss: 1.2411
  Epoch 2 [Batch 12/40]: Loss: 0.6309
  Epoch 2 [Batch 16/40]: Loss: 0.8418
  Epoch 2 [Batch 20/40]: Loss: 0.8222
  Epoch 2 [Batch 24/40]: Loss: 0.8852
  Epoch 2 [Batch 28/40]: Loss: 1.1451
  Epoch 2 [Batch 32/40]: Loss: 1.1377
  Epoch 2 [Batch 36/40]: Loss: 0.9354
  Epoch 2 Train Summary: Avg Loss: 0.9614, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8544, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8869 to 0.8544. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 0.8621
  Epoch 3 [Batch 4/40]: Loss: 0.8254
  Epoch 3 [Batch 8/40]: Loss: 1.0142
  Epoch 3 [Batch 12/40]: Loss: 0.8815
  Epoch 3 [Batch 16/40]: Loss: 0.8230
  Epoch 3 [Batch 20/40]: Loss: 1.1009
  Epoch 3 [Batch 24/40]: Loss: 1.1193
  Epoch 3 [Batch 28/40]: Loss: 0.9879
  Epoch 3 [Batch 32/40]: Loss: 0.6420
  Epoch 3 [Batch 36/40]: Loss: 1.1591
  Epoch 3 Train Summary: Avg Loss: 0.9407, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8631, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 1.2827
  Epoch 4 [Batch 4/40]: Loss: 0.9864
  Epoch 4 [Batch 8/40]: Loss: 0.9175
  Epoch 4 [Batch 12/40]: Loss: 1.1810
  Epoch 4 [Batch 16/40]: Loss: 0.8937
  Epoch 4 [Batch 20/40]: Loss: 0.9858
  Epoch 4 [Batch 24/40]: Loss: 0.9292
  Epoch 4 [Batch 28/40]: Loss: 0.7072
  Epoch 4 [Batch 32/40]: Loss: 1.1815
  Epoch 4 [Batch 36/40]: Loss: 0.9851
  Epoch 4 Train Summary: Avg Loss: 0.9378, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8687, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 1.1504
  Epoch 5 [Batch 4/40]: Loss: 1.0027
  Epoch 5 [Batch 8/40]: Loss: 0.9188
  Epoch 5 [Batch 12/40]: Loss: 0.8741
  Epoch 5 [Batch 16/40]: Loss: 0.6652
  Epoch 5 [Batch 20/40]: Loss: 0.9348
  Epoch 5 [Batch 24/40]: Loss: 0.8322
  Epoch 5 [Batch 28/40]: Loss: 0.9496
  Epoch 5 [Batch 32/40]: Loss: 0.8572
  Epoch 5 [Batch 36/40]: Loss: 0.5930
  Epoch 5 Train Summary: Avg Loss: 0.9130, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8372, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8544 to 0.8372. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 1.1969
  Epoch 6 [Batch 4/40]: Loss: 1.1608
  Epoch 6 [Batch 8/40]: Loss: 0.7009
  Epoch 6 [Batch 12/40]: Loss: 1.2623
  Epoch 6 [Batch 16/40]: Loss: 0.8955
  Epoch 6 [Batch 20/40]: Loss: 0.6436
  Epoch 6 [Batch 24/40]: Loss: 0.8648
  Epoch 6 [Batch 28/40]: Loss: 1.2492
  Epoch 6 [Batch 32/40]: Loss: 0.9197
  Epoch 6 [Batch 36/40]: Loss: 0.6629
  Epoch 6 Train Summary: Avg Loss: 0.9112, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8458, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 1.6098
  Epoch 7 [Batch 4/40]: Loss: 0.7607
  Epoch 7 [Batch 8/40]: Loss: 1.1700
  Epoch 7 [Batch 12/40]: Loss: 0.7836
  Epoch 7 [Batch 16/40]: Loss: 0.9585
  Epoch 7 [Batch 20/40]: Loss: 0.8684
  Epoch 7 [Batch 24/40]: Loss: 0.8954
  Epoch 7 [Batch 28/40]: Loss: 0.6904
  Epoch 7 [Batch 32/40]: Loss: 1.0325
  Epoch 7 [Batch 36/40]: Loss: 0.8749
  Epoch 7 Train Summary: Avg Loss: 0.9228, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8480, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.7986
  Epoch 8 [Batch 4/40]: Loss: 1.0569
  Epoch 8 [Batch 8/40]: Loss: 0.9132
  Epoch 8 [Batch 12/40]: Loss: 0.9326
  Epoch 8 [Batch 16/40]: Loss: 0.8396
  Epoch 8 [Batch 20/40]: Loss: 0.8429
  Epoch 8 [Batch 24/40]: Loss: 1.0363
  Epoch 8 [Batch 28/40]: Loss: 0.6729
  Epoch 8 [Batch 32/40]: Loss: 0.7550
  Epoch 8 [Batch 36/40]: Loss: 1.2405
  Epoch 8 Train Summary: Avg Loss: 0.8870, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8050, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8372 to 0.8050. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 1.1188
  Epoch 9 [Batch 4/40]: Loss: 1.0652
  Epoch 9 [Batch 8/40]: Loss: 0.9369
  Epoch 9 [Batch 12/40]: Loss: 1.0108
  Epoch 9 [Batch 16/40]: Loss: 0.9280
  Epoch 9 [Batch 20/40]: Loss: 0.9497
  Epoch 9 [Batch 24/40]: Loss: 0.7428
  Epoch 9 [Batch 28/40]: Loss: 0.8803
  Epoch 9 [Batch 32/40]: Loss: 0.6412
  Epoch 9 [Batch 36/40]: Loss: 0.7591
  Epoch 9 Train Summary: Avg Loss: 0.8707, Accuracy: 0.3368
  Validation Summary: Avg Loss: 0.7526, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8050 to 0.7526. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 1.0532
  Epoch 10 [Batch 4/40]: Loss: 0.8262
  Epoch 10 [Batch 8/40]: Loss: 0.7720
  Epoch 10 [Batch 12/40]: Loss: 0.8556
  Epoch 10 [Batch 16/40]: Loss: 0.8749
  Epoch 10 [Batch 20/40]: Loss: 0.8825
  Epoch 10 [Batch 24/40]: Loss: 0.5944
  Epoch 10 [Batch 28/40]: Loss: 0.8508
  Epoch 10 [Batch 32/40]: Loss: 0.8187
  Epoch 10 [Batch 36/40]: Loss: 0.9426
  Epoch 10 Train Summary: Avg Loss: 0.8544, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.7594, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.7529
  Epoch 11 [Batch 4/40]: Loss: 0.8777
  Epoch 11 [Batch 8/40]: Loss: 1.0835
  Epoch 11 [Batch 12/40]: Loss: 0.5922
  Epoch 11 [Batch 16/40]: Loss: 1.2497
  Epoch 11 [Batch 20/40]: Loss: 0.9262
  Epoch 11 [Batch 24/40]: Loss: 0.8642
  Epoch 11 [Batch 28/40]: Loss: 1.0458
  Epoch 11 [Batch 32/40]: Loss: 0.9672
  Epoch 11 [Batch 36/40]: Loss: 0.9738
  Epoch 11 Train Summary: Avg Loss: 0.8598, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.7866, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.7781
  Epoch 12 [Batch 4/40]: Loss: 0.6089
  Epoch 12 [Batch 8/40]: Loss: 0.7727
  Epoch 12 [Batch 12/40]: Loss: 0.5949
  Epoch 12 [Batch 16/40]: Loss: 1.0380
  Epoch 12 [Batch 20/40]: Loss: 0.6062
  Epoch 12 [Batch 24/40]: Loss: 0.8532
  Epoch 12 [Batch 28/40]: Loss: 1.4657
  Epoch 12 [Batch 32/40]: Loss: 0.6603
  Epoch 12 [Batch 36/40]: Loss: 0.7556
  Epoch 12 Train Summary: Avg Loss: 0.8447, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.7911, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.5423
  Epoch 13 [Batch 4/40]: Loss: 0.6981
  Epoch 13 [Batch 8/40]: Loss: 0.6837
  Epoch 13 [Batch 12/40]: Loss: 0.6929
  Epoch 13 [Batch 16/40]: Loss: 1.2371
  Epoch 13 [Batch 20/40]: Loss: 1.0996
  Epoch 13 [Batch 24/40]: Loss: 0.9762
  Epoch 13 [Batch 28/40]: Loss: 1.1221
  Epoch 13 [Batch 32/40]: Loss: 0.6404
  Epoch 13 [Batch 36/40]: Loss: 0.7229
  Epoch 13 Train Summary: Avg Loss: 0.8481, Accuracy: 0.3474
  Validation Summary: Avg Loss: 0.7942, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 1.0222
  Epoch 14 [Batch 4/40]: Loss: 0.5789
  Epoch 14 [Batch 8/40]: Loss: 1.2586
  Epoch 14 [Batch 12/40]: Loss: 1.0535
  Epoch 14 [Batch 16/40]: Loss: 0.6560
  Epoch 14 [Batch 20/40]: Loss: 0.6979
  Epoch 14 [Batch 24/40]: Loss: 0.7242
  Epoch 14 [Batch 28/40]: Loss: 0.8435
  Epoch 14 [Batch 32/40]: Loss: 0.7324
  Epoch 14 [Batch 36/40]: Loss: 0.7420
  Epoch 14 Train Summary: Avg Loss: 0.8293, Accuracy: 0.3417
  Validation Summary: Avg Loss: 0.8318, Accuracy: 0.3194, F1 (Macro): 0.2434
Training finished in 5.30 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.7526, Accuracy: 0.3333, F1 (Macro): 0.2462
Final Best Model Stats: Acc: 0.3333, F1: 0.2462, Loss: 0.7526
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=0.0001 drop=0.0 seed=123
================================================================================
Starting experiment: resnet50__384x384__lr-0.0001__drop-0.0__seed-123
Output directory: results_opg/resnet50__384x384__lr-0.0001__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 1.0939
  Epoch 0 [Batch 4/40]: Loss: 1.0830
  Epoch 0 [Batch 8/40]: Loss: 1.0560
  Epoch 0 [Batch 12/40]: Loss: 1.0737
  Epoch 0 [Batch 16/40]: Loss: 1.0742
  Epoch 0 [Batch 20/40]: Loss: 1.0501
  Epoch 0 [Batch 24/40]: Loss: 0.9215
  Epoch 0 [Batch 28/40]: Loss: 1.0433
  Epoch 0 [Batch 32/40]: Loss: 1.0077
  Epoch 0 [Batch 36/40]: Loss: 0.9077
  Epoch 0 Train Summary: Avg Loss: 1.0331, Accuracy: 0.3739
  Validation Summary: Avg Loss: 0.9614, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from inf to 0.9614. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 1.0908
  Epoch 1 [Batch 4/40]: Loss: 1.0509
  Epoch 1 [Batch 8/40]: Loss: 1.1141
  Epoch 1 [Batch 12/40]: Loss: 1.0148
  Epoch 1 [Batch 16/40]: Loss: 1.1934
  Epoch 1 [Batch 20/40]: Loss: 1.0312
  Epoch 1 [Batch 24/40]: Loss: 0.9706
  Epoch 1 [Batch 28/40]: Loss: 0.8140
  Epoch 1 [Batch 32/40]: Loss: 0.9944
  Epoch 1 [Batch 36/40]: Loss: 0.8343
  Epoch 1 Train Summary: Avg Loss: 0.9583, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8964, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9614 to 0.8964. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.1499
  Epoch 2 [Batch 4/40]: Loss: 0.9004
  Epoch 2 [Batch 8/40]: Loss: 0.8704
  Epoch 2 [Batch 12/40]: Loss: 1.0721
  Epoch 2 [Batch 16/40]: Loss: 1.1555
  Epoch 2 [Batch 20/40]: Loss: 0.9759
  Epoch 2 [Batch 24/40]: Loss: 0.8568
  Epoch 2 [Batch 28/40]: Loss: 0.9121
  Epoch 2 [Batch 32/40]: Loss: 0.7910
  Epoch 2 [Batch 36/40]: Loss: 0.7965
  Epoch 2 Train Summary: Avg Loss: 0.9573, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8956, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8964 to 0.8956. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 0.8520
  Epoch 3 [Batch 4/40]: Loss: 0.8265
  Epoch 3 [Batch 8/40]: Loss: 0.9283
  Epoch 3 [Batch 12/40]: Loss: 0.8769
  Epoch 3 [Batch 16/40]: Loss: 1.0806
  Epoch 3 [Batch 20/40]: Loss: 0.8342
  Epoch 3 [Batch 24/40]: Loss: 0.9181
  Epoch 3 [Batch 28/40]: Loss: 1.0247
  Epoch 3 [Batch 32/40]: Loss: 0.9291
  Epoch 3 [Batch 36/40]: Loss: 0.8698
  Epoch 3 Train Summary: Avg Loss: 0.9337, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8995, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 0.6241
  Epoch 4 [Batch 4/40]: Loss: 0.6764
  Epoch 4 [Batch 8/40]: Loss: 0.9061
  Epoch 4 [Batch 12/40]: Loss: 1.1664
  Epoch 4 [Batch 16/40]: Loss: 0.9991
  Epoch 4 [Batch 20/40]: Loss: 1.0792
  Epoch 4 [Batch 24/40]: Loss: 0.9735
  Epoch 4 [Batch 28/40]: Loss: 1.0715
  Epoch 4 [Batch 32/40]: Loss: 0.9608
  Epoch 4 [Batch 36/40]: Loss: 0.7728
  Epoch 4 Train Summary: Avg Loss: 0.9470, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8517, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8956 to 0.8517. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 1.0184
  Epoch 5 [Batch 4/40]: Loss: 0.8912
  Epoch 5 [Batch 8/40]: Loss: 0.8425
  Epoch 5 [Batch 12/40]: Loss: 1.3099
  Epoch 5 [Batch 16/40]: Loss: 0.7780
  Epoch 5 [Batch 20/40]: Loss: 0.6304
  Epoch 5 [Batch 24/40]: Loss: 0.9951
  Epoch 5 [Batch 28/40]: Loss: 0.7765
  Epoch 5 [Batch 32/40]: Loss: 0.8665
  Epoch 5 [Batch 36/40]: Loss: 0.8708
  Epoch 5 Train Summary: Avg Loss: 0.9397, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8330, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8517 to 0.8330. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 0.8295
  Epoch 6 [Batch 4/40]: Loss: 1.1255
  Epoch 6 [Batch 8/40]: Loss: 0.6953
  Epoch 6 [Batch 12/40]: Loss: 0.9587
  Epoch 6 [Batch 16/40]: Loss: 0.8432
  Epoch 6 [Batch 20/40]: Loss: 1.0280
  Epoch 6 [Batch 24/40]: Loss: 1.1587
  Epoch 6 [Batch 28/40]: Loss: 1.1753
  Epoch 6 [Batch 32/40]: Loss: 0.8139
  Epoch 6 [Batch 36/40]: Loss: 0.8258
  Epoch 6 Train Summary: Avg Loss: 0.9072, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8265, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8330 to 0.8265. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 1.1223
  Epoch 7 [Batch 4/40]: Loss: 0.9800
  Epoch 7 [Batch 8/40]: Loss: 0.9915
  Epoch 7 [Batch 12/40]: Loss: 1.2041
  Epoch 7 [Batch 16/40]: Loss: 0.8424
  Epoch 7 [Batch 20/40]: Loss: 0.9833
  Epoch 7 [Batch 24/40]: Loss: 0.8472
  Epoch 7 [Batch 28/40]: Loss: 0.6943
  Epoch 7 [Batch 32/40]: Loss: 0.7552
  Epoch 7 [Batch 36/40]: Loss: 0.6103
  Epoch 7 Train Summary: Avg Loss: 0.9411, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.7869, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8265 to 0.7869. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.6930
  Epoch 8 [Batch 4/40]: Loss: 1.0440
  Epoch 8 [Batch 8/40]: Loss: 0.5802
  Epoch 8 [Batch 12/40]: Loss: 0.7592
  Epoch 8 [Batch 16/40]: Loss: 0.5609
  Epoch 8 [Batch 20/40]: Loss: 1.0953
  Epoch 8 [Batch 24/40]: Loss: 0.6787
  Epoch 8 [Batch 28/40]: Loss: 0.8784
  Epoch 8 [Batch 32/40]: Loss: 0.9879
  Epoch 8 [Batch 36/40]: Loss: 0.5700
  Epoch 8 Train Summary: Avg Loss: 0.8894, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8215, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.7504
  Epoch 9 [Batch 4/40]: Loss: 0.9771
  Epoch 9 [Batch 8/40]: Loss: 0.7526
  Epoch 9 [Batch 12/40]: Loss: 1.1154
  Epoch 9 [Batch 16/40]: Loss: 0.8435
  Epoch 9 [Batch 20/40]: Loss: 0.9141
  Epoch 9 [Batch 24/40]: Loss: 1.1143
  Epoch 9 [Batch 28/40]: Loss: 0.6429
  Epoch 9 [Batch 32/40]: Loss: 0.8925
  Epoch 9 [Batch 36/40]: Loss: 0.7898
  Epoch 9 Train Summary: Avg Loss: 0.8856, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8639, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 1.0440
  Epoch 10 [Batch 4/40]: Loss: 0.9141
  Epoch 10 [Batch 8/40]: Loss: 0.9364
  Epoch 10 [Batch 12/40]: Loss: 0.7156
  Epoch 10 [Batch 16/40]: Loss: 0.7376
  Epoch 10 [Batch 20/40]: Loss: 0.9473
  Epoch 10 [Batch 24/40]: Loss: 0.6920
  Epoch 10 [Batch 28/40]: Loss: 0.9991
  Epoch 10 [Batch 32/40]: Loss: 1.5955
  Epoch 10 [Batch 36/40]: Loss: 0.8708
  Epoch 10 Train Summary: Avg Loss: 0.8741, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.7957, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.6882
  Epoch 11 [Batch 4/40]: Loss: 0.7602
  Epoch 11 [Batch 8/40]: Loss: 1.0408
  Epoch 11 [Batch 12/40]: Loss: 0.7967
  Epoch 11 [Batch 16/40]: Loss: 0.8822
  Epoch 11 [Batch 20/40]: Loss: 0.8565
  Epoch 11 [Batch 24/40]: Loss: 0.8083
  Epoch 11 [Batch 28/40]: Loss: 0.7791
  Epoch 11 [Batch 32/40]: Loss: 0.6631
  Epoch 11 [Batch 36/40]: Loss: 0.8621
  Epoch 11 Train Summary: Avg Loss: 0.8560, Accuracy: 0.3368
  Validation Summary: Avg Loss: 0.7881, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.8011
  Epoch 12 [Batch 4/40]: Loss: 0.9510
  Epoch 12 [Batch 8/40]: Loss: 0.6834
  Epoch 12 [Batch 12/40]: Loss: 1.1343
  Epoch 12 [Batch 16/40]: Loss: 0.5860
  Epoch 12 [Batch 20/40]: Loss: 0.7516
  Epoch 12 [Batch 24/40]: Loss: 0.8343
  Epoch 12 [Batch 28/40]: Loss: 0.7492
  Epoch 12 [Batch 32/40]: Loss: 0.7857
  Epoch 12 [Batch 36/40]: Loss: 0.7560
  Epoch 12 Train Summary: Avg Loss: 0.8522, Accuracy: 0.3506
  Validation Summary: Avg Loss: 0.7774, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.7869 to 0.7774. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 1.0042
  Epoch 13 [Batch 4/40]: Loss: 0.9627
  Epoch 13 [Batch 8/40]: Loss: 0.9420
  Epoch 13 [Batch 12/40]: Loss: 0.7471
  Epoch 13 [Batch 16/40]: Loss: 1.1463
  Epoch 13 [Batch 20/40]: Loss: 0.8113
  Epoch 13 [Batch 24/40]: Loss: 0.7205
  Epoch 13 [Batch 28/40]: Loss: 0.9227
  Epoch 13 [Batch 32/40]: Loss: 1.1087
  Epoch 13 [Batch 36/40]: Loss: 0.5850
  Epoch 13 Train Summary: Avg Loss: 0.8479, Accuracy: 0.3576
  Validation Summary: Avg Loss: 0.8784, Accuracy: 0.3194, F1 (Macro): 0.2434

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 0.9569
  Epoch 14 [Batch 4/40]: Loss: 1.1205
  Epoch 14 [Batch 8/40]: Loss: 0.7979
  Epoch 14 [Batch 12/40]: Loss: 1.2235
  Epoch 14 [Batch 16/40]: Loss: 0.9300
  Epoch 14 [Batch 20/40]: Loss: 0.8489
  Epoch 14 [Batch 24/40]: Loss: 0.8136
  Epoch 14 [Batch 28/40]: Loss: 0.6800
  Epoch 14 [Batch 32/40]: Loss: 0.7575
  Epoch 14 [Batch 36/40]: Loss: 0.5316
  Epoch 14 Train Summary: Avg Loss: 0.8151, Accuracy: 0.3558
  Validation Summary: Avg Loss: 0.7748, Accuracy: 0.3056, F1 (Macro): 0.2366
  New best model! Val loss improved from 0.7774 to 0.7748. Saving...
Training finished in 6.16 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.7748, Accuracy: 0.3056, F1 (Macro): 0.2366
Final Best Model Stats: Acc: 0.3056, F1: 0.2366, Loss: 0.7748
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=0.0001 drop=0.0 seed=999
================================================================================
Starting experiment: resnet50__384x384__lr-0.0001__drop-0.0__seed-999
Output directory: results_opg/resnet50__384x384__lr-0.0001__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 1.2051
  Epoch 0 [Batch 4/40]: Loss: 1.1268
  Epoch 0 [Batch 8/40]: Loss: 1.0927
  Epoch 0 [Batch 12/40]: Loss: 1.0705
  Epoch 0 [Batch 16/40]: Loss: 1.0838
  Epoch 0 [Batch 20/40]: Loss: 1.0633
  Epoch 0 [Batch 24/40]: Loss: 0.9720
  Epoch 0 [Batch 28/40]: Loss: 1.0234
  Epoch 0 [Batch 32/40]: Loss: 1.0140
  Epoch 0 [Batch 36/40]: Loss: 0.9883
  Epoch 0 Train Summary: Avg Loss: 1.0527, Accuracy: 0.3059
  Validation Summary: Avg Loss: 1.0172, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from inf to 1.0172. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 0.9961
  Epoch 1 [Batch 4/40]: Loss: 0.8468
  Epoch 1 [Batch 8/40]: Loss: 0.8356
  Epoch 1 [Batch 12/40]: Loss: 1.0301
  Epoch 1 [Batch 16/40]: Loss: 1.0893
  Epoch 1 [Batch 20/40]: Loss: 0.9115
  Epoch 1 [Batch 24/40]: Loss: 0.8590
  Epoch 1 [Batch 28/40]: Loss: 1.1799
  Epoch 1 [Batch 32/40]: Loss: 0.7976
  Epoch 1 [Batch 36/40]: Loss: 1.0000
  Epoch 1 Train Summary: Avg Loss: 0.9634, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9271, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0172 to 0.9271. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.2797
  Epoch 2 [Batch 4/40]: Loss: 0.9534
  Epoch 2 [Batch 8/40]: Loss: 0.9105
  Epoch 2 [Batch 12/40]: Loss: 0.8651
  Epoch 2 [Batch 16/40]: Loss: 0.9027
  Epoch 2 [Batch 20/40]: Loss: 0.9912
  Epoch 2 [Batch 24/40]: Loss: 0.9666
  Epoch 2 [Batch 28/40]: Loss: 1.0696
  Epoch 2 [Batch 32/40]: Loss: 1.0540
  Epoch 2 [Batch 36/40]: Loss: 1.2206
  Epoch 2 Train Summary: Avg Loss: 0.9451, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8654, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9271 to 0.8654. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 0.7712
  Epoch 3 [Batch 4/40]: Loss: 0.7741
  Epoch 3 [Batch 8/40]: Loss: 0.9007
  Epoch 3 [Batch 12/40]: Loss: 1.0200
  Epoch 3 [Batch 16/40]: Loss: 1.2366
  Epoch 3 [Batch 20/40]: Loss: 0.9824
  Epoch 3 [Batch 24/40]: Loss: 0.9631
  Epoch 3 [Batch 28/40]: Loss: 1.0078
  Epoch 3 [Batch 32/40]: Loss: 0.8866
  Epoch 3 [Batch 36/40]: Loss: 0.8004
  Epoch 3 Train Summary: Avg Loss: 0.9545, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8854, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 1.0443
  Epoch 4 [Batch 4/40]: Loss: 0.5566
  Epoch 4 [Batch 8/40]: Loss: 0.9806
  Epoch 4 [Batch 12/40]: Loss: 1.2934
  Epoch 4 [Batch 16/40]: Loss: 0.8066
  Epoch 4 [Batch 20/40]: Loss: 1.0596
  Epoch 4 [Batch 24/40]: Loss: 1.1491
  Epoch 4 [Batch 28/40]: Loss: 0.9153
  Epoch 4 [Batch 32/40]: Loss: 0.8631
  Epoch 4 [Batch 36/40]: Loss: 0.9618
  Epoch 4 Train Summary: Avg Loss: 0.9261, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8403, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8654 to 0.8403. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 0.5754
  Epoch 5 [Batch 4/40]: Loss: 1.0511
  Epoch 5 [Batch 8/40]: Loss: 1.0429
  Epoch 5 [Batch 12/40]: Loss: 0.8003
  Epoch 5 [Batch 16/40]: Loss: 0.6600
  Epoch 5 [Batch 20/40]: Loss: 0.7027
  Epoch 5 [Batch 24/40]: Loss: 0.8471
  Epoch 5 [Batch 28/40]: Loss: 0.6779
  Epoch 5 [Batch 32/40]: Loss: 1.2099
  Epoch 5 [Batch 36/40]: Loss: 0.7216
  Epoch 5 Train Summary: Avg Loss: 0.9403, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8344, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8403 to 0.8344. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 1.2279
  Epoch 6 [Batch 4/40]: Loss: 0.9135
  Epoch 6 [Batch 8/40]: Loss: 0.7080
  Epoch 6 [Batch 12/40]: Loss: 0.9095
  Epoch 6 [Batch 16/40]: Loss: 0.6988
  Epoch 6 [Batch 20/40]: Loss: 1.1762
  Epoch 6 [Batch 24/40]: Loss: 1.0617
  Epoch 6 [Batch 28/40]: Loss: 0.6958
  Epoch 6 [Batch 32/40]: Loss: 1.0282
  Epoch 6 [Batch 36/40]: Loss: 1.3400
  Epoch 6 Train Summary: Avg Loss: 0.9247, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8287, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8344 to 0.8287. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 1.0456
  Epoch 7 [Batch 4/40]: Loss: 0.8331
  Epoch 7 [Batch 8/40]: Loss: 0.9057
  Epoch 7 [Batch 12/40]: Loss: 1.1962
  Epoch 7 [Batch 16/40]: Loss: 0.7394
  Epoch 7 [Batch 20/40]: Loss: 0.8675
  Epoch 7 [Batch 24/40]: Loss: 1.0186
  Epoch 7 [Batch 28/40]: Loss: 0.7697
  Epoch 7 [Batch 32/40]: Loss: 0.8281
  Epoch 7 [Batch 36/40]: Loss: 0.7633
  Epoch 7 Train Summary: Avg Loss: 0.9166, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8058, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8287 to 0.8058. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.8946
  Epoch 8 [Batch 4/40]: Loss: 0.8873
  Epoch 8 [Batch 8/40]: Loss: 0.7862
  Epoch 8 [Batch 12/40]: Loss: 1.0603
  Epoch 8 [Batch 16/40]: Loss: 1.1087
  Epoch 8 [Batch 20/40]: Loss: 1.1784
  Epoch 8 [Batch 24/40]: Loss: 0.9445
  Epoch 8 [Batch 28/40]: Loss: 0.6675
  Epoch 8 [Batch 32/40]: Loss: 1.0902
  Epoch 8 [Batch 36/40]: Loss: 0.5340
  Epoch 8 Train Summary: Avg Loss: 0.8928, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8128, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.7055
  Epoch 9 [Batch 4/40]: Loss: 1.2118
  Epoch 9 [Batch 8/40]: Loss: 0.8854
  Epoch 9 [Batch 12/40]: Loss: 0.7303
  Epoch 9 [Batch 16/40]: Loss: 0.7177
  Epoch 9 [Batch 20/40]: Loss: 0.8570
  Epoch 9 [Batch 24/40]: Loss: 0.6139
  Epoch 9 [Batch 28/40]: Loss: 0.7705
  Epoch 9 [Batch 32/40]: Loss: 0.8480
  Epoch 9 [Batch 36/40]: Loss: 1.0619
  Epoch 9 Train Summary: Avg Loss: 0.8977, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8047, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8058 to 0.8047. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 1.1278
  Epoch 10 [Batch 4/40]: Loss: 0.8105
  Epoch 10 [Batch 8/40]: Loss: 1.0199
  Epoch 10 [Batch 12/40]: Loss: 0.9978
  Epoch 10 [Batch 16/40]: Loss: 0.7358
  Epoch 10 [Batch 20/40]: Loss: 1.1019
  Epoch 10 [Batch 24/40]: Loss: 1.1208
  Epoch 10 [Batch 28/40]: Loss: 0.6573
  Epoch 10 [Batch 32/40]: Loss: 0.7798
  Epoch 10 [Batch 36/40]: Loss: 1.1449
  Epoch 10 Train Summary: Avg Loss: 0.9062, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.7782, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8047 to 0.7782. Saving...

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.8348
  Epoch 11 [Batch 4/40]: Loss: 0.9944
  Epoch 11 [Batch 8/40]: Loss: 0.5579
  Epoch 11 [Batch 12/40]: Loss: 0.7493
  Epoch 11 [Batch 16/40]: Loss: 1.1446
  Epoch 11 [Batch 20/40]: Loss: 1.0338
  Epoch 11 [Batch 24/40]: Loss: 0.7223
  Epoch 11 [Batch 28/40]: Loss: 0.7484
  Epoch 11 [Batch 32/40]: Loss: 1.1503
  Epoch 11 [Batch 36/40]: Loss: 0.9343
  Epoch 11 Train Summary: Avg Loss: 0.8505, Accuracy: 0.3368
  Validation Summary: Avg Loss: 0.7801, Accuracy: 0.3611, F1 (Macro): 0.3013

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.8383
  Epoch 12 [Batch 4/40]: Loss: 0.8696
  Epoch 12 [Batch 8/40]: Loss: 1.1764
  Epoch 12 [Batch 12/40]: Loss: 0.7791
  Epoch 12 [Batch 16/40]: Loss: 0.7584
  Epoch 12 [Batch 20/40]: Loss: 0.7001
  Epoch 12 [Batch 24/40]: Loss: 0.9742
  Epoch 12 [Batch 28/40]: Loss: 1.5691
  Epoch 12 [Batch 32/40]: Loss: 0.7906
  Epoch 12 [Batch 36/40]: Loss: 1.0952
  Epoch 12 Train Summary: Avg Loss: 0.8567, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.7703, Accuracy: 0.3611, F1 (Macro): 0.3016
  New best model! Val loss improved from 0.7782 to 0.7703. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.5333
  Epoch 13 [Batch 4/40]: Loss: 0.9193
  Epoch 13 [Batch 8/40]: Loss: 1.0303
  Epoch 13 [Batch 12/40]: Loss: 0.8956
  Epoch 13 [Batch 16/40]: Loss: 1.0270
  Epoch 13 [Batch 20/40]: Loss: 1.0815
  Epoch 13 [Batch 24/40]: Loss: 0.6624
  Epoch 13 [Batch 28/40]: Loss: 0.6804
  Epoch 13 [Batch 32/40]: Loss: 0.8475
  Epoch 13 [Batch 36/40]: Loss: 0.7829
  Epoch 13 Train Summary: Avg Loss: 0.8219, Accuracy: 0.3368
  Validation Summary: Avg Loss: 0.7773, Accuracy: 0.3611, F1 (Macro): 0.3016

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 0.7595
  Epoch 14 [Batch 4/40]: Loss: 0.8340
  Epoch 14 [Batch 8/40]: Loss: 0.8545
  Epoch 14 [Batch 12/40]: Loss: 0.9696
  Epoch 14 [Batch 16/40]: Loss: 1.0020
  Epoch 14 [Batch 20/40]: Loss: 0.7117
  Epoch 14 [Batch 24/40]: Loss: 0.7330
  Epoch 14 [Batch 28/40]: Loss: 0.6579
  Epoch 14 [Batch 32/40]: Loss: 0.8617
  Epoch 14 [Batch 36/40]: Loss: 0.5631
  Epoch 14 Train Summary: Avg Loss: 0.8018, Accuracy: 0.3525
  Validation Summary: Avg Loss: 0.7554, Accuracy: 0.3472, F1 (Macro): 0.2918
  New best model! Val loss improved from 0.7703 to 0.7554. Saving...
Training finished in 5.27 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.7554, Accuracy: 0.3472, F1 (Macro): 0.2918
Final Best Model Stats: Acc: 0.3472, F1: 0.2918, Loss: 0.7554
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=5e-05 drop=0.0 seed=42
================================================================================
Starting experiment: resnet50__384x384__lr-5e-05__drop-0.0__seed-42
Output directory: results_opg/resnet50__384x384__lr-5e-05__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 1.1125
  Epoch 0 [Batch 4/40]: Loss: 1.1294
  Epoch 0 [Batch 8/40]: Loss: 1.1132
  Epoch 0 [Batch 12/40]: Loss: 1.1163
  Epoch 0 [Batch 16/40]: Loss: 1.0913
  Epoch 0 [Batch 20/40]: Loss: 1.0563
  Epoch 0 [Batch 24/40]: Loss: 1.0823
  Epoch 0 [Batch 28/40]: Loss: 1.0396
  Epoch 0 [Batch 32/40]: Loss: 1.0562
  Epoch 0 [Batch 36/40]: Loss: 1.1242
  Epoch 0 Train Summary: Avg Loss: 1.0828, Accuracy: 0.3500
  Validation Summary: Avg Loss: 1.0326, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from inf to 1.0326. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 0.9884
  Epoch 1 [Batch 4/40]: Loss: 0.9994
  Epoch 1 [Batch 8/40]: Loss: 0.9990
  Epoch 1 [Batch 12/40]: Loss: 1.0315
  Epoch 1 [Batch 16/40]: Loss: 0.9693
  Epoch 1 [Batch 20/40]: Loss: 1.0833
  Epoch 1 [Batch 24/40]: Loss: 1.0024
  Epoch 1 [Batch 28/40]: Loss: 1.0186
  Epoch 1 [Batch 32/40]: Loss: 1.0371
  Epoch 1 [Batch 36/40]: Loss: 1.1830
  Epoch 1 Train Summary: Avg Loss: 1.0120, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9764, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0326 to 0.9764. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.0523
  Epoch 2 [Batch 4/40]: Loss: 1.0147
  Epoch 2 [Batch 8/40]: Loss: 1.1553
  Epoch 2 [Batch 12/40]: Loss: 0.7884
  Epoch 2 [Batch 16/40]: Loss: 0.9084
  Epoch 2 [Batch 20/40]: Loss: 0.9173
  Epoch 2 [Batch 24/40]: Loss: 0.9470
  Epoch 2 [Batch 28/40]: Loss: 1.1053
  Epoch 2 [Batch 32/40]: Loss: 1.0953
  Epoch 2 [Batch 36/40]: Loss: 0.9416
  Epoch 2 Train Summary: Avg Loss: 0.9853, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9236, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9764 to 0.9236. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 0.8753
  Epoch 3 [Batch 4/40]: Loss: 0.8632
  Epoch 3 [Batch 8/40]: Loss: 0.9798
  Epoch 3 [Batch 12/40]: Loss: 0.8873
  Epoch 3 [Batch 16/40]: Loss: 0.9418
  Epoch 3 [Batch 20/40]: Loss: 1.1143
  Epoch 3 [Batch 24/40]: Loss: 1.0964
  Epoch 3 [Batch 28/40]: Loss: 0.9756
  Epoch 3 [Batch 32/40]: Loss: 0.7120
  Epoch 3 [Batch 36/40]: Loss: 1.1561
  Epoch 3 Train Summary: Avg Loss: 0.9588, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9285, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 1.2839
  Epoch 4 [Batch 4/40]: Loss: 1.0319
  Epoch 4 [Batch 8/40]: Loss: 0.9651
  Epoch 4 [Batch 12/40]: Loss: 1.2144
  Epoch 4 [Batch 16/40]: Loss: 0.9316
  Epoch 4 [Batch 20/40]: Loss: 0.9763
  Epoch 4 [Batch 24/40]: Loss: 0.9795
  Epoch 4 [Batch 28/40]: Loss: 0.7403
  Epoch 4 [Batch 32/40]: Loss: 1.1306
  Epoch 4 [Batch 36/40]: Loss: 1.0041
  Epoch 4 Train Summary: Avg Loss: 0.9589, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8885, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9236 to 0.8885. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 1.1516
  Epoch 5 [Batch 4/40]: Loss: 1.0187
  Epoch 5 [Batch 8/40]: Loss: 0.9634
  Epoch 5 [Batch 12/40]: Loss: 0.9150
  Epoch 5 [Batch 16/40]: Loss: 0.6991
  Epoch 5 [Batch 20/40]: Loss: 0.9664
  Epoch 5 [Batch 24/40]: Loss: 0.8005
  Epoch 5 [Batch 28/40]: Loss: 0.9756
  Epoch 5 [Batch 32/40]: Loss: 0.8610
  Epoch 5 [Batch 36/40]: Loss: 0.6271
  Epoch 5 Train Summary: Avg Loss: 0.9391, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8703, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8885 to 0.8703. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 1.1578
  Epoch 6 [Batch 4/40]: Loss: 1.1533
  Epoch 6 [Batch 8/40]: Loss: 0.7480
  Epoch 6 [Batch 12/40]: Loss: 1.2370
  Epoch 6 [Batch 16/40]: Loss: 0.9724
  Epoch 6 [Batch 20/40]: Loss: 0.6910
  Epoch 6 [Batch 24/40]: Loss: 0.8945
  Epoch 6 [Batch 28/40]: Loss: 1.1616
  Epoch 6 [Batch 32/40]: Loss: 0.9245
  Epoch 6 [Batch 36/40]: Loss: 0.7017
  Epoch 6 Train Summary: Avg Loss: 0.9295, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8796, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 1.4807
  Epoch 7 [Batch 4/40]: Loss: 0.8063
  Epoch 7 [Batch 8/40]: Loss: 1.1559
  Epoch 7 [Batch 12/40]: Loss: 0.8403
  Epoch 7 [Batch 16/40]: Loss: 0.9862
  Epoch 7 [Batch 20/40]: Loss: 0.8833
  Epoch 7 [Batch 24/40]: Loss: 0.9271
  Epoch 7 [Batch 28/40]: Loss: 0.7617
  Epoch 7 [Batch 32/40]: Loss: 0.9587
  Epoch 7 [Batch 36/40]: Loss: 0.8883
  Epoch 7 Train Summary: Avg Loss: 0.9361, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8762, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.9146
  Epoch 8 [Batch 4/40]: Loss: 1.1664
  Epoch 8 [Batch 8/40]: Loss: 0.9073
  Epoch 8 [Batch 12/40]: Loss: 1.0235
  Epoch 8 [Batch 16/40]: Loss: 0.8595
  Epoch 8 [Batch 20/40]: Loss: 0.9209
  Epoch 8 [Batch 24/40]: Loss: 1.0334
  Epoch 8 [Batch 28/40]: Loss: 0.7352
  Epoch 8 [Batch 32/40]: Loss: 0.8090
  Epoch 8 [Batch 36/40]: Loss: 1.2521
  Epoch 8 Train Summary: Avg Loss: 0.9256, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8859, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 1.0629
  Epoch 9 [Batch 4/40]: Loss: 1.0649
  Epoch 9 [Batch 8/40]: Loss: 0.8508
  Epoch 9 [Batch 12/40]: Loss: 1.0155
  Epoch 9 [Batch 16/40]: Loss: 0.9934
  Epoch 9 [Batch 20/40]: Loss: 1.0178
  Epoch 9 [Batch 24/40]: Loss: 0.7530
  Epoch 9 [Batch 28/40]: Loss: 0.9008
  Epoch 9 [Batch 32/40]: Loss: 0.6565
  Epoch 9 [Batch 36/40]: Loss: 0.8011
  Epoch 9 Train Summary: Avg Loss: 0.9093, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8853, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 1.0497
  Epoch 10 [Batch 4/40]: Loss: 0.8792
  Epoch 10 [Batch 8/40]: Loss: 0.8449
  Epoch 10 [Batch 12/40]: Loss: 0.9240
  Epoch 10 [Batch 16/40]: Loss: 0.9270
  Epoch 10 [Batch 20/40]: Loss: 0.8224
  Epoch 10 [Batch 24/40]: Loss: 0.6692
  Epoch 10 [Batch 28/40]: Loss: 0.8522
  Epoch 10 [Batch 32/40]: Loss: 0.9459
  Epoch 10 [Batch 36/40]: Loss: 1.0100
  Epoch 10 Train Summary: Avg Loss: 0.9091, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8555, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8703 to 0.8555. Saving...

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.8510
  Epoch 11 [Batch 4/40]: Loss: 0.8874
  Epoch 11 [Batch 8/40]: Loss: 1.0563
  Epoch 11 [Batch 12/40]: Loss: 0.5865
  Epoch 11 [Batch 16/40]: Loss: 1.2178
  Epoch 11 [Batch 20/40]: Loss: 1.0552
  Epoch 11 [Batch 24/40]: Loss: 0.8353
  Epoch 11 [Batch 28/40]: Loss: 1.0105
  Epoch 11 [Batch 32/40]: Loss: 1.0203
  Epoch 11 [Batch 36/40]: Loss: 0.9767
  Epoch 11 Train Summary: Avg Loss: 0.9088, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8698, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.9321
  Epoch 12 [Batch 4/40]: Loss: 0.6383
  Epoch 12 [Batch 8/40]: Loss: 0.9017
  Epoch 12 [Batch 12/40]: Loss: 0.6893
  Epoch 12 [Batch 16/40]: Loss: 1.1063
  Epoch 12 [Batch 20/40]: Loss: 0.6737
  Epoch 12 [Batch 24/40]: Loss: 0.9425
  Epoch 12 [Batch 28/40]: Loss: 1.4778
  Epoch 12 [Batch 32/40]: Loss: 0.7306
  Epoch 12 [Batch 36/40]: Loss: 0.9019
  Epoch 12 Train Summary: Avg Loss: 0.9152, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8543, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8555 to 0.8543. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.5397
  Epoch 13 [Batch 4/40]: Loss: 0.7656
  Epoch 13 [Batch 8/40]: Loss: 0.7461
  Epoch 13 [Batch 12/40]: Loss: 0.7546
  Epoch 13 [Batch 16/40]: Loss: 1.2333
  Epoch 13 [Batch 20/40]: Loss: 1.0991
  Epoch 13 [Batch 24/40]: Loss: 1.1167
  Epoch 13 [Batch 28/40]: Loss: 1.1848
  Epoch 13 [Batch 32/40]: Loss: 0.6133
  Epoch 13 [Batch 36/40]: Loss: 0.8325
  Epoch 13 Train Summary: Avg Loss: 0.9044, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8730, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 1.1847
  Epoch 14 [Batch 4/40]: Loss: 0.5687
  Epoch 14 [Batch 8/40]: Loss: 1.4210
  Epoch 14 [Batch 12/40]: Loss: 1.2854
  Epoch 14 [Batch 16/40]: Loss: 0.6839
  Epoch 14 [Batch 20/40]: Loss: 0.7177
  Epoch 14 [Batch 24/40]: Loss: 0.6719
  Epoch 14 [Batch 28/40]: Loss: 0.8761
  Epoch 14 [Batch 32/40]: Loss: 0.8524
  Epoch 14 [Batch 36/40]: Loss: 0.8447
  Epoch 14 Train Summary: Avg Loss: 0.9050, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9119, Accuracy: 0.3333, F1 (Macro): 0.2462
Training finished in 7.26 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.8543, Accuracy: 0.3333, F1 (Macro): 0.2462
Final Best Model Stats: Acc: 0.3333, F1: 0.2462, Loss: 0.8543
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=5e-05 drop=0.0 seed=123
================================================================================
Starting experiment: resnet50__384x384__lr-5e-05__drop-0.0__seed-123
Output directory: results_opg/resnet50__384x384__lr-5e-05__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 1.0939
  Epoch 0 [Batch 4/40]: Loss: 1.0916
  Epoch 0 [Batch 8/40]: Loss: 1.0718
  Epoch 0 [Batch 12/40]: Loss: 1.0791
  Epoch 0 [Batch 16/40]: Loss: 1.0949
  Epoch 0 [Batch 20/40]: Loss: 1.0860
  Epoch 0 [Batch 24/40]: Loss: 1.0168
  Epoch 0 [Batch 28/40]: Loss: 1.0677
  Epoch 0 [Batch 32/40]: Loss: 1.0464
  Epoch 0 [Batch 36/40]: Loss: 0.9915
  Epoch 0 Train Summary: Avg Loss: 1.0643, Accuracy: 0.3490
  Validation Summary: Avg Loss: 1.0373, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from inf to 1.0373. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 1.0896
  Epoch 1 [Batch 4/40]: Loss: 1.0575
  Epoch 1 [Batch 8/40]: Loss: 1.0810
  Epoch 1 [Batch 12/40]: Loss: 1.0259
  Epoch 1 [Batch 16/40]: Loss: 1.1360
  Epoch 1 [Batch 20/40]: Loss: 1.0385
  Epoch 1 [Batch 24/40]: Loss: 1.0212
  Epoch 1 [Batch 28/40]: Loss: 0.9123
  Epoch 1 [Batch 32/40]: Loss: 1.0061
  Epoch 1 [Batch 36/40]: Loss: 0.8994
  Epoch 1 Train Summary: Avg Loss: 1.0005, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9671, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0373 to 0.9671. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.0952
  Epoch 2 [Batch 4/40]: Loss: 0.9340
  Epoch 2 [Batch 8/40]: Loss: 0.9362
  Epoch 2 [Batch 12/40]: Loss: 1.0301
  Epoch 2 [Batch 16/40]: Loss: 1.1399
  Epoch 2 [Batch 20/40]: Loss: 0.9778
  Epoch 2 [Batch 24/40]: Loss: 0.9018
  Epoch 2 [Batch 28/40]: Loss: 0.9396
  Epoch 2 [Batch 32/40]: Loss: 0.8221
  Epoch 2 [Batch 36/40]: Loss: 0.8622
  Epoch 2 Train Summary: Avg Loss: 0.9691, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9327, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9671 to 0.9327. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 0.9014
  Epoch 3 [Batch 4/40]: Loss: 0.8881
  Epoch 3 [Batch 8/40]: Loss: 0.9238
  Epoch 3 [Batch 12/40]: Loss: 0.8758
  Epoch 3 [Batch 16/40]: Loss: 1.0384
  Epoch 3 [Batch 20/40]: Loss: 0.8482
  Epoch 3 [Batch 24/40]: Loss: 0.9466
  Epoch 3 [Batch 28/40]: Loss: 1.0188
  Epoch 3 [Batch 32/40]: Loss: 0.9535
  Epoch 3 [Batch 36/40]: Loss: 0.9066
  Epoch 3 Train Summary: Avg Loss: 0.9490, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9015, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9327 to 0.9015. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 0.6904
  Epoch 4 [Batch 4/40]: Loss: 0.7290
  Epoch 4 [Batch 8/40]: Loss: 0.9289
  Epoch 4 [Batch 12/40]: Loss: 1.1446
  Epoch 4 [Batch 16/40]: Loss: 1.0076
  Epoch 4 [Batch 20/40]: Loss: 1.0975
  Epoch 4 [Batch 24/40]: Loss: 0.9827
  Epoch 4 [Batch 28/40]: Loss: 1.0466
  Epoch 4 [Batch 32/40]: Loss: 0.9384
  Epoch 4 [Batch 36/40]: Loss: 0.7959
  Epoch 4 Train Summary: Avg Loss: 0.9604, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8580, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9015 to 0.8580. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 1.0343
  Epoch 5 [Batch 4/40]: Loss: 0.9435
  Epoch 5 [Batch 8/40]: Loss: 0.8553
  Epoch 5 [Batch 12/40]: Loss: 1.2644
  Epoch 5 [Batch 16/40]: Loss: 0.7759
  Epoch 5 [Batch 20/40]: Loss: 0.6478
  Epoch 5 [Batch 24/40]: Loss: 0.9385
  Epoch 5 [Batch 28/40]: Loss: 0.7990
  Epoch 5 [Batch 32/40]: Loss: 0.9039
  Epoch 5 [Batch 36/40]: Loss: 0.9031
  Epoch 5 Train Summary: Avg Loss: 0.9484, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8488, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8580 to 0.8488. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 0.8587
  Epoch 6 [Batch 4/40]: Loss: 1.1537
  Epoch 6 [Batch 8/40]: Loss: 0.7238
  Epoch 6 [Batch 12/40]: Loss: 0.9952
  Epoch 6 [Batch 16/40]: Loss: 0.8921
  Epoch 6 [Batch 20/40]: Loss: 1.0622
  Epoch 6 [Batch 24/40]: Loss: 1.1930
  Epoch 6 [Batch 28/40]: Loss: 1.1797
  Epoch 6 [Batch 32/40]: Loss: 0.8522
  Epoch 6 [Batch 36/40]: Loss: 0.8766
  Epoch 6 Train Summary: Avg Loss: 0.9319, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8431, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8488 to 0.8431. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 1.1548
  Epoch 7 [Batch 4/40]: Loss: 0.9740
  Epoch 7 [Batch 8/40]: Loss: 1.0081
  Epoch 7 [Batch 12/40]: Loss: 1.2190
  Epoch 7 [Batch 16/40]: Loss: 0.8035
  Epoch 7 [Batch 20/40]: Loss: 1.0368
  Epoch 7 [Batch 24/40]: Loss: 0.8585
  Epoch 7 [Batch 28/40]: Loss: 0.6953
  Epoch 7 [Batch 32/40]: Loss: 0.8449
  Epoch 7 [Batch 36/40]: Loss: 0.6724
  Epoch 7 Train Summary: Avg Loss: 0.9528, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8453, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.7200
  Epoch 8 [Batch 4/40]: Loss: 1.0762
  Epoch 8 [Batch 8/40]: Loss: 0.6431
  Epoch 8 [Batch 12/40]: Loss: 0.8472
  Epoch 8 [Batch 16/40]: Loss: 0.6108
  Epoch 8 [Batch 20/40]: Loss: 0.9535
  Epoch 8 [Batch 24/40]: Loss: 0.7062
  Epoch 8 [Batch 28/40]: Loss: 0.9823
  Epoch 8 [Batch 32/40]: Loss: 1.0686
  Epoch 8 [Batch 36/40]: Loss: 0.5963
  Epoch 8 Train Summary: Avg Loss: 0.9302, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8207, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8431 to 0.8207. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.8359
  Epoch 9 [Batch 4/40]: Loss: 1.0553
  Epoch 9 [Batch 8/40]: Loss: 0.8332
  Epoch 9 [Batch 12/40]: Loss: 1.1326
  Epoch 9 [Batch 16/40]: Loss: 0.8611
  Epoch 9 [Batch 20/40]: Loss: 0.9738
  Epoch 9 [Batch 24/40]: Loss: 1.1229
  Epoch 9 [Batch 28/40]: Loss: 0.7072
  Epoch 9 [Batch 32/40]: Loss: 0.9912
  Epoch 9 [Batch 36/40]: Loss: 0.7776
  Epoch 9 Train Summary: Avg Loss: 0.9163, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8244, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 1.0767
  Epoch 10 [Batch 4/40]: Loss: 0.9777
  Epoch 10 [Batch 8/40]: Loss: 1.0836
  Epoch 10 [Batch 12/40]: Loss: 0.8578
  Epoch 10 [Batch 16/40]: Loss: 0.8071
  Epoch 10 [Batch 20/40]: Loss: 0.9663
  Epoch 10 [Batch 24/40]: Loss: 0.7374
  Epoch 10 [Batch 28/40]: Loss: 1.0406
  Epoch 10 [Batch 32/40]: Loss: 1.5381
  Epoch 10 [Batch 36/40]: Loss: 0.8996
  Epoch 10 Train Summary: Avg Loss: 0.9154, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8119, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8207 to 0.8119. Saving...

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.7221
  Epoch 11 [Batch 4/40]: Loss: 0.7533
  Epoch 11 [Batch 8/40]: Loss: 0.9735
  Epoch 11 [Batch 12/40]: Loss: 0.8252
  Epoch 11 [Batch 16/40]: Loss: 0.9974
  Epoch 11 [Batch 20/40]: Loss: 0.9418
  Epoch 11 [Batch 24/40]: Loss: 0.8144
  Epoch 11 [Batch 28/40]: Loss: 0.8454
  Epoch 11 [Batch 32/40]: Loss: 0.6788
  Epoch 11 [Batch 36/40]: Loss: 0.8663
  Epoch 11 Train Summary: Avg Loss: 0.9035, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.7948, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8119 to 0.7948. Saving...

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.8921
  Epoch 12 [Batch 4/40]: Loss: 0.9142
  Epoch 12 [Batch 8/40]: Loss: 0.7259
  Epoch 12 [Batch 12/40]: Loss: 1.2081
  Epoch 12 [Batch 16/40]: Loss: 0.6281
  Epoch 12 [Batch 20/40]: Loss: 0.7793
  Epoch 12 [Batch 24/40]: Loss: 0.9496
  Epoch 12 [Batch 28/40]: Loss: 0.8966
  Epoch 12 [Batch 32/40]: Loss: 0.8628
  Epoch 12 [Batch 36/40]: Loss: 0.7877
  Epoch 12 Train Summary: Avg Loss: 0.9125, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.7980, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 1.1695
  Epoch 13 [Batch 4/40]: Loss: 1.1381
  Epoch 13 [Batch 8/40]: Loss: 0.9528
  Epoch 13 [Batch 12/40]: Loss: 0.6751
  Epoch 13 [Batch 16/40]: Loss: 1.2147
  Epoch 13 [Batch 20/40]: Loss: 0.8785
  Epoch 13 [Batch 24/40]: Loss: 0.8368
  Epoch 13 [Batch 28/40]: Loss: 0.9196
  Epoch 13 [Batch 32/40]: Loss: 1.0233
  Epoch 13 [Batch 36/40]: Loss: 0.5931
  Epoch 13 Train Summary: Avg Loss: 0.8928, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8058, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 1.0575
  Epoch 14 [Batch 4/40]: Loss: 1.1854
  Epoch 14 [Batch 8/40]: Loss: 0.9073
  Epoch 14 [Batch 12/40]: Loss: 1.2320
  Epoch 14 [Batch 16/40]: Loss: 0.9978
  Epoch 14 [Batch 20/40]: Loss: 0.9642
  Epoch 14 [Batch 24/40]: Loss: 0.9180
  Epoch 14 [Batch 28/40]: Loss: 0.7244
  Epoch 14 [Batch 32/40]: Loss: 0.8023
  Epoch 14 [Batch 36/40]: Loss: 0.5876
  Epoch 14 Train Summary: Avg Loss: 0.8890, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.7944, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.7948 to 0.7944. Saving...
Training finished in 6.66 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.7944, Accuracy: 0.3333, F1 (Macro): 0.2462
Final Best Model Stats: Acc: 0.3333, F1: 0.2462, Loss: 0.7944
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=5e-05 drop=0.0 seed=999
================================================================================
Starting experiment: resnet50__384x384__lr-5e-05__drop-0.0__seed-999
Output directory: results_opg/resnet50__384x384__lr-5e-05__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 1.2051
  Epoch 0 [Batch 4/40]: Loss: 1.1406
  Epoch 0 [Batch 8/40]: Loss: 1.1127
  Epoch 0 [Batch 12/40]: Loss: 1.0989
  Epoch 0 [Batch 16/40]: Loss: 1.0916
  Epoch 0 [Batch 20/40]: Loss: 1.0845
  Epoch 0 [Batch 24/40]: Loss: 1.0557
  Epoch 0 [Batch 28/40]: Loss: 1.0732
  Epoch 0 [Batch 32/40]: Loss: 1.0783
  Epoch 0 [Batch 36/40]: Loss: 1.0492
  Epoch 0 Train Summary: Avg Loss: 1.0878, Accuracy: 0.3149
  Validation Summary: Avg Loss: 1.0523, Accuracy: 0.3611, F1 (Macro): 0.3013
  New best model! Val loss improved from inf to 1.0523. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 1.0392
  Epoch 1 [Batch 4/40]: Loss: 1.0123
  Epoch 1 [Batch 8/40]: Loss: 0.9941
  Epoch 1 [Batch 12/40]: Loss: 1.0612
  Epoch 1 [Batch 16/40]: Loss: 1.0665
  Epoch 1 [Batch 20/40]: Loss: 0.9906
  Epoch 1 [Batch 24/40]: Loss: 0.9456
  Epoch 1 [Batch 28/40]: Loss: 1.1149
  Epoch 1 [Batch 32/40]: Loss: 0.9390
  Epoch 1 [Batch 36/40]: Loss: 1.0137
  Epoch 1 Train Summary: Avg Loss: 1.0208, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9893, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0523 to 0.9893. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.1606
  Epoch 2 [Batch 4/40]: Loss: 0.9930
  Epoch 2 [Batch 8/40]: Loss: 0.9880
  Epoch 2 [Batch 12/40]: Loss: 0.9466
  Epoch 2 [Batch 16/40]: Loss: 0.9701
  Epoch 2 [Batch 20/40]: Loss: 0.9987
  Epoch 2 [Batch 24/40]: Loss: 0.9952
  Epoch 2 [Batch 28/40]: Loss: 1.0780
  Epoch 2 [Batch 32/40]: Loss: 1.0663
  Epoch 2 [Batch 36/40]: Loss: 1.1622
  Epoch 2 Train Summary: Avg Loss: 0.9790, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9223, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9893 to 0.9223. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 0.8501
  Epoch 3 [Batch 4/40]: Loss: 0.8584
  Epoch 3 [Batch 8/40]: Loss: 0.9320
  Epoch 3 [Batch 12/40]: Loss: 1.0035
  Epoch 3 [Batch 16/40]: Loss: 1.1574
  Epoch 3 [Batch 20/40]: Loss: 0.9983
  Epoch 3 [Batch 24/40]: Loss: 1.0197
  Epoch 3 [Batch 28/40]: Loss: 1.0143
  Epoch 3 [Batch 32/40]: Loss: 0.8778
  Epoch 3 [Batch 36/40]: Loss: 0.8510
  Epoch 3 Train Summary: Avg Loss: 0.9698, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8943, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9223 to 0.8943. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 1.0419
  Epoch 4 [Batch 4/40]: Loss: 0.6294
  Epoch 4 [Batch 8/40]: Loss: 1.0318
  Epoch 4 [Batch 12/40]: Loss: 1.2188
  Epoch 4 [Batch 16/40]: Loss: 0.8460
  Epoch 4 [Batch 20/40]: Loss: 0.9985
  Epoch 4 [Batch 24/40]: Loss: 1.1364
  Epoch 4 [Batch 28/40]: Loss: 0.9346
  Epoch 4 [Batch 32/40]: Loss: 0.8946
  Epoch 4 [Batch 36/40]: Loss: 1.0148
  Epoch 4 Train Summary: Avg Loss: 0.9476, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8854, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8943 to 0.8854. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 0.6807
  Epoch 5 [Batch 4/40]: Loss: 1.0839
  Epoch 5 [Batch 8/40]: Loss: 1.0795
  Epoch 5 [Batch 12/40]: Loss: 0.8419
  Epoch 5 [Batch 16/40]: Loss: 0.6994
  Epoch 5 [Batch 20/40]: Loss: 0.7604
  Epoch 5 [Batch 24/40]: Loss: 0.9043
  Epoch 5 [Batch 28/40]: Loss: 0.7459
  Epoch 5 [Batch 32/40]: Loss: 1.1104
  Epoch 5 [Batch 36/40]: Loss: 0.7763
  Epoch 5 Train Summary: Avg Loss: 0.9588, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8562, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8854 to 0.8562. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 1.1887
  Epoch 6 [Batch 4/40]: Loss: 0.9459
  Epoch 6 [Batch 8/40]: Loss: 0.7333
  Epoch 6 [Batch 12/40]: Loss: 0.9328
  Epoch 6 [Batch 16/40]: Loss: 0.7224
  Epoch 6 [Batch 20/40]: Loss: 1.2034
  Epoch 6 [Batch 24/40]: Loss: 1.1038
  Epoch 6 [Batch 28/40]: Loss: 0.7102
  Epoch 6 [Batch 32/40]: Loss: 1.0120
  Epoch 6 [Batch 36/40]: Loss: 1.3385
  Epoch 6 Train Summary: Avg Loss: 0.9445, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8637, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 1.0509
  Epoch 7 [Batch 4/40]: Loss: 0.9139
  Epoch 7 [Batch 8/40]: Loss: 0.9966
  Epoch 7 [Batch 12/40]: Loss: 1.1816
  Epoch 7 [Batch 16/40]: Loss: 0.8189
  Epoch 7 [Batch 20/40]: Loss: 0.9054
  Epoch 7 [Batch 24/40]: Loss: 1.0562
  Epoch 7 [Batch 28/40]: Loss: 0.8103
  Epoch 7 [Batch 32/40]: Loss: 0.8066
  Epoch 7 [Batch 36/40]: Loss: 0.8112
  Epoch 7 Train Summary: Avg Loss: 0.9448, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8450, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8562 to 0.8450. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.9626
  Epoch 8 [Batch 4/40]: Loss: 0.9426
  Epoch 8 [Batch 8/40]: Loss: 0.8008
  Epoch 8 [Batch 12/40]: Loss: 1.0599
  Epoch 8 [Batch 16/40]: Loss: 1.0845
  Epoch 8 [Batch 20/40]: Loss: 1.2010
  Epoch 8 [Batch 24/40]: Loss: 0.9757
  Epoch 8 [Batch 28/40]: Loss: 0.6868
  Epoch 8 [Batch 32/40]: Loss: 1.0632
  Epoch 8 [Batch 36/40]: Loss: 0.6261
  Epoch 8 Train Summary: Avg Loss: 0.9336, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8532, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.7595
  Epoch 9 [Batch 4/40]: Loss: 1.1501
  Epoch 9 [Batch 8/40]: Loss: 0.8915
  Epoch 9 [Batch 12/40]: Loss: 0.8600
  Epoch 9 [Batch 16/40]: Loss: 0.7896
  Epoch 9 [Batch 20/40]: Loss: 0.8798
  Epoch 9 [Batch 24/40]: Loss: 0.6333
  Epoch 9 [Batch 28/40]: Loss: 0.7398
  Epoch 9 [Batch 32/40]: Loss: 0.7688
  Epoch 9 [Batch 36/40]: Loss: 1.0517
  Epoch 9 Train Summary: Avg Loss: 0.9336, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8464, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 1.0414
  Epoch 10 [Batch 4/40]: Loss: 0.8389
  Epoch 10 [Batch 8/40]: Loss: 1.1480
  Epoch 10 [Batch 12/40]: Loss: 1.0556
  Epoch 10 [Batch 16/40]: Loss: 0.7937
  Epoch 10 [Batch 20/40]: Loss: 1.1501
  Epoch 10 [Batch 24/40]: Loss: 1.1405
  Epoch 10 [Batch 28/40]: Loss: 0.6873
  Epoch 10 [Batch 32/40]: Loss: 0.8374
  Epoch 10 [Batch 36/40]: Loss: 1.0124
  Epoch 10 Train Summary: Avg Loss: 0.9512, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8692, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.9088
  Epoch 11 [Batch 4/40]: Loss: 0.9975
  Epoch 11 [Batch 8/40]: Loss: 0.6313
  Epoch 11 [Batch 12/40]: Loss: 0.7869
  Epoch 11 [Batch 16/40]: Loss: 1.2229
  Epoch 11 [Batch 20/40]: Loss: 1.2045
  Epoch 11 [Batch 24/40]: Loss: 0.8547
  Epoch 11 [Batch 28/40]: Loss: 0.8237
  Epoch 11 [Batch 32/40]: Loss: 1.0861
  Epoch 11 [Batch 36/40]: Loss: 0.9261
  Epoch 11 Train Summary: Avg Loss: 0.9171, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8646, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.9918
  Epoch 12 [Batch 4/40]: Loss: 0.7950
  Epoch 12 [Batch 8/40]: Loss: 1.2406
  Epoch 12 [Batch 12/40]: Loss: 0.8535
  Epoch 12 [Batch 16/40]: Loss: 0.7009
  Epoch 12 [Batch 20/40]: Loss: 0.8278
  Epoch 12 [Batch 24/40]: Loss: 1.0725
  Epoch 12 [Batch 28/40]: Loss: 1.6037
  Epoch 12 [Batch 32/40]: Loss: 0.9657
  Epoch 12 [Batch 36/40]: Loss: 1.1014
  Epoch 12 Train Summary: Avg Loss: 0.9250, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8280, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.8450 to 0.8280. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.5741
  Epoch 13 [Batch 4/40]: Loss: 0.8890
  Epoch 13 [Batch 8/40]: Loss: 1.2310
  Epoch 13 [Batch 12/40]: Loss: 0.9375
  Epoch 13 [Batch 16/40]: Loss: 1.0484
  Epoch 13 [Batch 20/40]: Loss: 1.1771
  Epoch 13 [Batch 24/40]: Loss: 0.6831
  Epoch 13 [Batch 28/40]: Loss: 0.7992
  Epoch 13 [Batch 32/40]: Loss: 0.9836
  Epoch 13 [Batch 36/40]: Loss: 0.8588
  Epoch 13 Train Summary: Avg Loss: 0.9073, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8543, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 0.8122
  Epoch 14 [Batch 4/40]: Loss: 0.8844
  Epoch 14 [Batch 8/40]: Loss: 1.0617
  Epoch 14 [Batch 12/40]: Loss: 1.1910
  Epoch 14 [Batch 16/40]: Loss: 1.0978
  Epoch 14 [Batch 20/40]: Loss: 0.8336
  Epoch 14 [Batch 24/40]: Loss: 0.9152
  Epoch 14 [Batch 28/40]: Loss: 0.7875
  Epoch 14 [Batch 32/40]: Loss: 0.9960
  Epoch 14 [Batch 36/40]: Loss: 0.7368
  Epoch 14 Train Summary: Avg Loss: 0.9042, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8476, Accuracy: 0.3333, F1 (Macro): 0.2462
Training finished in 7.37 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.8280, Accuracy: 0.3333, F1 (Macro): 0.2462
Final Best Model Stats: Acc: 0.3333, F1: 0.2462, Loss: 0.8280
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=1e-05 drop=0.0 seed=42
================================================================================
Starting experiment: resnet50__384x384__lr-1e-05__drop-0.0__seed-42
Output directory: results_opg/resnet50__384x384__lr-1e-05__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 1.1125
  Epoch 0 [Batch 4/40]: Loss: 1.1372
  Epoch 0 [Batch 8/40]: Loss: 1.1268
  Epoch 0 [Batch 12/40]: Loss: 1.1425
  Epoch 0 [Batch 16/40]: Loss: 1.1236
  Epoch 0 [Batch 20/40]: Loss: 1.1013
  Epoch 0 [Batch 24/40]: Loss: 1.1232
  Epoch 0 [Batch 28/40]: Loss: 1.0971
  Epoch 0 [Batch 32/40]: Loss: 1.1236
  Epoch 0 [Batch 36/40]: Loss: 1.0948
  Epoch 0 Train Summary: Avg Loss: 1.1129, Accuracy: 0.3552
  Validation Summary: Avg Loss: 1.0939, Accuracy: 0.2500, F1 (Macro): 0.2572
  New best model! Val loss improved from inf to 1.0939. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 1.0914
  Epoch 1 [Batch 4/40]: Loss: 1.1061
  Epoch 1 [Batch 8/40]: Loss: 1.0999
  Epoch 1 [Batch 12/40]: Loss: 1.0945
  Epoch 1 [Batch 16/40]: Loss: 1.0908
  Epoch 1 [Batch 20/40]: Loss: 1.0953
  Epoch 1 [Batch 24/40]: Loss: 1.0850
  Epoch 1 [Batch 28/40]: Loss: 1.0879
  Epoch 1 [Batch 32/40]: Loss: 1.1010
  Epoch 1 [Batch 36/40]: Loss: 1.1163
  Epoch 1 Train Summary: Avg Loss: 1.0953, Accuracy: 0.3945
  Validation Summary: Avg Loss: 1.0813, Accuracy: 0.2778, F1 (Macro): 0.2591
  New best model! Val loss improved from 1.0939 to 1.0813. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.0974
  Epoch 2 [Batch 4/40]: Loss: 1.1025
  Epoch 2 [Batch 8/40]: Loss: 1.1162
  Epoch 2 [Batch 12/40]: Loss: 1.0517
  Epoch 2 [Batch 16/40]: Loss: 1.0710
  Epoch 2 [Batch 20/40]: Loss: 1.0672
  Epoch 2 [Batch 24/40]: Loss: 1.0815
  Epoch 2 [Batch 28/40]: Loss: 1.0928
  Epoch 2 [Batch 32/40]: Loss: 1.0843
  Epoch 2 [Batch 36/40]: Loss: 1.0958
  Epoch 2 Train Summary: Avg Loss: 1.0803, Accuracy: 0.3372
  Validation Summary: Avg Loss: 1.0651, Accuracy: 0.3056, F1 (Macro): 0.2614
  New best model! Val loss improved from 1.0813 to 1.0651. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 1.0541
  Epoch 3 [Batch 4/40]: Loss: 1.0508
  Epoch 3 [Batch 8/40]: Loss: 1.0832
  Epoch 3 [Batch 12/40]: Loss: 1.0488
  Epoch 3 [Batch 16/40]: Loss: 1.0498
  Epoch 3 [Batch 20/40]: Loss: 1.0747
  Epoch 3 [Batch 24/40]: Loss: 1.0860
  Epoch 3 [Batch 28/40]: Loss: 1.0766
  Epoch 3 [Batch 32/40]: Loss: 1.0009
  Epoch 3 [Batch 36/40]: Loss: 1.1164
  Epoch 3 Train Summary: Avg Loss: 1.0615, Accuracy: 0.3350
  Validation Summary: Avg Loss: 1.0500, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0651 to 1.0500. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 1.1225
  Epoch 4 [Batch 4/40]: Loss: 1.0897
  Epoch 4 [Batch 8/40]: Loss: 1.0662
  Epoch 4 [Batch 12/40]: Loss: 1.1093
  Epoch 4 [Batch 16/40]: Loss: 1.0334
  Epoch 4 [Batch 20/40]: Loss: 1.0449
  Epoch 4 [Batch 24/40]: Loss: 1.0466
  Epoch 4 [Batch 28/40]: Loss: 1.0012
  Epoch 4 [Batch 32/40]: Loss: 1.0823
  Epoch 4 [Batch 36/40]: Loss: 1.0600
  Epoch 4 Train Summary: Avg Loss: 1.0511, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0376, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0500 to 1.0376. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 1.0943
  Epoch 5 [Batch 4/40]: Loss: 1.0632
  Epoch 5 [Batch 8/40]: Loss: 1.0285
  Epoch 5 [Batch 12/40]: Loss: 1.0335
  Epoch 5 [Batch 16/40]: Loss: 0.9583
  Epoch 5 [Batch 20/40]: Loss: 1.0469
  Epoch 5 [Batch 24/40]: Loss: 0.9756
  Epoch 5 [Batch 28/40]: Loss: 1.0566
  Epoch 5 [Batch 32/40]: Loss: 0.9983
  Epoch 5 [Batch 36/40]: Loss: 0.9378
  Epoch 5 Train Summary: Avg Loss: 1.0327, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0155, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0376 to 1.0155. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 1.0927
  Epoch 6 [Batch 4/40]: Loss: 1.1000
  Epoch 6 [Batch 8/40]: Loss: 0.9631
  Epoch 6 [Batch 12/40]: Loss: 1.1093
  Epoch 6 [Batch 16/40]: Loss: 1.0585
  Epoch 6 [Batch 20/40]: Loss: 0.9319
  Epoch 6 [Batch 24/40]: Loss: 1.0110
  Epoch 6 [Batch 28/40]: Loss: 1.0722
  Epoch 6 [Batch 32/40]: Loss: 1.0205
  Epoch 6 [Batch 36/40]: Loss: 0.9368
  Epoch 6 Train Summary: Avg Loss: 1.0209, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0057, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0155 to 1.0057. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 1.1981
  Epoch 7 [Batch 4/40]: Loss: 0.9388
  Epoch 7 [Batch 8/40]: Loss: 1.0837
  Epoch 7 [Batch 12/40]: Loss: 1.0056
  Epoch 7 [Batch 16/40]: Loss: 1.0688
  Epoch 7 [Batch 20/40]: Loss: 0.9841
  Epoch 7 [Batch 24/40]: Loss: 1.0167
  Epoch 7 [Batch 28/40]: Loss: 0.9601
  Epoch 7 [Batch 32/40]: Loss: 1.0029
  Epoch 7 [Batch 36/40]: Loss: 0.9789
  Epoch 7 Train Summary: Avg Loss: 1.0125, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9746, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0057 to 0.9746. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.9728
  Epoch 8 [Batch 4/40]: Loss: 1.1120
  Epoch 8 [Batch 8/40]: Loss: 1.0052
  Epoch 8 [Batch 12/40]: Loss: 1.0529
  Epoch 8 [Batch 16/40]: Loss: 0.9892
  Epoch 8 [Batch 20/40]: Loss: 0.9765
  Epoch 8 [Batch 24/40]: Loss: 1.0425
  Epoch 8 [Batch 28/40]: Loss: 0.9579
  Epoch 8 [Batch 32/40]: Loss: 0.9490
  Epoch 8 [Batch 36/40]: Loss: 1.1205
  Epoch 8 Train Summary: Avg Loss: 1.0020, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9818, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 1.0179
  Epoch 9 [Batch 4/40]: Loss: 1.0556
  Epoch 9 [Batch 8/40]: Loss: 0.9305
  Epoch 9 [Batch 12/40]: Loss: 1.0411
  Epoch 9 [Batch 16/40]: Loss: 1.0621
  Epoch 9 [Batch 20/40]: Loss: 1.0341
  Epoch 9 [Batch 24/40]: Loss: 0.9236
  Epoch 9 [Batch 28/40]: Loss: 0.9771
  Epoch 9 [Batch 32/40]: Loss: 0.8551
  Epoch 9 [Batch 36/40]: Loss: 0.9422
  Epoch 9 Train Summary: Avg Loss: 0.9892, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9769, Accuracy: 0.3333, F1 (Macro): 0.2462

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 1.0566
  Epoch 10 [Batch 4/40]: Loss: 0.9186
  Epoch 10 [Batch 8/40]: Loss: 0.9498
  Epoch 10 [Batch 12/40]: Loss: 1.0155
  Epoch 10 [Batch 16/40]: Loss: 0.9839
  Epoch 10 [Batch 20/40]: Loss: 0.9217
  Epoch 10 [Batch 24/40]: Loss: 0.8602
  Epoch 10 [Batch 28/40]: Loss: 0.9412
  Epoch 10 [Batch 32/40]: Loss: 1.0319
  Epoch 10 [Batch 36/40]: Loss: 0.9782
  Epoch 10 Train Summary: Avg Loss: 0.9807, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9710, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9746 to 0.9710. Saving...

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.9725
  Epoch 11 [Batch 4/40]: Loss: 0.9920
  Epoch 11 [Batch 8/40]: Loss: 1.0810
  Epoch 11 [Batch 12/40]: Loss: 0.7990
  Epoch 11 [Batch 16/40]: Loss: 1.1020
  Epoch 11 [Batch 20/40]: Loss: 1.0698
  Epoch 11 [Batch 24/40]: Loss: 0.9020
  Epoch 11 [Batch 28/40]: Loss: 1.0228
  Epoch 11 [Batch 32/40]: Loss: 1.0764
  Epoch 11 [Batch 36/40]: Loss: 0.9826
  Epoch 11 Train Summary: Avg Loss: 0.9783, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9609, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9710 to 0.9609. Saving...

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 1.0156
  Epoch 12 [Batch 4/40]: Loss: 0.8529
  Epoch 12 [Batch 8/40]: Loss: 0.9602
  Epoch 12 [Batch 12/40]: Loss: 0.8150
  Epoch 12 [Batch 16/40]: Loss: 1.1367
  Epoch 12 [Batch 20/40]: Loss: 0.8494
  Epoch 12 [Batch 24/40]: Loss: 0.9638
  Epoch 12 [Batch 28/40]: Loss: 1.2790
  Epoch 12 [Batch 32/40]: Loss: 0.8833
  Epoch 12 [Batch 36/40]: Loss: 0.9257
  Epoch 12 Train Summary: Avg Loss: 0.9781, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9585, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9609 to 0.9585. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.7408
  Epoch 13 [Batch 4/40]: Loss: 0.8598
  Epoch 13 [Batch 8/40]: Loss: 0.8989
  Epoch 13 [Batch 12/40]: Loss: 0.9224
  Epoch 13 [Batch 16/40]: Loss: 1.1509
  Epoch 13 [Batch 20/40]: Loss: 1.0121
  Epoch 13 [Batch 24/40]: Loss: 1.0556
  Epoch 13 [Batch 28/40]: Loss: 1.1426
  Epoch 13 [Batch 32/40]: Loss: 0.7696
  Epoch 13 [Batch 36/40]: Loss: 0.9288
  Epoch 13 Train Summary: Avg Loss: 0.9708, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9465, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9585 to 0.9465. Saving...

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 1.1569
  Epoch 14 [Batch 4/40]: Loss: 0.7451
  Epoch 14 [Batch 8/40]: Loss: 1.2501
  Epoch 14 [Batch 12/40]: Loss: 1.1827
  Epoch 14 [Batch 16/40]: Loss: 0.7541
  Epoch 14 [Batch 20/40]: Loss: 0.8624
  Epoch 14 [Batch 24/40]: Loss: 0.8016
  Epoch 14 [Batch 28/40]: Loss: 0.9564
  Epoch 14 [Batch 32/40]: Loss: 0.9336
  Epoch 14 [Batch 36/40]: Loss: 0.9578
  Epoch 14 Train Summary: Avg Loss: 0.9694, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9356, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9465 to 0.9356. Saving...
Training finished in 19.56 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.9356, Accuracy: 0.3333, F1 (Macro): 0.2462
Final Best Model Stats: Acc: 0.3333, F1: 0.2462, Loss: 0.9356
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=1e-05 drop=0.0 seed=123
================================================================================
Starting experiment: resnet50__384x384__lr-1e-05__drop-0.0__seed-123
Output directory: results_opg/resnet50__384x384__lr-1e-05__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 1.0939
  Epoch 0 [Batch 4/40]: Loss: 1.0941
  Epoch 0 [Batch 8/40]: Loss: 1.0850
  Epoch 0 [Batch 12/40]: Loss: 1.0824
  Epoch 0 [Batch 16/40]: Loss: 1.1087
  Epoch 0 [Batch 20/40]: Loss: 1.1105
  Epoch 0 [Batch 24/40]: Loss: 1.0900
  Epoch 0 [Batch 28/40]: Loss: 1.0864
  Epoch 0 [Batch 32/40]: Loss: 1.0880
  Epoch 0 [Batch 36/40]: Loss: 1.0796
  Epoch 0 Train Summary: Avg Loss: 1.0926, Accuracy: 0.3273
  Validation Summary: Avg Loss: 1.0924, Accuracy: 0.3333, F1 (Macro): 0.1538
  New best model! Val loss improved from inf to 1.0924. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 1.0898
  Epoch 1 [Batch 4/40]: Loss: 1.0910
  Epoch 1 [Batch 8/40]: Loss: 1.0876
  Epoch 1 [Batch 12/40]: Loss: 1.0661
  Epoch 1 [Batch 16/40]: Loss: 1.1000
  Epoch 1 [Batch 20/40]: Loss: 1.0818
  Epoch 1 [Batch 24/40]: Loss: 1.0879
  Epoch 1 [Batch 28/40]: Loss: 1.0538
  Epoch 1 [Batch 32/40]: Loss: 1.0711
  Epoch 1 [Batch 36/40]: Loss: 1.0556
  Epoch 1 Train Summary: Avg Loss: 1.0761, Accuracy: 0.3422
  Validation Summary: Avg Loss: 1.0808, Accuracy: 0.3194, F1 (Macro): 0.2085
  New best model! Val loss improved from 1.0924 to 1.0808. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.1039
  Epoch 2 [Batch 4/40]: Loss: 1.0484
  Epoch 2 [Batch 8/40]: Loss: 1.0577
  Epoch 2 [Batch 12/40]: Loss: 1.0608
  Epoch 2 [Batch 16/40]: Loss: 1.0795
  Epoch 2 [Batch 20/40]: Loss: 1.0576
  Epoch 2 [Batch 24/40]: Loss: 1.0514
  Epoch 2 [Batch 28/40]: Loss: 1.0457
  Epoch 2 [Batch 32/40]: Loss: 1.0398
  Epoch 2 [Batch 36/40]: Loss: 1.0304
  Epoch 2 Train Summary: Avg Loss: 1.0615, Accuracy: 0.3469
  Validation Summary: Avg Loss: 1.0707, Accuracy: 0.2639, F1 (Macro): 0.2248
  New best model! Val loss improved from 1.0808 to 1.0707. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 1.0584
  Epoch 3 [Batch 4/40]: Loss: 1.0401
  Epoch 3 [Batch 8/40]: Loss: 1.0373
  Epoch 3 [Batch 12/40]: Loss: 1.0332
  Epoch 3 [Batch 16/40]: Loss: 1.0605
  Epoch 3 [Batch 20/40]: Loss: 1.0095
  Epoch 3 [Batch 24/40]: Loss: 1.0560
  Epoch 3 [Batch 28/40]: Loss: 1.0723
  Epoch 3 [Batch 32/40]: Loss: 1.0380
  Epoch 3 [Batch 36/40]: Loss: 1.0245
  Epoch 3 Train Summary: Avg Loss: 1.0464, Accuracy: 0.3296
  Validation Summary: Avg Loss: 1.0492, Accuracy: 0.3889, F1 (Macro): 0.3621
  New best model! Val loss improved from 1.0707 to 1.0492. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 0.9938
  Epoch 4 [Batch 4/40]: Loss: 0.9873
  Epoch 4 [Batch 8/40]: Loss: 1.0382
  Epoch 4 [Batch 12/40]: Loss: 1.0665
  Epoch 4 [Batch 16/40]: Loss: 1.0573
  Epoch 4 [Batch 20/40]: Loss: 1.0899
  Epoch 4 [Batch 24/40]: Loss: 1.0394
  Epoch 4 [Batch 28/40]: Loss: 1.0461
  Epoch 4 [Batch 32/40]: Loss: 1.0402
  Epoch 4 [Batch 36/40]: Loss: 1.0124
  Epoch 4 Train Summary: Avg Loss: 1.0404, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0379, Accuracy: 0.3611, F1 (Macro): 0.3013
  New best model! Val loss improved from 1.0492 to 1.0379. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 1.0643
  Epoch 5 [Batch 4/40]: Loss: 1.0311
  Epoch 5 [Batch 8/40]: Loss: 1.0188
  Epoch 5 [Batch 12/40]: Loss: 1.1416
  Epoch 5 [Batch 16/40]: Loss: 0.9795
  Epoch 5 [Batch 20/40]: Loss: 0.9426
  Epoch 5 [Batch 24/40]: Loss: 1.0250
  Epoch 5 [Batch 28/40]: Loss: 0.9877
  Epoch 5 [Batch 32/40]: Loss: 0.9982
  Epoch 5 [Batch 36/40]: Loss: 1.0110
  Epoch 5 Train Summary: Avg Loss: 1.0281, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0258, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0379 to 1.0258. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 0.9978
  Epoch 6 [Batch 4/40]: Loss: 1.0967
  Epoch 6 [Batch 8/40]: Loss: 0.9560
  Epoch 6 [Batch 12/40]: Loss: 1.0470
  Epoch 6 [Batch 16/40]: Loss: 1.0184
  Epoch 6 [Batch 20/40]: Loss: 1.0509
  Epoch 6 [Batch 24/40]: Loss: 1.1420
  Epoch 6 [Batch 28/40]: Loss: 1.0833
  Epoch 6 [Batch 32/40]: Loss: 0.9754
  Epoch 6 [Batch 36/40]: Loss: 0.9615
  Epoch 6 Train Summary: Avg Loss: 1.0130, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0102, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0258 to 1.0102. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 1.1272
  Epoch 7 [Batch 4/40]: Loss: 1.0432
  Epoch 7 [Batch 8/40]: Loss: 1.0141
  Epoch 7 [Batch 12/40]: Loss: 1.1229
  Epoch 7 [Batch 16/40]: Loss: 0.9592
  Epoch 7 [Batch 20/40]: Loss: 1.0582
  Epoch 7 [Batch 24/40]: Loss: 0.9615
  Epoch 7 [Batch 28/40]: Loss: 0.9006
  Epoch 7 [Batch 32/40]: Loss: 0.9663
  Epoch 7 [Batch 36/40]: Loss: 0.8962
  Epoch 7 Train Summary: Avg Loss: 1.0136, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9974, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0102 to 0.9974. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.9169
  Epoch 8 [Batch 4/40]: Loss: 1.0431
  Epoch 8 [Batch 8/40]: Loss: 0.8654
  Epoch 8 [Batch 12/40]: Loss: 0.9859
  Epoch 8 [Batch 16/40]: Loss: 0.8439
  Epoch 8 [Batch 20/40]: Loss: 1.0128
  Epoch 8 [Batch 24/40]: Loss: 0.9057
  Epoch 8 [Batch 28/40]: Loss: 1.0220
  Epoch 8 [Batch 32/40]: Loss: 1.0422
  Epoch 8 [Batch 36/40]: Loss: 0.8503
  Epoch 8 Train Summary: Avg Loss: 0.9970, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9919, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9974 to 0.9919. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.9611
  Epoch 9 [Batch 4/40]: Loss: 1.0579
  Epoch 9 [Batch 8/40]: Loss: 0.9346
  Epoch 9 [Batch 12/40]: Loss: 1.0971
  Epoch 9 [Batch 16/40]: Loss: 0.9552
  Epoch 9 [Batch 20/40]: Loss: 0.9603
  Epoch 9 [Batch 24/40]: Loss: 1.0818
  Epoch 9 [Batch 28/40]: Loss: 0.8553
  Epoch 9 [Batch 32/40]: Loss: 1.0466
  Epoch 9 [Batch 36/40]: Loss: 0.9343
  Epoch 9 Train Summary: Avg Loss: 0.9823, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9805, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9919 to 0.9805. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 1.0653
  Epoch 10 [Batch 4/40]: Loss: 1.0207
  Epoch 10 [Batch 8/40]: Loss: 1.1058
  Epoch 10 [Batch 12/40]: Loss: 0.9495
  Epoch 10 [Batch 16/40]: Loss: 0.8947
  Epoch 10 [Batch 20/40]: Loss: 1.0054
  Epoch 10 [Batch 24/40]: Loss: 0.8578
  Epoch 10 [Batch 28/40]: Loss: 1.0180
  Epoch 10 [Batch 32/40]: Loss: 1.2857
  Epoch 10 [Batch 36/40]: Loss: 0.9766
  Epoch 10 Train Summary: Avg Loss: 0.9793, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9802, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9805 to 0.9802. Saving...

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.8692
  Epoch 11 [Batch 4/40]: Loss: 0.9024
  Epoch 11 [Batch 8/40]: Loss: 0.9890
  Epoch 11 [Batch 12/40]: Loss: 0.9495
  Epoch 11 [Batch 16/40]: Loss: 1.0579
  Epoch 11 [Batch 20/40]: Loss: 0.9463
  Epoch 11 [Batch 24/40]: Loss: 0.9232
  Epoch 11 [Batch 28/40]: Loss: 0.9602
  Epoch 11 [Batch 32/40]: Loss: 0.8265
  Epoch 11 [Batch 36/40]: Loss: 0.9687
  Epoch 11 Train Summary: Avg Loss: 0.9755, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9634, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9802 to 0.9634. Saving...

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 1.0109
  Epoch 12 [Batch 4/40]: Loss: 0.9543
  Epoch 12 [Batch 8/40]: Loss: 0.8794
  Epoch 12 [Batch 12/40]: Loss: 1.1077
  Epoch 12 [Batch 16/40]: Loss: 0.7985
  Epoch 12 [Batch 20/40]: Loss: 0.8550
  Epoch 12 [Batch 24/40]: Loss: 0.9687
  Epoch 12 [Batch 28/40]: Loss: 0.9646
  Epoch 12 [Batch 32/40]: Loss: 0.9698
  Epoch 12 [Batch 36/40]: Loss: 0.8754
  Epoch 12 Train Summary: Avg Loss: 0.9727, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9549, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9634 to 0.9549. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 1.1665
  Epoch 13 [Batch 4/40]: Loss: 1.0973
  Epoch 13 [Batch 8/40]: Loss: 1.0068
  Epoch 13 [Batch 12/40]: Loss: 0.8361
  Epoch 13 [Batch 16/40]: Loss: 1.1552
  Epoch 13 [Batch 20/40]: Loss: 0.9416
  Epoch 13 [Batch 24/40]: Loss: 0.9460
  Epoch 13 [Batch 28/40]: Loss: 0.9858
  Epoch 13 [Batch 32/40]: Loss: 1.0472
  Epoch 13 [Batch 36/40]: Loss: 0.7453
  Epoch 13 Train Summary: Avg Loss: 0.9621, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9521, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9549 to 0.9521. Saving...

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 1.0815
  Epoch 14 [Batch 4/40]: Loss: 1.1369
  Epoch 14 [Batch 8/40]: Loss: 0.9762
  Epoch 14 [Batch 12/40]: Loss: 1.1138
  Epoch 14 [Batch 16/40]: Loss: 1.0279
  Epoch 14 [Batch 20/40]: Loss: 0.9293
  Epoch 14 [Batch 24/40]: Loss: 1.0261
  Epoch 14 [Batch 28/40]: Loss: 0.8740
  Epoch 14 [Batch 32/40]: Loss: 0.9142
  Epoch 14 [Batch 36/40]: Loss: 0.7700
  Epoch 14 Train Summary: Avg Loss: 0.9607, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9318, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9521 to 0.9318. Saving...
Training finished in 21.62 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.9318, Accuracy: 0.3333, F1 (Macro): 0.2462
Final Best Model Stats: Acc: 0.3333, F1: 0.2462, Loss: 0.9318
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=1e-05 drop=0.0 seed=999
================================================================================
Starting experiment: resnet50__384x384__lr-1e-05__drop-0.0__seed-999
Output directory: results_opg/resnet50__384x384__lr-1e-05__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 1.2051
  Epoch 0 [Batch 4/40]: Loss: 1.1438
  Epoch 0 [Batch 8/40]: Loss: 1.1247
  Epoch 0 [Batch 12/40]: Loss: 1.1269
  Epoch 0 [Batch 16/40]: Loss: 1.0934
  Epoch 0 [Batch 20/40]: Loss: 1.1147
  Epoch 0 [Batch 24/40]: Loss: 1.1388
  Epoch 0 [Batch 28/40]: Loss: 1.1230
  Epoch 0 [Batch 32/40]: Loss: 1.1316
  Epoch 0 [Batch 36/40]: Loss: 1.1055
  Epoch 0 Train Summary: Avg Loss: 1.1234, Accuracy: 0.2923
  Validation Summary: Avg Loss: 1.1299, Accuracy: 0.2833, F1 (Macro): 0.1381
  New best model! Val loss improved from inf to 1.1299. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 1.0935
  Epoch 1 [Batch 4/40]: Loss: 1.1488
  Epoch 1 [Batch 8/40]: Loss: 1.1207
  Epoch 1 [Batch 12/40]: Loss: 1.1195
  Epoch 1 [Batch 16/40]: Loss: 1.0922
  Epoch 1 [Batch 20/40]: Loss: 1.1066
  Epoch 1 [Batch 24/40]: Loss: 1.0891
  Epoch 1 [Batch 28/40]: Loss: 1.0790
  Epoch 1 [Batch 32/40]: Loss: 1.1078
  Epoch 1 [Batch 36/40]: Loss: 1.0841
  Epoch 1 Train Summary: Avg Loss: 1.1041, Accuracy: 0.3357
  Validation Summary: Avg Loss: 1.1201, Accuracy: 0.3444, F1 (Macro): 0.2005
  New best model! Val loss improved from 1.1299 to 1.1201. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.0950
  Epoch 2 [Batch 4/40]: Loss: 1.0797
  Epoch 2 [Batch 8/40]: Loss: 1.0915
  Epoch 2 [Batch 12/40]: Loss: 1.0839
  Epoch 2 [Batch 16/40]: Loss: 1.0695
  Epoch 2 [Batch 20/40]: Loss: 1.0821
  Epoch 2 [Batch 24/40]: Loss: 1.0823
  Epoch 2 [Batch 28/40]: Loss: 1.0785
  Epoch 2 [Batch 32/40]: Loss: 1.0780
  Epoch 2 [Batch 36/40]: Loss: 1.1120
  Epoch 2 Train Summary: Avg Loss: 1.0884, Accuracy: 0.3601
  Validation Summary: Avg Loss: 1.1003, Accuracy: 0.2917, F1 (Macro): 0.2069
  New best model! Val loss improved from 1.1201 to 1.1003. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 1.0854
  Epoch 3 [Batch 4/40]: Loss: 1.0771
  Epoch 3 [Batch 8/40]: Loss: 1.0756
  Epoch 3 [Batch 12/40]: Loss: 1.0721
  Epoch 3 [Batch 16/40]: Loss: 1.0728
  Epoch 3 [Batch 20/40]: Loss: 1.0693
  Epoch 3 [Batch 24/40]: Loss: 1.0832
  Epoch 3 [Batch 28/40]: Loss: 1.0838
  Epoch 3 [Batch 32/40]: Loss: 1.0783
  Epoch 3 [Batch 36/40]: Loss: 1.0414
  Epoch 3 Train Summary: Avg Loss: 1.0742, Accuracy: 0.3479
  Validation Summary: Avg Loss: 1.0804, Accuracy: 0.3611, F1 (Macro): 0.3324
  New best model! Val loss improved from 1.1003 to 1.0804. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 1.0697
  Epoch 4 [Batch 4/40]: Loss: 1.0283
  Epoch 4 [Batch 8/40]: Loss: 1.0618
  Epoch 4 [Batch 12/40]: Loss: 1.1075
  Epoch 4 [Batch 16/40]: Loss: 1.0467
  Epoch 4 [Batch 20/40]: Loss: 1.0602
  Epoch 4 [Batch 24/40]: Loss: 1.0777
  Epoch 4 [Batch 28/40]: Loss: 1.0557
  Epoch 4 [Batch 32/40]: Loss: 1.0387
  Epoch 4 [Batch 36/40]: Loss: 1.0662
  Epoch 4 Train Summary: Avg Loss: 1.0594, Accuracy: 0.3436
  Validation Summary: Avg Loss: 1.0680, Accuracy: 0.2917, F1 (Macro): 0.2517
  New best model! Val loss improved from 1.0804 to 1.0680. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 1.0132
  Epoch 5 [Batch 4/40]: Loss: 1.0807
  Epoch 5 [Batch 8/40]: Loss: 1.0793
  Epoch 5 [Batch 12/40]: Loss: 1.0243
  Epoch 5 [Batch 16/40]: Loss: 0.9876
  Epoch 5 [Batch 20/40]: Loss: 1.0124
  Epoch 5 [Batch 24/40]: Loss: 1.0342
  Epoch 5 [Batch 28/40]: Loss: 1.0046
  Epoch 5 [Batch 32/40]: Loss: 1.0628
  Epoch 5 [Batch 36/40]: Loss: 0.9944
  Epoch 5 Train Summary: Avg Loss: 1.0503, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0517, Accuracy: 0.3194, F1 (Macro): 0.2396
  New best model! Val loss improved from 1.0680 to 1.0517. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 1.1022
  Epoch 6 [Batch 4/40]: Loss: 1.0445
  Epoch 6 [Batch 8/40]: Loss: 0.9914
  Epoch 6 [Batch 12/40]: Loss: 1.0352
  Epoch 6 [Batch 16/40]: Loss: 0.9997
  Epoch 6 [Batch 20/40]: Loss: 1.0911
  Epoch 6 [Batch 24/40]: Loss: 1.0789
  Epoch 6 [Batch 28/40]: Loss: 0.9901
  Epoch 6 [Batch 32/40]: Loss: 1.0359
  Epoch 6 [Batch 36/40]: Loss: 1.1328
  Epoch 6 Train Summary: Avg Loss: 1.0390, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0363, Accuracy: 0.3194, F1 (Macro): 0.2396
  New best model! Val loss improved from 1.0517 to 1.0363. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 1.0699
  Epoch 7 [Batch 4/40]: Loss: 1.0235
  Epoch 7 [Batch 8/40]: Loss: 1.0340
  Epoch 7 [Batch 12/40]: Loss: 1.0947
  Epoch 7 [Batch 16/40]: Loss: 0.9857
  Epoch 7 [Batch 20/40]: Loss: 1.0201
  Epoch 7 [Batch 24/40]: Loss: 1.0487
  Epoch 7 [Batch 28/40]: Loss: 0.9847
  Epoch 7 [Batch 32/40]: Loss: 0.9847
  Epoch 7 [Batch 36/40]: Loss: 0.9920
  Epoch 7 Train Summary: Avg Loss: 1.0294, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0229, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0363 to 1.0229. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 1.0520
  Epoch 8 [Batch 4/40]: Loss: 1.0364
  Epoch 8 [Batch 8/40]: Loss: 0.9781
  Epoch 8 [Batch 12/40]: Loss: 1.0459
  Epoch 8 [Batch 16/40]: Loss: 1.0773
  Epoch 8 [Batch 20/40]: Loss: 1.1153
  Epoch 8 [Batch 24/40]: Loss: 1.0365
  Epoch 8 [Batch 28/40]: Loss: 0.9362
  Epoch 8 [Batch 32/40]: Loss: 1.0603
  Epoch 8 [Batch 36/40]: Loss: 0.9060
  Epoch 8 Train Summary: Avg Loss: 1.0189, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0102, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0229 to 1.0102. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.9761
  Epoch 9 [Batch 4/40]: Loss: 1.1137
  Epoch 9 [Batch 8/40]: Loss: 0.9989
  Epoch 9 [Batch 12/40]: Loss: 0.9958
  Epoch 9 [Batch 16/40]: Loss: 0.9567
  Epoch 9 [Batch 20/40]: Loss: 0.9890
  Epoch 9 [Batch 24/40]: Loss: 0.9016
  Epoch 9 [Batch 28/40]: Loss: 0.9375
  Epoch 9 [Batch 32/40]: Loss: 0.9391
  Epoch 9 [Batch 36/40]: Loss: 1.0858
  Epoch 9 Train Summary: Avg Loss: 1.0120, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0022, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0102 to 1.0022. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 1.0481
  Epoch 10 [Batch 4/40]: Loss: 0.9518
  Epoch 10 [Batch 8/40]: Loss: 1.0837
  Epoch 10 [Batch 12/40]: Loss: 1.0714
  Epoch 10 [Batch 16/40]: Loss: 0.9577
  Epoch 10 [Batch 20/40]: Loss: 1.1005
  Epoch 10 [Batch 24/40]: Loss: 1.0858
  Epoch 10 [Batch 28/40]: Loss: 0.9090
  Epoch 10 [Batch 32/40]: Loss: 0.9555
  Epoch 10 [Batch 36/40]: Loss: 1.0119
  Epoch 10 Train Summary: Avg Loss: 1.0110, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9902, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 1.0022 to 0.9902. Saving...

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.9815
  Epoch 11 [Batch 4/40]: Loss: 1.0437
  Epoch 11 [Batch 8/40]: Loss: 0.8616
  Epoch 11 [Batch 12/40]: Loss: 0.9552
  Epoch 11 [Batch 16/40]: Loss: 1.1392
  Epoch 11 [Batch 20/40]: Loss: 1.1152
  Epoch 11 [Batch 24/40]: Loss: 0.9600
  Epoch 11 [Batch 28/40]: Loss: 0.9422
  Epoch 11 [Batch 32/40]: Loss: 1.0471
  Epoch 11 [Batch 36/40]: Loss: 0.9901
  Epoch 11 Train Summary: Avg Loss: 0.9930, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9716, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9902 to 0.9716. Saving...

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 1.0310
  Epoch 12 [Batch 4/40]: Loss: 0.9524
  Epoch 12 [Batch 8/40]: Loss: 1.1522
  Epoch 12 [Batch 12/40]: Loss: 0.9718
  Epoch 12 [Batch 16/40]: Loss: 0.8691
  Epoch 12 [Batch 20/40]: Loss: 0.9359
  Epoch 12 [Batch 24/40]: Loss: 1.0560
  Epoch 12 [Batch 28/40]: Loss: 1.2708
  Epoch 12 [Batch 32/40]: Loss: 0.9900
  Epoch 12 [Batch 36/40]: Loss: 1.0464
  Epoch 12 Train Summary: Avg Loss: 0.9885, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9542, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9716 to 0.9542. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.8216
  Epoch 13 [Batch 4/40]: Loss: 0.9669
  Epoch 13 [Batch 8/40]: Loss: 1.1284
  Epoch 13 [Batch 12/40]: Loss: 0.9468
  Epoch 13 [Batch 16/40]: Loss: 1.0516
  Epoch 13 [Batch 20/40]: Loss: 1.0895
  Epoch 13 [Batch 24/40]: Loss: 0.8751
  Epoch 13 [Batch 28/40]: Loss: 0.9231
  Epoch 13 [Batch 32/40]: Loss: 1.0102
  Epoch 13 [Batch 36/40]: Loss: 0.8935
  Epoch 13 Train Summary: Avg Loss: 0.9766, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9504, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9542 to 0.9504. Saving...

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 0.9346
  Epoch 14 [Batch 4/40]: Loss: 0.9944
  Epoch 14 [Batch 8/40]: Loss: 1.0800
  Epoch 14 [Batch 12/40]: Loss: 1.1216
  Epoch 14 [Batch 16/40]: Loss: 1.1160
  Epoch 14 [Batch 20/40]: Loss: 0.9368
  Epoch 14 [Batch 24/40]: Loss: 0.9811
  Epoch 14 [Batch 28/40]: Loss: 0.9091
  Epoch 14 [Batch 32/40]: Loss: 1.0573
  Epoch 14 [Batch 36/40]: Loss: 0.8979
  Epoch 14 Train Summary: Avg Loss: 0.9805, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9450, Accuracy: 0.3333, F1 (Macro): 0.2462
  New best model! Val loss improved from 0.9504 to 0.9450. Saving...
Training finished in 24.80 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  [2m2025-11-07T16:48:57.083989Z[0m [33m WARN[0m  [33mReqwest(reqwest::Error { kind: Request, url: "https://transfer.xethub.hf.co/xorbs/default/180d3b4278d66d8e1657f56c1ddd2ed85158e59527360ad8f1914461df17f72b?X-Xet-Signed-Range=bytes%3D36324317-36613795&X-Xet-Session-Id=01K9FKGR711S92N0ZY5AVEY8FH&Expires=1762537736&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly90cmFuc2Zlci54ZXRodWIuaGYuY28veG9yYnMvZGVmYXVsdC8xODBkM2I0Mjc4ZDY2ZDhlMTY1N2Y1NmMxZGRkMmVkODUxNThlNTk1MjczNjBhZDhmMTkxNDQ2MWRmMTdmNzJiP1gtWGV0LVNpZ25lZC1SYW5nZT1ieXRlcyUzRDM2MzI0MzE3LTM2NjEzNzk1JlgtWGV0LVNlc3Npb24tSWQ9MDFLOUZLR1I3MTFTOTJOMFpZNUFWRVk4RkgiLCJDb25kaXRpb24iOnsiRGF0ZUxlc3NUaGFuIjp7IkFXUzpFcG9jaFRpbWUiOjE3NjI1Mzc3MzZ9fX1dfQ__&Signature=JX5Ctdz9MHA0vfvGymvG3vhl3hZQX6jYotzR422velgKXBJEDS4RNRvlYK6J4YSFkz~1QHp4xGECzTFmLSgs78Go4xLIUM3T-n5CPNdkTf5zxbk4bNbkct5EWqGzLvLvk9xPsiTnzLgt70d9ye5lMgHamkceGMyjvSI7DgD~L--HFpL6lInH9eJANW9e7evKZEwox9bbnYd9HdwrC~dAqR1LR-uEKwWLLxsNgpFTjVj5INN~7l1bb55VHLimPvqhmA~5hIepPd-FqZsw9ROYP3T18oJzs9-tCsylfBmK~E2rpucsX-PfvJ-4Y0sK5i9pAioXlj~j1X5trLvNT86HXg__&Key-Pair-Id=K2L8F4GPSG1IFC", source: hyper_util::client::legacy::Error(Connect, ConnectError("dns error", Custom { kind: Uncategorized, error: "failed to lookup address information: Temporary failure in name resolution" })) }). Retrying...[0m
    [2;3mat[0m /home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs:233

  [2m2025-11-07T16:48:57.084021Z[0m [33m WARN[0m  [33mRetry attempt #0. Sleeping 1.742928586s before the next attempt[0m
    [2;3mat[0m /root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs:171

  [2m2025-11-07T16:48:57.084036Z[0m [33m WARN[0m  [33mReqwest(reqwest::Error { kind: Request, url: "https://transfer.xethub.hf.co/xorbs/default/180d3b4278d66d8e1657f56c1ddd2ed85158e59527360ad8f1914461df17f72b?X-Xet-Signed-Range=bytes%3D29119042-29329904&X-Xet-Session-Id=01K9FKGR711S92N0ZY5AVEY8FH&Expires=1762537736&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly90cmFuc2Zlci54ZXRodWIuaGYuY28veG9yYnMvZGVmYXVsdC8xODBkM2I0Mjc4ZDY2ZDhlMTY1N2Y1NmMxZGRkMmVkODUxNThlNTk1MjczNjBhZDhmMTkxNDQ2MWRmMTdmNzJiP1gtWGV0LVNpZ25lZC1SYW5nZT1ieXRlcyUzRDI5MTE5MDQyLTI5MzI5OTA0JlgtWGV0LVNlc3Npb24tSWQ9MDFLOUZLR1I3MTFTOTJOMFpZNUFWRVk4RkgiLCJDb25kaXRpb24iOnsiRGF0ZUxlc3NUaGFuIjp7IkFXUzpFcG9jaFRpbWUiOjE3NjI1Mzc3MzZ9fX1dfQ__&Signature=LZag~UIYveEyPzoAJE6N6wao4v2j0x~0JRpLquYQHjLWSKMF2hrO5Fd2SAAoRDjLILwe4XSZduWO8VzNl0RUPK4uzRRqX9adiBZ37SkBg8z8rk8qZDXH4TbqJqhD94LJ-jM85KkE5aOhpuGmKJs-Utb~432J23PKRSyG4wzf6~kZxkXFCTSvu1kSwJpo9VmIUUtIkc57Y-ivMpwEV0DLFcrAKHyC4lfhz8fHTYtxPylh98w2M97o4eo2pUNDiGgFApdClBU7VQrFonkZsoxBI1RJ3hzYF2GIDZP2LVv0gvzxTqFCEHYfVFLrgQc1slaXUd5Gb4f4Es4mbReGr-mPQg__&Key-Pair-Id=K2L8F4GPSG1IFC", source: hyper_util::client::legacy::Error(Connect, ConnectError("dns error", Custom { kind: Uncategorized, error: "failed to lookup address information: Temporary failure in name resolution" })) }). Retrying...[0m
    [2;3mat[0m /home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs:233

  [2m2025-11-07T16:48:57.084042Z[0m [33m WARN[0m  [33mRetry attempt #0. Sleeping 2.168277202s before the next attempt[0m
    [2;3mat[0m /root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs:171

  [2m2025-11-07T16:48:57.084050Z[0m [33m WARN[0m  [33mReqwest(reqwest::Error { kind: Request, url: "https://transfer.xethub.hf.co/xorbs/default/180d3b4278d66d8e1657f56c1ddd2ed85158e59527360ad8f1914461df17f72b?X-Xet-Signed-Range=bytes%3D8835953-8956482&X-Xet-Session-Id=01K9FKGR711S92N0ZY5AVEY8FH&Expires=1762537736&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly90cmFuc2Zlci54ZXRodWIuaGYuY28veG9yYnMvZGVmYXVsdC8xODBkM2I0Mjc4ZDY2ZDhlMTY1N2Y1NmMxZGRkMmVkODUxNThlNTk1MjczNjBhZDhmMTkxNDQ2MWRmMTdmNzJiP1gtWGV0LVNpZ25lZC1SYW5nZT1ieXRlcyUzRDg4MzU5NTMtODk1NjQ4MiZYLVhldC1TZXNzaW9uLUlkPTAxSzlGS0dSNzExUzkyTjBaWTVBVkVZOEZIIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzYyNTM3NzM2fX19XX0_&Signature=GbXHoRkvsL2oHYMQqX6nlreRPaYOTBrX2YEDUOc4SApyEEWo1oIUm5zHReA6suX7yu9KcMzYgq0vR7dCyI1pX4wUpqPALujm-qicM0DJAe3qhWShxgl3lt3zXRvw3Pii6HBpzDBRphRYRBT5jfs5VxN3BHo18~fFXfaEhcgnFyV7JpUC3BZ7o3khBrGCcHqGKYvWuocuaR5T2ngw-fTLYZ8sW3MAPhhX~QXOPkhfYhTIambLGfRZbtPwZ2tKwZBPqbXHR0dm7hVYFPaAj1wO6dMhzVR6dPOA-6bYK0rveQgnqtne3XPWOSdA7AZOLEZNaczi28wz2qD3TA3J7-b3uw__&Key-Pair-Id=K2L8F4GPSG1IFC", source: hyper_util::client::legacy::Error(Connect, ConnectError("dns error", Custom { kind: Uncategorized, error: "failed to lookup address information: Temporary failure in name resolution" })) }). Retrying...[0m
    [2;3mat[0m /home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs:233

  [2m2025-11-07T16:48:57.084060Z[0m [33m WARN[0m  [33mRetry attempt #0. Sleeping 1.942380217s before the next attempt[0m
    [2;3mat[0m /root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs:171

  [2m2025-11-07T16:48:57.084069Z[0m [33m WARN[0m  [33mReqwest(reqwest::Error { kind: Request, url: "https://transfer.xethub.hf.co/xorbs/default/0ebb6b7f5b3601eba122737174fa6cd82c2bc3cac903c514b44d7641bd3f4f0e?X-Xet-Signed-Range=bytes%3D2247904-4174545&X-Xet-Session-Id=01K9FKGR711S92N0ZY5AVEY8FH&Expires=1762537736&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly90cmFuc2Zlci54ZXRodWIuaGYuY28veG9yYnMvZGVmYXVsdC8wZWJiNmI3ZjViMzYwMWViYTEyMjczNzE3NGZhNmNkODJjMmJjM2NhYzkwM2M1MTRiNDRkNzY0MWJkM2Y0ZjBlP1gtWGV0LVNpZ25lZC1SYW5nZT1ieXRlcyUzRDIyNDc5MDQtNDE3NDU0NSZYLVhldC1TZXNzaW9uLUlkPTAxSzlGS0dSNzExUzkyTjBaWTVBVkVZOEZIIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzYyNTM3NzM2fX19XX0_&Signature=bI3wsdVzEU2rlOoiy-FhNdyTo0bwMlmNnUUShpiPy7G9~CWgN0DmpLxnK0IXOLBmijFQcBH1RXakhU4sJRt7v2jqbRSy5R21NSi1gFXjziChqxodHD0~6mmq57km3D~~HJjzQXqxWd-TnAdYzIfGU2PWAHC0dJzOa-d13DGY1KgFTq1CiQyper4ae~OO3SHO8vVlSfd1XG7GJ1Y1qoXEylzVoUw~HgRztLt0VH2uOTYQIRxtzi-WGKmnqD4uvySVX8ucXjF41QJo3rCt-YcLg3JmnEwr6pN3A4hSHuLqrw6jf4EJ2YZNmSF-xNJ6z8nnYqypq4LXN7fW-w1syT7ZWw__&Key-Pair-Id=K2L8F4GPSG1IFC", source: hyper_util::client::legacy::Error(Connect, ConnectError("dns error", Custom { kind: Uncategorized, error: "failed to lookup address information: Temporary failure in name resolution" })) }). Retrying...[0m
    [2;3mat[0m /home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs:233

  [2m2025-11-07T16:48:57.084078Z[0m [33m WARN[0m  [33mRetry attempt #0. Sleeping 2.709955729s before the next attempt[0m
    [2;3mat[0m /root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs:171

  [2m2025-11-07T16:48:57.084085Z[0m [33m WARN[0m  [33mReqwest(reqwest::Error { kind: Request, url: "https://transfer.xethub.hf.co/xorbs/default/180d3b4278d66d8e1657f56c1ddd2ed85158e59527360ad8f1914461df17f72b?X-Xet-Signed-Range=bytes%3D32115589-32165550&X-Xet-Session-Id=01K9FKGR711S92N0ZY5AVEY8FH&Expires=1762537736&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly90cmFuc2Zlci54ZXRodWIuaGYuY28veG9yYnMvZGVmYXVsdC8xODBkM2I0Mjc4ZDY2ZDhlMTY1N2Y1NmMxZGRkMmVkODUxNThlNTk1MjczNjBhZDhmMTkxNDQ2MWRmMTdmNzJiP1gtWGV0LVNpZ25lZC1SYW5nZT1ieXRlcyUzRDMyMTE1NTg5LTMyMTY1NTUwJlgtWGV0LVNlc3Npb24tSWQ9MDFLOUZLR1I3MTFTOTJOMFpZNUFWRVk4RkgiLCJDb25kaXRpb24iOnsiRGF0ZUxlc3NUaGFuIjp7IkFXUzpFcG9jaFRpbWUiOjE3NjI1Mzc3MzZ9fX1dfQ__&Signature=qeV~8gGnuvN-5f~iCOPk-zqAt~2mLzoDZ5dy7u5yUrNDtgFvpP0WxPnqpXBDMlsCPW1BekA-ZoxrjW7jpZOPfHPEOszPDGgj0TL09cEz57lqrAm3pMN7o6r8KmqYxiag~enSRJPtfH2M4AYBLRkBzTuuZbU5lQVNPOG8vRag5LLQmgow373Bd1xXsaYU7h54lazmx1BDkktGLGOLiwjGL8IozN0Zc5SPf-N6CDWYdx2~insnIXp3SHGmr~gvgzuexp1JZen30ZNTkAIx-Smz5AUM5LPWS9sbQkTWbl9e3g1ZGtVC5oJBCmRoxCd8CLivXJF55yLbkd~vtr8eC~412g__&Key-Pair-Id=K2L8F4GPSG1IFC", source: hyper_util::client::legacy::Error(Connect, ConnectError("dns error", Custom { kind: Uncategorized, error: "failed to lookup address information: Temporary failure in name resolution" })) }). Retrying...[0m
    [2;3mat[0m /home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs:233

  [2m2025-11-07T16:48:57.084094Z[0m [33m WARN[0m  [33mRetry attempt #0. Sleeping 2.088976747s before the next attempt[0m
    [2;3mat[0m /root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs:171

  [2m2025-11-07T16:48:57.084102Z[0m [33m WARN[0m  [33mReqwest(reqwest::Error { kind: Request, url: "https://transfer.xethub.hf.co/xorbs/default/180d3b4278d66d8e1657f56c1ddd2ed85158e59527360ad8f1914461df17f72b?X-Xet-Signed-Range=bytes%3D36007713-36268919&X-Xet-Session-Id=01K9FKGR711S92N0ZY5AVEY8FH&Expires=1762537736&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly90cmFuc2Zlci54ZXRodWIuaGYuY28veG9yYnMvZGVmYXVsdC8xODBkM2I0Mjc4ZDY2ZDhlMTY1N2Y1NmMxZGRkMmVkODUxNThlNTk1MjczNjBhZDhmMTkxNDQ2MWRmMTdmNzJiP1gtWGV0LVNpZ25lZC1SYW5nZT1ieXRlcyUzRDM2MDA3NzEzLTM2MjY4OTE5JlgtWGV0LVNlc3Npb24tSWQ9MDFLOUZLR1I3MTFTOTJOMFpZNUFWRVk4RkgiLCJDb25kaXRpb24iOnsiRGF0ZUxlc3NUaGFuIjp7IkFXUzpFcG9jaFRpbWUiOjE3NjI1Mzc3MzZ9fX1dfQ__&Signature=RoNAyjhblXz4bK07BVayAM-psuSfpZFjBMKEjDt5hk~yaVj67wGN33a1ZzTByfPV0R2wjGzoaMBAtoqkxjE5YIaGTKdRDvZN~jSdlymItAnB-ayVhupUqGgQ5rbwFECZ9mfzhfEOQastMxNlJpv1nsG-5UnDU1vg80diDosTcS7FptYsp0PngoN-PBoElNMxEVusZva1QxJOubl5a7SQOhRCnl51QsW8socBKVVWzNjuzbS4mbdF6VO-0y1YrH7WQpOyg0hdFvhhpJ27fEVhCJBt2CX7qUO-egEc6OZP9eIx0SDHGdqMf79krG6NocYj0mApayAwgwcF-wcebtrwrQ__&Key-Pair-Id=K2L8F4GPSG1IFC", source: hyper_util::client::legacy::Error(Connect, ConnectError("dns error", Custom { kind: Uncategorized, error: "failed to lookup address information: Temporary failure in name resolution" })) }). Retrying...[0m
    [2;3mat[0m /home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs:233

  [2m2025-11-07T16:48:57.084108Z[0m [33m WARN[0m  [33mRetry attempt #0. Sleeping 477.727369ms before the next attempt[0m
    [2;3mat[0m /root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs:171

  [2m2025-11-07T16:48:57.084104Z[0m [33m WARN[0m  [33mReqwest(reqwest::Error { kind: Request, url: "https://transfer.xethub.hf.co/xorbs/default/180d3b4278d66d8e1657f56c1ddd2ed85158e59527360ad8f1914461df17f72b?X-Xet-Signed-Range=bytes%3D9812248-12261304&X-Xet-Session-Id=01K9FKGR711S92N0ZY5AVEY8FH&Expires=1762537736&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly90cmFuc2Zlci54ZXRodWIuaGYuY28veG9yYnMvZGVmYXVsdC8xODBkM2I0Mjc4ZDY2ZDhlMTY1N2Y1NmMxZGRkMmVkODUxNThlNTk1MjczNjBhZDhmMTkxNDQ2MWRmMTdmNzJiP1gtWGV0LVNpZ25lZC1SYW5nZT1ieXRlcyUzRDk4MTIyNDgtMTIyNjEzMDQmWC1YZXQtU2Vzc2lvbi1JZD0wMUs5RktHUjcxMVM5Mk4wWlk1QVZFWThGSCIsIkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTc2MjUzNzczNn19fV19&Signature=MGiKNeCdr2XwEBdWJ4msRe36OfLZy9GcG09MiARUSbPreJdIkm~J4LTAA0qx~~HCSpDncBm19U9V1UW6sF0BpKkfeTpzUcKr0MA0vnOTwuYt~go-1-wxixZ~-HXzS09ymOSIEydR8oT9Rgca~M43pyLzOKpWEfGt8~ijsXYfL4ohyfmDLusVO1yLGar6OeYDct-X84zxVGs5WrJaWFjDTK5MIx2nrV8ee1-pG-pfSNRO06utmD5tL4vi34sXnfAUxFDKW1iLM5B4Q8FrCdwEulVZdlXTZVJsYILvj2R7F0mqMwUp56chidbCFhRUrcflNOtFpF~74ZmDYQojpjAkcA__&Key-Pair-Id=K2L8F4GPSG1IFC", source: hyper_util::client::legacy::Error(Connect, ConnectError("dns error", Custom { kind: Uncategorized, error: "failed to lookup address information: Temporary failure in name resolution" })) }). Retrying...[0m
    [2;3mat[0m /home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs:233

  [2m2025-11-07T16:48:57.084116Z[0m [33m WARN[0m  [33mReqwest(reqwest::Error { kind: Request, url: "https://transfer.xethub.hf.co/xorbs/default/180d3b4278d66d8e1657f56c1ddd2ed85158e59527360ad8f1914461df17f72b?X-Xet-Signed-Range=bytes%3D37965524-38172462&X-Xet-Session-Id=01K9FKGR711S92N0ZY5AVEY8FH&Expires=1762537736&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly90cmFuc2Zlci54ZXRodWIuaGYuY28veG9yYnMvZGVmYXVsdC8xODBkM2I0Mjc4ZDY2ZDhlMTY1N2Y1NmMxZGRkMmVkODUxNThlNTk1MjczNjBhZDhmMTkxNDQ2MWRmMTdmNzJiP1gtWGV0LVNpZ25lZC1SYW5nZT1ieXRlcyUzRDM3OTY1NTI0LTM4MTcyNDYyJlgtWGV0LVNlc3Npb24tSWQ9MDFLOUZLR1I3MTFTOTJOMFpZNUFWRVk4RkgiLCJDb25kaXRpb24iOnsiRGF0ZUxlc3NUaGFuIjp7IkFXUzpFcG9jaFRpbWUiOjE3NjI1Mzc3MzZ9fX1dfQ__&Signature=SSfJRwApW8FwDxA9Xb3Gbqv7MjOhRnkaoS8GW3QjaqHMI5vug1XuYZniRt4L2ptu4g27RqntkQQutIqjzxYlQNTbfXTujqBFOfdlSbMbCI2CkTIRe677CoCXtPl9NdkmDoQKjMZM55WlqhbhTTjFVfDZFNJx~y9R8cXgp7AEGsoF4qZ69m5jXyxfJSutlMAQBv2lPa22XE3T7fzqbOWnRl3A0kViO4rAbVfSwMB-qK82gKRofgrJ5rdHu6Akv1-MCmjJCbUjI9hObZ7wHouvoLwTQw0~E18Rji9Fey7E7GM0JGIm-3LumN02pb3kV0XaOoEKfXuEdGkSLTuigEReVQ__&Key-Pair-Id=K2L8F4GPSG1IFC", source: hyper_util::client::legacy::Error(Connect, ConnectError("dns error", Custom { kind: Uncategorized, error: "failed to lookup address information: Temporary failure in name resolution" })) }). Retrying...[0m
    [2;3mat[0m /home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs:233

  [2m2025-11-07T16:48:57.084125Z[0m [33m WARN[0m  [33mRetry attempt #0. Sleeping 2.917612929s before the next attempt[0m
    [2;3mat[0m /root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs:171

  [2m2025-11-07T16:48:57.084127Z[0m [33m WARN[0m  [33mRetry attempt #0. Sleeping 1.192312859s before the next attempt[0m
    [2;3mat[0m /root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs:171

  [2m2025-11-07T16:48:57.084138Z[0m [33m WARN[0m  [33mReqwest(reqwest::Error { kind: Request, url: "https://transfer.xethub.hf.co/xorbs/default/180d3b4278d66d8e1657f56c1ddd2ed85158e59527360ad8f1914461df17f72b?X-Xet-Signed-Range=bytes%3D8433948-8818760&X-Xet-Session-Id=01K9FKGR711S92N0ZY5AVEY8FH&Expires=1762537736&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly90cmFuc2Zlci54ZXRodWIuaGYuY28veG9yYnMvZGVmYXVsdC8xODBkM2I0Mjc4ZDY2ZDhlMTY1N2Y1NmMxZGRkMmVkODUxNThlNTk1MjczNjBhZDhmMTkxNDQ2MWRmMTdmNzJiP1gtWGV0LVNpZ25lZC1SYW5nZT1ieXRlcyUzRDg0MzM5NDgtODgxODc2MCZYLVhldC1TZXNzaW9uLUlkPTAxSzlGS0dSNzExUzkyTjBaWTVBVkVZOEZIIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzYyNTM3NzM2fX19XX0_&Signature=dHLOzZsK~QXx-x8r22RPUMtaoiuAsvZ7MLsGtZffJoEtAEI4-2mcg5uountNovsA-UHDs6HHaj~801khImE309ViISE5io18xy30Eb~AlfLYksPqnbrlAQdKMnK-I8IVWFNP76dH5~CNYuusjGtXh5MF6qQG3qhU5hWgDNEItV9gFBHOmcPEm3MumOItUGtQkKD4JZlkuoUzdHjA2yc5I2vSpQtJr2U5uARqFJor1o4yKPm~YfxULpkb4XkTmFXd0F-nZqvJBUAMajNENnbT2DP05LsStot9e2py8~bkJXareaJ-EiJ3XszVQGDwCQ2tAOwrA4x3rU5DG9eusUf9Ng__&Key-Pair-Id=K2L8F4GPSG1IFC", source: hyper_util::client::legacy::Error(Connect, ConnectError("dns error", Custom { kind: Uncategorized, error: "failed to lookup address information: Temporary failure in name resolution" })) }). Retrying...[0m
    [2;3mat[0m /home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs:233

  [2m2025-11-07T16:48:57.084144Z[0m [33m WARN[0m  [33mRetry attempt #0. Sleeping 155.782102ms before the next attempt[0m
    [2;3mat[0m /root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs:171

  [2m2025-11-07T16:48:57.086206Z[0m [33m WARN[0m  [33mReqwest(reqwest::Error { kind: Request, url: "https://transfer.xethub.hf.co/xorbs/default/180d3b4278d66d8e1657f56c1ddd2ed85158e59527360ad8f1914461df17f72b?X-Xet-Signed-Range=bytes%3D18641372-20206316&X-Xet-Session-Id=01K9FKGR711S92N0ZY5AVEY8FH&Expires=1762537736&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly90cmFuc2Zlci54ZXRodWIuaGYuY28veG9yYnMvZGVmYXVsdC8xODBkM2I0Mjc4ZDY2ZDhlMTY1N2Y1NmMxZGRkMmVkODUxNThlNTk1MjczNjBhZDhmMTkxNDQ2MWRmMTdmNzJiP1gtWGV0LVNpZ25lZC1SYW5nZT1ieXRlcyUzRDE4NjQxMzcyLTIwMjA2MzE2JlgtWGV0LVNlc3Npb24tSWQ9MDFLOUZLR1I3MTFTOTJOMFpZNUFWRVk4RkgiLCJDb25kaXRpb24iOnsiRGF0ZUxlc3NUaGFuIjp7IkFXUzpFcG9jaFRpbWUiOjE3NjI1Mzc3MzZ9fX1dfQ__&Signature=UWUC9~tUMWwcfhIwQUP4ovr5gCJNkLz7vwAHbf922UOET7V3dKNO2wzVH8NsKQ2-JQ1GqAMc8TVDHHAUuZShP8OYsksA5Y6xNEcawWXCtC7XA6YXexWoQJJJwcDYdZN67-iP7nEa6IY~WP2VKlYVMqW1fkDRgpX63S~NdJWp6LbTQeXFTRnnHajzgSu5uadPl66q8xmL9qEJui0fga59wGi3NyXuyqm4UFWws803X6eJnkK74py2eDVpvRyFDcW2CUUuMCfSUHCi0GpZkJwF83ztnf1IarOhjQkOUqePItT~J2ScUkyyXU-7qx5NVLYRZxXnWUwSh8poyQzMIyV0Mw__&Key-Pair-Id=K2L8F4GPSG1IFC", source: hyper_util::client::legacy::Error(Connect, ConnectError("dns error", Custom { kind: Uncategorized, error: "failed to lookup address information: Temporary failure in name resolution" })) }). Retrying...[0m
    [2;3mat[0m /home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs:233

  [2m2025-11-07T16:48:57.086216Z[0m [33m WARN[0m  [33mRetry attempt #0. Sleeping 2.134380999s before the next attempt[0m
    [2;3mat[0m /root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs:171

  [2m2025-11-07T16:48:57.086255Z[0m [33m WARN[0m  [33mReqwest(reqwest::Error { kind: Request, url: "https://transfer.xethub.hf.co/xorbs/default/180d3b4278d66d8e1657f56c1ddd2ed85158e59527360ad8f1914461df17f72b?X-Xet-Signed-Range=bytes%3D13806643-13916530&X-Xet-Session-Id=01K9FKGR711S92N0ZY5AVEY8FH&Expires=1762537736&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly90cmFuc2Zlci54ZXRodWIuaGYuY28veG9yYnMvZGVmYXVsdC8xODBkM2I0Mjc4ZDY2ZDhlMTY1N2Y1NmMxZGRkMmVkODUxNThlNTk1MjczNjBhZDhmMTkxNDQ2MWRmMTdmNzJiP1gtWGV0LVNpZ25lZC1SYW5nZT1ieXRlcyUzRDEzODA2NjQzLTEzOTE2NTMwJlgtWGV0LVNlc3Npb24tSWQ9MDFLOUZLR1I3MTFTOTJOMFpZNUFWRVk4RkgiLCJDb25kaXRpb24iOnsiRGF0ZUxlc3NUaGFuIjp7IkFXUzpFcG9jaFRpbWUiOjE3NjI1Mzc3MzZ9fX1dfQ__&Signature=ZajRGJ0U1pIXsmF0~6pz8sYEFMgi2BFl0KO8Eb-Vz3zQ3lM1HgbPtDsFKQmqv61rzHxbg9vJN9M5FITuXxA4GtG8qkRqaGeSZMaSIOoKUmiZL2f~XWpH8JjpcxNfriM9iR4Y1b7tkz0hLarKkuvHQ-5KzDXTs8TIMW4T23BE7Y0Dyz2UIlZwZK038sMpLeCwEYRTEyOIf1yZZc3VPzPIvPblK8djANBhRFcnpHXRQ5Ugb9mqe9bZ1SnSGu~4ZGWS8dL04P~WbotVxX6IBC0evAc7mEp7sT0MP7YjfznpBSd6RvOHn4XCQn7cjA0AMG442b-pExFkz62hP1FqW0bQfA__&Key-Pair-Id=K2L8F4GPSG1IFC", source: hyper_util::client::legacy::Error(Connect, ConnectError("dns error", Custom { kind: Uncategorized, error: "failed to lookup address information: Temporary failure in name resolution" })) }). Retrying...[0m
    [2;3mat[0m /home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs:233

  [2m2025-11-07T16:48:57.086262Z[0m [33m WARN[0m  [33mRetry attempt #0. Sleeping 220.24583ms before the next attempt[0m
    [2;3mat[0m /root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs:171

  [2m2025-11-07T16:48:57.086303Z[0m [33m WARN[0m  [33mReqwest(reqwest::Error { kind: Request, url: "https://transfer.xethub.hf.co/xorbs/default/180d3b4278d66d8e1657f56c1ddd2ed85158e59527360ad8f1914461df17f72b?X-Xet-Signed-Range=bytes%3D28365237-28814787&X-Xet-Session-Id=01K9FKGR711S92N0ZY5AVEY8FH&Expires=1762537736&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly90cmFuc2Zlci54ZXRodWIuaGYuY28veG9yYnMvZGVmYXVsdC8xODBkM2I0Mjc4ZDY2ZDhlMTY1N2Y1NmMxZGRkMmVkODUxNThlNTk1MjczNjBhZDhmMTkxNDQ2MWRmMTdmNzJiP1gtWGV0LVNpZ25lZC1SYW5nZT1ieXRlcyUzRDI4MzY1MjM3LTI4ODE0Nzg3JlgtWGV0LVNlc3Npb24tSWQ9MDFLOUZLR1I3MTFTOTJOMFpZNUFWRVk4RkgiLCJDb25kaXRpb24iOnsiRGF0ZUxlc3NUaGFuIjp7IkFXUzpFcG9jaFRpbWUiOjE3NjI1Mzc3MzZ9fX1dfQ__&Signature=ashQbmSHPvLrjsrFxokDbddFrYhvzFt4mxN9LTQJduS1JEPo0V7-LGo7GxLCTxBViv9~-2mXMvwRQlKgphEWKYdY-xx-VjlI1sDbRhXtbFRIO54ZjmiPK0DqLGklmYw73-xaQjJgmxPcVA7UYw3FszsknsFdRXWHFL8i6lulxqaNoDwzgJd1xpfvhIf~Rt14JMvExt2ZxexWnDNFDYNBksDu~PgiHYDGumOKaeQPiUGvbnvVCdCIywxoxC6gDvDADg1bJqVWjooeWBQsoRh3StiWRopizjWD0YdJP9ZAVd7Ykvh1SSWCx3hBJKRPYqsYgUj5fbdFLdh3zGNKC~FRjw__&Key-Pair-Id=K2L8F4GPSG1IFC", source: hyper_util::client::legacy::Error(Connect, ConnectError("dns error", Custom { kind: Uncategorized, error: "failed to lookup address information: Temporary failure in name resolution" })) }). Retrying...[0m
    [2;3mat[0m /home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs:233

  [2m2025-11-07T16:48:57.086308Z[0m [33m WARN[0m  [33mRetry attempt #0. Sleeping 1.930940601s before the next attempt[0m
    [2;3mat[0m /root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs:171

  [2m2025-11-07T16:48:57.086499Z[0m [33m WARN[0m  [33mReqwest(reqwest::Error { kind: Request, url: "https://transfer.xethub.hf.co/xorbs/default/180d3b4278d66d8e1657f56c1ddd2ed85158e59527360ad8f1914461df17f72b?X-Xet-Signed-Range=bytes%3D27261622-27417354&X-Xet-Session-Id=01K9FKGR711S92N0ZY5AVEY8FH&Expires=1762537736&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly90cmFuc2Zlci54ZXRodWIuaGYuY28veG9yYnMvZGVmYXVsdC8xODBkM2I0Mjc4ZDY2ZDhlMTY1N2Y1NmMxZGRkMmVkODUxNThlNTk1MjczNjBhZDhmMTkxNDQ2MWRmMTdmNzJiP1gtWGV0LVNpZ25lZC1SYW5nZT1ieXRlcyUzRDI3MjYxNjIyLTI3NDE3MzU0JlgtWGV0LVNlc3Npb24tSWQ9MDFLOUZLR1I3MTFTOTJOMFpZNUFWRVk4RkgiLCJDb25kaXRpb24iOnsiRGF0ZUxlc3NUaGFuIjp7IkFXUzpFcG9jaFRpbWUiOjE3NjI1Mzc3MzZ9fX1dfQ__&Signature=MM2qwwb3snoRkTF5EGXqDYCj1yNLzwOtH4bro5YKARe5dAOILkExECPGuA6ixLI0pRmJaWlEtHVq4KhF0U2Ka6iJYHjIHN9dwlOFqZhUXzkupn~PWkgDcp4ZnjRLixn1QYO~0Mc2tedM~lSVf2aKCEYgpOvH7Apz~VFiVEFuUSSIR6cS1lDFwYZtIrrjbllIZDaSDhf-ib7uBanILm5hyAZ-KsunaJRXrNRWNkfmdiEbrfKmp14TC2SIUKKtsA-lC6XNVkQLkVCI2xyaLHoxkjiE-YilHGJBKNgv4kZNbX4b-EWhoJPNvzFhRAWYfRlCKK9JtDQYRBxSRplnWBmvFA__&Key-Pair-Id=K2L8F4GPSG1IFC", source: hyper_util::client::legacy::Error(Connect, ConnectError("dns error", Custom { kind: Uncategorized, error: "failed to lookup address information: Temporary failure in name resolution" })) }). Retrying...[0m
    [2;3mat[0m /home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs:233

  [2m2025-11-07T16:48:57.086507Z[0m [33m WARN[0m  [33mRetry attempt #0. Sleeping 1.15186433s before the next attempt[0m
    [2;3mat[0m /root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs:171

  [2m2025-11-07T16:48:57.086689Z[0m [33m WARN[0m  [33mReqwest(reqwest::Error { kind: Request, url: "https://transfer.xethub.hf.co/xorbs/default/180d3b4278d66d8e1657f56c1ddd2ed85158e59527360ad8f1914461df17f72b?X-Xet-Signed-Range=bytes%3D1437565-4532811&X-Xet-Session-Id=01K9FKGR711S92N0ZY5AVEY8FH&Expires=1762537736&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly90cmFuc2Zlci54ZXRodWIuaGYuY28veG9yYnMvZGVmYXVsdC8xODBkM2I0Mjc4ZDY2ZDhlMTY1N2Y1NmMxZGRkMmVkODUxNThlNTk1MjczNjBhZDhmMTkxNDQ2MWRmMTdmNzJiP1gtWGV0LVNpZ25lZC1SYW5nZT1ieXRlcyUzRDE0Mzc1NjUtNDUzMjgxMSZYLVhldC1TZXNzaW9uLUlkPTAxSzlGS0dSNzExUzkyTjBaWTVBVkVZOEZIIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzYyNTM3NzM2fX19XX0_&Signature=Am3odhDWHPewrBsTYky3udQjUA8ld4Qx81AA7SHMjdqd59e1Z7NWSStg36tblYmPha9JhQTX8xdzfySiyOeCnZxRZOSviJFIMja8rQYtaGk6Gl~XreYB8oWV9L5pucnU6LVg~i8L0svT1QP63o2oYhryVDgtUcgCTwf72Y1HB5gaP7lWIKdvL7~DAeL6cw0DkdDIZiOGUgVqIDfsynfT0lngJHRtV2wdGeZMEehR2IdvsxR1aQfHwU7lQLzOTRr-CA~KEQJmrD1IiPQkNsy1wQxTEJcCmhg6tx1eJwWWk32tTKhslgJPLwenX~RTx7kuO8sz5HF7tlZ0NZCJyMFOhQ__&Key-Pair-Id=K2L8F4GPSG1IFC", source: hyper_util::client::legacy::Error(Connect, ConnectError("dns error", Custom { kind: Uncategorized, error: "failed to lookup address information: Temporary failure in name resolution" })) }). Retrying...[0m
    [2;3mat[0m /home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs:233

  [2m2025-11-07T16:48:57.086693Z[0m [33m WARN[0m  [33mReqwest(reqwest::Error { kind: Request, url: "https://transfer.xethub.hf.co/xorbs/default/180d3b4278d66d8e1657f56c1ddd2ed85158e59527360ad8f1914461df17f72b?X-Xet-Signed-Range=bytes%3D32901398-33761169&X-Xet-Session-Id=01K9FKGR711S92N0ZY5AVEY8FH&Expires=1762537736&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly90cmFuc2Zlci54ZXRodWIuaGYuY28veG9yYnMvZGVmYXVsdC8xODBkM2I0Mjc4ZDY2ZDhlMTY1N2Y1NmMxZGRkMmVkODUxNThlNTk1MjczNjBhZDhmMTkxNDQ2MWRmMTdmNzJiP1gtWGV0LVNpZ25lZC1SYW5nZT1ieXRlcyUzRDMyOTAxMzk4LTMzNzYxMTY5JlgtWGV0LVNlc3Npb24tSWQ9MDFLOUZLR1I3MTFTOTJOMFpZNUFWRVk4RkgiLCJDb25kaXRpb24iOnsiRGF0ZUxlc3NUaGFuIjp7IkFXUzpFcG9jaFRpbWUiOjE3NjI1Mzc3MzZ9fX1dfQ__&Signature=HZwtJMkoKuKA8L1c9wM9Y9ewWEO~VtNhNXPxxyaC2gxmyA2jNYUj73c6-qM6994zC2d7U62y6zfni7Bz6zsG7U-bwQoPMx3X7G~dGDI2d6PYOkHuMuILJnjDjFLVuORA~xjoOjWK0Qgjb-LSa~tdyUD8HFK53f~49LwIdL05zwBly1iohGJmIIfDGAVU2l~D503c5tdxlyRQEuh9rNNwpC9NuGZZW9X0REe6Jxt-K7~Kpak~00RHHDYtGgZfFVWmbJga5l-4LkMvsSo8w3V3S7xvF0NSHs3rWOiRTZj7qru445oAE3rUZ~jAysc8Xtx0nPGRZx~iy12d~7x7lgeWnA__&Key-Pair-Id=K2L8F4GPSG1IFC", source: hyper_util::client::legacy::Error(Connect, ConnectError("dns error", Custom { kind: Uncategorized, error: "failed to lookup address information: Temporary failure in name resolution" })) }). Retrying...[0m
    [2;3mat[0m /home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs:233

  [2m2025-11-07T16:48:57.086695Z[0m [33m WARN[0m  [33mRetry attempt #0. Sleeping 2.171027106s before the next attempt[0m
    [2;3mat[0m /root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs:171

  [2m2025-11-07T16:48:57.086699Z[0m [33m WARN[0m  [33mRetry attempt #0. Sleeping 2.825635789s before the next attempt[0m
    [2;3mat[0m /root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs:171

  [2m2025-11-07T16:48:57.086739Z[0m [33m WARN[0m  [33mReqwest(reqwest::Error { kind: Request, url: "https://transfer.xethub.hf.co/xorbs/default/180d3b4278d66d8e1657f56c1ddd2ed85158e59527360ad8f1914461df17f72b?X-Xet-Signed-Range=bytes%3D24522196-25137327&X-Xet-Session-Id=01K9FKGR711S92N0ZY5AVEY8FH&Expires=1762537736&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly90cmFuc2Zlci54ZXRodWIuaGYuY28veG9yYnMvZGVmYXVsdC8xODBkM2I0Mjc4ZDY2ZDhlMTY1N2Y1NmMxZGRkMmVkODUxNThlNTk1MjczNjBhZDhmMTkxNDQ2MWRmMTdmNzJiP1gtWGV0LVNpZ25lZC1SYW5nZT1ieXRlcyUzRDI0NTIyMTk2LTI1MTM3MzI3JlgtWGV0LVNlc3Npb24tSWQ9MDFLOUZLR1I3MTFTOTJOMFpZNUFWRVk4RkgiLCJDb25kaXRpb24iOnsiRGF0ZUxlc3NUaGFuIjp7IkFXUzpFcG9jaFRpbWUiOjE3NjI1Mzc3MzZ9fX1dfQ__&Signature=XtOv7WuuWAd1QRkCVSA8NHDMfvxBcjlRQNjiy4EQ592sHwh3bgyxueD9rrzike-yCxOtGGI-ytXaLJX21N3ikad1hXlqJyac4DakomO3cnaX08NbT8ARofkWhRgbchgU9hgTIcWqpz7qJPDV0-e~J~8~EEHj4fwLJMf31p0mrfm7vvTTpwVl51qXgkzDVWLovIRWDxJBOo6dhypZW48CqstO-ew0GISVclimhE1U-52OlfbqA6dt6Tv0p6LxXWNrXTLKAcC4DI~4qeIJBnzRS3k2jz338jkVRt3tcVHhTKmWRefzUouKRO59q4zFBzOAXFUcrIDTXd2m0LafgsgZyw__&Key-Pair-Id=K2L8F4GPSG1IFC", source: hyper_util::client::legacy::Error(Connect, ConnectError("dns error", Custom { kind: Uncategorized, error: "failed to lookup address information: Temporary failure in name resolution" })) }). Retrying...[0m
    [2;3mat[0m /home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs:233

  [2m2025-11-07T16:48:57.086744Z[0m [33m WARN[0m  [33mRetry attempt #0. Sleeping 1.060006875s before the next attempt[0m
    [2;3mat[0m /root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs:171

  [2m2025-11-07T16:48:57.086784Z[0m [33m WARN[0m  [33mReqwest(reqwest::Error { kind: Request, url: "https://transfer.xethub.hf.co/xorbs/default/180d3b4278d66d8e1657f56c1ddd2ed85158e59527360ad8f1914461df17f72b?X-Xet-Signed-Range=bytes%3D5331074-7299941&X-Xet-Session-Id=01K9FKGR711S92N0ZY5AVEY8FH&Expires=1762537736&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly90cmFuc2Zlci54ZXRodWIuaGYuY28veG9yYnMvZGVmYXVsdC8xODBkM2I0Mjc4ZDY2ZDhlMTY1N2Y1NmMxZGRkMmVkODUxNThlNTk1MjczNjBhZDhmMTkxNDQ2MWRmMTdmNzJiP1gtWGV0LVNpZ25lZC1SYW5nZT1ieXRlcyUzRDUzMzEwNzQtNzI5OTk0MSZYLVhldC1TZXNzaW9uLUlkPTAxSzlGS0dSNzExUzkyTjBaWTVBVkVZOEZIIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzYyNTM3NzM2fX19XX0_&Signature=OS4hHeY96YVuGC3SfCtIvBnPdhlTQwNTrOFTrwDfzYO1pUreJhcpv5HudffEETbf1YjYbKPicV43IiNxZ8zmFopofu5bxpobcKFj2bItBEwklbH5tpGdhooK77ZqPZo32516GgrDSfK8eeQr3K5nM7dNx1Qm5scry8klaidCZDLg4FGAkDga5TQSe0482dHbhwyuuYhMXZ-kaKbafcVlzFXnREdxBH4bnHbV4d5oEvKtHpXrgt8oW6ES-vQ53fXQaS2J4J2VuAdmnT6xgLZOmFsiVg5hWbstmyBDR~66SKTJNtJisEQ11t0Ji32N2FscgFMR02cr7pI02MNFmJOIZg__&Key-Pair-Id=K2L8F4GPSG1IFC", source: hyper_util::client::legacy::Error(Connect, ConnectError("dns error", Custom { kind: Uncategorized, error: "failed to lookup address information: Temporary failure in name resolution" })) }). Retrying...[0m
    [2;3mat[0m /home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs:233

  [2m2025-11-07T16:48:57.086789Z[0m [33m WARN[0m  [33mRetry attempt #0. Sleeping 1.687949438s before the next attempt[0m
    [2;3mat[0m /root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs:171

  [2m2025-11-07T16:48:57.242649Z[0m [33m WARN[0m  [33mReqwest(reqwest::Error { kind: Request, url: "https://transfer.xethub.hf.co/xorbs/default/180d3b4278d66d8e1657f56c1ddd2ed85158e59527360ad8f1914461df17f72b?X-Xet-Signed-Range=bytes%3D37757788-37931883&X-Xet-Session-Id=01K9FKGR711S92N0ZY5AVEY8FH&Expires=1762537736&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly90cmFuc2Zlci54ZXRodWIuaGYuY28veG9yYnMvZGVmYXVsdC8xODBkM2I0Mjc4ZDY2ZDhlMTY1N2Y1NmMxZGRkMmVkODUxNThlNTk1MjczNjBhZDhmMTkxNDQ2MWRmMTdmNzJiP1gtWGV0LVNpZ25lZC1SYW5nZT1ieXRlcyUzRDM3NzU3Nzg4LTM3OTMxODgzJlgtWGV0LVNlc3Npb24tSWQ9MDFLOUZLR1I3MTFTOTJOMFpZNUFWRVk4RkgiLCJDb25kaXRpb24iOnsiRGF0ZUxlc3NUaGFuIjp7IkFXUzpFcG9jaFRpbWUiOjE3NjI1Mzc3MzZ9fX1dfQ__&Signature=elHre~VYUouTL5Wwi8NW4myim~kbLjKfyUaOOnsGKHR4oVoit--DaIALEgtwSxo2asCFxw4kSrlhcDNoEKumJE5Bbs5HQbp0BMEdvEXEAF1YZaMLib4afch3EXuIeM2R2gGQy0EDorBZfZSA23ynmdoyOs3W4RRGz7Ugx~rq9~iIz8DKr2xTfKdMKLBGps6kLZOMp2vhRgRkMCywjVzuFmhWp90~Bb~UPh1TyCsYhfby1jiONGJJ9AU5AvaJWiJ0sINi3JU3yliPfbfuYmhetH1dU9Ngx4GVewgEDby~4YUq0wWG9aln-dG1BsEYG~5mmDvrhdqVbO6AWz46KxHeYQ__&Key-Pair-Id=K2L8F4GPSG1IFC", source: hyper_util::client::legacy::Error(Connect, ConnectError("dns error", Custom { kind: Uncategorized, error: "failed to lookup address information: Temporary failure in name resolution" })) }). Retrying...[0m
    [2;3mat[0m /home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs:233

  [2m2025-11-07T16:48:57.242679Z[0m [33m WARN[0m  [33mRetry attempt #0. Sleeping 2.032265505s before the next attempt[0m
    [2;3mat[0m /root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs:171

  [2m2025-11-07T16:48:57.242985Z[0m [33m WARN[0m  [33mReqwest(reqwest::Error { kind: Request, url: "https://transfer.xethub.hf.co/xorbs/default/180d3b4278d66d8e1657f56c1ddd2ed85158e59527360ad8f1914461df17f72b?X-Xet-Signed-Range=bytes%3D13373292-13584461&X-Xet-Session-Id=01K9FKGR711S92N0ZY5AVEY8FH&Expires=1762537736&Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly90cmFuc2Zlci54ZXRodWIuaGYuY28veG9yYnMvZGVmYXVsdC8xODBkM2I0Mjc4ZDY2ZDhlMTY1N2Y1NmMxZGRkMmVkODUxNThlNTk1MjczNjBhZDhmMTkxNDQ2MWRmMTdmNzJiP1gtWGV0LVNpZ25lZC1SYW5nZT1ieXRlcyUzRDEzMzczMjkyLTEzNTg0NDYxJlgtWGV0LVNlc3Npb24tSWQ9MDFLOUZLR1I3MTFTOTJOMFpZNUFWRVk4RkgiLCJDb25kaXRpb24iOnsiRGF0ZUxlc3NUaGFuIjp7IkFXUzpFcG9jaFRpbWUiOjE3NjI1Mzc3MzZ9fX1dfQ__&Signature=WYFxPTVPIoBuTPzq7eP27-GZIXLzEIQ6bFp62VrVsm~W87sgG~n~U7E5-jgreygmuxtiWHCQZ7raV18Ed~-ZejX57qGZvhYYzP0g6F7GM1Qce14Aqc5~vWk-QLSg5Rg1OUUrxRB~4KcUu2TCAD-g16-YQyZt~e7xQb-aYLp4ZOmgyVe-aYQvf3XoWVSNrWhS9ktSSCHk6jYuJHsAW6etN3OHthe33Y0oqS7GHa0xhNeQd-3L~4KTZz5aRLZRy8NhB8yU58canVPvHVoNNUr7e~zBDMAqgbK0vCYLNf8nEIZDDPVJQHv96ts1CScuXFKWOqDc01x5IqrFVf~DGVEkcA__&Key-Pair-Id=K2L8F4GPSG1IFC", source: hyper_util::client::legacy::Error(Connect, ConnectError("dns error", Custom { kind: Uncategorized, error: "failed to lookup address information: Temporary failure in name resolution" })) }). Retrying...[0m
    [2;3mat[0m /home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs:233

  [2m2025-11-07T16:48:57.242995Z[0m [33m WARN[0m  [33mRetry attempt #0. Sleeping 96.267919ms before the next attempt[0m
    [2;3mat[0m /root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs:171

  Validation Summary: Avg Loss: 0.9450, Accuracy: 0.3333, F1 (Macro): 0.2462
Final Best Model Stats: Acc: 0.3333, F1: 0.2462, Loss: 0.9450
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=224x224 lr=0.0001 drop=0.0 seed=42
================================================================================
Starting experiment: efficientnet_b0__224x224__lr-0.0001__drop-0.0__seed-42
Output directory: results_opg/efficientnet_b0__224x224__lr-0.0001__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 2.0874
  Epoch 0 [Batch 4/40]: Loss: 3.3719
  Epoch 0 [Batch 8/40]: Loss: 1.8124
  Epoch 0 [Batch 12/40]: Loss: 1.0837
  Epoch 0 [Batch 16/40]: Loss: 2.1302
  Epoch 0 [Batch 20/40]: Loss: 1.5220
  Epoch 0 [Batch 24/40]: Loss: 2.9894
  Epoch 0 [Batch 28/40]: Loss: 2.1291
  Epoch 0 [Batch 32/40]: Loss: 3.3701
  Epoch 0 [Batch 36/40]: Loss: 1.6432
  Epoch 0 Train Summary: Avg Loss: 2.2794, Accuracy: 0.3284
  Validation Summary: Avg Loss: 1.6493, Accuracy: 0.3472, F1 (Macro): 0.3205
  New best model! Val loss improved from inf to 1.6493. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 2.1670
  Epoch 1 [Batch 4/40]: Loss: 1.7849
  Epoch 1 [Batch 8/40]: Loss: 0.7604
  Epoch 1 [Batch 12/40]: Loss: 0.8887
  Epoch 1 [Batch 16/40]: Loss: 1.1630
  Epoch 1 [Batch 20/40]: Loss: 1.2580
  Epoch 1 [Batch 24/40]: Loss: 3.1640
  Epoch 1 [Batch 28/40]: Loss: 1.0906
  Epoch 1 [Batch 32/40]: Loss: 1.3151
  Epoch 1 [Batch 36/40]: Loss: 1.5005
  Epoch 1 Train Summary: Avg Loss: 1.5286, Accuracy: 0.4394
  Validation Summary: Avg Loss: 1.7969, Accuracy: 0.2917, F1 (Macro): 0.3177

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 0.7466
  Epoch 2 [Batch 4/40]: Loss: 1.2442
  Epoch 2 [Batch 8/40]: Loss: 1.7450
  Epoch 2 [Batch 12/40]: Loss: 1.1501
  Epoch 2 [Batch 16/40]: Loss: 1.3852
  Epoch 2 [Batch 20/40]: Loss: 1.3930
  Epoch 2 [Batch 24/40]: Loss: 1.9307
  Epoch 2 [Batch 28/40]: Loss: 1.1447
  Epoch 2 [Batch 32/40]: Loss: 1.8472
  Epoch 2 [Batch 36/40]: Loss: 2.4119
  Epoch 2 Train Summary: Avg Loss: 1.1851, Accuracy: 0.5844
  Validation Summary: Avg Loss: 1.6470, Accuracy: 0.3722, F1 (Macro): 0.3621
  New best model! Val loss improved from 1.6493 to 1.6470. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 1.1654
  Epoch 3 [Batch 4/40]: Loss: 0.8553
  Epoch 3 [Batch 8/40]: Loss: 1.1015
  Epoch 3 [Batch 12/40]: Loss: 1.2110
  Epoch 3 [Batch 16/40]: Loss: 0.5433
  Epoch 3 [Batch 20/40]: Loss: 3.8081
  Epoch 3 [Batch 24/40]: Loss: 1.6347
  Epoch 3 [Batch 28/40]: Loss: 1.4306
  Epoch 3 [Batch 32/40]: Loss: 0.9826
  Epoch 3 [Batch 36/40]: Loss: 0.4533
  Epoch 3 Train Summary: Avg Loss: 0.9751, Accuracy: 0.5464
  Validation Summary: Avg Loss: 1.2324, Accuracy: 0.4028, F1 (Macro): 0.3998
  New best model! Val loss improved from 1.6470 to 1.2324. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 0.2578
  Epoch 4 [Batch 4/40]: Loss: 0.6072
  Epoch 4 [Batch 8/40]: Loss: 1.1419
  Epoch 4 [Batch 12/40]: Loss: 0.5242
  Epoch 4 [Batch 16/40]: Loss: 1.8571
  Epoch 4 [Batch 20/40]: Loss: 0.4394
  Epoch 4 [Batch 24/40]: Loss: 1.5170
  Epoch 4 [Batch 28/40]: Loss: 0.3919
  Epoch 4 [Batch 32/40]: Loss: 0.5867
  Epoch 4 [Batch 36/40]: Loss: 1.5522
  Epoch 4 Train Summary: Avg Loss: 0.8180, Accuracy: 0.6724
  Validation Summary: Avg Loss: 1.0532, Accuracy: 0.4417, F1 (Macro): 0.4429
  New best model! Val loss improved from 1.2324 to 1.0532. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 0.3417
  Epoch 5 [Batch 4/40]: Loss: 0.9124
  Epoch 5 [Batch 8/40]: Loss: 0.9157
  Epoch 5 [Batch 12/40]: Loss: 0.1960
  Epoch 5 [Batch 16/40]: Loss: 0.6038
  Epoch 5 [Batch 20/40]: Loss: 0.9923
  Epoch 5 [Batch 24/40]: Loss: 0.0810
  Epoch 5 [Batch 28/40]: Loss: 0.5811
  Epoch 5 [Batch 32/40]: Loss: 0.6830
  Epoch 5 [Batch 36/40]: Loss: 1.5086
  Epoch 5 Train Summary: Avg Loss: 0.8608, Accuracy: 0.6885
  Validation Summary: Avg Loss: 1.0996, Accuracy: 0.4139, F1 (Macro): 0.4189

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 0.6878
  Epoch 6 [Batch 4/40]: Loss: 0.6874
  Epoch 6 [Batch 8/40]: Loss: 0.0205
  Epoch 6 [Batch 12/40]: Loss: 1.1081
  Epoch 6 [Batch 16/40]: Loss: 0.4900
  Epoch 6 [Batch 20/40]: Loss: 0.2527
  Epoch 6 [Batch 24/40]: Loss: 1.2260
  Epoch 6 [Batch 28/40]: Loss: 1.2130
  Epoch 6 [Batch 32/40]: Loss: 1.0634
  Epoch 6 [Batch 36/40]: Loss: 0.2480
  Epoch 6 Train Summary: Avg Loss: 0.6245, Accuracy: 0.7428
  Validation Summary: Avg Loss: 1.2764, Accuracy: 0.3472, F1 (Macro): 0.3492

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 0.5269
  Epoch 7 [Batch 4/40]: Loss: 0.3430
  Epoch 7 [Batch 8/40]: Loss: 0.8104
  Epoch 7 [Batch 12/40]: Loss: 0.3222
  Epoch 7 [Batch 16/40]: Loss: 0.0077
  Epoch 7 [Batch 20/40]: Loss: 0.8416
  Epoch 7 [Batch 24/40]: Loss: 0.4756
  Epoch 7 [Batch 28/40]: Loss: 1.0297
  Epoch 7 [Batch 32/40]: Loss: 0.9099
  Epoch 7 [Batch 36/40]: Loss: 0.8860
  Epoch 7 Train Summary: Avg Loss: 0.5828, Accuracy: 0.7947
  Validation Summary: Avg Loss: 1.1463, Accuracy: 0.3861, F1 (Macro): 0.3838

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.1256
  Epoch 8 [Batch 4/40]: Loss: 0.0721
  Epoch 8 [Batch 8/40]: Loss: 0.5768
  Epoch 8 [Batch 12/40]: Loss: 0.1538
  Epoch 8 [Batch 16/40]: Loss: 0.6972
  Epoch 8 [Batch 20/40]: Loss: 0.1232
  Epoch 8 [Batch 24/40]: Loss: 0.6780
  Epoch 8 [Batch 28/40]: Loss: 0.8634
  Epoch 8 [Batch 32/40]: Loss: 0.5359
  Epoch 8 [Batch 36/40]: Loss: 1.2411
  Epoch 8 Train Summary: Avg Loss: 0.5710, Accuracy: 0.7858
  Validation Summary: Avg Loss: 1.3582, Accuracy: 0.4417, F1 (Macro): 0.4397

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.3688
  Epoch 9 [Batch 4/40]: Loss: 0.5728
  Epoch 9 [Batch 8/40]: Loss: 0.2618
  Epoch 9 [Batch 12/40]: Loss: 0.1452
  Epoch 9 [Batch 16/40]: Loss: 0.1005
  Epoch 9 [Batch 20/40]: Loss: 0.7600
  Epoch 9 [Batch 24/40]: Loss: 0.3405
  Epoch 9 [Batch 28/40]: Loss: 0.1234
  Epoch 9 [Batch 32/40]: Loss: 0.1291
  Epoch 9 [Batch 36/40]: Loss: 0.1674
  Epoch 9 Train Summary: Avg Loss: 0.3845, Accuracy: 0.8125
  Validation Summary: Avg Loss: 1.0419, Accuracy: 0.4694, F1 (Macro): 0.4797
  New best model! Val loss improved from 1.0532 to 1.0419. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 0.5594
  Epoch 10 [Batch 4/40]: Loss: 0.1710
  Epoch 10 [Batch 8/40]: Loss: 0.5970
  Epoch 10 [Batch 12/40]: Loss: 0.9228
  Epoch 10 [Batch 16/40]: Loss: 0.0316
  Epoch 10 [Batch 20/40]: Loss: 0.4400
  Epoch 10 [Batch 24/40]: Loss: 0.0034
  Epoch 10 [Batch 28/40]: Loss: 0.1377
  Epoch 10 [Batch 32/40]: Loss: 0.3905
  Epoch 10 [Batch 36/40]: Loss: 0.0680
  Epoch 10 Train Summary: Avg Loss: 0.5039, Accuracy: 0.8323
  Validation Summary: Avg Loss: 1.3549, Accuracy: 0.4694, F1 (Macro): 0.4846

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.2740
  Epoch 11 [Batch 4/40]: Loss: 0.0850
  Epoch 11 [Batch 8/40]: Loss: 0.1766
  Epoch 11 [Batch 12/40]: Loss: 0.3811
  Epoch 11 [Batch 16/40]: Loss: 0.0784
  Epoch 11 [Batch 20/40]: Loss: 0.2754
  Epoch 11 [Batch 24/40]: Loss: 1.0078
  Epoch 11 [Batch 28/40]: Loss: 0.0685
  Epoch 11 [Batch 32/40]: Loss: 0.1793
  Epoch 11 [Batch 36/40]: Loss: 0.2638
  Epoch 11 Train Summary: Avg Loss: 0.3497, Accuracy: 0.8808
  Validation Summary: Avg Loss: 1.1921, Accuracy: 0.4417, F1 (Macro): 0.4514

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.2958
  Epoch 12 [Batch 4/40]: Loss: 0.0191
  Epoch 12 [Batch 8/40]: Loss: 0.9130
  Epoch 12 [Batch 12/40]: Loss: 0.1203
  Epoch 12 [Batch 16/40]: Loss: 0.3978
  Epoch 12 [Batch 20/40]: Loss: 0.6886
  Epoch 12 [Batch 24/40]: Loss: 0.0089
  Epoch 12 [Batch 28/40]: Loss: 0.4484
  Epoch 12 [Batch 32/40]: Loss: 1.0345
  Epoch 12 [Batch 36/40]: Loss: 0.1783
  Epoch 12 Train Summary: Avg Loss: 0.3794, Accuracy: 0.7991
  Validation Summary: Avg Loss: 1.0401, Accuracy: 0.4556, F1 (Macro): 0.4636
  New best model! Val loss improved from 1.0419 to 1.0401. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.1800
  Epoch 13 [Batch 4/40]: Loss: 0.0254
  Epoch 13 [Batch 8/40]: Loss: 0.0226
  Epoch 13 [Batch 12/40]: Loss: 0.4688
  Epoch 13 [Batch 16/40]: Loss: 0.2409
  Epoch 13 [Batch 20/40]: Loss: 0.0251
  Epoch 13 [Batch 24/40]: Loss: 0.3861
  Epoch 13 [Batch 28/40]: Loss: 0.3496
  Epoch 13 [Batch 32/40]: Loss: 0.7344
  Epoch 13 [Batch 36/40]: Loss: 0.4347
  Epoch 13 Train Summary: Avg Loss: 0.2898, Accuracy: 0.8928
  Validation Summary: Avg Loss: 1.2046, Accuracy: 0.3861, F1 (Macro): 0.3757

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 0.0711
  Epoch 14 [Batch 4/40]: Loss: 0.2021
  Epoch 14 [Batch 8/40]: Loss: 0.0565
  Epoch 14 [Batch 12/40]: Loss: 0.0166
  Epoch 14 [Batch 16/40]: Loss: 0.1211
  Epoch 14 [Batch 20/40]: Loss: 0.1159
  Epoch 14 [Batch 24/40]: Loss: 0.0014
  Epoch 14 [Batch 28/40]: Loss: 2.2505
  Epoch 14 [Batch 32/40]: Loss: 0.4034
  Epoch 14 [Batch 36/40]: Loss: 0.0045
  Epoch 14 Train Summary: Avg Loss: 0.3224, Accuracy: 0.8986
  Validation Summary: Avg Loss: 1.1310, Accuracy: 0.4667, F1 (Macro): 0.4533
Training finished in 8.85 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.0401, Accuracy: 0.4556, F1 (Macro): 0.4636
Final Best Model Stats: Acc: 0.4556, F1: 0.4636, Loss: 1.0401
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=224x224 lr=0.0001 drop=0.0 seed=123
================================================================================
Starting experiment: efficientnet_b0__224x224__lr-0.0001__drop-0.0__seed-123
Output directory: results_opg/efficientnet_b0__224x224__lr-0.0001__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 3.2826
  Epoch 0 [Batch 4/40]: Loss: 3.8751
  Epoch 0 [Batch 8/40]: Loss: 2.7691
  Epoch 0 [Batch 12/40]: Loss: 2.0552
  Epoch 0 [Batch 16/40]: Loss: 1.2415
  Epoch 0 [Batch 20/40]: Loss: 3.2694
  Epoch 0 [Batch 24/40]: Loss: 2.9935
  Epoch 0 [Batch 28/40]: Loss: 1.0011
  Epoch 0 [Batch 32/40]: Loss: 4.5763
  Epoch 0 [Batch 36/40]: Loss: 2.5175
  Epoch 0 Train Summary: Avg Loss: 2.5665, Accuracy: 0.3425
  Validation Summary: Avg Loss: 2.4962, Accuracy: 0.2361, F1 (Macro): 0.2361
  New best model! Val loss improved from inf to 2.4962. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 1.8996
  Epoch 1 [Batch 4/40]: Loss: 1.5645
  Epoch 1 [Batch 8/40]: Loss: 1.3513
  Epoch 1 [Batch 12/40]: Loss: 2.5612
  Epoch 1 [Batch 16/40]: Loss: 1.2034
  Epoch 1 [Batch 20/40]: Loss: 0.4035
  Epoch 1 [Batch 24/40]: Loss: 1.1852
  Epoch 1 [Batch 28/40]: Loss: 1.7497
  Epoch 1 [Batch 32/40]: Loss: 1.5642
  Epoch 1 [Batch 36/40]: Loss: 2.4139
  Epoch 1 Train Summary: Avg Loss: 1.7003, Accuracy: 0.4238
  Validation Summary: Avg Loss: 1.9215, Accuracy: 0.2500, F1 (Macro): 0.2621
  New best model! Val loss improved from 2.4962 to 1.9215. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.6476
  Epoch 2 [Batch 4/40]: Loss: 2.4356
  Epoch 2 [Batch 8/40]: Loss: 1.3957
  Epoch 2 [Batch 12/40]: Loss: 0.6901
  Epoch 2 [Batch 16/40]: Loss: 0.9000
  Epoch 2 [Batch 20/40]: Loss: 1.9905
  Epoch 2 [Batch 24/40]: Loss: 1.1820
  Epoch 2 [Batch 28/40]: Loss: 0.5758
  Epoch 2 [Batch 32/40]: Loss: 0.8156
  Epoch 2 [Batch 36/40]: Loss: 2.3495
  Epoch 2 Train Summary: Avg Loss: 1.4647, Accuracy: 0.5118
  Validation Summary: Avg Loss: 2.0003, Accuracy: 0.3333, F1 (Macro): 0.3117

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 0.5865
  Epoch 3 [Batch 4/40]: Loss: 0.8089
  Epoch 3 [Batch 8/40]: Loss: 1.2229
  Epoch 3 [Batch 12/40]: Loss: 1.1531
  Epoch 3 [Batch 16/40]: Loss: 1.7085
  Epoch 3 [Batch 20/40]: Loss: 0.4266
  Epoch 3 [Batch 24/40]: Loss: 1.2121
  Epoch 3 [Batch 28/40]: Loss: 1.4903
  Epoch 3 [Batch 32/40]: Loss: 1.5882
  Epoch 3 [Batch 36/40]: Loss: 0.5929
  Epoch 3 Train Summary: Avg Loss: 1.1896, Accuracy: 0.5822
  Validation Summary: Avg Loss: 1.8067, Accuracy: 0.3444, F1 (Macro): 0.3418
  New best model! Val loss improved from 1.9215 to 1.8067. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 0.7886
  Epoch 4 [Batch 4/40]: Loss: 1.8379
  Epoch 4 [Batch 8/40]: Loss: 1.0941
  Epoch 4 [Batch 12/40]: Loss: 0.9298
  Epoch 4 [Batch 16/40]: Loss: 0.3640
  Epoch 4 [Batch 20/40]: Loss: 0.3276
  Epoch 4 [Batch 24/40]: Loss: 0.4471
  Epoch 4 [Batch 28/40]: Loss: 1.1695
  Epoch 4 [Batch 32/40]: Loss: 0.8826
  Epoch 4 [Batch 36/40]: Loss: 0.0739
  Epoch 4 Train Summary: Avg Loss: 0.9185, Accuracy: 0.6456
  Validation Summary: Avg Loss: 1.9274, Accuracy: 0.2500, F1 (Macro): 0.2320

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 0.7533
  Epoch 5 [Batch 4/40]: Loss: 0.9543
  Epoch 5 [Batch 8/40]: Loss: 0.6042
  Epoch 5 [Batch 12/40]: Loss: 0.9037
  Epoch 5 [Batch 16/40]: Loss: 1.0858
  Epoch 5 [Batch 20/40]: Loss: 0.7449
  Epoch 5 [Batch 24/40]: Loss: 0.3478
  Epoch 5 [Batch 28/40]: Loss: 1.4029
  Epoch 5 [Batch 32/40]: Loss: 0.9847
  Epoch 5 [Batch 36/40]: Loss: 0.7705
  Epoch 5 Train Summary: Avg Loss: 0.8374, Accuracy: 0.6279
  Validation Summary: Avg Loss: 1.9660, Accuracy: 0.2750, F1 (Macro): 0.2677

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 0.4496
  Epoch 6 [Batch 4/40]: Loss: 0.4020
  Epoch 6 [Batch 8/40]: Loss: 0.4696
  Epoch 6 [Batch 12/40]: Loss: 0.2020
  Epoch 6 [Batch 16/40]: Loss: 0.5229
  Epoch 6 [Batch 20/40]: Loss: 0.4551
  Epoch 6 [Batch 24/40]: Loss: 0.3554
  Epoch 6 [Batch 28/40]: Loss: 1.0430
  Epoch 6 [Batch 32/40]: Loss: 0.8057
  Epoch 6 [Batch 36/40]: Loss: 0.5787
  Epoch 6 Train Summary: Avg Loss: 0.6063, Accuracy: 0.7389
  Validation Summary: Avg Loss: 1.9914, Accuracy: 0.3028, F1 (Macro): 0.2977

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 0.0583
  Epoch 7 [Batch 4/40]: Loss: 0.4209
  Epoch 7 [Batch 8/40]: Loss: 0.1446
  Epoch 7 [Batch 12/40]: Loss: 0.0138
  Epoch 7 [Batch 16/40]: Loss: 0.9430
  Epoch 7 [Batch 20/40]: Loss: 0.8240
  Epoch 7 [Batch 24/40]: Loss: 0.6232
  Epoch 7 [Batch 28/40]: Loss: 0.5242
  Epoch 7 [Batch 32/40]: Loss: 0.3928
  Epoch 7 [Batch 36/40]: Loss: 0.2909
  Epoch 7 Train Summary: Avg Loss: 0.6376, Accuracy: 0.7531
  Validation Summary: Avg Loss: 1.9368, Accuracy: 0.3167, F1 (Macro): 0.3180

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.7901
  Epoch 8 [Batch 4/40]: Loss: 0.3710
  Epoch 8 [Batch 8/40]: Loss: 0.3504
  Epoch 8 [Batch 12/40]: Loss: 1.3247
  Epoch 8 [Batch 16/40]: Loss: 0.1681
  Epoch 8 [Batch 20/40]: Loss: 0.5320
  Epoch 8 [Batch 24/40]: Loss: 0.7140
  Epoch 8 [Batch 28/40]: Loss: 0.2931
  Epoch 8 [Batch 32/40]: Loss: 0.9036
  Epoch 8 [Batch 36/40]: Loss: 0.9065
  Epoch 8 Train Summary: Avg Loss: 0.5754, Accuracy: 0.7415
  Validation Summary: Avg Loss: 2.1091, Accuracy: 0.3556, F1 (Macro): 0.3236

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.1615
  Epoch 9 [Batch 4/40]: Loss: 0.4261
  Epoch 9 [Batch 8/40]: Loss: 0.9991
  Epoch 9 [Batch 12/40]: Loss: 0.0894
  Epoch 9 [Batch 16/40]: Loss: 1.0651
  Epoch 9 [Batch 20/40]: Loss: 0.6908
  Epoch 9 [Batch 24/40]: Loss: 1.0799
  Epoch 9 [Batch 28/40]: Loss: 0.3012
  Epoch 9 [Batch 32/40]: Loss: 0.1091
  Epoch 9 [Batch 36/40]: Loss: 0.7794
  Epoch 9 Train Summary: Avg Loss: 0.4897, Accuracy: 0.7567
  Validation Summary: Avg Loss: 1.7451, Accuracy: 0.3167, F1 (Macro): 0.3185
  New best model! Val loss improved from 1.8067 to 1.7451. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 0.2467
  Epoch 10 [Batch 4/40]: Loss: 0.1653
  Epoch 10 [Batch 8/40]: Loss: 0.3455
  Epoch 10 [Batch 12/40]: Loss: 0.0350
  Epoch 10 [Batch 16/40]: Loss: 0.2854
  Epoch 10 [Batch 20/40]: Loss: 0.5278
  Epoch 10 [Batch 24/40]: Loss: 0.1141
  Epoch 10 [Batch 28/40]: Loss: 1.2884
  Epoch 10 [Batch 32/40]: Loss: 0.3522
  Epoch 10 [Batch 36/40]: Loss: 0.9214
  Epoch 10 Train Summary: Avg Loss: 0.4015, Accuracy: 0.8144
  Validation Summary: Avg Loss: 1.8327, Accuracy: 0.3861, F1 (Macro): 0.3942

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.2679
  Epoch 11 [Batch 4/40]: Loss: 0.7141
  Epoch 11 [Batch 8/40]: Loss: 0.1441
  Epoch 11 [Batch 12/40]: Loss: 0.6498
  Epoch 11 [Batch 16/40]: Loss: 1.2522
  Epoch 11 [Batch 20/40]: Loss: 0.4706
  Epoch 11 [Batch 24/40]: Loss: 0.2627
  Epoch 11 [Batch 28/40]: Loss: 0.2352
  Epoch 11 [Batch 32/40]: Loss: 0.2578
  Epoch 11 [Batch 36/40]: Loss: 0.2784
  Epoch 11 Train Summary: Avg Loss: 0.4270, Accuracy: 0.8116
  Validation Summary: Avg Loss: 1.5391, Accuracy: 0.3444, F1 (Macro): 0.3374
  New best model! Val loss improved from 1.7451 to 1.5391. Saving...

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.7010
  Epoch 12 [Batch 4/40]: Loss: 0.3258
  Epoch 12 [Batch 8/40]: Loss: 0.2060
  Epoch 12 [Batch 12/40]: Loss: 0.4018
  Epoch 12 [Batch 16/40]: Loss: 0.6905
  Epoch 12 [Batch 20/40]: Loss: 0.7487
  Epoch 12 [Batch 24/40]: Loss: 0.1396
  Epoch 12 [Batch 28/40]: Loss: 0.2437
  Epoch 12 [Batch 32/40]: Loss: 0.2844
  Epoch 12 [Batch 36/40]: Loss: 0.1910
  Epoch 12 Train Summary: Avg Loss: 0.3486, Accuracy: 0.8642
  Validation Summary: Avg Loss: 1.8225, Accuracy: 0.3722, F1 (Macro): 0.3559

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.0553
  Epoch 13 [Batch 4/40]: Loss: 0.1556
  Epoch 13 [Batch 8/40]: Loss: 0.8045
  Epoch 13 [Batch 12/40]: Loss: 1.0370
  Epoch 13 [Batch 16/40]: Loss: 0.4784
  Epoch 13 [Batch 20/40]: Loss: 0.7351
  Epoch 13 [Batch 24/40]: Loss: 0.1441
  Epoch 13 [Batch 28/40]: Loss: 0.1795
  Epoch 13 [Batch 32/40]: Loss: 0.5395
  Epoch 13 [Batch 36/40]: Loss: 0.2963
  Epoch 13 Train Summary: Avg Loss: 0.3207, Accuracy: 0.8451
  Validation Summary: Avg Loss: 1.8626, Accuracy: 0.3306, F1 (Macro): 0.3136

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 0.1674
  Epoch 14 [Batch 4/40]: Loss: 0.1855
  Epoch 14 [Batch 8/40]: Loss: 1.2940
  Epoch 14 [Batch 12/40]: Loss: 0.2839
  Epoch 14 [Batch 16/40]: Loss: 0.0867
  Epoch 14 [Batch 20/40]: Loss: 0.4846
  Epoch 14 [Batch 24/40]: Loss: 0.0228
  Epoch 14 [Batch 28/40]: Loss: 0.1552
  Epoch 14 [Batch 32/40]: Loss: 0.1469
  Epoch 14 [Batch 36/40]: Loss: 0.2169
  Epoch 14 Train Summary: Avg Loss: 0.2622, Accuracy: 0.8933
  Validation Summary: Avg Loss: 1.9174, Accuracy: 0.2750, F1 (Macro): 0.2702
Training finished in 8.07 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.5391, Accuracy: 0.3444, F1 (Macro): 0.3374
Final Best Model Stats: Acc: 0.3444, F1: 0.3374, Loss: 1.5391
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=224x224 lr=0.0001 drop=0.0 seed=999
================================================================================
Starting experiment: efficientnet_b0__224x224__lr-0.0001__drop-0.0__seed-999
Output directory: results_opg/efficientnet_b0__224x224__lr-0.0001__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 2.2709
  Epoch 0 [Batch 4/40]: Loss: 2.2170
  Epoch 0 [Batch 8/40]: Loss: 2.0030
  Epoch 0 [Batch 12/40]: Loss: 2.5506
  Epoch 0 [Batch 16/40]: Loss: 1.7197
  Epoch 0 [Batch 20/40]: Loss: 3.2138
  Epoch 0 [Batch 24/40]: Loss: 3.4066
  Epoch 0 [Batch 28/40]: Loss: 3.9331
  Epoch 0 [Batch 32/40]: Loss: 4.1425
  Epoch 0 [Batch 36/40]: Loss: 1.5457
  Epoch 0 Train Summary: Avg Loss: 2.3966, Accuracy: 0.3383
  Validation Summary: Avg Loss: 2.8051, Accuracy: 0.4361, F1 (Macro): 0.3724
  New best model! Val loss improved from inf to 2.8051. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 1.7621
  Epoch 1 [Batch 4/40]: Loss: 1.1103
  Epoch 1 [Batch 8/40]: Loss: 1.1154
  Epoch 1 [Batch 12/40]: Loss: 1.2116
  Epoch 1 [Batch 16/40]: Loss: 1.0055
  Epoch 1 [Batch 20/40]: Loss: 1.1201
  Epoch 1 [Batch 24/40]: Loss: 0.6664
  Epoch 1 [Batch 28/40]: Loss: 2.2742
  Epoch 1 [Batch 32/40]: Loss: 1.9887
  Epoch 1 [Batch 36/40]: Loss: 1.6753
  Epoch 1 Train Summary: Avg Loss: 1.6354, Accuracy: 0.4555
  Validation Summary: Avg Loss: 1.5595, Accuracy: 0.3194, F1 (Macro): 0.3250
  New best model! Val loss improved from 2.8051 to 1.5595. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.7448
  Epoch 2 [Batch 4/40]: Loss: 2.3066
  Epoch 2 [Batch 8/40]: Loss: 0.2901
  Epoch 2 [Batch 12/40]: Loss: 2.3954
  Epoch 2 [Batch 16/40]: Loss: 1.4463
  Epoch 2 [Batch 20/40]: Loss: 0.5929
  Epoch 2 [Batch 24/40]: Loss: 1.8437
  Epoch 2 [Batch 28/40]: Loss: 1.7984
  Epoch 2 [Batch 32/40]: Loss: 2.1997
  Epoch 2 [Batch 36/40]: Loss: 1.7534
  Epoch 2 Train Summary: Avg Loss: 1.3462, Accuracy: 0.5123
  Validation Summary: Avg Loss: 1.4723, Accuracy: 0.5611, F1 (Macro): 0.5260
  New best model! Val loss improved from 1.5595 to 1.4723. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 1.5644
  Epoch 3 [Batch 4/40]: Loss: 0.6898
  Epoch 3 [Batch 8/40]: Loss: 1.1520
  Epoch 3 [Batch 12/40]: Loss: 1.6592
  Epoch 3 [Batch 16/40]: Loss: 0.4726
  Epoch 3 [Batch 20/40]: Loss: 0.4152
  Epoch 3 [Batch 24/40]: Loss: 0.8926
  Epoch 3 [Batch 28/40]: Loss: 0.5436
  Epoch 3 [Batch 32/40]: Loss: 1.0364
  Epoch 3 [Batch 36/40]: Loss: 0.8398
  Epoch 3 Train Summary: Avg Loss: 1.0284, Accuracy: 0.5747
  Validation Summary: Avg Loss: 1.4798, Accuracy: 0.4556, F1 (Macro): 0.4454

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 0.4792
  Epoch 4 [Batch 4/40]: Loss: 0.8128
  Epoch 4 [Batch 8/40]: Loss: 1.9228
  Epoch 4 [Batch 12/40]: Loss: 0.7634
  Epoch 4 [Batch 16/40]: Loss: 2.0770
  Epoch 4 [Batch 20/40]: Loss: 0.7513
  Epoch 4 [Batch 24/40]: Loss: 0.7250
  Epoch 4 [Batch 28/40]: Loss: 2.6484
  Epoch 4 [Batch 32/40]: Loss: 0.6797
  Epoch 4 [Batch 36/40]: Loss: 0.7079
  Epoch 4 Train Summary: Avg Loss: 0.8654, Accuracy: 0.6152
  Validation Summary: Avg Loss: 1.9191, Accuracy: 0.5167, F1 (Macro): 0.3739

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 0.4675
  Epoch 5 [Batch 4/40]: Loss: 2.5533
  Epoch 5 [Batch 8/40]: Loss: 1.0288
  Epoch 5 [Batch 12/40]: Loss: 0.9142
  Epoch 5 [Batch 16/40]: Loss: 0.8760
  Epoch 5 [Batch 20/40]: Loss: 0.5197
  Epoch 5 [Batch 24/40]: Loss: 0.6591
  Epoch 5 [Batch 28/40]: Loss: 1.9329
  Epoch 5 [Batch 32/40]: Loss: 1.1112
  Epoch 5 [Batch 36/40]: Loss: 0.0620
  Epoch 5 Train Summary: Avg Loss: 0.7874, Accuracy: 0.6857
  Validation Summary: Avg Loss: 1.3300, Accuracy: 0.4667, F1 (Macro): 0.4529
  New best model! Val loss improved from 1.4723 to 1.3300. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 0.8222
  Epoch 6 [Batch 4/40]: Loss: 0.4448
  Epoch 6 [Batch 8/40]: Loss: 0.1661
  Epoch 6 [Batch 12/40]: Loss: 0.6181
  Epoch 6 [Batch 16/40]: Loss: 0.3628
  Epoch 6 [Batch 20/40]: Loss: 1.1365
  Epoch 6 [Batch 24/40]: Loss: 0.0261
  Epoch 6 [Batch 28/40]: Loss: 0.9100
  Epoch 6 [Batch 32/40]: Loss: 1.4630
  Epoch 6 [Batch 36/40]: Loss: 0.3903
  Epoch 6 Train Summary: Avg Loss: 0.5950, Accuracy: 0.7332
  Validation Summary: Avg Loss: 1.4288, Accuracy: 0.3333, F1 (Macro): 0.3289

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 0.5678
  Epoch 7 [Batch 4/40]: Loss: 0.7156
  Epoch 7 [Batch 8/40]: Loss: 0.8523
  Epoch 7 [Batch 12/40]: Loss: 0.0890
  Epoch 7 [Batch 16/40]: Loss: 0.0518
  Epoch 7 [Batch 20/40]: Loss: 1.0350
  Epoch 7 [Batch 24/40]: Loss: 0.6505
  Epoch 7 [Batch 28/40]: Loss: 0.7575
  Epoch 7 [Batch 32/40]: Loss: 0.7444
  Epoch 7 [Batch 36/40]: Loss: 0.5244
  Epoch 7 Train Summary: Avg Loss: 0.6901, Accuracy: 0.7110
  Validation Summary: Avg Loss: 1.4456, Accuracy: 0.4028, F1 (Macro): 0.3783

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.2933
  Epoch 8 [Batch 4/40]: Loss: 0.1985
  Epoch 8 [Batch 8/40]: Loss: 0.7499
  Epoch 8 [Batch 12/40]: Loss: 0.4429
  Epoch 8 [Batch 16/40]: Loss: 1.1142
  Epoch 8 [Batch 20/40]: Loss: 0.3412
  Epoch 8 [Batch 24/40]: Loss: 0.7412
  Epoch 8 [Batch 28/40]: Loss: 1.7673
  Epoch 8 [Batch 32/40]: Loss: 0.0524
  Epoch 8 [Batch 36/40]: Loss: 0.8294
  Epoch 8 Train Summary: Avg Loss: 0.6408, Accuracy: 0.7534
  Validation Summary: Avg Loss: 1.2409, Accuracy: 0.4694, F1 (Macro): 0.4606
  New best model! Val loss improved from 1.3300 to 1.2409. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.7902
  Epoch 9 [Batch 4/40]: Loss: 0.8810
  Epoch 9 [Batch 8/40]: Loss: 0.0500
  Epoch 9 [Batch 12/40]: Loss: 0.6077
  Epoch 9 [Batch 16/40]: Loss: 0.8718
  Epoch 9 [Batch 20/40]: Loss: 0.7637
  Epoch 9 [Batch 24/40]: Loss: 0.2218
  Epoch 9 [Batch 28/40]: Loss: 0.1731
  Epoch 9 [Batch 32/40]: Loss: 0.8618
  Epoch 9 [Batch 36/40]: Loss: 0.0275
  Epoch 9 Train Summary: Avg Loss: 0.4722, Accuracy: 0.8111
  Validation Summary: Avg Loss: 1.4540, Accuracy: 0.4028, F1 (Macro): 0.3904

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 0.0529
  Epoch 10 [Batch 4/40]: Loss: 0.1911
  Epoch 10 [Batch 8/40]: Loss: 0.0547
  Epoch 10 [Batch 12/40]: Loss: 0.2586
  Epoch 10 [Batch 16/40]: Loss: 0.9520
  Epoch 10 [Batch 20/40]: Loss: 0.4399
  Epoch 10 [Batch 24/40]: Loss: 0.1131
  Epoch 10 [Batch 28/40]: Loss: 0.0207
  Epoch 10 [Batch 32/40]: Loss: 0.2995
  Epoch 10 [Batch 36/40]: Loss: 0.2655
  Epoch 10 Train Summary: Avg Loss: 0.3730, Accuracy: 0.8541
  Validation Summary: Avg Loss: 1.3030, Accuracy: 0.3889, F1 (Macro): 0.3742

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.3656
  Epoch 11 [Batch 4/40]: Loss: 0.1561
  Epoch 11 [Batch 8/40]: Loss: 0.4739
  Epoch 11 [Batch 12/40]: Loss: 0.2195
  Epoch 11 [Batch 16/40]: Loss: 0.6500
  Epoch 11 [Batch 20/40]: Loss: 0.3422
  Epoch 11 [Batch 24/40]: Loss: 0.9487
  Epoch 11 [Batch 28/40]: Loss: 0.7220
  Epoch 11 [Batch 32/40]: Loss: 0.1806
  Epoch 11 [Batch 36/40]: Loss: 0.0660
  Epoch 11 Train Summary: Avg Loss: 0.3292, Accuracy: 0.8296
  Validation Summary: Avg Loss: 1.6376, Accuracy: 0.3333, F1 (Macro): 0.3131

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.0123
  Epoch 12 [Batch 4/40]: Loss: 0.0620
  Epoch 12 [Batch 8/40]: Loss: 0.4730
  Epoch 12 [Batch 12/40]: Loss: 0.6304
  Epoch 12 [Batch 16/40]: Loss: 0.0725
  Epoch 12 [Batch 20/40]: Loss: 1.0319
  Epoch 12 [Batch 24/40]: Loss: 0.0739
  Epoch 12 [Batch 28/40]: Loss: 0.0181
  Epoch 12 [Batch 32/40]: Loss: 0.2167
  Epoch 12 [Batch 36/40]: Loss: 0.3046
  Epoch 12 Train Summary: Avg Loss: 0.3567, Accuracy: 0.8741
  Validation Summary: Avg Loss: 1.4142, Accuracy: 0.4028, F1 (Macro): 0.3790

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.4222
  Epoch 13 [Batch 4/40]: Loss: 0.7010
  Epoch 13 [Batch 8/40]: Loss: 0.3033
  Epoch 13 [Batch 12/40]: Loss: 0.4906
  Epoch 13 [Batch 16/40]: Loss: 0.0137
  Epoch 13 [Batch 20/40]: Loss: 0.5852
  Epoch 13 [Batch 24/40]: Loss: 0.1237
  Epoch 13 [Batch 28/40]: Loss: 0.4581
  Epoch 13 [Batch 32/40]: Loss: 0.9747
  Epoch 13 [Batch 36/40]: Loss: 0.5500
  Epoch 13 Train Summary: Avg Loss: 0.3258, Accuracy: 0.8850
  Validation Summary: Avg Loss: 1.3402, Accuracy: 0.4833, F1 (Macro): 0.4972

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 0.5958
  Epoch 14 [Batch 4/40]: Loss: 0.0475
  Epoch 14 [Batch 8/40]: Loss: 0.4290
  Epoch 14 [Batch 12/40]: Loss: 0.0493
  Epoch 14 [Batch 16/40]: Loss: 0.3962
  Epoch 14 [Batch 20/40]: Loss: 0.0346
  Epoch 14 [Batch 24/40]: Loss: 0.0575
  Epoch 14 [Batch 28/40]: Loss: 0.4469
  Epoch 14 [Batch 32/40]: Loss: 0.9530
  Epoch 14 [Batch 36/40]: Loss: 0.0237
  Epoch 14 Train Summary: Avg Loss: 0.3026, Accuracy: 0.8347
  Validation Summary: Avg Loss: 1.5464, Accuracy: 0.4417, F1 (Macro): 0.4512
Training finished in 8.02 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.2409, Accuracy: 0.4694, F1 (Macro): 0.4606
Final Best Model Stats: Acc: 0.4694, F1: 0.4606, Loss: 1.2409
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=224x224 lr=5e-05 drop=0.0 seed=42
================================================================================
Starting experiment: efficientnet_b0__224x224__lr-5e-05__drop-0.0__seed-42
Output directory: results_opg/efficientnet_b0__224x224__lr-5e-05__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 2.0874
  Epoch 0 [Batch 4/40]: Loss: 3.5309
  Epoch 0 [Batch 8/40]: Loss: 1.7329
  Epoch 0 [Batch 12/40]: Loss: 1.2163
  Epoch 0 [Batch 16/40]: Loss: 1.9370
  Epoch 0 [Batch 20/40]: Loss: 1.2895
  Epoch 0 [Batch 24/40]: Loss: 3.1549
  Epoch 0 [Batch 28/40]: Loss: 1.6043
  Epoch 0 [Batch 32/40]: Loss: 3.3157
  Epoch 0 [Batch 36/40]: Loss: 1.5842
  Epoch 0 Train Summary: Avg Loss: 2.3940, Accuracy: 0.3454
  Validation Summary: Avg Loss: 2.1657, Accuracy: 0.4556, F1 (Macro): 0.3786
  New best model! Val loss improved from inf to 2.1657. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 1.7369
  Epoch 1 [Batch 4/40]: Loss: 2.0143
  Epoch 1 [Batch 8/40]: Loss: 1.0354
  Epoch 1 [Batch 12/40]: Loss: 1.0431
  Epoch 1 [Batch 16/40]: Loss: 2.5998
  Epoch 1 [Batch 20/40]: Loss: 1.9715
  Epoch 1 [Batch 24/40]: Loss: 4.2555
  Epoch 1 [Batch 28/40]: Loss: 1.2777
  Epoch 1 [Batch 32/40]: Loss: 0.9801
  Epoch 1 [Batch 36/40]: Loss: 1.6492
  Epoch 1 Train Summary: Avg Loss: 1.6995, Accuracy: 0.3849
  Validation Summary: Avg Loss: 1.8411, Accuracy: 0.4389, F1 (Macro): 0.4189
  New best model! Val loss improved from 2.1657 to 1.8411. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.0292
  Epoch 2 [Batch 4/40]: Loss: 1.5157
  Epoch 2 [Batch 8/40]: Loss: 1.7174
  Epoch 2 [Batch 12/40]: Loss: 1.1641
  Epoch 2 [Batch 16/40]: Loss: 1.2945
  Epoch 2 [Batch 20/40]: Loss: 2.3144
  Epoch 2 [Batch 24/40]: Loss: 2.6223
  Epoch 2 [Batch 28/40]: Loss: 1.2586
  Epoch 2 [Batch 32/40]: Loss: 1.7710
  Epoch 2 [Batch 36/40]: Loss: 1.5558
  Epoch 2 Train Summary: Avg Loss: 1.4716, Accuracy: 0.4638
  Validation Summary: Avg Loss: 1.6385, Accuracy: 0.2917, F1 (Macro): 0.3139
  New best model! Val loss improved from 1.8411 to 1.6385. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 2.1369
  Epoch 3 [Batch 4/40]: Loss: 1.4246
  Epoch 3 [Batch 8/40]: Loss: 1.2320
  Epoch 3 [Batch 12/40]: Loss: 1.8780
  Epoch 3 [Batch 16/40]: Loss: 0.4132
  Epoch 3 [Batch 20/40]: Loss: 3.5381
  Epoch 3 [Batch 24/40]: Loss: 1.5331
  Epoch 3 [Batch 28/40]: Loss: 1.4211
  Epoch 3 [Batch 32/40]: Loss: 1.3739
  Epoch 3 [Batch 36/40]: Loss: 0.8602
  Epoch 3 Train Summary: Avg Loss: 1.1119, Accuracy: 0.5363
  Validation Summary: Avg Loss: 1.5030, Accuracy: 0.2917, F1 (Macro): 0.3019
  New best model! Val loss improved from 1.6385 to 1.5030. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 0.3636
  Epoch 4 [Batch 4/40]: Loss: 1.1694
  Epoch 4 [Batch 8/40]: Loss: 1.0807
  Epoch 4 [Batch 12/40]: Loss: 0.5459
  Epoch 4 [Batch 16/40]: Loss: 2.1576
  Epoch 4 [Batch 20/40]: Loss: 0.6757
  Epoch 4 [Batch 24/40]: Loss: 1.2482
  Epoch 4 [Batch 28/40]: Loss: 0.7838
  Epoch 4 [Batch 32/40]: Loss: 0.7740
  Epoch 4 [Batch 36/40]: Loss: 1.9558
  Epoch 4 Train Summary: Avg Loss: 0.9657, Accuracy: 0.5865
  Validation Summary: Avg Loss: 1.5548, Accuracy: 0.2917, F1 (Macro): 0.3019

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 0.3922
  Epoch 5 [Batch 4/40]: Loss: 1.2163
  Epoch 5 [Batch 8/40]: Loss: 1.0523
  Epoch 5 [Batch 12/40]: Loss: 0.4263
  Epoch 5 [Batch 16/40]: Loss: 0.6853
  Epoch 5 [Batch 20/40]: Loss: 0.8561
  Epoch 5 [Batch 24/40]: Loss: 0.5212
  Epoch 5 [Batch 28/40]: Loss: 0.6868
  Epoch 5 [Batch 32/40]: Loss: 0.5558
  Epoch 5 [Batch 36/40]: Loss: 1.4641
  Epoch 5 Train Summary: Avg Loss: 1.0684, Accuracy: 0.5975
  Validation Summary: Avg Loss: 1.4060, Accuracy: 0.4000, F1 (Macro): 0.4133
  New best model! Val loss improved from 1.5030 to 1.4060. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 0.4299
  Epoch 6 [Batch 4/40]: Loss: 1.5475
  Epoch 6 [Batch 8/40]: Loss: 0.1129
  Epoch 6 [Batch 12/40]: Loss: 1.5474
  Epoch 6 [Batch 16/40]: Loss: 0.5920
  Epoch 6 [Batch 20/40]: Loss: 0.4412
  Epoch 6 [Batch 24/40]: Loss: 1.6604
  Epoch 6 [Batch 28/40]: Loss: 0.9522
  Epoch 6 [Batch 32/40]: Loss: 1.0311
  Epoch 6 [Batch 36/40]: Loss: 0.3740
  Epoch 6 Train Summary: Avg Loss: 0.7929, Accuracy: 0.6794
  Validation Summary: Avg Loss: 1.4113, Accuracy: 0.3861, F1 (Macro): 0.3907

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 0.8970
  Epoch 7 [Batch 4/40]: Loss: 0.5775
  Epoch 7 [Batch 8/40]: Loss: 1.1410
  Epoch 7 [Batch 12/40]: Loss: 0.3898
  Epoch 7 [Batch 16/40]: Loss: 0.1785
  Epoch 7 [Batch 20/40]: Loss: 2.1113
  Epoch 7 [Batch 24/40]: Loss: 0.2070
  Epoch 7 [Batch 28/40]: Loss: 0.9329
  Epoch 7 [Batch 32/40]: Loss: 0.6619
  Epoch 7 [Batch 36/40]: Loss: 1.2690
  Epoch 7 Train Summary: Avg Loss: 0.7770, Accuracy: 0.7086
  Validation Summary: Avg Loss: 1.3661, Accuracy: 0.3194, F1 (Macro): 0.3481
  New best model! Val loss improved from 1.4060 to 1.3661. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.4822
  Epoch 8 [Batch 4/40]: Loss: 0.1237
  Epoch 8 [Batch 8/40]: Loss: 0.9825
  Epoch 8 [Batch 12/40]: Loss: 0.4242
  Epoch 8 [Batch 16/40]: Loss: 0.7909
  Epoch 8 [Batch 20/40]: Loss: 0.1247
  Epoch 8 [Batch 24/40]: Loss: 1.3172
  Epoch 8 [Batch 28/40]: Loss: 0.6021
  Epoch 8 [Batch 32/40]: Loss: 0.7015
  Epoch 8 [Batch 36/40]: Loss: 1.6005
  Epoch 8 Train Summary: Avg Loss: 0.8191, Accuracy: 0.6245
  Validation Summary: Avg Loss: 1.3347, Accuracy: 0.3861, F1 (Macro): 0.4013
  New best model! Val loss improved from 1.3661 to 1.3347. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.4637
  Epoch 9 [Batch 4/40]: Loss: 0.8066
  Epoch 9 [Batch 8/40]: Loss: 0.2891
  Epoch 9 [Batch 12/40]: Loss: 0.4569
  Epoch 9 [Batch 16/40]: Loss: 0.2700
  Epoch 9 [Batch 20/40]: Loss: 2.1689
  Epoch 9 [Batch 24/40]: Loss: 0.5881
  Epoch 9 [Batch 28/40]: Loss: 0.5820
  Epoch 9 [Batch 32/40]: Loss: 0.2601
  Epoch 9 [Batch 36/40]: Loss: 0.5439
  Epoch 9 Train Summary: Avg Loss: 0.5983, Accuracy: 0.7244
  Validation Summary: Avg Loss: 1.0021, Accuracy: 0.3750, F1 (Macro): 0.3750
  New best model! Val loss improved from 1.3347 to 1.0021. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 0.7804
  Epoch 10 [Batch 4/40]: Loss: 0.2020
  Epoch 10 [Batch 8/40]: Loss: 0.6260
  Epoch 10 [Batch 12/40]: Loss: 1.4496
  Epoch 10 [Batch 16/40]: Loss: 0.2416
  Epoch 10 [Batch 20/40]: Loss: 0.9836
  Epoch 10 [Batch 24/40]: Loss: 0.0344
  Epoch 10 [Batch 28/40]: Loss: 0.4570
  Epoch 10 [Batch 32/40]: Loss: 0.9232
  Epoch 10 [Batch 36/40]: Loss: 0.3413
  Epoch 10 Train Summary: Avg Loss: 0.6334, Accuracy: 0.7570
  Validation Summary: Avg Loss: 1.1810, Accuracy: 0.4278, F1 (Macro): 0.4290

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 1.0930
  Epoch 11 [Batch 4/40]: Loss: 0.2264
  Epoch 11 [Batch 8/40]: Loss: 0.3435
  Epoch 11 [Batch 12/40]: Loss: 1.6361
  Epoch 11 [Batch 16/40]: Loss: 0.1437
  Epoch 11 [Batch 20/40]: Loss: 0.7680
  Epoch 11 [Batch 24/40]: Loss: 0.5546
  Epoch 11 [Batch 28/40]: Loss: 0.1054
  Epoch 11 [Batch 32/40]: Loss: 0.2639
  Epoch 11 [Batch 36/40]: Loss: 0.1316
  Epoch 11 Train Summary: Avg Loss: 0.5471, Accuracy: 0.7395
  Validation Summary: Avg Loss: 1.1903, Accuracy: 0.3889, F1 (Macro): 0.4103

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.7529
  Epoch 12 [Batch 4/40]: Loss: 0.0483
  Epoch 12 [Batch 8/40]: Loss: 0.5245
  Epoch 12 [Batch 12/40]: Loss: 0.1361
  Epoch 12 [Batch 16/40]: Loss: 0.3327
  Epoch 12 [Batch 20/40]: Loss: 0.4847
  Epoch 12 [Batch 24/40]: Loss: 0.1420
  Epoch 12 [Batch 28/40]: Loss: 1.1298
  Epoch 12 [Batch 32/40]: Loss: 1.3537
  Epoch 12 [Batch 36/40]: Loss: 0.7510
  Epoch 12 Train Summary: Avg Loss: 0.5675, Accuracy: 0.7282
  Validation Summary: Avg Loss: 1.0541, Accuracy: 0.3472, F1 (Macro): 0.3750

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.2906
  Epoch 13 [Batch 4/40]: Loss: 0.0335
  Epoch 13 [Batch 8/40]: Loss: 0.4075
  Epoch 13 [Batch 12/40]: Loss: 0.4028
  Epoch 13 [Batch 16/40]: Loss: 0.5166
  Epoch 13 [Batch 20/40]: Loss: 0.3182
  Epoch 13 [Batch 24/40]: Loss: 0.2139
  Epoch 13 [Batch 28/40]: Loss: 1.1207
  Epoch 13 [Batch 32/40]: Loss: 0.6723
  Epoch 13 [Batch 36/40]: Loss: 0.9009
  Epoch 13 Train Summary: Avg Loss: 0.4576, Accuracy: 0.7928
  Validation Summary: Avg Loss: 1.0057, Accuracy: 0.4556, F1 (Macro): 0.4668

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 0.7829
  Epoch 14 [Batch 4/40]: Loss: 0.1564
  Epoch 14 [Batch 8/40]: Loss: 0.2973
  Epoch 14 [Batch 12/40]: Loss: 0.1079
  Epoch 14 [Batch 16/40]: Loss: 0.2414
  Epoch 14 [Batch 20/40]: Loss: 0.1214
  Epoch 14 [Batch 24/40]: Loss: 0.0362
  Epoch 14 [Batch 28/40]: Loss: 1.5136
  Epoch 14 [Batch 32/40]: Loss: 0.3616
  Epoch 14 [Batch 36/40]: Loss: 0.0731
  Epoch 14 Train Summary: Avg Loss: 0.3953, Accuracy: 0.8200
  Validation Summary: Avg Loss: 1.4528, Accuracy: 0.5083, F1 (Macro): 0.4676
Training finished in 8.12 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.0021, Accuracy: 0.3750, F1 (Macro): 0.3750
Final Best Model Stats: Acc: 0.3750, F1: 0.3750, Loss: 1.0021
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=224x224 lr=5e-05 drop=0.0 seed=123
================================================================================
Starting experiment: efficientnet_b0__224x224__lr-5e-05__drop-0.0__seed-123
Output directory: results_opg/efficientnet_b0__224x224__lr-5e-05__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 3.2826
  Epoch 0 [Batch 4/40]: Loss: 3.9975
  Epoch 0 [Batch 8/40]: Loss: 2.6143
  Epoch 0 [Batch 12/40]: Loss: 2.5196
  Epoch 0 [Batch 16/40]: Loss: 1.5713
  Epoch 0 [Batch 20/40]: Loss: 3.3509
  Epoch 0 [Batch 24/40]: Loss: 2.1951
  Epoch 0 [Batch 28/40]: Loss: 1.2544
  Epoch 0 [Batch 32/40]: Loss: 4.6118
  Epoch 0 [Batch 36/40]: Loss: 2.4767
  Epoch 0 Train Summary: Avg Loss: 2.6583, Accuracy: 0.3381
  Validation Summary: Avg Loss: 3.0050, Accuracy: 0.2333, F1 (Macro): 0.2286
  New best model! Val loss improved from inf to 3.0050. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 2.6488
  Epoch 1 [Batch 4/40]: Loss: 2.0080
  Epoch 1 [Batch 8/40]: Loss: 2.0433
  Epoch 1 [Batch 12/40]: Loss: 2.8878
  Epoch 1 [Batch 16/40]: Loss: 2.3526
  Epoch 1 [Batch 20/40]: Loss: 0.8917
  Epoch 1 [Batch 24/40]: Loss: 0.9669
  Epoch 1 [Batch 28/40]: Loss: 2.1675
  Epoch 1 [Batch 32/40]: Loss: 1.3023
  Epoch 1 [Batch 36/40]: Loss: 1.9812
  Epoch 1 Train Summary: Avg Loss: 1.9078, Accuracy: 0.4324
  Validation Summary: Avg Loss: 2.0925, Accuracy: 0.3028, F1 (Macro): 0.2978
  New best model! Val loss improved from 3.0050 to 2.0925. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.3572
  Epoch 2 [Batch 4/40]: Loss: 3.2229
  Epoch 2 [Batch 8/40]: Loss: 1.3209
  Epoch 2 [Batch 12/40]: Loss: 0.8271
  Epoch 2 [Batch 16/40]: Loss: 1.0807
  Epoch 2 [Batch 20/40]: Loss: 1.4632
  Epoch 2 [Batch 24/40]: Loss: 1.6527
  Epoch 2 [Batch 28/40]: Loss: 0.4875
  Epoch 2 [Batch 32/40]: Loss: 1.4554
  Epoch 2 [Batch 36/40]: Loss: 1.9576
  Epoch 2 Train Summary: Avg Loss: 1.5977, Accuracy: 0.4303
  Validation Summary: Avg Loss: 1.9302, Accuracy: 0.3167, F1 (Macro): 0.3122
  New best model! Val loss improved from 2.0925 to 1.9302. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 0.8282
  Epoch 3 [Batch 4/40]: Loss: 0.9296
  Epoch 3 [Batch 8/40]: Loss: 0.7542
  Epoch 3 [Batch 12/40]: Loss: 1.1006
  Epoch 3 [Batch 16/40]: Loss: 2.0777
  Epoch 3 [Batch 20/40]: Loss: 0.9287
  Epoch 3 [Batch 24/40]: Loss: 1.2287
  Epoch 3 [Batch 28/40]: Loss: 1.4867
  Epoch 3 [Batch 32/40]: Loss: 1.4294
  Epoch 3 [Batch 36/40]: Loss: 0.9486
  Epoch 3 Train Summary: Avg Loss: 1.2534, Accuracy: 0.5153
  Validation Summary: Avg Loss: 2.1208, Accuracy: 0.2889, F1 (Macro): 0.2857

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 0.7134
  Epoch 4 [Batch 4/40]: Loss: 2.7374
  Epoch 4 [Batch 8/40]: Loss: 0.8310
  Epoch 4 [Batch 12/40]: Loss: 1.0488
  Epoch 4 [Batch 16/40]: Loss: 1.1197
  Epoch 4 [Batch 20/40]: Loss: 0.4221
  Epoch 4 [Batch 24/40]: Loss: 0.9748
  Epoch 4 [Batch 28/40]: Loss: 2.0617
  Epoch 4 [Batch 32/40]: Loss: 1.2421
  Epoch 4 [Batch 36/40]: Loss: 0.1820
  Epoch 4 Train Summary: Avg Loss: 1.1472, Accuracy: 0.5595
  Validation Summary: Avg Loss: 1.9433, Accuracy: 0.3306, F1 (Macro): 0.3254

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 0.9569
  Epoch 5 [Batch 4/40]: Loss: 0.5842
  Epoch 5 [Batch 8/40]: Loss: 1.3602
  Epoch 5 [Batch 12/40]: Loss: 1.6178
  Epoch 5 [Batch 16/40]: Loss: 1.2323
  Epoch 5 [Batch 20/40]: Loss: 1.1031
  Epoch 5 [Batch 24/40]: Loss: 1.0368
  Epoch 5 [Batch 28/40]: Loss: 0.9907
  Epoch 5 [Batch 32/40]: Loss: 0.9400
  Epoch 5 [Batch 36/40]: Loss: 1.9201
  Epoch 5 Train Summary: Avg Loss: 1.1959, Accuracy: 0.5434
  Validation Summary: Avg Loss: 1.7981, Accuracy: 0.3444, F1 (Macro): 0.3399
  New best model! Val loss improved from 1.9302 to 1.7981. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 0.6236
  Epoch 6 [Batch 4/40]: Loss: 0.7954
  Epoch 6 [Batch 8/40]: Loss: 0.6445
  Epoch 6 [Batch 12/40]: Loss: 0.2606
  Epoch 6 [Batch 16/40]: Loss: 0.4680
  Epoch 6 [Batch 20/40]: Loss: 0.4208
  Epoch 6 [Batch 24/40]: Loss: 0.6574
  Epoch 6 [Batch 28/40]: Loss: 1.5022
  Epoch 6 [Batch 32/40]: Loss: 1.0565
  Epoch 6 [Batch 36/40]: Loss: 0.8829
  Epoch 6 Train Summary: Avg Loss: 0.8525, Accuracy: 0.6451
  Validation Summary: Avg Loss: 1.7839, Accuracy: 0.3972, F1 (Macro): 0.3663
  New best model! Val loss improved from 1.7981 to 1.7839. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 0.1775
  Epoch 7 [Batch 4/40]: Loss: 0.8560
  Epoch 7 [Batch 8/40]: Loss: 0.2625
  Epoch 7 [Batch 12/40]: Loss: 0.1516
  Epoch 7 [Batch 16/40]: Loss: 0.6480
  Epoch 7 [Batch 20/40]: Loss: 0.9278
  Epoch 7 [Batch 24/40]: Loss: 0.1923
  Epoch 7 [Batch 28/40]: Loss: 0.6887
  Epoch 7 [Batch 32/40]: Loss: 0.1900
  Epoch 7 [Batch 36/40]: Loss: 0.3309
  Epoch 7 Train Summary: Avg Loss: 0.7647, Accuracy: 0.6901
  Validation Summary: Avg Loss: 1.5193, Accuracy: 0.3583, F1 (Macro): 0.3558
  New best model! Val loss improved from 1.7839 to 1.5193. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 1.7140
  Epoch 8 [Batch 4/40]: Loss: 0.7719
  Epoch 8 [Batch 8/40]: Loss: 0.2920
  Epoch 8 [Batch 12/40]: Loss: 1.5515
  Epoch 8 [Batch 16/40]: Loss: 0.7320
  Epoch 8 [Batch 20/40]: Loss: 0.5752
  Epoch 8 [Batch 24/40]: Loss: 1.1911
  Epoch 8 [Batch 28/40]: Loss: 0.4680
  Epoch 8 [Batch 32/40]: Loss: 0.4399
  Epoch 8 [Batch 36/40]: Loss: 1.5172
  Epoch 8 Train Summary: Avg Loss: 0.7611, Accuracy: 0.6615
  Validation Summary: Avg Loss: 1.9181, Accuracy: 0.3444, F1 (Macro): 0.3331

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.2048
  Epoch 9 [Batch 4/40]: Loss: 0.7862
  Epoch 9 [Batch 8/40]: Loss: 0.9803
  Epoch 9 [Batch 12/40]: Loss: 0.4739
  Epoch 9 [Batch 16/40]: Loss: 1.4230
  Epoch 9 [Batch 20/40]: Loss: 0.6976
  Epoch 9 [Batch 24/40]: Loss: 1.6424
  Epoch 9 [Batch 28/40]: Loss: 0.9120
  Epoch 9 [Batch 32/40]: Loss: 0.8953
  Epoch 9 [Batch 36/40]: Loss: 0.9698
  Epoch 9 Train Summary: Avg Loss: 0.7295, Accuracy: 0.6857
  Validation Summary: Avg Loss: 1.7683, Accuracy: 0.3444, F1 (Macro): 0.3343

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 0.7237
  Epoch 10 [Batch 4/40]: Loss: 0.3918
  Epoch 10 [Batch 8/40]: Loss: 0.2615
  Epoch 10 [Batch 12/40]: Loss: 0.1117
  Epoch 10 [Batch 16/40]: Loss: 0.6314
  Epoch 10 [Batch 20/40]: Loss: 0.7185
  Epoch 10 [Batch 24/40]: Loss: 0.0537
  Epoch 10 [Batch 28/40]: Loss: 1.5042
  Epoch 10 [Batch 32/40]: Loss: 0.6908
  Epoch 10 [Batch 36/40]: Loss: 0.9906
  Epoch 10 Train Summary: Avg Loss: 0.5699, Accuracy: 0.7547
  Validation Summary: Avg Loss: 1.6144, Accuracy: 0.3444, F1 (Macro): 0.3404

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.4119
  Epoch 11 [Batch 4/40]: Loss: 0.7824
  Epoch 11 [Batch 8/40]: Loss: 0.4179
  Epoch 11 [Batch 12/40]: Loss: 1.1076
  Epoch 11 [Batch 16/40]: Loss: 1.2310
  Epoch 11 [Batch 20/40]: Loss: 0.7360
  Epoch 11 [Batch 24/40]: Loss: 0.5142
  Epoch 11 [Batch 28/40]: Loss: 0.9073
  Epoch 11 [Batch 32/40]: Loss: 0.2797
  Epoch 11 [Batch 36/40]: Loss: 1.2108
  Epoch 11 Train Summary: Avg Loss: 0.6475, Accuracy: 0.7151
  Validation Summary: Avg Loss: 1.6224, Accuracy: 0.4250, F1 (Macro): 0.4015

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.7294
  Epoch 12 [Batch 4/40]: Loss: 0.8138
  Epoch 12 [Batch 8/40]: Loss: 0.4246
  Epoch 12 [Batch 12/40]: Loss: 0.6510
  Epoch 12 [Batch 16/40]: Loss: 0.3402
  Epoch 12 [Batch 20/40]: Loss: 0.8567
  Epoch 12 [Batch 24/40]: Loss: 0.1409
  Epoch 12 [Batch 28/40]: Loss: 0.5645
  Epoch 12 [Batch 32/40]: Loss: 1.0762
  Epoch 12 [Batch 36/40]: Loss: 0.3267
  Epoch 12 Train Summary: Avg Loss: 0.5029, Accuracy: 0.7550
  Validation Summary: Avg Loss: 1.7492, Accuracy: 0.3444, F1 (Macro): 0.3335

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.1508
  Epoch 13 [Batch 4/40]: Loss: 0.0486
  Epoch 13 [Batch 8/40]: Loss: 0.6175
  Epoch 13 [Batch 12/40]: Loss: 0.8962
  Epoch 13 [Batch 16/40]: Loss: 0.7476
  Epoch 13 [Batch 20/40]: Loss: 0.7006
  Epoch 13 [Batch 24/40]: Loss: 0.1866
  Epoch 13 [Batch 28/40]: Loss: 0.7907
  Epoch 13 [Batch 32/40]: Loss: 0.4857
  Epoch 13 [Batch 36/40]: Loss: 0.5200
  Epoch 13 Train Summary: Avg Loss: 0.4505, Accuracy: 0.7857
  Validation Summary: Avg Loss: 1.6433, Accuracy: 0.3556, F1 (Macro): 0.3309

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 0.2985
  Epoch 14 [Batch 4/40]: Loss: 0.2960
  Epoch 14 [Batch 8/40]: Loss: 0.6486
  Epoch 14 [Batch 12/40]: Loss: 0.7637
  Epoch 14 [Batch 16/40]: Loss: 0.1061
  Epoch 14 [Batch 20/40]: Loss: 0.6506
  Epoch 14 [Batch 24/40]: Loss: 0.0405
  Epoch 14 [Batch 28/40]: Loss: 0.4296
  Epoch 14 [Batch 32/40]: Loss: 0.1216
  Epoch 14 [Batch 36/40]: Loss: 0.1697
  Epoch 14 Train Summary: Avg Loss: 0.4020, Accuracy: 0.8460
  Validation Summary: Avg Loss: 1.9566, Accuracy: 0.3833, F1 (Macro): 0.3424
Training finished in 9.78 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.5193, Accuracy: 0.3583, F1 (Macro): 0.3558
Final Best Model Stats: Acc: 0.3583, F1: 0.3558, Loss: 1.5193
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=224x224 lr=5e-05 drop=0.0 seed=999
================================================================================
Starting experiment: efficientnet_b0__224x224__lr-5e-05__drop-0.0__seed-999
Output directory: results_opg/efficientnet_b0__224x224__lr-5e-05__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 2.2709
  Epoch 0 [Batch 4/40]: Loss: 2.5022
  Epoch 0 [Batch 8/40]: Loss: 2.1066
  Epoch 0 [Batch 12/40]: Loss: 2.6127
  Epoch 0 [Batch 16/40]: Loss: 1.6470
  Epoch 0 [Batch 20/40]: Loss: 3.2055
  Epoch 0 [Batch 24/40]: Loss: 3.4258
  Epoch 0 [Batch 28/40]: Loss: 3.1033
  Epoch 0 [Batch 32/40]: Loss: 3.2594
  Epoch 0 [Batch 36/40]: Loss: 1.4757
  Epoch 0 Train Summary: Avg Loss: 2.3890, Accuracy: 0.3100
  Validation Summary: Avg Loss: 3.1932, Accuracy: 0.3278, F1 (Macro): 0.3076
  New best model! Val loss improved from inf to 3.1932. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 2.8733
  Epoch 1 [Batch 4/40]: Loss: 1.5543
  Epoch 1 [Batch 8/40]: Loss: 0.8584
  Epoch 1 [Batch 12/40]: Loss: 1.5738
  Epoch 1 [Batch 16/40]: Loss: 1.0055
  Epoch 1 [Batch 20/40]: Loss: 0.7375
  Epoch 1 [Batch 24/40]: Loss: 1.3263
  Epoch 1 [Batch 28/40]: Loss: 1.9450
  Epoch 1 [Batch 32/40]: Loss: 2.3701
  Epoch 1 [Batch 36/40]: Loss: 1.3587
  Epoch 1 Train Summary: Avg Loss: 1.8535, Accuracy: 0.4177
  Validation Summary: Avg Loss: 1.7084, Accuracy: 0.3444, F1 (Macro): 0.3429
  New best model! Val loss improved from 3.1932 to 1.7084. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 2.1658
  Epoch 2 [Batch 4/40]: Loss: 2.6054
  Epoch 2 [Batch 8/40]: Loss: 0.8893
  Epoch 2 [Batch 12/40]: Loss: 2.1946
  Epoch 2 [Batch 16/40]: Loss: 1.9090
  Epoch 2 [Batch 20/40]: Loss: 0.7264
  Epoch 2 [Batch 24/40]: Loss: 2.3210
  Epoch 2 [Batch 28/40]: Loss: 2.1057
  Epoch 2 [Batch 32/40]: Loss: 3.0546
  Epoch 2 [Batch 36/40]: Loss: 2.3429
  Epoch 2 Train Summary: Avg Loss: 1.6506, Accuracy: 0.4704
  Validation Summary: Avg Loss: 1.9357, Accuracy: 0.3139, F1 (Macro): 0.2600

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 2.7847
  Epoch 3 [Batch 4/40]: Loss: 1.3141
  Epoch 3 [Batch 8/40]: Loss: 1.3696
  Epoch 3 [Batch 12/40]: Loss: 2.2991
  Epoch 3 [Batch 16/40]: Loss: 0.4628
  Epoch 3 [Batch 20/40]: Loss: 0.5442
  Epoch 3 [Batch 24/40]: Loss: 0.9683
  Epoch 3 [Batch 28/40]: Loss: 0.8642
  Epoch 3 [Batch 32/40]: Loss: 1.0197
  Epoch 3 [Batch 36/40]: Loss: 1.0467
  Epoch 3 Train Summary: Avg Loss: 1.2979, Accuracy: 0.4900
  Validation Summary: Avg Loss: 1.8090, Accuracy: 0.3306, F1 (Macro): 0.3367

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 0.5016
  Epoch 4 [Batch 4/40]: Loss: 0.9541
  Epoch 4 [Batch 8/40]: Loss: 1.7134
  Epoch 4 [Batch 12/40]: Loss: 0.8621
  Epoch 4 [Batch 16/40]: Loss: 2.3801
  Epoch 4 [Batch 20/40]: Loss: 0.2920
  Epoch 4 [Batch 24/40]: Loss: 0.7604
  Epoch 4 [Batch 28/40]: Loss: 2.1976
  Epoch 4 [Batch 32/40]: Loss: 0.8966
  Epoch 4 [Batch 36/40]: Loss: 1.3045
  Epoch 4 Train Summary: Avg Loss: 1.0582, Accuracy: 0.5738
  Validation Summary: Avg Loss: 1.8740, Accuracy: 0.3694, F1 (Macro): 0.3431

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 0.4342
  Epoch 5 [Batch 4/40]: Loss: 2.7845
  Epoch 5 [Batch 8/40]: Loss: 1.7683
  Epoch 5 [Batch 12/40]: Loss: 0.9337
  Epoch 5 [Batch 16/40]: Loss: 0.8177
  Epoch 5 [Batch 20/40]: Loss: 0.4500
  Epoch 5 [Batch 24/40]: Loss: 1.2317
  Epoch 5 [Batch 28/40]: Loss: 1.7766
  Epoch 5 [Batch 32/40]: Loss: 0.7333
  Epoch 5 [Batch 36/40]: Loss: 0.3625
  Epoch 5 Train Summary: Avg Loss: 1.0580, Accuracy: 0.5573
  Validation Summary: Avg Loss: 1.4114, Accuracy: 0.3583, F1 (Macro): 0.3617
  New best model! Val loss improved from 1.7084 to 1.4114. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 1.0506
  Epoch 6 [Batch 4/40]: Loss: 0.5736
  Epoch 6 [Batch 8/40]: Loss: 0.6629
  Epoch 6 [Batch 12/40]: Loss: 0.6943
  Epoch 6 [Batch 16/40]: Loss: 0.6704
  Epoch 6 [Batch 20/40]: Loss: 1.7781
  Epoch 6 [Batch 24/40]: Loss: 0.1869
  Epoch 6 [Batch 28/40]: Loss: 0.6464
  Epoch 6 [Batch 32/40]: Loss: 0.9691
  Epoch 6 [Batch 36/40]: Loss: 0.3535
  Epoch 6 Train Summary: Avg Loss: 0.7339, Accuracy: 0.6656
  Validation Summary: Avg Loss: 1.5985, Accuracy: 0.3861, F1 (Macro): 0.3725

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 0.7653
  Epoch 7 [Batch 4/40]: Loss: 1.2805
  Epoch 7 [Batch 8/40]: Loss: 1.6062
  Epoch 7 [Batch 12/40]: Loss: 0.1854
  Epoch 7 [Batch 16/40]: Loss: 0.1160
  Epoch 7 [Batch 20/40]: Loss: 0.7076
  Epoch 7 [Batch 24/40]: Loss: 0.5797
  Epoch 7 [Batch 28/40]: Loss: 0.5639
  Epoch 7 [Batch 32/40]: Loss: 0.7909
  Epoch 7 [Batch 36/40]: Loss: 1.1299
  Epoch 7 Train Summary: Avg Loss: 0.7662, Accuracy: 0.6611
  Validation Summary: Avg Loss: 1.4770, Accuracy: 0.4139, F1 (Macro): 0.4057

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.4066
  Epoch 8 [Batch 4/40]: Loss: 0.4094
  Epoch 8 [Batch 8/40]: Loss: 1.3056
  Epoch 8 [Batch 12/40]: Loss: 0.6336
  Epoch 8 [Batch 16/40]: Loss: 0.8342
  Epoch 8 [Batch 20/40]: Loss: 0.2996
  Epoch 8 [Batch 24/40]: Loss: 0.8385
  Epoch 8 [Batch 28/40]: Loss: 2.3829
  Epoch 8 [Batch 32/40]: Loss: 0.1446
  Epoch 8 [Batch 36/40]: Loss: 0.8440
  Epoch 8 Train Summary: Avg Loss: 0.8191, Accuracy: 0.6514
  Validation Summary: Avg Loss: 1.3168, Accuracy: 0.4000, F1 (Macro): 0.3899
  New best model! Val loss improved from 1.4114 to 1.3168. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 1.9559
  Epoch 9 [Batch 4/40]: Loss: 1.0887
  Epoch 9 [Batch 8/40]: Loss: 0.5123
  Epoch 9 [Batch 12/40]: Loss: 0.8169
  Epoch 9 [Batch 16/40]: Loss: 1.0651
  Epoch 9 [Batch 20/40]: Loss: 0.8787
  Epoch 9 [Batch 24/40]: Loss: 0.1422
  Epoch 9 [Batch 28/40]: Loss: 0.1631
  Epoch 9 [Batch 32/40]: Loss: 0.6170
  Epoch 9 [Batch 36/40]: Loss: 0.2652
  Epoch 9 Train Summary: Avg Loss: 0.6843, Accuracy: 0.7017
  Validation Summary: Avg Loss: 1.2870, Accuracy: 0.3722, F1 (Macro): 0.3699
  New best model! Val loss improved from 1.3168 to 1.2870. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 0.0984
  Epoch 10 [Batch 4/40]: Loss: 0.4854
  Epoch 10 [Batch 8/40]: Loss: 0.1321
  Epoch 10 [Batch 12/40]: Loss: 0.2559
  Epoch 10 [Batch 16/40]: Loss: 0.7814
  Epoch 10 [Batch 20/40]: Loss: 0.9804
  Epoch 10 [Batch 24/40]: Loss: 0.5848
  Epoch 10 [Batch 28/40]: Loss: 0.2838
  Epoch 10 [Batch 32/40]: Loss: 0.7870
  Epoch 10 [Batch 36/40]: Loss: 0.0816
  Epoch 10 Train Summary: Avg Loss: 0.6395, Accuracy: 0.7262
  Validation Summary: Avg Loss: 1.3017, Accuracy: 0.4417, F1 (Macro): 0.4367

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.6696
  Epoch 11 [Batch 4/40]: Loss: 0.3054
  Epoch 11 [Batch 8/40]: Loss: 0.5260
  Epoch 11 [Batch 12/40]: Loss: 0.2517
  Epoch 11 [Batch 16/40]: Loss: 0.7855
  Epoch 11 [Batch 20/40]: Loss: 1.2277
  Epoch 11 [Batch 24/40]: Loss: 1.2146
  Epoch 11 [Batch 28/40]: Loss: 0.5290
  Epoch 11 [Batch 32/40]: Loss: 0.0723
  Epoch 11 [Batch 36/40]: Loss: 0.3681
  Epoch 11 Train Summary: Avg Loss: 0.5229, Accuracy: 0.7547
  Validation Summary: Avg Loss: 1.4669, Accuracy: 0.3333, F1 (Macro): 0.3244

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.2675
  Epoch 12 [Batch 4/40]: Loss: 0.4796
  Epoch 12 [Batch 8/40]: Loss: 0.5156
  Epoch 12 [Batch 12/40]: Loss: 0.8613
  Epoch 12 [Batch 16/40]: Loss: 0.3516
  Epoch 12 [Batch 20/40]: Loss: 0.4881
  Epoch 12 [Batch 24/40]: Loss: 0.1665
  Epoch 12 [Batch 28/40]: Loss: 0.2737
  Epoch 12 [Batch 32/40]: Loss: 1.4298
  Epoch 12 [Batch 36/40]: Loss: 0.3341
  Epoch 12 Train Summary: Avg Loss: 0.4988, Accuracy: 0.8193
  Validation Summary: Avg Loss: 1.3746, Accuracy: 0.3333, F1 (Macro): 0.3151

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.1876
  Epoch 13 [Batch 4/40]: Loss: 0.3486
  Epoch 13 [Batch 8/40]: Loss: 0.3149
  Epoch 13 [Batch 12/40]: Loss: 0.5950
  Epoch 13 [Batch 16/40]: Loss: 0.0972
  Epoch 13 [Batch 20/40]: Loss: 1.5408
  Epoch 13 [Batch 24/40]: Loss: 0.1061
  Epoch 13 [Batch 28/40]: Loss: 0.1992
  Epoch 13 [Batch 32/40]: Loss: 0.6421
  Epoch 13 [Batch 36/40]: Loss: 0.6628
  Epoch 13 Train Summary: Avg Loss: 0.4471, Accuracy: 0.8119
  Validation Summary: Avg Loss: 1.2475, Accuracy: 0.4139, F1 (Macro): 0.4123
  New best model! Val loss improved from 1.2870 to 1.2475. Saving...

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 0.7452
  Epoch 14 [Batch 4/40]: Loss: 0.1846
  Epoch 14 [Batch 8/40]: Loss: 0.1377
  Epoch 14 [Batch 12/40]: Loss: 0.1788
  Epoch 14 [Batch 16/40]: Loss: 0.7755
  Epoch 14 [Batch 20/40]: Loss: 0.1761
  Epoch 14 [Batch 24/40]: Loss: 0.0978
  Epoch 14 [Batch 28/40]: Loss: 0.6802
  Epoch 14 [Batch 32/40]: Loss: 0.8115
  Epoch 14 [Batch 36/40]: Loss: 0.0960
  Epoch 14 Train Summary: Avg Loss: 0.3886, Accuracy: 0.8091
  Validation Summary: Avg Loss: 1.3755, Accuracy: 0.4556, F1 (Macro): 0.4636
Training finished in 6.85 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.2475, Accuracy: 0.4139, F1 (Macro): 0.4123
Final Best Model Stats: Acc: 0.4139, F1: 0.4123, Loss: 1.2475
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=224x224 lr=1e-05 drop=0.0 seed=42
================================================================================
Starting experiment: efficientnet_b0__224x224__lr-1e-05__drop-0.0__seed-42
Output directory: results_opg/efficientnet_b0__224x224__lr-1e-05__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 2.0874
  Epoch 0 [Batch 4/40]: Loss: 3.7562
  Epoch 0 [Batch 8/40]: Loss: 1.8245
  Epoch 0 [Batch 12/40]: Loss: 1.4497
  Epoch 0 [Batch 16/40]: Loss: 2.0605
  Epoch 0 [Batch 20/40]: Loss: 1.6974
  Epoch 0 [Batch 24/40]: Loss: 2.6950
  Epoch 0 [Batch 28/40]: Loss: 2.0964
  Epoch 0 [Batch 32/40]: Loss: 4.0998
  Epoch 0 [Batch 36/40]: Loss: 2.2076
  Epoch 0 Train Summary: Avg Loss: 2.7964, Accuracy: 0.3459
  Validation Summary: Avg Loss: 4.4624, Accuracy: 0.3194, F1 (Macro): 0.1775
  New best model! Val loss improved from inf to 4.4624. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 1.6300
  Epoch 1 [Batch 4/40]: Loss: 2.8980
  Epoch 1 [Batch 8/40]: Loss: 2.0565
  Epoch 1 [Batch 12/40]: Loss: 1.4463
  Epoch 1 [Batch 16/40]: Loss: 4.0763
  Epoch 1 [Batch 20/40]: Loss: 2.5658
  Epoch 1 [Batch 24/40]: Loss: 4.9766
  Epoch 1 [Batch 28/40]: Loss: 2.0985
  Epoch 1 [Batch 32/40]: Loss: 1.9486
  Epoch 1 [Batch 36/40]: Loss: 2.5950
  Epoch 1 Train Summary: Avg Loss: 2.4401, Accuracy: 0.3270
  Validation Summary: Avg Loss: 3.2452, Accuracy: 0.3583, F1 (Macro): 0.2377
  New best model! Val loss improved from 4.4624 to 3.2452. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.9486
  Epoch 2 [Batch 4/40]: Loss: 1.0179
  Epoch 2 [Batch 8/40]: Loss: 2.3866
  Epoch 2 [Batch 12/40]: Loss: 1.7809
  Epoch 2 [Batch 16/40]: Loss: 2.6331
  Epoch 2 [Batch 20/40]: Loss: 2.9961
  Epoch 2 [Batch 24/40]: Loss: 3.9900
  Epoch 2 [Batch 28/40]: Loss: 2.1097
  Epoch 2 [Batch 32/40]: Loss: 2.0496
  Epoch 2 [Batch 36/40]: Loss: 1.5937
  Epoch 2 Train Summary: Avg Loss: 2.2783, Accuracy: 0.3091
  Validation Summary: Avg Loss: 2.7121, Accuracy: 0.3028, F1 (Macro): 0.2138
  New best model! Val loss improved from 3.2452 to 2.7121. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 2.9512
  Epoch 3 [Batch 4/40]: Loss: 3.2137
  Epoch 3 [Batch 8/40]: Loss: 1.4665
  Epoch 3 [Batch 12/40]: Loss: 2.8786
  Epoch 3 [Batch 16/40]: Loss: 1.6404
  Epoch 3 [Batch 20/40]: Loss: 2.2998
  Epoch 3 [Batch 24/40]: Loss: 1.5880
  Epoch 3 [Batch 28/40]: Loss: 1.2831
  Epoch 3 [Batch 32/40]: Loss: 2.0226
  Epoch 3 [Batch 36/40]: Loss: 2.0138
  Epoch 3 Train Summary: Avg Loss: 1.8299, Accuracy: 0.3946
  Validation Summary: Avg Loss: 2.4129, Accuracy: 0.3028, F1 (Macro): 0.2456
  New best model! Val loss improved from 2.7121 to 2.4129. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 1.1760
  Epoch 4 [Batch 4/40]: Loss: 2.6207
  Epoch 4 [Batch 8/40]: Loss: 0.7044
  Epoch 4 [Batch 12/40]: Loss: 1.3423
  Epoch 4 [Batch 16/40]: Loss: 2.4721
  Epoch 4 [Batch 20/40]: Loss: 1.1916
  Epoch 4 [Batch 24/40]: Loss: 2.4920
  Epoch 4 [Batch 28/40]: Loss: 1.5541
  Epoch 4 [Batch 32/40]: Loss: 1.3557
  Epoch 4 [Batch 36/40]: Loss: 2.0450
  Epoch 4 Train Summary: Avg Loss: 1.6215, Accuracy: 0.4784
  Validation Summary: Avg Loss: 2.9228, Accuracy: 0.2917, F1 (Macro): 0.2088

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 1.1831
  Epoch 5 [Batch 4/40]: Loss: 1.7707
  Epoch 5 [Batch 8/40]: Loss: 2.1254
  Epoch 5 [Batch 12/40]: Loss: 1.0940
  Epoch 5 [Batch 16/40]: Loss: 1.5186
  Epoch 5 [Batch 20/40]: Loss: 1.4225
  Epoch 5 [Batch 24/40]: Loss: 0.7645
  Epoch 5 [Batch 28/40]: Loss: 0.9212
  Epoch 5 [Batch 32/40]: Loss: 1.1507
  Epoch 5 [Batch 36/40]: Loss: 2.1583
  Epoch 5 Train Summary: Avg Loss: 1.7443, Accuracy: 0.4262
  Validation Summary: Avg Loss: 2.1007, Accuracy: 0.1944, F1 (Macro): 0.1920
  New best model! Val loss improved from 2.4129 to 2.1007. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 1.1943
  Epoch 6 [Batch 4/40]: Loss: 2.4362
  Epoch 6 [Batch 8/40]: Loss: 1.0856
  Epoch 6 [Batch 12/40]: Loss: 2.7340
  Epoch 6 [Batch 16/40]: Loss: 1.3128
  Epoch 6 [Batch 20/40]: Loss: 1.7173
  Epoch 6 [Batch 24/40]: Loss: 2.0586
  Epoch 6 [Batch 28/40]: Loss: 1.1803
  Epoch 6 [Batch 32/40]: Loss: 1.1863
  Epoch 6 [Batch 36/40]: Loss: 0.8295
  Epoch 6 Train Summary: Avg Loss: 1.5148, Accuracy: 0.4641
  Validation Summary: Avg Loss: 2.2731, Accuracy: 0.2611, F1 (Macro): 0.2255

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 2.2142
  Epoch 7 [Batch 4/40]: Loss: 1.6158
  Epoch 7 [Batch 8/40]: Loss: 1.1435
  Epoch 7 [Batch 12/40]: Loss: 1.0341
  Epoch 7 [Batch 16/40]: Loss: 0.7020
  Epoch 7 [Batch 20/40]: Loss: 1.8679
  Epoch 7 [Batch 24/40]: Loss: 1.4328
  Epoch 7 [Batch 28/40]: Loss: 1.9380
  Epoch 7 [Batch 32/40]: Loss: 0.9269
  Epoch 7 [Batch 36/40]: Loss: 1.4371
  Epoch 7 Train Summary: Avg Loss: 1.5365, Accuracy: 0.4671
  Validation Summary: Avg Loss: 2.2791, Accuracy: 0.3861, F1 (Macro): 0.3208

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 1.8069
  Epoch 8 [Batch 4/40]: Loss: 0.7627
  Epoch 8 [Batch 8/40]: Loss: 1.1721
  Epoch 8 [Batch 12/40]: Loss: 1.4811
  Epoch 8 [Batch 16/40]: Loss: 1.6068
  Epoch 8 [Batch 20/40]: Loss: 1.2691
  Epoch 8 [Batch 24/40]: Loss: 2.3885
  Epoch 8 [Batch 28/40]: Loss: 1.8550
  Epoch 8 [Batch 32/40]: Loss: 2.5850
  Epoch 8 [Batch 36/40]: Loss: 1.8559
  Epoch 8 Train Summary: Avg Loss: 1.5753, Accuracy: 0.4083
  Validation Summary: Avg Loss: 1.9748, Accuracy: 0.1944, F1 (Macro): 0.2015
  New best model! Val loss improved from 2.1007 to 1.9748. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 1.3895
  Epoch 9 [Batch 4/40]: Loss: 1.6073
  Epoch 9 [Batch 8/40]: Loss: 0.7907
  Epoch 9 [Batch 12/40]: Loss: 1.3243
  Epoch 9 [Batch 16/40]: Loss: 1.4675
  Epoch 9 [Batch 20/40]: Loss: 2.9724
  Epoch 9 [Batch 24/40]: Loss: 0.7316
  Epoch 9 [Batch 28/40]: Loss: 1.1479
  Epoch 9 [Batch 32/40]: Loss: 0.7526
  Epoch 9 [Batch 36/40]: Loss: 1.2549
  Epoch 9 Train Summary: Avg Loss: 1.3112, Accuracy: 0.5025
  Validation Summary: Avg Loss: 1.8810, Accuracy: 0.3583, F1 (Macro): 0.3224
  New best model! Val loss improved from 1.9748 to 1.8810. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 1.4643
  Epoch 10 [Batch 4/40]: Loss: 1.3138
  Epoch 10 [Batch 8/40]: Loss: 1.2249
  Epoch 10 [Batch 12/40]: Loss: 2.2789
  Epoch 10 [Batch 16/40]: Loss: 1.2799
  Epoch 10 [Batch 20/40]: Loss: 1.2296
  Epoch 10 [Batch 24/40]: Loss: 0.4165
  Epoch 10 [Batch 28/40]: Loss: 0.9503
  Epoch 10 [Batch 32/40]: Loss: 0.8353
  Epoch 10 [Batch 36/40]: Loss: 0.4979
  Epoch 10 Train Summary: Avg Loss: 1.2577, Accuracy: 0.4670
  Validation Summary: Avg Loss: 1.7968, Accuracy: 0.2778, F1 (Macro): 0.2741
  New best model! Val loss improved from 1.8810 to 1.7968. Saving...

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 2.5497
  Epoch 11 [Batch 4/40]: Loss: 0.8887
  Epoch 11 [Batch 8/40]: Loss: 1.0380
  Epoch 11 [Batch 12/40]: Loss: 2.5320
  Epoch 11 [Batch 16/40]: Loss: 0.3343
  Epoch 11 [Batch 20/40]: Loss: 1.8131
  Epoch 11 [Batch 24/40]: Loss: 1.6069
  Epoch 11 [Batch 28/40]: Loss: 0.7316
  Epoch 11 [Batch 32/40]: Loss: 1.3380
  Epoch 11 [Batch 36/40]: Loss: 0.5272
  Epoch 11 Train Summary: Avg Loss: 1.3670, Accuracy: 0.4766
  Validation Summary: Avg Loss: 2.2437, Accuracy: 0.3722, F1 (Macro): 0.3222

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 1.6926
  Epoch 12 [Batch 4/40]: Loss: 0.9614
  Epoch 12 [Batch 8/40]: Loss: 1.1392
  Epoch 12 [Batch 12/40]: Loss: 1.0874
  Epoch 12 [Batch 16/40]: Loss: 0.8986
  Epoch 12 [Batch 20/40]: Loss: 0.6720
  Epoch 12 [Batch 24/40]: Loss: 0.7612
  Epoch 12 [Batch 28/40]: Loss: 2.0398
  Epoch 12 [Batch 32/40]: Loss: 3.4423
  Epoch 12 [Batch 36/40]: Loss: 1.9099
  Epoch 12 Train Summary: Avg Loss: 1.3931, Accuracy: 0.4538
  Validation Summary: Avg Loss: 1.7150, Accuracy: 0.3861, F1 (Macro): 0.3849
  New best model! Val loss improved from 1.7968 to 1.7150. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 1.2221
  Epoch 13 [Batch 4/40]: Loss: 0.7959
  Epoch 13 [Batch 8/40]: Loss: 1.6862
  Epoch 13 [Batch 12/40]: Loss: 1.2793
  Epoch 13 [Batch 16/40]: Loss: 0.8541
  Epoch 13 [Batch 20/40]: Loss: 0.4957
  Epoch 13 [Batch 24/40]: Loss: 0.4083
  Epoch 13 [Batch 28/40]: Loss: 1.4663
  Epoch 13 [Batch 32/40]: Loss: 0.9044
  Epoch 13 [Batch 36/40]: Loss: 1.4298
  Epoch 13 Train Summary: Avg Loss: 1.0672, Accuracy: 0.5386
  Validation Summary: Avg Loss: 1.7648, Accuracy: 0.2222, F1 (Macro): 0.2315

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 1.3996
  Epoch 14 [Batch 4/40]: Loss: 1.3086
  Epoch 14 [Batch 8/40]: Loss: 0.5936
  Epoch 14 [Batch 12/40]: Loss: 0.9836
  Epoch 14 [Batch 16/40]: Loss: 0.7974
  Epoch 14 [Batch 20/40]: Loss: 1.0517
  Epoch 14 [Batch 24/40]: Loss: 0.8035
  Epoch 14 [Batch 28/40]: Loss: 1.1420
  Epoch 14 [Batch 32/40]: Loss: 0.9417
  Epoch 14 [Batch 36/40]: Loss: 0.4726
  Epoch 14 Train Summary: Avg Loss: 1.0946, Accuracy: 0.5811
  Validation Summary: Avg Loss: 2.7292, Accuracy: 0.3556, F1 (Macro): 0.2609
Training finished in 6.92 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.7150, Accuracy: 0.3861, F1 (Macro): 0.3849
Final Best Model Stats: Acc: 0.3861, F1: 0.3849, Loss: 1.7150
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=224x224 lr=1e-05 drop=0.0 seed=123
================================================================================
Starting experiment: efficientnet_b0__224x224__lr-1e-05__drop-0.0__seed-123
Output directory: results_opg/efficientnet_b0__224x224__lr-1e-05__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 3.2826
  Epoch 0 [Batch 4/40]: Loss: 4.1451
  Epoch 0 [Batch 8/40]: Loss: 2.4062
  Epoch 0 [Batch 12/40]: Loss: 3.1791
  Epoch 0 [Batch 16/40]: Loss: 1.5230
  Epoch 0 [Batch 20/40]: Loss: 3.6597
  Epoch 0 [Batch 24/40]: Loss: 2.6742
  Epoch 0 [Batch 28/40]: Loss: 1.6810
  Epoch 0 [Batch 32/40]: Loss: 4.3501
  Epoch 0 [Batch 36/40]: Loss: 2.6492
  Epoch 0 Train Summary: Avg Loss: 2.9468, Accuracy: 0.3326
  Validation Summary: Avg Loss: 3.8091, Accuracy: 0.3111, F1 (Macro): 0.2175
  New best model! Val loss improved from inf to 3.8091. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 3.4767
  Epoch 1 [Batch 4/40]: Loss: 3.4534
  Epoch 1 [Batch 8/40]: Loss: 3.5401
  Epoch 1 [Batch 12/40]: Loss: 3.1627
  Epoch 1 [Batch 16/40]: Loss: 3.3629
  Epoch 1 [Batch 20/40]: Loss: 2.2628
  Epoch 1 [Batch 24/40]: Loss: 2.2992
  Epoch 1 [Batch 28/40]: Loss: 3.2593
  Epoch 1 [Batch 32/40]: Loss: 1.1052
  Epoch 1 [Batch 36/40]: Loss: 2.6097
  Epoch 1 Train Summary: Avg Loss: 2.7450, Accuracy: 0.3484
  Validation Summary: Avg Loss: 2.9814, Accuracy: 0.3278, F1 (Macro): 0.2939
  New best model! Val loss improved from 3.8091 to 2.9814. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.9068
  Epoch 2 [Batch 4/40]: Loss: 4.5606
  Epoch 2 [Batch 8/40]: Loss: 1.3884
  Epoch 2 [Batch 12/40]: Loss: 2.1309
  Epoch 2 [Batch 16/40]: Loss: 2.0512
  Epoch 2 [Batch 20/40]: Loss: 1.6670
  Epoch 2 [Batch 24/40]: Loss: 3.9687
  Epoch 2 [Batch 28/40]: Loss: 1.1103
  Epoch 2 [Batch 32/40]: Loss: 2.0657
  Epoch 2 [Batch 36/40]: Loss: 1.5711
  Epoch 2 Train Summary: Avg Loss: 2.4412, Accuracy: 0.3688
  Validation Summary: Avg Loss: 2.6125, Accuracy: 0.2611, F1 (Macro): 0.2606
  New best model! Val loss improved from 2.9814 to 2.6125. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 2.0722
  Epoch 3 [Batch 4/40]: Loss: 1.5975
  Epoch 3 [Batch 8/40]: Loss: 1.2343
  Epoch 3 [Batch 12/40]: Loss: 1.5826
  Epoch 3 [Batch 16/40]: Loss: 3.6715
  Epoch 3 [Batch 20/40]: Loss: 1.5708
  Epoch 3 [Batch 24/40]: Loss: 2.1237
  Epoch 3 [Batch 28/40]: Loss: 1.9058
  Epoch 3 [Batch 32/40]: Loss: 1.8007
  Epoch 3 [Batch 36/40]: Loss: 2.3456
  Epoch 3 Train Summary: Avg Loss: 2.0724, Accuracy: 0.3794
  Validation Summary: Avg Loss: 3.0227, Accuracy: 0.2056, F1 (Macro): 0.1958

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 1.8759
  Epoch 4 [Batch 4/40]: Loss: 1.9226
  Epoch 4 [Batch 8/40]: Loss: 1.4252
  Epoch 4 [Batch 12/40]: Loss: 1.2358
  Epoch 4 [Batch 16/40]: Loss: 1.7676
  Epoch 4 [Batch 20/40]: Loss: 1.6531
  Epoch 4 [Batch 24/40]: Loss: 2.1587
  Epoch 4 [Batch 28/40]: Loss: 3.3130
  Epoch 4 [Batch 32/40]: Loss: 1.6997
  Epoch 4 [Batch 36/40]: Loss: 0.9807
  Epoch 4 Train Summary: Avg Loss: 1.8032, Accuracy: 0.3462
  Validation Summary: Avg Loss: 2.4756, Accuracy: 0.3417, F1 (Macro): 0.3113
  New best model! Val loss improved from 2.6125 to 2.4756. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 3.1915
  Epoch 5 [Batch 4/40]: Loss: 1.4760
  Epoch 5 [Batch 8/40]: Loss: 2.6560
  Epoch 5 [Batch 12/40]: Loss: 3.7240
  Epoch 5 [Batch 16/40]: Loss: 1.6150
  Epoch 5 [Batch 20/40]: Loss: 1.7735
  Epoch 5 [Batch 24/40]: Loss: 1.7717
  Epoch 5 [Batch 28/40]: Loss: 0.9910
  Epoch 5 [Batch 32/40]: Loss: 1.7965
  Epoch 5 [Batch 36/40]: Loss: 2.8357
  Epoch 5 Train Summary: Avg Loss: 2.0565, Accuracy: 0.3347
  Validation Summary: Avg Loss: 2.4594, Accuracy: 0.2889, F1 (Macro): 0.2853
  New best model! Val loss improved from 2.4756 to 2.4594. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 1.6326
  Epoch 6 [Batch 4/40]: Loss: 1.4442
  Epoch 6 [Batch 8/40]: Loss: 1.7666
  Epoch 6 [Batch 12/40]: Loss: 0.9422
  Epoch 6 [Batch 16/40]: Loss: 1.2742
  Epoch 6 [Batch 20/40]: Loss: 1.0418
  Epoch 6 [Batch 24/40]: Loss: 1.6470
  Epoch 6 [Batch 28/40]: Loss: 3.2012
  Epoch 6 [Batch 32/40]: Loss: 1.7856
  Epoch 6 [Batch 36/40]: Loss: 1.8743
  Epoch 6 Train Summary: Avg Loss: 1.6589, Accuracy: 0.4125
  Validation Summary: Avg Loss: 2.2417, Accuracy: 0.4111, F1 (Macro): 0.3876
  New best model! Val loss improved from 2.4594 to 2.2417. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 0.7323
  Epoch 7 [Batch 4/40]: Loss: 2.4105
  Epoch 7 [Batch 8/40]: Loss: 1.2816
  Epoch 7 [Batch 12/40]: Loss: 0.5922
  Epoch 7 [Batch 16/40]: Loss: 0.7575
  Epoch 7 [Batch 20/40]: Loss: 2.2331
  Epoch 7 [Batch 24/40]: Loss: 0.7805
  Epoch 7 [Batch 28/40]: Loss: 1.7407
  Epoch 7 [Batch 32/40]: Loss: 1.7340
  Epoch 7 [Batch 36/40]: Loss: 1.5251
  Epoch 7 Train Summary: Avg Loss: 1.5385, Accuracy: 0.4744
  Validation Summary: Avg Loss: 2.1655, Accuracy: 0.3028, F1 (Macro): 0.2994
  New best model! Val loss improved from 2.2417 to 2.1655. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 1.8608
  Epoch 8 [Batch 4/40]: Loss: 0.8358
  Epoch 8 [Batch 8/40]: Loss: 0.2674
  Epoch 8 [Batch 12/40]: Loss: 1.6480
  Epoch 8 [Batch 16/40]: Loss: 1.5813
  Epoch 8 [Batch 20/40]: Loss: 1.8881
  Epoch 8 [Batch 24/40]: Loss: 2.7009
  Epoch 8 [Batch 28/40]: Loss: 1.5727
  Epoch 8 [Batch 32/40]: Loss: 1.0969
  Epoch 8 [Batch 36/40]: Loss: 1.5798
  Epoch 8 Train Summary: Avg Loss: 1.4399, Accuracy: 0.4834
  Validation Summary: Avg Loss: 2.4397, Accuracy: 0.3028, F1 (Macro): 0.3005

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 1.5527
  Epoch 9 [Batch 4/40]: Loss: 2.1544
  Epoch 9 [Batch 8/40]: Loss: 0.7489
  Epoch 9 [Batch 12/40]: Loss: 1.1160
  Epoch 9 [Batch 16/40]: Loss: 3.2705
  Epoch 9 [Batch 20/40]: Loss: 1.2907
  Epoch 9 [Batch 24/40]: Loss: 2.8341
  Epoch 9 [Batch 28/40]: Loss: 1.8120
  Epoch 9 [Batch 32/40]: Loss: 2.3844
  Epoch 9 [Batch 36/40]: Loss: 1.5077
  Epoch 9 Train Summary: Avg Loss: 1.5152, Accuracy: 0.4799
  Validation Summary: Avg Loss: 2.1277, Accuracy: 0.3833, F1 (Macro): 0.3555
  New best model! Val loss improved from 2.1655 to 2.1277. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 1.5304
  Epoch 10 [Batch 4/40]: Loss: 0.9458
  Epoch 10 [Batch 8/40]: Loss: 1.3016
  Epoch 10 [Batch 12/40]: Loss: 0.7282
  Epoch 10 [Batch 16/40]: Loss: 1.1524
  Epoch 10 [Batch 20/40]: Loss: 1.3680
  Epoch 10 [Batch 24/40]: Loss: 0.6281
  Epoch 10 [Batch 28/40]: Loss: 1.2139
  Epoch 10 [Batch 32/40]: Loss: 1.2437
  Epoch 10 [Batch 36/40]: Loss: 1.0567
  Epoch 10 Train Summary: Avg Loss: 1.3499, Accuracy: 0.4652
  Validation Summary: Avg Loss: 2.1624, Accuracy: 0.2889, F1 (Macro): 0.2864

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 1.3194
  Epoch 11 [Batch 4/40]: Loss: 2.3437
  Epoch 11 [Batch 8/40]: Loss: 0.7569
  Epoch 11 [Batch 12/40]: Loss: 2.2930
  Epoch 11 [Batch 16/40]: Loss: 2.0079
  Epoch 11 [Batch 20/40]: Loss: 1.8839
  Epoch 11 [Batch 24/40]: Loss: 1.2585
  Epoch 11 [Batch 28/40]: Loss: 2.0871
  Epoch 11 [Batch 32/40]: Loss: 1.1138
  Epoch 11 [Batch 36/40]: Loss: 2.3830
  Epoch 11 Train Summary: Avg Loss: 1.4729, Accuracy: 0.4767
  Validation Summary: Avg Loss: 2.1595, Accuracy: 0.3694, F1 (Macro): 0.3368

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 1.2015
  Epoch 12 [Batch 4/40]: Loss: 1.6247
  Epoch 12 [Batch 8/40]: Loss: 2.0075
  Epoch 12 [Batch 12/40]: Loss: 0.4296
  Epoch 12 [Batch 16/40]: Loss: 0.5308
  Epoch 12 [Batch 20/40]: Loss: 1.8558
  Epoch 12 [Batch 24/40]: Loss: 1.1691
  Epoch 12 [Batch 28/40]: Loss: 1.7007
  Epoch 12 [Batch 32/40]: Loss: 1.8735
  Epoch 12 [Batch 36/40]: Loss: 1.3432
  Epoch 12 Train Summary: Avg Loss: 1.2648, Accuracy: 0.5400
  Validation Summary: Avg Loss: 2.3145, Accuracy: 0.2889, F1 (Macro): 0.2894

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.6558
  Epoch 13 [Batch 4/40]: Loss: 0.2295
  Epoch 13 [Batch 8/40]: Loss: 1.7458
  Epoch 13 [Batch 12/40]: Loss: 0.8625
  Epoch 13 [Batch 16/40]: Loss: 0.8958
  Epoch 13 [Batch 20/40]: Loss: 0.7062
  Epoch 13 [Batch 24/40]: Loss: 0.7680
  Epoch 13 [Batch 28/40]: Loss: 2.2824
  Epoch 13 [Batch 32/40]: Loss: 1.0535
  Epoch 13 [Batch 36/40]: Loss: 1.4827
  Epoch 13 Train Summary: Avg Loss: 1.1673, Accuracy: 0.5401
  Validation Summary: Avg Loss: 2.0974, Accuracy: 0.2889, F1 (Macro): 0.2842
  New best model! Val loss improved from 2.1277 to 2.0974. Saving...

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 1.2833
  Epoch 14 [Batch 4/40]: Loss: 0.5594
  Epoch 14 [Batch 8/40]: Loss: 1.9423
  Epoch 14 [Batch 12/40]: Loss: 1.0739
  Epoch 14 [Batch 16/40]: Loss: 1.6755
  Epoch 14 [Batch 20/40]: Loss: 1.8160
  Epoch 14 [Batch 24/40]: Loss: 0.6005
  Epoch 14 [Batch 28/40]: Loss: 1.7550
  Epoch 14 [Batch 32/40]: Loss: 1.1205
  Epoch 14 [Batch 36/40]: Loss: 0.7360
  Epoch 14 Train Summary: Avg Loss: 1.2409, Accuracy: 0.4726
  Validation Summary: Avg Loss: 2.5890, Accuracy: 0.3278, F1 (Macro): 0.2919
Training finished in 6.89 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 2.0974, Accuracy: 0.2889, F1 (Macro): 0.2842
Final Best Model Stats: Acc: 0.2889, F1: 0.2842, Loss: 2.0974
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=224x224 lr=1e-05 drop=0.0 seed=999
================================================================================
Starting experiment: efficientnet_b0__224x224__lr-1e-05__drop-0.0__seed-999
Output directory: results_opg/efficientnet_b0__224x224__lr-1e-05__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 2.2709
  Epoch 0 [Batch 4/40]: Loss: 2.9544
  Epoch 0 [Batch 8/40]: Loss: 2.2708
  Epoch 0 [Batch 12/40]: Loss: 2.6501
  Epoch 0 [Batch 16/40]: Loss: 1.7738
  Epoch 0 [Batch 20/40]: Loss: 3.3487
  Epoch 0 [Batch 24/40]: Loss: 3.1417
  Epoch 0 [Batch 28/40]: Loss: 3.2705
  Epoch 0 [Batch 32/40]: Loss: 2.6681
  Epoch 0 [Batch 36/40]: Loss: 1.8476
  Epoch 0 Train Summary: Avg Loss: 2.5872, Accuracy: 0.3271
  Validation Summary: Avg Loss: 3.1141, Accuracy: 0.4222, F1 (Macro): 0.3567
  New best model! Val loss improved from inf to 3.1141. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 3.5820
  Epoch 1 [Batch 4/40]: Loss: 2.7447
  Epoch 1 [Batch 8/40]: Loss: 1.0141
  Epoch 1 [Batch 12/40]: Loss: 2.2592
  Epoch 1 [Batch 16/40]: Loss: 0.9544
  Epoch 1 [Batch 20/40]: Loss: 0.9549
  Epoch 1 [Batch 24/40]: Loss: 1.8553
  Epoch 1 [Batch 28/40]: Loss: 2.4826
  Epoch 1 [Batch 32/40]: Loss: 3.6053
  Epoch 1 [Batch 36/40]: Loss: 1.9485
  Epoch 1 Train Summary: Avg Loss: 2.4729, Accuracy: 0.3175
  Validation Summary: Avg Loss: 2.7457, Accuracy: 0.3139, F1 (Macro): 0.2655
  New best model! Val loss improved from 3.1141 to 2.7457. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 3.1723
  Epoch 2 [Batch 4/40]: Loss: 3.2683
  Epoch 2 [Batch 8/40]: Loss: 1.4293
  Epoch 2 [Batch 12/40]: Loss: 2.5835
  Epoch 2 [Batch 16/40]: Loss: 2.0644
  Epoch 2 [Batch 20/40]: Loss: 1.2959
  Epoch 2 [Batch 24/40]: Loss: 2.4833
  Epoch 2 [Batch 28/40]: Loss: 2.9447
  Epoch 2 [Batch 32/40]: Loss: 4.5146
  Epoch 2 [Batch 36/40]: Loss: 3.6813
  Epoch 2 Train Summary: Avg Loss: 2.3706, Accuracy: 0.3876
  Validation Summary: Avg Loss: 3.2560, Accuracy: 0.2306, F1 (Macro): 0.1724

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 3.7884
  Epoch 3 [Batch 4/40]: Loss: 2.2642
  Epoch 3 [Batch 8/40]: Loss: 1.6173
  Epoch 3 [Batch 12/40]: Loss: 3.2417
  Epoch 3 [Batch 16/40]: Loss: 1.2049
  Epoch 3 [Batch 20/40]: Loss: 2.6151
  Epoch 3 [Batch 24/40]: Loss: 2.4470
  Epoch 3 [Batch 28/40]: Loss: 1.4962
  Epoch 3 [Batch 32/40]: Loss: 2.1693
  Epoch 3 [Batch 36/40]: Loss: 2.1575
  Epoch 3 Train Summary: Avg Loss: 2.0670, Accuracy: 0.3938
  Validation Summary: Avg Loss: 3.0098, Accuracy: 0.4111, F1 (Macro): 0.3800

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 1.1504
  Epoch 4 [Batch 4/40]: Loss: 1.9780
  Epoch 4 [Batch 8/40]: Loss: 1.7894
  Epoch 4 [Batch 12/40]: Loss: 2.1771
  Epoch 4 [Batch 16/40]: Loss: 3.8611
  Epoch 4 [Batch 20/40]: Loss: 1.6657
  Epoch 4 [Batch 24/40]: Loss: 2.2880
  Epoch 4 [Batch 28/40]: Loss: 1.7230
  Epoch 4 [Batch 32/40]: Loss: 1.5241
  Epoch 4 [Batch 36/40]: Loss: 2.0941
  Epoch 4 Train Summary: Avg Loss: 1.8854, Accuracy: 0.3618
  Validation Summary: Avg Loss: 2.8025, Accuracy: 0.2056, F1 (Macro): 0.2115

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 1.6599
  Epoch 5 [Batch 4/40]: Loss: 2.1658
  Epoch 5 [Batch 8/40]: Loss: 2.4788
  Epoch 5 [Batch 12/40]: Loss: 0.9570
  Epoch 5 [Batch 16/40]: Loss: 1.8664
  Epoch 5 [Batch 20/40]: Loss: 1.1573
  Epoch 5 [Batch 24/40]: Loss: 1.0630
  Epoch 5 [Batch 28/40]: Loss: 2.3666
  Epoch 5 [Batch 32/40]: Loss: 1.4978
  Epoch 5 [Batch 36/40]: Loss: 0.7984
  Epoch 5 Train Summary: Avg Loss: 2.0236, Accuracy: 0.3601
  Validation Summary: Avg Loss: 2.2600, Accuracy: 0.2472, F1 (Macro): 0.2590
  New best model! Val loss improved from 2.7457 to 2.2600. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 1.5873
  Epoch 6 [Batch 4/40]: Loss: 1.1764
  Epoch 6 [Batch 8/40]: Loss: 1.4903
  Epoch 6 [Batch 12/40]: Loss: 1.7611
  Epoch 6 [Batch 16/40]: Loss: 1.3913
  Epoch 6 [Batch 20/40]: Loss: 2.4979
  Epoch 6 [Batch 24/40]: Loss: 0.8589
  Epoch 6 [Batch 28/40]: Loss: 2.2168
  Epoch 6 [Batch 32/40]: Loss: 1.5674
  Epoch 6 [Batch 36/40]: Loss: 1.4191
  Epoch 6 Train Summary: Avg Loss: 1.5065, Accuracy: 0.4132
  Validation Summary: Avg Loss: 2.5002, Accuracy: 0.3556, F1 (Macro): 0.3047

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 2.1034
  Epoch 7 [Batch 4/40]: Loss: 1.7213
  Epoch 7 [Batch 8/40]: Loss: 2.2246
  Epoch 7 [Batch 12/40]: Loss: 1.4941
  Epoch 7 [Batch 16/40]: Loss: 1.2202
  Epoch 7 [Batch 20/40]: Loss: 0.9092
  Epoch 7 [Batch 24/40]: Loss: 0.7839
  Epoch 7 [Batch 28/40]: Loss: 0.5177
  Epoch 7 [Batch 32/40]: Loss: 1.9988
  Epoch 7 [Batch 36/40]: Loss: 1.1180
  Epoch 7 Train Summary: Avg Loss: 1.5168, Accuracy: 0.4038
  Validation Summary: Avg Loss: 2.7696, Accuracy: 0.3000, F1 (Macro): 0.2449

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 1.5271
  Epoch 8 [Batch 4/40]: Loss: 1.6984
  Epoch 8 [Batch 8/40]: Loss: 2.9018
  Epoch 8 [Batch 12/40]: Loss: 3.2103
  Epoch 8 [Batch 16/40]: Loss: 1.8428
  Epoch 8 [Batch 20/40]: Loss: 0.7147
  Epoch 8 [Batch 24/40]: Loss: 1.5985
  Epoch 8 [Batch 28/40]: Loss: 3.3120
  Epoch 8 [Batch 32/40]: Loss: 0.9074
  Epoch 8 [Batch 36/40]: Loss: 1.4391
  Epoch 8 Train Summary: Avg Loss: 1.6821, Accuracy: 0.4175
  Validation Summary: Avg Loss: 2.2415, Accuracy: 0.2889, F1 (Macro): 0.2897
  New best model! Val loss improved from 2.2600 to 2.2415. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 2.8183
  Epoch 9 [Batch 4/40]: Loss: 2.0989
  Epoch 9 [Batch 8/40]: Loss: 1.4615
  Epoch 9 [Batch 12/40]: Loss: 2.1980
  Epoch 9 [Batch 16/40]: Loss: 0.9334
  Epoch 9 [Batch 20/40]: Loss: 1.4953
  Epoch 9 [Batch 24/40]: Loss: 0.7592
  Epoch 9 [Batch 28/40]: Loss: 1.6424
  Epoch 9 [Batch 32/40]: Loss: 0.6714
  Epoch 9 [Batch 36/40]: Loss: 1.5280
  Epoch 9 Train Summary: Avg Loss: 1.4095, Accuracy: 0.4896
  Validation Summary: Avg Loss: 2.0718, Accuracy: 0.2889, F1 (Macro): 0.2967
  New best model! Val loss improved from 2.2415 to 2.0718. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 0.5362
  Epoch 10 [Batch 4/40]: Loss: 0.8148
  Epoch 10 [Batch 8/40]: Loss: 0.4808
  Epoch 10 [Batch 12/40]: Loss: 1.0407
  Epoch 10 [Batch 16/40]: Loss: 0.8467
  Epoch 10 [Batch 20/40]: Loss: 1.3606
  Epoch 10 [Batch 24/40]: Loss: 1.7890
  Epoch 10 [Batch 28/40]: Loss: 1.9825
  Epoch 10 [Batch 32/40]: Loss: 2.0990
  Epoch 10 [Batch 36/40]: Loss: 0.6038
  Epoch 10 Train Summary: Avg Loss: 1.4489, Accuracy: 0.4866
  Validation Summary: Avg Loss: 2.2025, Accuracy: 0.3694, F1 (Macro): 0.3406

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 1.8283
  Epoch 11 [Batch 4/40]: Loss: 1.2453
  Epoch 11 [Batch 8/40]: Loss: 1.1260
  Epoch 11 [Batch 12/40]: Loss: 0.5673
  Epoch 11 [Batch 16/40]: Loss: 2.0705
  Epoch 11 [Batch 20/40]: Loss: 1.2705
  Epoch 11 [Batch 24/40]: Loss: 2.1672
  Epoch 11 [Batch 28/40]: Loss: 1.2653
  Epoch 11 [Batch 32/40]: Loss: 0.5492
  Epoch 11 [Batch 36/40]: Loss: 1.5759
  Epoch 11 Train Summary: Avg Loss: 1.2595, Accuracy: 0.4945
  Validation Summary: Avg Loss: 1.9616, Accuracy: 0.3444, F1 (Macro): 0.3459
  New best model! Val loss improved from 2.0718 to 1.9616. Saving...

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 1.6060
  Epoch 12 [Batch 4/40]: Loss: 1.2561
  Epoch 12 [Batch 8/40]: Loss: 1.1198
  Epoch 12 [Batch 12/40]: Loss: 1.8813
  Epoch 12 [Batch 16/40]: Loss: 1.5268
  Epoch 12 [Batch 20/40]: Loss: 1.0861
  Epoch 12 [Batch 24/40]: Loss: 0.8102
  Epoch 12 [Batch 28/40]: Loss: 1.3652
  Epoch 12 [Batch 32/40]: Loss: 2.0000
  Epoch 12 [Batch 36/40]: Loss: 0.6271
  Epoch 12 Train Summary: Avg Loss: 1.2285, Accuracy: 0.5396
  Validation Summary: Avg Loss: 1.9997, Accuracy: 0.3028, F1 (Macro): 0.3050

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.5094
  Epoch 13 [Batch 4/40]: Loss: 0.5333
  Epoch 13 [Batch 8/40]: Loss: 1.4891
  Epoch 13 [Batch 12/40]: Loss: 1.2215
  Epoch 13 [Batch 16/40]: Loss: 0.6608
  Epoch 13 [Batch 20/40]: Loss: 3.3272
  Epoch 13 [Batch 24/40]: Loss: 1.0182
  Epoch 13 [Batch 28/40]: Loss: 0.8832
  Epoch 13 [Batch 32/40]: Loss: 0.6163
  Epoch 13 [Batch 36/40]: Loss: 1.3205
  Epoch 13 Train Summary: Avg Loss: 1.1731, Accuracy: 0.5241
  Validation Summary: Avg Loss: 1.8635, Accuracy: 0.3028, F1 (Macro): 0.3069
  New best model! Val loss improved from 1.9616 to 1.8635. Saving...

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 1.6675
  Epoch 14 [Batch 4/40]: Loss: 0.9085
  Epoch 14 [Batch 8/40]: Loss: 2.0549
  Epoch 14 [Batch 12/40]: Loss: 1.3728
  Epoch 14 [Batch 16/40]: Loss: 2.0425
  Epoch 14 [Batch 20/40]: Loss: 1.7950
  Epoch 14 [Batch 24/40]: Loss: 0.3622
  Epoch 14 [Batch 28/40]: Loss: 1.9493
  Epoch 14 [Batch 32/40]: Loss: 1.2532
  Epoch 14 [Batch 36/40]: Loss: 0.8756
  Epoch 14 Train Summary: Avg Loss: 1.2356, Accuracy: 0.4755
  Validation Summary: Avg Loss: 2.2572, Accuracy: 0.2222, F1 (Macro): 0.2586
Training finished in 6.87 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.8635, Accuracy: 0.3028, F1 (Macro): 0.3069
Final Best Model Stats: Acc: 0.3028, F1: 0.3069, Loss: 1.8635
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=384x384 lr=0.0001 drop=0.0 seed=42
================================================================================
Starting experiment: efficientnet_b0__384x384__lr-0.0001__drop-0.0__seed-42
Output directory: results_opg/efficientnet_b0__384x384__lr-0.0001__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 2.0517
  Epoch 0 [Batch 4/40]: Loss: 1.7635
  Epoch 0 [Batch 8/40]: Loss: 1.5430
  Epoch 0 [Batch 12/40]: Loss: 1.5989
  Epoch 0 [Batch 16/40]: Loss: 2.0520
  Epoch 0 [Batch 20/40]: Loss: 2.5582
  Epoch 0 [Batch 24/40]: Loss: 2.7699
  Epoch 0 [Batch 28/40]: Loss: 1.2867
  Epoch 0 [Batch 32/40]: Loss: 2.0371
  Epoch 0 [Batch 36/40]: Loss: 0.9557
  Epoch 0 Train Summary: Avg Loss: 1.8055, Accuracy: 0.3332
  Validation Summary: Avg Loss: 1.3178, Accuracy: 0.4278, F1 (Macro): 0.4125
  New best model! Val loss improved from inf to 1.3178. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 2.0238
  Epoch 1 [Batch 4/40]: Loss: 0.7671
  Epoch 1 [Batch 8/40]: Loss: 0.7338
  Epoch 1 [Batch 12/40]: Loss: 0.5805
  Epoch 1 [Batch 16/40]: Loss: 2.4438
  Epoch 1 [Batch 20/40]: Loss: 1.4079
  Epoch 1 [Batch 24/40]: Loss: 1.4306
  Epoch 1 [Batch 28/40]: Loss: 1.1317
  Epoch 1 [Batch 32/40]: Loss: 0.9039
  Epoch 1 [Batch 36/40]: Loss: 1.3388
  Epoch 1 Train Summary: Avg Loss: 1.0818, Accuracy: 0.5362
  Validation Summary: Avg Loss: 0.9696, Accuracy: 0.4556, F1 (Macro): 0.4542
  New best model! Val loss improved from 1.3178 to 0.9696. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.6152
  Epoch 2 [Batch 4/40]: Loss: 0.8925
  Epoch 2 [Batch 8/40]: Loss: 1.9388
  Epoch 2 [Batch 12/40]: Loss: 1.3641
  Epoch 2 [Batch 16/40]: Loss: 1.3057
  Epoch 2 [Batch 20/40]: Loss: 1.1048
  Epoch 2 [Batch 24/40]: Loss: 1.3516
  Epoch 2 [Batch 28/40]: Loss: 1.3453
  Epoch 2 [Batch 32/40]: Loss: 0.3865
  Epoch 2 [Batch 36/40]: Loss: 1.5854
  Epoch 2 Train Summary: Avg Loss: 0.8915, Accuracy: 0.6306
  Validation Summary: Avg Loss: 1.2633, Accuracy: 0.3889, F1 (Macro): 0.3620

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 0.4890
  Epoch 3 [Batch 4/40]: Loss: 0.2679
  Epoch 3 [Batch 8/40]: Loss: 0.4569
  Epoch 3 [Batch 12/40]: Loss: 0.5118
  Epoch 3 [Batch 16/40]: Loss: 0.9923
  Epoch 3 [Batch 20/40]: Loss: 2.0486
  Epoch 3 [Batch 24/40]: Loss: 0.9280
  Epoch 3 [Batch 28/40]: Loss: 0.5195
  Epoch 3 [Batch 32/40]: Loss: 1.2965
  Epoch 3 [Batch 36/40]: Loss: 0.6115
  Epoch 3 Train Summary: Avg Loss: 0.6202, Accuracy: 0.6957
  Validation Summary: Avg Loss: 1.1527, Accuracy: 0.3889, F1 (Macro): 0.3580

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 0.2127
  Epoch 4 [Batch 4/40]: Loss: 0.1248
  Epoch 4 [Batch 8/40]: Loss: 0.7790
  Epoch 4 [Batch 12/40]: Loss: 0.1480
  Epoch 4 [Batch 16/40]: Loss: 0.5400
  Epoch 4 [Batch 20/40]: Loss: 0.3062
  Epoch 4 [Batch 24/40]: Loss: 0.3742
  Epoch 4 [Batch 28/40]: Loss: 1.0963
  Epoch 4 [Batch 32/40]: Loss: 0.6223
  Epoch 4 [Batch 36/40]: Loss: 1.1071
  Epoch 4 Train Summary: Avg Loss: 0.5655, Accuracy: 0.7214
  Validation Summary: Avg Loss: 1.1261, Accuracy: 0.3889, F1 (Macro): 0.3751

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 0.5671
  Epoch 5 [Batch 4/40]: Loss: 0.2350
  Epoch 5 [Batch 8/40]: Loss: 0.1363
  Epoch 5 [Batch 12/40]: Loss: 0.8421
  Epoch 5 [Batch 16/40]: Loss: 0.3826
  Epoch 5 [Batch 20/40]: Loss: 0.9031
  Epoch 5 [Batch 24/40]: Loss: 0.8803
  Epoch 5 [Batch 28/40]: Loss: 0.1651
  Epoch 5 [Batch 32/40]: Loss: 0.1933
  Epoch 5 [Batch 36/40]: Loss: 1.0626
  Epoch 5 Train Summary: Avg Loss: 0.5033, Accuracy: 0.7787
  Validation Summary: Avg Loss: 1.6754, Accuracy: 0.4417, F1 (Macro): 0.4029

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 0.2368
  Epoch 6 [Batch 4/40]: Loss: 0.1234
  Epoch 6 [Batch 8/40]: Loss: 0.6221
  Epoch 6 [Batch 12/40]: Loss: 0.5353
  Epoch 6 [Batch 16/40]: Loss: 0.1212
  Epoch 6 [Batch 20/40]: Loss: 0.1328
  Epoch 6 [Batch 24/40]: Loss: 0.3146
  Epoch 6 [Batch 28/40]: Loss: 1.1174
  Epoch 6 [Batch 32/40]: Loss: 0.8656
  Epoch 6 [Batch 36/40]: Loss: 0.0768
  Epoch 6 Train Summary: Avg Loss: 0.3303, Accuracy: 0.8549
  Validation Summary: Avg Loss: 1.4080, Accuracy: 0.4278, F1 (Macro): 0.4127

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 0.5553
  Epoch 7 [Batch 4/40]: Loss: 0.1916
  Epoch 7 [Batch 8/40]: Loss: 0.1300
  Epoch 7 [Batch 12/40]: Loss: 0.1697
  Epoch 7 [Batch 16/40]: Loss: 0.1691
  Epoch 7 [Batch 20/40]: Loss: 0.4232
  Epoch 7 [Batch 24/40]: Loss: 0.1255
  Epoch 7 [Batch 28/40]: Loss: 0.1313
  Epoch 7 [Batch 32/40]: Loss: 0.7001
  Epoch 7 [Batch 36/40]: Loss: 0.4400
  Epoch 7 Train Summary: Avg Loss: 0.2766, Accuracy: 0.8614
  Validation Summary: Avg Loss: 1.3423, Accuracy: 0.4306, F1 (Macro): 0.4000

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.1030
  Epoch 8 [Batch 4/40]: Loss: 0.0645
  Epoch 8 [Batch 8/40]: Loss: 0.2174
  Epoch 8 [Batch 12/40]: Loss: 0.0263
  Epoch 8 [Batch 16/40]: Loss: 0.6094
  Epoch 8 [Batch 20/40]: Loss: 0.2346
  Epoch 8 [Batch 24/40]: Loss: 0.4502
  Epoch 8 [Batch 28/40]: Loss: 0.1881
  Epoch 8 [Batch 32/40]: Loss: 0.2159
  Epoch 8 [Batch 36/40]: Loss: 1.6443
  Epoch 8 Train Summary: Avg Loss: 0.2882, Accuracy: 0.8627
  Validation Summary: Avg Loss: 1.4509, Accuracy: 0.3750, F1 (Macro): 0.3535

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.0189
  Epoch 9 [Batch 4/40]: Loss: 0.6559
  Epoch 9 [Batch 8/40]: Loss: 0.2154
  Epoch 9 [Batch 12/40]: Loss: 0.0782
  Epoch 9 [Batch 16/40]: Loss: 0.1854
  Epoch 9 [Batch 20/40]: Loss: 0.1303
  Epoch 9 [Batch 24/40]: Loss: 0.2934
  Epoch 9 [Batch 28/40]: Loss: 0.0511
  Epoch 9 [Batch 32/40]: Loss: 0.0185
  Epoch 9 [Batch 36/40]: Loss: 0.0210
  Epoch 9 Train Summary: Avg Loss: 0.1977, Accuracy: 0.8950
  Validation Summary: Avg Loss: 1.4710, Accuracy: 0.3889, F1 (Macro): 0.3618

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 0.1973
  Epoch 10 [Batch 4/40]: Loss: 0.2887
  Epoch 10 [Batch 8/40]: Loss: 0.1688
  Epoch 10 [Batch 12/40]: Loss: 0.1985
  Epoch 10 [Batch 16/40]: Loss: 0.3789
  Epoch 10 [Batch 20/40]: Loss: 0.2511
  Epoch 10 [Batch 24/40]: Loss: 0.1908
  Epoch 10 [Batch 28/40]: Loss: 0.3109
  Epoch 10 [Batch 32/40]: Loss: 0.1194
  Epoch 10 [Batch 36/40]: Loss: 0.1099
  Epoch 10 Train Summary: Avg Loss: 0.3224, Accuracy: 0.8439
  Validation Summary: Avg Loss: 1.4548, Accuracy: 0.4167, F1 (Macro): 0.3842

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.1277
  Epoch 11 [Batch 4/40]: Loss: 0.0787
  Epoch 11 [Batch 8/40]: Loss: 0.2950
  Epoch 11 [Batch 12/40]: Loss: 0.3850
  Epoch 11 [Batch 16/40]: Loss: 0.0639
  Epoch 11 [Batch 20/40]: Loss: 0.0769
  Epoch 11 [Batch 24/40]: Loss: 0.1629
  Epoch 11 [Batch 28/40]: Loss: 0.2042
  Epoch 11 [Batch 32/40]: Loss: 0.1574
  Epoch 11 [Batch 36/40]: Loss: 0.0523
  Epoch 11 Train Summary: Avg Loss: 0.1816, Accuracy: 0.9153
  Validation Summary: Avg Loss: 1.2674, Accuracy: 0.3889, F1 (Macro): 0.3741

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.0199
  Epoch 12 [Batch 4/40]: Loss: 0.0663
  Epoch 12 [Batch 8/40]: Loss: 0.4560
  Epoch 12 [Batch 12/40]: Loss: 0.2531
  Epoch 12 [Batch 16/40]: Loss: 0.0684
  Epoch 12 [Batch 20/40]: Loss: 0.0293
  Epoch 12 [Batch 24/40]: Loss: 0.1132
  Epoch 12 [Batch 28/40]: Loss: 0.1464
  Epoch 12 [Batch 32/40]: Loss: 0.7826
  Epoch 12 [Batch 36/40]: Loss: 0.1468
  Epoch 12 Train Summary: Avg Loss: 0.1607, Accuracy: 0.9056
  Validation Summary: Avg Loss: 1.3295, Accuracy: 0.3889, F1 (Macro): 0.3741

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.2728
  Epoch 13 [Batch 4/40]: Loss: 0.1495
  Epoch 13 [Batch 8/40]: Loss: 0.0984
  Epoch 13 [Batch 12/40]: Loss: 0.0485
  Epoch 13 [Batch 16/40]: Loss: 0.1681
  Epoch 13 [Batch 20/40]: Loss: 0.0582
  Epoch 13 [Batch 24/40]: Loss: 0.4649
  Epoch 13 [Batch 28/40]: Loss: 0.1076
  Epoch 13 [Batch 32/40]: Loss: 0.0261
  Epoch 13 [Batch 36/40]: Loss: 0.1158
  Epoch 13 Train Summary: Avg Loss: 0.1599, Accuracy: 0.9023
  Validation Summary: Avg Loss: 1.3370, Accuracy: 0.3889, F1 (Macro): 0.3696

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 0.0955
  Epoch 14 [Batch 4/40]: Loss: 0.2223
  Epoch 14 [Batch 8/40]: Loss: 0.0265
  Epoch 14 [Batch 12/40]: Loss: 0.0255
  Epoch 14 [Batch 16/40]: Loss: 0.0531
  Epoch 14 [Batch 20/40]: Loss: 0.1317
  Epoch 14 [Batch 24/40]: Loss: 0.0615
  Epoch 14 [Batch 28/40]: Loss: 0.9865
  Epoch 14 [Batch 32/40]: Loss: 0.8262
  Epoch 14 [Batch 36/40]: Loss: 0.0583
  Epoch 14 Train Summary: Avg Loss: 0.1989, Accuracy: 0.9202
  Validation Summary: Avg Loss: 1.1683, Accuracy: 0.3889, F1 (Macro): 0.3630
Training finished in 5.87 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.9696, Accuracy: 0.4556, F1 (Macro): 0.4542
Final Best Model Stats: Acc: 0.4556, F1: 0.4542, Loss: 0.9696
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=384x384 lr=0.0001 drop=0.0 seed=123
================================================================================
Starting experiment: efficientnet_b0__384x384__lr-0.0001__drop-0.0__seed-123
Output directory: results_opg/efficientnet_b0__384x384__lr-0.0001__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 2.2355
  Epoch 0 [Batch 4/40]: Loss: 1.9593
  Epoch 0 [Batch 8/40]: Loss: 1.2494
  Epoch 0 [Batch 12/40]: Loss: 2.0887
  Epoch 0 [Batch 16/40]: Loss: 0.7182
  Epoch 0 [Batch 20/40]: Loss: 2.6089
  Epoch 0 [Batch 24/40]: Loss: 1.4932
  Epoch 0 [Batch 28/40]: Loss: 0.9068
  Epoch 0 [Batch 32/40]: Loss: 2.3515
  Epoch 0 [Batch 36/40]: Loss: 2.2185
  Epoch 0 Train Summary: Avg Loss: 1.8625, Accuracy: 0.3168
  Validation Summary: Avg Loss: 2.0376, Accuracy: 0.3306, F1 (Macro): 0.3086
  New best model! Val loss improved from inf to 2.0376. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 0.8738
  Epoch 1 [Batch 4/40]: Loss: 1.7157
  Epoch 1 [Batch 8/40]: Loss: 0.9383
  Epoch 1 [Batch 12/40]: Loss: 2.9469
  Epoch 1 [Batch 16/40]: Loss: 1.2265
  Epoch 1 [Batch 20/40]: Loss: 0.8040
  Epoch 1 [Batch 24/40]: Loss: 1.0064
  Epoch 1 [Batch 28/40]: Loss: 0.9484
  Epoch 1 [Batch 32/40]: Loss: 1.1495
  Epoch 1 [Batch 36/40]: Loss: 2.2884
  Epoch 1 Train Summary: Avg Loss: 1.2009, Accuracy: 0.5055
  Validation Summary: Avg Loss: 2.5178, Accuracy: 0.3389, F1 (Macro): 0.2610

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.9796
  Epoch 2 [Batch 4/40]: Loss: 1.3858
  Epoch 2 [Batch 8/40]: Loss: 1.0068
  Epoch 2 [Batch 12/40]: Loss: 0.4959
  Epoch 2 [Batch 16/40]: Loss: 0.4418
  Epoch 2 [Batch 20/40]: Loss: 0.6824
  Epoch 2 [Batch 24/40]: Loss: 1.2504
  Epoch 2 [Batch 28/40]: Loss: 0.6409
  Epoch 2 [Batch 32/40]: Loss: 0.3163
  Epoch 2 [Batch 36/40]: Loss: 1.5016
  Epoch 2 Train Summary: Avg Loss: 0.9391, Accuracy: 0.6039
  Validation Summary: Avg Loss: 1.5515, Accuracy: 0.4806, F1 (Macro): 0.4451
  New best model! Val loss improved from 2.0376 to 1.5515. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 0.4176
  Epoch 3 [Batch 4/40]: Loss: 0.4938
  Epoch 3 [Batch 8/40]: Loss: 0.5174
  Epoch 3 [Batch 12/40]: Loss: 0.4022
  Epoch 3 [Batch 16/40]: Loss: 0.6211
  Epoch 3 [Batch 20/40]: Loss: 0.7235
  Epoch 3 [Batch 24/40]: Loss: 0.5196
  Epoch 3 [Batch 28/40]: Loss: 1.0142
  Epoch 3 [Batch 32/40]: Loss: 1.6568
  Epoch 3 [Batch 36/40]: Loss: 0.1555
  Epoch 3 Train Summary: Avg Loss: 0.7222, Accuracy: 0.6595
  Validation Summary: Avg Loss: 1.5199, Accuracy: 0.3861, F1 (Macro): 0.3757
  New best model! Val loss improved from 1.5515 to 1.5199. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 0.5616
  Epoch 4 [Batch 4/40]: Loss: 0.4831
  Epoch 4 [Batch 8/40]: Loss: 0.5577
  Epoch 4 [Batch 12/40]: Loss: 1.1304
  Epoch 4 [Batch 16/40]: Loss: 0.5495
  Epoch 4 [Batch 20/40]: Loss: 1.1473
  Epoch 4 [Batch 24/40]: Loss: 0.1977
  Epoch 4 [Batch 28/40]: Loss: 0.4877
  Epoch 4 [Batch 32/40]: Loss: 0.3127
  Epoch 4 [Batch 36/40]: Loss: 0.2349
  Epoch 4 Train Summary: Avg Loss: 0.5581, Accuracy: 0.7337
  Validation Summary: Avg Loss: 1.5074, Accuracy: 0.4389, F1 (Macro): 0.3911
  New best model! Val loss improved from 1.5199 to 1.5074. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 0.1270
  Epoch 5 [Batch 4/40]: Loss: 0.1343
  Epoch 5 [Batch 8/40]: Loss: 0.3732
  Epoch 5 [Batch 12/40]: Loss: 0.4346
  Epoch 5 [Batch 16/40]: Loss: 0.5624
  Epoch 5 [Batch 20/40]: Loss: 0.2990
  Epoch 5 [Batch 24/40]: Loss: 0.4409
  Epoch 5 [Batch 28/40]: Loss: 0.4783
  Epoch 5 [Batch 32/40]: Loss: 0.7233
  Epoch 5 [Batch 36/40]: Loss: 0.4533
  Epoch 5 Train Summary: Avg Loss: 0.5163, Accuracy: 0.7908
  Validation Summary: Avg Loss: 1.6694, Accuracy: 0.3722, F1 (Macro): 0.3478

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 0.8512
  Epoch 6 [Batch 4/40]: Loss: 0.5149
  Epoch 6 [Batch 8/40]: Loss: 0.2235
  Epoch 6 [Batch 12/40]: Loss: 0.1659
  Epoch 6 [Batch 16/40]: Loss: 0.1834
  Epoch 6 [Batch 20/40]: Loss: 0.1039
  Epoch 6 [Batch 24/40]: Loss: 0.3987
  Epoch 6 [Batch 28/40]: Loss: 0.8214
  Epoch 6 [Batch 32/40]: Loss: 0.1693
  Epoch 6 [Batch 36/40]: Loss: 0.5838
  Epoch 6 Train Summary: Avg Loss: 0.3948, Accuracy: 0.7968
  Validation Summary: Avg Loss: 1.5832, Accuracy: 0.4389, F1 (Macro): 0.4127

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 0.2815
  Epoch 7 [Batch 4/40]: Loss: 0.0558
  Epoch 7 [Batch 8/40]: Loss: 0.0651
  Epoch 7 [Batch 12/40]: Loss: 0.0988
  Epoch 7 [Batch 16/40]: Loss: 0.3588
  Epoch 7 [Batch 20/40]: Loss: 0.0749
  Epoch 7 [Batch 24/40]: Loss: 0.0510
  Epoch 7 [Batch 28/40]: Loss: 0.3096
  Epoch 7 [Batch 32/40]: Loss: 0.3857
  Epoch 7 [Batch 36/40]: Loss: 0.1023
  Epoch 7 Train Summary: Avg Loss: 0.3296, Accuracy: 0.8626
  Validation Summary: Avg Loss: 1.5224, Accuracy: 0.4139, F1 (Macro): 0.4212

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.0731
  Epoch 8 [Batch 4/40]: Loss: 0.2038
  Epoch 8 [Batch 8/40]: Loss: 0.0352
  Epoch 8 [Batch 12/40]: Loss: 0.3844
  Epoch 8 [Batch 16/40]: Loss: 0.0928
  Epoch 8 [Batch 20/40]: Loss: 0.3665
  Epoch 8 [Batch 24/40]: Loss: 0.3515
  Epoch 8 [Batch 28/40]: Loss: 0.1507
  Epoch 8 [Batch 32/40]: Loss: 0.3827
  Epoch 8 [Batch 36/40]: Loss: 0.3314
  Epoch 8 Train Summary: Avg Loss: 0.3008, Accuracy: 0.8446
  Validation Summary: Avg Loss: 1.4916, Accuracy: 0.3861, F1 (Macro): 0.3867
  New best model! Val loss improved from 1.5074 to 1.4916. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.0479
  Epoch 9 [Batch 4/40]: Loss: 0.0783
  Epoch 9 [Batch 8/40]: Loss: 0.5677
  Epoch 9 [Batch 12/40]: Loss: 0.6976
  Epoch 9 [Batch 16/40]: Loss: 0.5634
  Epoch 9 [Batch 20/40]: Loss: 0.3010
  Epoch 9 [Batch 24/40]: Loss: 0.2687
  Epoch 9 [Batch 28/40]: Loss: 0.4880
  Epoch 9 [Batch 32/40]: Loss: 0.0853
  Epoch 9 [Batch 36/40]: Loss: 0.2674
  Epoch 9 Train Summary: Avg Loss: 0.2756, Accuracy: 0.8921
  Validation Summary: Avg Loss: 1.6721, Accuracy: 0.3861, F1 (Macro): 0.3777

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 0.0663
  Epoch 10 [Batch 4/40]: Loss: 0.0139
  Epoch 10 [Batch 8/40]: Loss: 0.1456
  Epoch 10 [Batch 12/40]: Loss: 0.2038
  Epoch 10 [Batch 16/40]: Loss: 0.1472
  Epoch 10 [Batch 20/40]: Loss: 0.1262
  Epoch 10 [Batch 24/40]: Loss: 0.0295
  Epoch 10 [Batch 28/40]: Loss: 0.0309
  Epoch 10 [Batch 32/40]: Loss: 0.1166
  Epoch 10 [Batch 36/40]: Loss: 0.3461
  Epoch 10 Train Summary: Avg Loss: 0.1436, Accuracy: 0.9630
  Validation Summary: Avg Loss: 1.5797, Accuracy: 0.2639, F1 (Macro): 0.2575

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.2671
  Epoch 11 [Batch 4/40]: Loss: 0.2166
  Epoch 11 [Batch 8/40]: Loss: 0.5097
  Epoch 11 [Batch 12/40]: Loss: 0.1746
  Epoch 11 [Batch 16/40]: Loss: 0.1597
  Epoch 11 [Batch 20/40]: Loss: 1.2917
  Epoch 11 [Batch 24/40]: Loss: 0.3320
  Epoch 11 [Batch 28/40]: Loss: 0.1880
  Epoch 11 [Batch 32/40]: Loss: 0.6605
  Epoch 11 [Batch 36/40]: Loss: 0.0728
  Epoch 11 Train Summary: Avg Loss: 0.2339, Accuracy: 0.8989
  Validation Summary: Avg Loss: 1.4705, Accuracy: 0.3750, F1 (Macro): 0.3556
  New best model! Val loss improved from 1.4916 to 1.4705. Saving...

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.1265
  Epoch 12 [Batch 4/40]: Loss: 0.1938
  Epoch 12 [Batch 8/40]: Loss: 0.0852
  Epoch 12 [Batch 12/40]: Loss: 0.5091
  Epoch 12 [Batch 16/40]: Loss: 0.1997
  Epoch 12 [Batch 20/40]: Loss: 0.3978
  Epoch 12 [Batch 24/40]: Loss: 0.3261
  Epoch 12 [Batch 28/40]: Loss: 0.4811
  Epoch 12 [Batch 32/40]: Loss: 0.2118
  Epoch 12 [Batch 36/40]: Loss: 0.4535
  Epoch 12 Train Summary: Avg Loss: 0.2584, Accuracy: 0.8912
  Validation Summary: Avg Loss: 1.5439, Accuracy: 0.3194, F1 (Macro): 0.3071

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.0409
  Epoch 13 [Batch 4/40]: Loss: 0.2389
  Epoch 13 [Batch 8/40]: Loss: 0.1118
  Epoch 13 [Batch 12/40]: Loss: 0.9527
  Epoch 13 [Batch 16/40]: Loss: 0.2525
  Epoch 13 [Batch 20/40]: Loss: 0.1127
  Epoch 13 [Batch 24/40]: Loss: 0.1921
  Epoch 13 [Batch 28/40]: Loss: 0.4363
  Epoch 13 [Batch 32/40]: Loss: 0.1387
  Epoch 13 [Batch 36/40]: Loss: 0.0264
  Epoch 13 Train Summary: Avg Loss: 0.1929, Accuracy: 0.9438
  Validation Summary: Avg Loss: 1.6022, Accuracy: 0.3472, F1 (Macro): 0.3274

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 0.1767
  Epoch 14 [Batch 4/40]: Loss: 0.1804
  Epoch 14 [Batch 8/40]: Loss: 0.1087
  Epoch 14 [Batch 12/40]: Loss: 0.4234
  Epoch 14 [Batch 16/40]: Loss: 0.1535
  Epoch 14 [Batch 20/40]: Loss: 0.0259
  Epoch 14 [Batch 24/40]: Loss: 0.0558
  Epoch 14 [Batch 28/40]: Loss: 0.0051
  Epoch 14 [Batch 32/40]: Loss: 0.1013
  Epoch 14 [Batch 36/40]: Loss: 0.0054
  Epoch 14 Train Summary: Avg Loss: 0.1161, Accuracy: 0.9642
  Validation Summary: Avg Loss: 1.6682, Accuracy: 0.4000, F1 (Macro): 0.4152
Training finished in 5.56 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.4705, Accuracy: 0.3750, F1 (Macro): 0.3556
Final Best Model Stats: Acc: 0.3750, F1: 0.3556, Loss: 1.4705
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=384x384 lr=0.0001 drop=0.0 seed=999
================================================================================
Starting experiment: efficientnet_b0__384x384__lr-0.0001__drop-0.0__seed-999
Output directory: results_opg/efficientnet_b0__384x384__lr-0.0001__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 1.6707
  Epoch 0 [Batch 4/40]: Loss: 1.5997
  Epoch 0 [Batch 8/40]: Loss: 1.2830
  Epoch 0 [Batch 12/40]: Loss: 1.3004
  Epoch 0 [Batch 16/40]: Loss: 1.4531
  Epoch 0 [Batch 20/40]: Loss: 2.0578
  Epoch 0 [Batch 24/40]: Loss: 2.3752
  Epoch 0 [Batch 28/40]: Loss: 2.0316
  Epoch 0 [Batch 32/40]: Loss: 1.8520
  Epoch 0 [Batch 36/40]: Loss: 1.8522
  Epoch 0 Train Summary: Avg Loss: 1.6633, Accuracy: 0.3839
  Validation Summary: Avg Loss: 2.4807, Accuracy: 0.3556, F1 (Macro): 0.2873
  New best model! Val loss improved from inf to 2.4807. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 2.1449
  Epoch 1 [Batch 4/40]: Loss: 0.6956
  Epoch 1 [Batch 8/40]: Loss: 1.0171
  Epoch 1 [Batch 12/40]: Loss: 0.7725
  Epoch 1 [Batch 16/40]: Loss: 1.1303
  Epoch 1 [Batch 20/40]: Loss: 1.2489
  Epoch 1 [Batch 24/40]: Loss: 0.6187
  Epoch 1 [Batch 28/40]: Loss: 1.7933
  Epoch 1 [Batch 32/40]: Loss: 1.1373
  Epoch 1 [Batch 36/40]: Loss: 1.1038
  Epoch 1 Train Summary: Avg Loss: 1.0580, Accuracy: 0.5030
  Validation Summary: Avg Loss: 1.4967, Accuracy: 0.3194, F1 (Macro): 0.2815
  New best model! Val loss improved from 2.4807 to 1.4967. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 0.4184
  Epoch 2 [Batch 4/40]: Loss: 0.6870
  Epoch 2 [Batch 8/40]: Loss: 0.6351
  Epoch 2 [Batch 12/40]: Loss: 0.9493
  Epoch 2 [Batch 16/40]: Loss: 1.3408
  Epoch 2 [Batch 20/40]: Loss: 0.3324
  Epoch 2 [Batch 24/40]: Loss: 0.7602
  Epoch 2 [Batch 28/40]: Loss: 1.2409
  Epoch 2 [Batch 32/40]: Loss: 0.5866
  Epoch 2 [Batch 36/40]: Loss: 0.2293
  Epoch 2 Train Summary: Avg Loss: 0.7957, Accuracy: 0.6123
  Validation Summary: Avg Loss: 1.4446, Accuracy: 0.3972, F1 (Macro): 0.3712
  New best model! Val loss improved from 1.4967 to 1.4446. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 0.4665
  Epoch 3 [Batch 4/40]: Loss: 0.3420
  Epoch 3 [Batch 8/40]: Loss: 1.3510
  Epoch 3 [Batch 12/40]: Loss: 0.3169
  Epoch 3 [Batch 16/40]: Loss: 1.1433
  Epoch 3 [Batch 20/40]: Loss: 1.2003
  Epoch 3 [Batch 24/40]: Loss: 0.4075
  Epoch 3 [Batch 28/40]: Loss: 0.7691
  Epoch 3 [Batch 32/40]: Loss: 0.4919
  Epoch 3 [Batch 36/40]: Loss: 0.5961
  Epoch 3 Train Summary: Avg Loss: 0.6728, Accuracy: 0.6625
  Validation Summary: Avg Loss: 1.6182, Accuracy: 0.3861, F1 (Macro): 0.3790

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 0.6773
  Epoch 4 [Batch 4/40]: Loss: 0.2854
  Epoch 4 [Batch 8/40]: Loss: 0.4965
  Epoch 4 [Batch 12/40]: Loss: 0.3056
  Epoch 4 [Batch 16/40]: Loss: 0.3436
  Epoch 4 [Batch 20/40]: Loss: 0.2438
  Epoch 4 [Batch 24/40]: Loss: 0.7106
  Epoch 4 [Batch 28/40]: Loss: 0.5531
  Epoch 4 [Batch 32/40]: Loss: 0.5940
  Epoch 4 [Batch 36/40]: Loss: 0.3271
  Epoch 4 Train Summary: Avg Loss: 0.5645, Accuracy: 0.7313
  Validation Summary: Avg Loss: 1.4339, Accuracy: 0.4694, F1 (Macro): 0.4363
  New best model! Val loss improved from 1.4446 to 1.4339. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 0.9479
  Epoch 5 [Batch 4/40]: Loss: 0.9567
  Epoch 5 [Batch 8/40]: Loss: 1.3279
  Epoch 5 [Batch 12/40]: Loss: 1.6279
  Epoch 5 [Batch 16/40]: Loss: 0.4523
  Epoch 5 [Batch 20/40]: Loss: 0.3279
  Epoch 5 [Batch 24/40]: Loss: 0.4577
  Epoch 5 [Batch 28/40]: Loss: 1.0044
  Epoch 5 [Batch 32/40]: Loss: 0.2654
  Epoch 5 [Batch 36/40]: Loss: 0.0545
  Epoch 5 Train Summary: Avg Loss: 0.5310, Accuracy: 0.7507
  Validation Summary: Avg Loss: 1.3572, Accuracy: 0.3472, F1 (Macro): 0.3414
  New best model! Val loss improved from 1.4339 to 1.3572. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 0.4205
  Epoch 6 [Batch 4/40]: Loss: 0.5504
  Epoch 6 [Batch 8/40]: Loss: 0.1393
  Epoch 6 [Batch 12/40]: Loss: 0.1931
  Epoch 6 [Batch 16/40]: Loss: 0.1592
  Epoch 6 [Batch 20/40]: Loss: 0.0750
  Epoch 6 [Batch 24/40]: Loss: 0.3051
  Epoch 6 [Batch 28/40]: Loss: 0.0332
  Epoch 6 [Batch 32/40]: Loss: 0.1747
  Epoch 6 [Batch 36/40]: Loss: 0.2638
  Epoch 6 Train Summary: Avg Loss: 0.3768, Accuracy: 0.8053
  Validation Summary: Avg Loss: 1.2474, Accuracy: 0.3472, F1 (Macro): 0.3344
  New best model! Val loss improved from 1.3572 to 1.2474. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 0.5701
  Epoch 7 [Batch 4/40]: Loss: 0.4546
  Epoch 7 [Batch 8/40]: Loss: 0.5399
  Epoch 7 [Batch 12/40]: Loss: 0.1313
  Epoch 7 [Batch 16/40]: Loss: 0.2847
  Epoch 7 [Batch 20/40]: Loss: 0.2960
  Epoch 7 [Batch 24/40]: Loss: 0.3547
  Epoch 7 [Batch 28/40]: Loss: 0.7388
  Epoch 7 [Batch 32/40]: Loss: 0.7633
  Epoch 7 [Batch 36/40]: Loss: 0.2853
  Epoch 7 Train Summary: Avg Loss: 0.3400, Accuracy: 0.8243
  Validation Summary: Avg Loss: 1.4371, Accuracy: 0.3056, F1 (Macro): 0.2929

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.1163
  Epoch 8 [Batch 4/40]: Loss: 0.3422
  Epoch 8 [Batch 8/40]: Loss: 0.0435
  Epoch 8 [Batch 12/40]: Loss: 0.0660
  Epoch 8 [Batch 16/40]: Loss: 0.1762
  Epoch 8 [Batch 20/40]: Loss: 0.2024
  Epoch 8 [Batch 24/40]: Loss: 0.9097
  Epoch 8 [Batch 28/40]: Loss: 0.3191
  Epoch 8 [Batch 32/40]: Loss: 0.0209
  Epoch 8 [Batch 36/40]: Loss: 0.3516
  Epoch 8 Train Summary: Avg Loss: 0.2703, Accuracy: 0.8803
  Validation Summary: Avg Loss: 1.3024, Accuracy: 0.3333, F1 (Macro): 0.3176

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.1170
  Epoch 9 [Batch 4/40]: Loss: 0.5172
  Epoch 9 [Batch 8/40]: Loss: 0.1927
  Epoch 9 [Batch 12/40]: Loss: 0.6768
  Epoch 9 [Batch 16/40]: Loss: 0.0383
  Epoch 9 [Batch 20/40]: Loss: 0.5234
  Epoch 9 [Batch 24/40]: Loss: 0.1025
  Epoch 9 [Batch 28/40]: Loss: 0.0405
  Epoch 9 [Batch 32/40]: Loss: 0.3154
  Epoch 9 [Batch 36/40]: Loss: 0.0343
  Epoch 9 Train Summary: Avg Loss: 0.2261, Accuracy: 0.9162
  Validation Summary: Avg Loss: 1.2356, Accuracy: 0.3444, F1 (Macro): 0.3413
  New best model! Val loss improved from 1.2474 to 1.2356. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 0.0362
  Epoch 10 [Batch 4/40]: Loss: 0.0077
  Epoch 10 [Batch 8/40]: Loss: 0.0215
  Epoch 10 [Batch 12/40]: Loss: 0.3715
  Epoch 10 [Batch 16/40]: Loss: 0.1292
  Epoch 10 [Batch 20/40]: Loss: 0.4053
  Epoch 10 [Batch 24/40]: Loss: 0.0227
  Epoch 10 [Batch 28/40]: Loss: 0.0297
  Epoch 10 [Batch 32/40]: Loss: 0.3143
  Epoch 10 [Batch 36/40]: Loss: 0.0400
  Epoch 10 Train Summary: Avg Loss: 0.2097, Accuracy: 0.8966
  Validation Summary: Avg Loss: 1.3965, Accuracy: 0.4028, F1 (Macro): 0.3784

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.0350
  Epoch 11 [Batch 4/40]: Loss: 0.0353
  Epoch 11 [Batch 8/40]: Loss: 0.2038
  Epoch 11 [Batch 12/40]: Loss: 0.0099
  Epoch 11 [Batch 16/40]: Loss: 0.1471
  Epoch 11 [Batch 20/40]: Loss: 0.1422
  Epoch 11 [Batch 24/40]: Loss: 0.0978
  Epoch 11 [Batch 28/40]: Loss: 0.1451
  Epoch 11 [Batch 32/40]: Loss: 0.3607
  Epoch 11 [Batch 36/40]: Loss: 0.0485
  Epoch 11 Train Summary: Avg Loss: 0.1640, Accuracy: 0.9387
  Validation Summary: Avg Loss: 1.3422, Accuracy: 0.4167, F1 (Macro): 0.3960

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.0687
  Epoch 12 [Batch 4/40]: Loss: 0.0179
  Epoch 12 [Batch 8/40]: Loss: 0.3085
  Epoch 12 [Batch 12/40]: Loss: 0.4155
  Epoch 12 [Batch 16/40]: Loss: 0.1190
  Epoch 12 [Batch 20/40]: Loss: 0.9499
  Epoch 12 [Batch 24/40]: Loss: 0.0568
  Epoch 12 [Batch 28/40]: Loss: 0.0230
  Epoch 12 [Batch 32/40]: Loss: 0.0788
  Epoch 12 [Batch 36/40]: Loss: 0.2676
  Epoch 12 Train Summary: Avg Loss: 0.2575, Accuracy: 0.9156
  Validation Summary: Avg Loss: 1.4366, Accuracy: 0.4444, F1 (Macro): 0.4046

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.2938
  Epoch 13 [Batch 4/40]: Loss: 0.3587
  Epoch 13 [Batch 8/40]: Loss: 0.0478
  Epoch 13 [Batch 12/40]: Loss: 0.1881
  Epoch 13 [Batch 16/40]: Loss: 0.2075
  Epoch 13 [Batch 20/40]: Loss: 0.4387
  Epoch 13 [Batch 24/40]: Loss: 0.0624
  Epoch 13 [Batch 28/40]: Loss: 0.2390
  Epoch 13 [Batch 32/40]: Loss: 0.0460
  Epoch 13 [Batch 36/40]: Loss: 0.1682
  Epoch 13 Train Summary: Avg Loss: 0.1908, Accuracy: 0.9216
  Validation Summary: Avg Loss: 1.5702, Accuracy: 0.4167, F1 (Macro): 0.3842

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 0.0288
  Epoch 14 [Batch 4/40]: Loss: 0.1015
  Epoch 14 [Batch 8/40]: Loss: 0.0956
  Epoch 14 [Batch 12/40]: Loss: 0.2034
  Epoch 14 [Batch 16/40]: Loss: 0.1102
  Epoch 14 [Batch 20/40]: Loss: 0.0351
  Epoch 14 [Batch 24/40]: Loss: 0.0172
  Epoch 14 [Batch 28/40]: Loss: 0.4873
  Epoch 14 [Batch 32/40]: Loss: 0.4188
  Epoch 14 [Batch 36/40]: Loss: 0.0100
  Epoch 14 Train Summary: Avg Loss: 0.2026, Accuracy: 0.9221
  Validation Summary: Avg Loss: 1.6348, Accuracy: 0.4556, F1 (Macro): 0.4456
Training finished in 10.81 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.2356, Accuracy: 0.3444, F1 (Macro): 0.3413
Final Best Model Stats: Acc: 0.3444, F1: 0.3413, Loss: 1.2356
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=384x384 lr=5e-05 drop=0.0 seed=42
================================================================================
Starting experiment: efficientnet_b0__384x384__lr-5e-05__drop-0.0__seed-42
Output directory: results_opg/efficientnet_b0__384x384__lr-5e-05__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 2.0517
  Epoch 0 [Batch 4/40]: Loss: 2.2419
  Epoch 0 [Batch 8/40]: Loss: 1.5485
  Epoch 0 [Batch 12/40]: Loss: 1.6071
  Epoch 0 [Batch 16/40]: Loss: 1.8941
  Epoch 0 [Batch 20/40]: Loss: 2.0533
  Epoch 0 [Batch 24/40]: Loss: 2.7772
  Epoch 0 [Batch 28/40]: Loss: 1.2957
  Epoch 0 [Batch 32/40]: Loss: 1.9100
  Epoch 0 [Batch 36/40]: Loss: 0.9437
  Epoch 0 Train Summary: Avg Loss: 1.8450, Accuracy: 0.3366
  Validation Summary: Avg Loss: 2.0004, Accuracy: 0.4278, F1 (Macro): 0.3583
  New best model! Val loss improved from inf to 2.0004. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 1.7619
  Epoch 1 [Batch 4/40]: Loss: 0.7942
  Epoch 1 [Batch 8/40]: Loss: 0.8992
  Epoch 1 [Batch 12/40]: Loss: 0.8169
  Epoch 1 [Batch 16/40]: Loss: 2.3366
  Epoch 1 [Batch 20/40]: Loss: 1.7203
  Epoch 1 [Batch 24/40]: Loss: 1.6840
  Epoch 1 [Batch 28/40]: Loss: 1.0269
  Epoch 1 [Batch 32/40]: Loss: 0.5519
  Epoch 1 [Batch 36/40]: Loss: 1.8158
  Epoch 1 Train Summary: Avg Loss: 1.1702, Accuracy: 0.4710
  Validation Summary: Avg Loss: 1.4231, Accuracy: 0.4000, F1 (Macro): 0.3606
  New best model! Val loss improved from 2.0004 to 1.4231. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.8345
  Epoch 2 [Batch 4/40]: Loss: 0.7032
  Epoch 2 [Batch 8/40]: Loss: 2.1229
  Epoch 2 [Batch 12/40]: Loss: 1.6708
  Epoch 2 [Batch 16/40]: Loss: 1.1896
  Epoch 2 [Batch 20/40]: Loss: 1.5408
  Epoch 2 [Batch 24/40]: Loss: 0.9878
  Epoch 2 [Batch 28/40]: Loss: 1.3285
  Epoch 2 [Batch 32/40]: Loss: 0.3264
  Epoch 2 [Batch 36/40]: Loss: 1.7164
  Epoch 2 Train Summary: Avg Loss: 1.0415, Accuracy: 0.5493
  Validation Summary: Avg Loss: 1.7321, Accuracy: 0.3583, F1 (Macro): 0.2999

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 0.8227
  Epoch 3 [Batch 4/40]: Loss: 0.3241
  Epoch 3 [Batch 8/40]: Loss: 0.5357
  Epoch 3 [Batch 12/40]: Loss: 0.9260
  Epoch 3 [Batch 16/40]: Loss: 1.2676
  Epoch 3 [Batch 20/40]: Loss: 2.0035
  Epoch 3 [Batch 24/40]: Loss: 1.2277
  Epoch 3 [Batch 28/40]: Loss: 0.9597
  Epoch 3 [Batch 32/40]: Loss: 1.3123
  Epoch 3 [Batch 36/40]: Loss: 0.6423
  Epoch 3 Train Summary: Avg Loss: 0.8323, Accuracy: 0.5535
  Validation Summary: Avg Loss: 1.4938, Accuracy: 0.3611, F1 (Macro): 0.3243

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 0.7629
  Epoch 4 [Batch 4/40]: Loss: 0.2338
  Epoch 4 [Batch 8/40]: Loss: 1.0432
  Epoch 4 [Batch 12/40]: Loss: 0.1759
  Epoch 4 [Batch 16/40]: Loss: 0.9225
  Epoch 4 [Batch 20/40]: Loss: 0.6412
  Epoch 4 [Batch 24/40]: Loss: 0.6321
  Epoch 4 [Batch 28/40]: Loss: 0.8149
  Epoch 4 [Batch 32/40]: Loss: 0.6694
  Epoch 4 [Batch 36/40]: Loss: 1.1758
  Epoch 4 Train Summary: Avg Loss: 0.6915, Accuracy: 0.6528
  Validation Summary: Avg Loss: 1.4004, Accuracy: 0.3194, F1 (Macro): 0.2955
  New best model! Val loss improved from 1.4231 to 1.4004. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 1.0369
  Epoch 5 [Batch 4/40]: Loss: 0.5217
  Epoch 5 [Batch 8/40]: Loss: 0.2896
  Epoch 5 [Batch 12/40]: Loss: 0.8179
  Epoch 5 [Batch 16/40]: Loss: 0.4280
  Epoch 5 [Batch 20/40]: Loss: 1.1283
  Epoch 5 [Batch 24/40]: Loss: 1.0576
  Epoch 5 [Batch 28/40]: Loss: 0.1887
  Epoch 5 [Batch 32/40]: Loss: 0.4294
  Epoch 5 [Batch 36/40]: Loss: 1.1976
  Epoch 5 Train Summary: Avg Loss: 0.6331, Accuracy: 0.7272
  Validation Summary: Avg Loss: 1.6990, Accuracy: 0.3056, F1 (Macro): 0.2616

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 0.4247
  Epoch 6 [Batch 4/40]: Loss: 0.3742
  Epoch 6 [Batch 8/40]: Loss: 0.7072
  Epoch 6 [Batch 12/40]: Loss: 0.4460
  Epoch 6 [Batch 16/40]: Loss: 0.2627
  Epoch 6 [Batch 20/40]: Loss: 0.4341
  Epoch 6 [Batch 24/40]: Loss: 0.8252
  Epoch 6 [Batch 28/40]: Loss: 1.4074
  Epoch 6 [Batch 32/40]: Loss: 0.6872
  Epoch 6 [Batch 36/40]: Loss: 0.1685
  Epoch 6 Train Summary: Avg Loss: 0.5145, Accuracy: 0.7155
  Validation Summary: Avg Loss: 1.5278, Accuracy: 0.3611, F1 (Macro): 0.3326

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 0.9341
  Epoch 7 [Batch 4/40]: Loss: 0.3142
  Epoch 7 [Batch 8/40]: Loss: 0.4320
  Epoch 7 [Batch 12/40]: Loss: 0.3982
  Epoch 7 [Batch 16/40]: Loss: 0.2206
  Epoch 7 [Batch 20/40]: Loss: 0.6084
  Epoch 7 [Batch 24/40]: Loss: 0.6500
  Epoch 7 [Batch 28/40]: Loss: 0.3726
  Epoch 7 [Batch 32/40]: Loss: 0.5708
  Epoch 7 [Batch 36/40]: Loss: 0.7911
  Epoch 7 Train Summary: Avg Loss: 0.4408, Accuracy: 0.8122
  Validation Summary: Avg Loss: 1.2608, Accuracy: 0.4167, F1 (Macro): 0.3889
  New best model! Val loss improved from 1.4004 to 1.2608. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.3196
  Epoch 8 [Batch 4/40]: Loss: 0.3284
  Epoch 8 [Batch 8/40]: Loss: 0.2434
  Epoch 8 [Batch 12/40]: Loss: 0.0425
  Epoch 8 [Batch 16/40]: Loss: 0.5231
  Epoch 8 [Batch 20/40]: Loss: 0.5139
  Epoch 8 [Batch 24/40]: Loss: 0.7425
  Epoch 8 [Batch 28/40]: Loss: 0.4459
  Epoch 8 [Batch 32/40]: Loss: 0.3777
  Epoch 8 [Batch 36/40]: Loss: 1.3956
  Epoch 8 Train Summary: Avg Loss: 0.5025, Accuracy: 0.7203
  Validation Summary: Avg Loss: 1.4336, Accuracy: 0.3333, F1 (Macro): 0.3081

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.2189
  Epoch 9 [Batch 4/40]: Loss: 0.5644
  Epoch 9 [Batch 8/40]: Loss: 0.4901
  Epoch 9 [Batch 12/40]: Loss: 0.1681
  Epoch 9 [Batch 16/40]: Loss: 0.3271
  Epoch 9 [Batch 20/40]: Loss: 0.2994
  Epoch 9 [Batch 24/40]: Loss: 0.4798
  Epoch 9 [Batch 28/40]: Loss: 0.3537
  Epoch 9 [Batch 32/40]: Loss: 0.1443
  Epoch 9 [Batch 36/40]: Loss: 0.2397
  Epoch 9 Train Summary: Avg Loss: 0.3465, Accuracy: 0.8348
  Validation Summary: Avg Loss: 1.5784, Accuracy: 0.3472, F1 (Macro): 0.3148

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 0.1758
  Epoch 10 [Batch 4/40]: Loss: 0.7976
  Epoch 10 [Batch 8/40]: Loss: 0.1429
  Epoch 10 [Batch 12/40]: Loss: 0.6083
  Epoch 10 [Batch 16/40]: Loss: 0.2978
  Epoch 10 [Batch 20/40]: Loss: 0.3137
  Epoch 10 [Batch 24/40]: Loss: 0.1807
  Epoch 10 [Batch 28/40]: Loss: 0.3304
  Epoch 10 [Batch 32/40]: Loss: 0.2263
  Epoch 10 [Batch 36/40]: Loss: 0.3843
  Epoch 10 Train Summary: Avg Loss: 0.4249, Accuracy: 0.8141
  Validation Summary: Avg Loss: 1.2571, Accuracy: 0.3889, F1 (Macro): 0.3730
  New best model! Val loss improved from 1.2608 to 1.2571. Saving...

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.3716
  Epoch 11 [Batch 4/40]: Loss: 0.1119
  Epoch 11 [Batch 8/40]: Loss: 0.5375
  Epoch 11 [Batch 12/40]: Loss: 0.3841
  Epoch 11 [Batch 16/40]: Loss: 0.1721
  Epoch 11 [Batch 20/40]: Loss: 0.3540
  Epoch 11 [Batch 24/40]: Loss: 0.2376
  Epoch 11 [Batch 28/40]: Loss: 0.8157
  Epoch 11 [Batch 32/40]: Loss: 0.2591
  Epoch 11 [Batch 36/40]: Loss: 0.0770
  Epoch 11 Train Summary: Avg Loss: 0.3244, Accuracy: 0.8199
  Validation Summary: Avg Loss: 1.0808, Accuracy: 0.3611, F1 (Macro): 0.3613
  New best model! Val loss improved from 1.2571 to 1.0808. Saving...

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.1659
  Epoch 12 [Batch 4/40]: Loss: 0.0457
  Epoch 12 [Batch 8/40]: Loss: 0.6090
  Epoch 12 [Batch 12/40]: Loss: 0.1238
  Epoch 12 [Batch 16/40]: Loss: 0.1266
  Epoch 12 [Batch 20/40]: Loss: 0.0843
  Epoch 12 [Batch 24/40]: Loss: 0.0340
  Epoch 12 [Batch 28/40]: Loss: 0.2401
  Epoch 12 [Batch 32/40]: Loss: 0.5669
  Epoch 12 [Batch 36/40]: Loss: 0.0889
  Epoch 12 Train Summary: Avg Loss: 0.2206, Accuracy: 0.8656
  Validation Summary: Avg Loss: 1.0777, Accuracy: 0.4167, F1 (Macro): 0.4047
  New best model! Val loss improved from 1.0808 to 1.0777. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.2956
  Epoch 13 [Batch 4/40]: Loss: 0.2047
  Epoch 13 [Batch 8/40]: Loss: 0.0745
  Epoch 13 [Batch 12/40]: Loss: 0.0680
  Epoch 13 [Batch 16/40]: Loss: 0.3212
  Epoch 13 [Batch 20/40]: Loss: 0.1387
  Epoch 13 [Batch 24/40]: Loss: 0.3711
  Epoch 13 [Batch 28/40]: Loss: 0.1239
  Epoch 13 [Batch 32/40]: Loss: 0.0432
  Epoch 13 [Batch 36/40]: Loss: 0.1752
  Epoch 13 Train Summary: Avg Loss: 0.2415, Accuracy: 0.8690
  Validation Summary: Avg Loss: 1.2673, Accuracy: 0.4028, F1 (Macro): 0.3818

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 0.0214
  Epoch 14 [Batch 4/40]: Loss: 0.1266
  Epoch 14 [Batch 8/40]: Loss: 0.1368
  Epoch 14 [Batch 12/40]: Loss: 0.1074
  Epoch 14 [Batch 16/40]: Loss: 0.1379
  Epoch 14 [Batch 20/40]: Loss: 0.1076
  Epoch 14 [Batch 24/40]: Loss: 0.1069
  Epoch 14 [Batch 28/40]: Loss: 1.0255
  Epoch 14 [Batch 32/40]: Loss: 0.1644
  Epoch 14 [Batch 36/40]: Loss: 0.0290
  Epoch 14 Train Summary: Avg Loss: 0.2353, Accuracy: 0.9054
  Validation Summary: Avg Loss: 1.2284, Accuracy: 0.4417, F1 (Macro): 0.4184
Training finished in 5.37 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.0777, Accuracy: 0.4167, F1 (Macro): 0.4047
Final Best Model Stats: Acc: 0.4167, F1: 0.4047, Loss: 1.0777
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=384x384 lr=5e-05 drop=0.0 seed=123
================================================================================
Starting experiment: efficientnet_b0__384x384__lr-5e-05__drop-0.0__seed-123
Output directory: results_opg/efficientnet_b0__384x384__lr-5e-05__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 2.2355
  Epoch 0 [Batch 4/40]: Loss: 2.0244
  Epoch 0 [Batch 8/40]: Loss: 1.2576
  Epoch 0 [Batch 12/40]: Loss: 2.1522
  Epoch 0 [Batch 16/40]: Loss: 0.8846
  Epoch 0 [Batch 20/40]: Loss: 2.1258
  Epoch 0 [Batch 24/40]: Loss: 1.3728
  Epoch 0 [Batch 28/40]: Loss: 0.9279
  Epoch 0 [Batch 32/40]: Loss: 2.6235
  Epoch 0 [Batch 36/40]: Loss: 2.2389
  Epoch 0 Train Summary: Avg Loss: 1.9353, Accuracy: 0.3299
  Validation Summary: Avg Loss: 2.4030, Accuracy: 0.2889, F1 (Macro): 0.2703
  New best model! Val loss improved from inf to 2.4030. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 0.7245
  Epoch 1 [Batch 4/40]: Loss: 1.4542
  Epoch 1 [Batch 8/40]: Loss: 1.5154
  Epoch 1 [Batch 12/40]: Loss: 3.0977
  Epoch 1 [Batch 16/40]: Loss: 1.3373
  Epoch 1 [Batch 20/40]: Loss: 0.7598
  Epoch 1 [Batch 24/40]: Loss: 0.8826
  Epoch 1 [Batch 28/40]: Loss: 1.1345
  Epoch 1 [Batch 32/40]: Loss: 1.3884
  Epoch 1 [Batch 36/40]: Loss: 1.7285
  Epoch 1 Train Summary: Avg Loss: 1.3096, Accuracy: 0.4249
  Validation Summary: Avg Loss: 2.5662, Accuracy: 0.2972, F1 (Macro): 0.2022

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.9077
  Epoch 2 [Batch 4/40]: Loss: 1.3571
  Epoch 2 [Batch 8/40]: Loss: 0.7535
  Epoch 2 [Batch 12/40]: Loss: 0.6134
  Epoch 2 [Batch 16/40]: Loss: 0.9202
  Epoch 2 [Batch 20/40]: Loss: 0.8777
  Epoch 2 [Batch 24/40]: Loss: 1.6257
  Epoch 2 [Batch 28/40]: Loss: 0.7104
  Epoch 2 [Batch 32/40]: Loss: 0.5033
  Epoch 2 [Batch 36/40]: Loss: 1.5153
  Epoch 2 Train Summary: Avg Loss: 1.0698, Accuracy: 0.5283
  Validation Summary: Avg Loss: 1.9676, Accuracy: 0.4500, F1 (Macro): 0.3889
  New best model! Val loss improved from 2.4030 to 1.9676. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 0.7172
  Epoch 3 [Batch 4/40]: Loss: 0.6867
  Epoch 3 [Batch 8/40]: Loss: 0.7527
  Epoch 3 [Batch 12/40]: Loss: 0.4902
  Epoch 3 [Batch 16/40]: Loss: 0.7406
  Epoch 3 [Batch 20/40]: Loss: 0.8743
  Epoch 3 [Batch 24/40]: Loss: 0.4842
  Epoch 3 [Batch 28/40]: Loss: 0.9553
  Epoch 3 [Batch 32/40]: Loss: 1.2927
  Epoch 3 [Batch 36/40]: Loss: 0.1605
  Epoch 3 Train Summary: Avg Loss: 0.8585, Accuracy: 0.5283
  Validation Summary: Avg Loss: 2.0825, Accuracy: 0.3806, F1 (Macro): 0.3079

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 0.9870
  Epoch 4 [Batch 4/40]: Loss: 0.8337
  Epoch 4 [Batch 8/40]: Loss: 0.6278
  Epoch 4 [Batch 12/40]: Loss: 1.5465
  Epoch 4 [Batch 16/40]: Loss: 0.4924
  Epoch 4 [Batch 20/40]: Loss: 1.2432
  Epoch 4 [Batch 24/40]: Loss: 0.3202
  Epoch 4 [Batch 28/40]: Loss: 0.6998
  Epoch 4 [Batch 32/40]: Loss: 0.9994
  Epoch 4 [Batch 36/40]: Loss: 0.2008
  Epoch 4 Train Summary: Avg Loss: 0.8194, Accuracy: 0.5969
  Validation Summary: Avg Loss: 1.7033, Accuracy: 0.4778, F1 (Macro): 0.4053
  New best model! Val loss improved from 1.9676 to 1.7033. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 0.2060
  Epoch 5 [Batch 4/40]: Loss: 0.4441
  Epoch 5 [Batch 8/40]: Loss: 0.4625
  Epoch 5 [Batch 12/40]: Loss: 0.7682
  Epoch 5 [Batch 16/40]: Loss: 0.2034
  Epoch 5 [Batch 20/40]: Loss: 0.6222
  Epoch 5 [Batch 24/40]: Loss: 0.7986
  Epoch 5 [Batch 28/40]: Loss: 0.2927
  Epoch 5 [Batch 32/40]: Loss: 0.5616
  Epoch 5 [Batch 36/40]: Loss: 0.6418
  Epoch 5 Train Summary: Avg Loss: 0.6851, Accuracy: 0.6732
  Validation Summary: Avg Loss: 1.7060, Accuracy: 0.4778, F1 (Macro): 0.4041

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 0.8429
  Epoch 6 [Batch 4/40]: Loss: 0.8076
  Epoch 6 [Batch 8/40]: Loss: 0.5340
  Epoch 6 [Batch 12/40]: Loss: 0.4028
  Epoch 6 [Batch 16/40]: Loss: 0.3005
  Epoch 6 [Batch 20/40]: Loss: 0.1278
  Epoch 6 [Batch 24/40]: Loss: 0.2749
  Epoch 6 [Batch 28/40]: Loss: 1.3536
  Epoch 6 [Batch 32/40]: Loss: 0.3277
  Epoch 6 [Batch 36/40]: Loss: 0.2599
  Epoch 6 Train Summary: Avg Loss: 0.5445, Accuracy: 0.7258
  Validation Summary: Avg Loss: 1.7059, Accuracy: 0.4639, F1 (Macro): 0.4006

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 0.7235
  Epoch 7 [Batch 4/40]: Loss: 0.1636
  Epoch 7 [Batch 8/40]: Loss: 0.1961
  Epoch 7 [Batch 12/40]: Loss: 0.2193
  Epoch 7 [Batch 16/40]: Loss: 0.3689
  Epoch 7 [Batch 20/40]: Loss: 0.2080
  Epoch 7 [Batch 24/40]: Loss: 0.1638
  Epoch 7 [Batch 28/40]: Loss: 0.3754
  Epoch 7 [Batch 32/40]: Loss: 0.6238
  Epoch 7 [Batch 36/40]: Loss: 0.3000
  Epoch 7 Train Summary: Avg Loss: 0.5001, Accuracy: 0.7632
  Validation Summary: Avg Loss: 1.5183, Accuracy: 0.4139, F1 (Macro): 0.4150
  New best model! Val loss improved from 1.7033 to 1.5183. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.3005
  Epoch 8 [Batch 4/40]: Loss: 0.2678
  Epoch 8 [Batch 8/40]: Loss: 0.1392
  Epoch 8 [Batch 12/40]: Loss: 0.4132
  Epoch 8 [Batch 16/40]: Loss: 0.2590
  Epoch 8 [Batch 20/40]: Loss: 0.6607
  Epoch 8 [Batch 24/40]: Loss: 0.5065
  Epoch 8 [Batch 28/40]: Loss: 0.4361
  Epoch 8 [Batch 32/40]: Loss: 0.5065
  Epoch 8 [Batch 36/40]: Loss: 0.5788
  Epoch 8 Train Summary: Avg Loss: 0.4100, Accuracy: 0.8049
  Validation Summary: Avg Loss: 1.5802, Accuracy: 0.4528, F1 (Macro): 0.4407

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.0621
  Epoch 9 [Batch 4/40]: Loss: 0.2060
  Epoch 9 [Batch 8/40]: Loss: 0.7570
  Epoch 9 [Batch 12/40]: Loss: 0.6383
  Epoch 9 [Batch 16/40]: Loss: 0.5301
  Epoch 9 [Batch 20/40]: Loss: 0.2952
  Epoch 9 [Batch 24/40]: Loss: 0.4314
  Epoch 9 [Batch 28/40]: Loss: 1.1648
  Epoch 9 [Batch 32/40]: Loss: 0.4258
  Epoch 9 [Batch 36/40]: Loss: 0.4800
  Epoch 9 Train Summary: Avg Loss: 0.3918, Accuracy: 0.8070
  Validation Summary: Avg Loss: 1.8072, Accuracy: 0.3167, F1 (Macro): 0.3042

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 0.2418
  Epoch 10 [Batch 4/40]: Loss: 0.0951
  Epoch 10 [Batch 8/40]: Loss: 0.2400
  Epoch 10 [Batch 12/40]: Loss: 0.3326
  Epoch 10 [Batch 16/40]: Loss: 0.3218
  Epoch 10 [Batch 20/40]: Loss: 0.3115
  Epoch 10 [Batch 24/40]: Loss: 0.1519
  Epoch 10 [Batch 28/40]: Loss: 0.1538
  Epoch 10 [Batch 32/40]: Loss: 0.1660
  Epoch 10 [Batch 36/40]: Loss: 0.2983
  Epoch 10 Train Summary: Avg Loss: 0.2775, Accuracy: 0.8851
  Validation Summary: Avg Loss: 1.5475, Accuracy: 0.3583, F1 (Macro): 0.3612

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.3211
  Epoch 11 [Batch 4/40]: Loss: 0.4854
  Epoch 11 [Batch 8/40]: Loss: 0.2744
  Epoch 11 [Batch 12/40]: Loss: 0.4111
  Epoch 11 [Batch 16/40]: Loss: 0.3539
  Epoch 11 [Batch 20/40]: Loss: 0.8558
  Epoch 11 [Batch 24/40]: Loss: 0.4424
  Epoch 11 [Batch 28/40]: Loss: 0.1469
  Epoch 11 [Batch 32/40]: Loss: 0.3140
  Epoch 11 [Batch 36/40]: Loss: 0.1252
  Epoch 11 Train Summary: Avg Loss: 0.3158, Accuracy: 0.8482
  Validation Summary: Avg Loss: 1.5311, Accuracy: 0.4528, F1 (Macro): 0.4340

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.2995
  Epoch 12 [Batch 4/40]: Loss: 0.2276
  Epoch 12 [Batch 8/40]: Loss: 0.2870
  Epoch 12 [Batch 12/40]: Loss: 0.3590
  Epoch 12 [Batch 16/40]: Loss: 0.8589
  Epoch 12 [Batch 20/40]: Loss: 0.2500
  Epoch 12 [Batch 24/40]: Loss: 0.4143
  Epoch 12 [Batch 28/40]: Loss: 0.4264
  Epoch 12 [Batch 32/40]: Loss: 0.4228
  Epoch 12 [Batch 36/40]: Loss: 0.3285
  Epoch 12 Train Summary: Avg Loss: 0.3461, Accuracy: 0.8607
  Validation Summary: Avg Loss: 1.5532, Accuracy: 0.3583, F1 (Macro): 0.3522

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.1279
  Epoch 13 [Batch 4/40]: Loss: 0.8231
  Epoch 13 [Batch 8/40]: Loss: 0.3879
  Epoch 13 [Batch 12/40]: Loss: 0.4116
  Epoch 13 [Batch 16/40]: Loss: 0.1517
  Epoch 13 [Batch 20/40]: Loss: 0.1990
  Epoch 13 [Batch 24/40]: Loss: 0.3729
  Epoch 13 [Batch 28/40]: Loss: 0.8466
  Epoch 13 [Batch 32/40]: Loss: 0.4523
  Epoch 13 [Batch 36/40]: Loss: 0.1410
  Epoch 13 Train Summary: Avg Loss: 0.3104, Accuracy: 0.8755
  Validation Summary: Avg Loss: 1.5648, Accuracy: 0.3861, F1 (Macro): 0.3859

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 0.3537
  Epoch 14 [Batch 4/40]: Loss: 0.2000
  Epoch 14 [Batch 8/40]: Loss: 0.2043
  Epoch 14 [Batch 12/40]: Loss: 0.8235
  Epoch 14 [Batch 16/40]: Loss: 0.2719
  Epoch 14 [Batch 20/40]: Loss: 0.2069
  Epoch 14 [Batch 24/40]: Loss: 0.0850
  Epoch 14 [Batch 28/40]: Loss: 0.0220
  Epoch 14 [Batch 32/40]: Loss: 0.0445
  Epoch 14 [Batch 36/40]: Loss: 0.0112
  Epoch 14 Train Summary: Avg Loss: 0.1759, Accuracy: 0.9430
  Validation Summary: Avg Loss: 1.5820, Accuracy: 0.4111, F1 (Macro): 0.3955
Training finished in 6.06 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.5183, Accuracy: 0.4139, F1 (Macro): 0.4150
Final Best Model Stats: Acc: 0.4139, F1: 0.4150, Loss: 1.5183
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=384x384 lr=5e-05 drop=0.0 seed=999
================================================================================
Starting experiment: efficientnet_b0__384x384__lr-5e-05__drop-0.0__seed-999
Output directory: results_opg/efficientnet_b0__384x384__lr-5e-05__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 1.6707
  Epoch 0 [Batch 4/40]: Loss: 1.5018
  Epoch 0 [Batch 8/40]: Loss: 1.0281
  Epoch 0 [Batch 12/40]: Loss: 1.2269
  Epoch 0 [Batch 16/40]: Loss: 1.4087
  Epoch 0 [Batch 20/40]: Loss: 1.9322
  Epoch 0 [Batch 24/40]: Loss: 2.6091
  Epoch 0 [Batch 28/40]: Loss: 1.6188
  Epoch 0 [Batch 32/40]: Loss: 1.5975
  Epoch 0 [Batch 36/40]: Loss: 1.7205
  Epoch 0 Train Summary: Avg Loss: 1.6359, Accuracy: 0.3673
  Validation Summary: Avg Loss: 2.6785, Accuracy: 0.3000, F1 (Macro): 0.2476
  New best model! Val loss improved from inf to 2.6785. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 2.3392
  Epoch 1 [Batch 4/40]: Loss: 1.2220
  Epoch 1 [Batch 8/40]: Loss: 1.0086
  Epoch 1 [Batch 12/40]: Loss: 1.3533
  Epoch 1 [Batch 16/40]: Loss: 1.3902
  Epoch 1 [Batch 20/40]: Loss: 1.1108
  Epoch 1 [Batch 24/40]: Loss: 0.4597
  Epoch 1 [Batch 28/40]: Loss: 2.0575
  Epoch 1 [Batch 32/40]: Loss: 2.4027
  Epoch 1 [Batch 36/40]: Loss: 0.7681
  Epoch 1 Train Summary: Avg Loss: 1.1866, Accuracy: 0.4598
  Validation Summary: Avg Loss: 1.4935, Accuracy: 0.2917, F1 (Macro): 0.2938
  New best model! Val loss improved from 2.6785 to 1.4935. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 0.8538
  Epoch 2 [Batch 4/40]: Loss: 0.6390
  Epoch 2 [Batch 8/40]: Loss: 0.6417
  Epoch 2 [Batch 12/40]: Loss: 1.1368
  Epoch 2 [Batch 16/40]: Loss: 1.5383
  Epoch 2 [Batch 20/40]: Loss: 0.6033
  Epoch 2 [Batch 24/40]: Loss: 0.6012
  Epoch 2 [Batch 28/40]: Loss: 1.6003
  Epoch 2 [Batch 32/40]: Loss: 1.4102
  Epoch 2 [Batch 36/40]: Loss: 0.4258
  Epoch 2 Train Summary: Avg Loss: 1.0230, Accuracy: 0.5149
  Validation Summary: Avg Loss: 1.4696, Accuracy: 0.4639, F1 (Macro): 0.3986
  New best model! Val loss improved from 1.4935 to 1.4696. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 0.6195
  Epoch 3 [Batch 4/40]: Loss: 0.5472
  Epoch 3 [Batch 8/40]: Loss: 1.3279
  Epoch 3 [Batch 12/40]: Loss: 0.6286
  Epoch 3 [Batch 16/40]: Loss: 1.1705
  Epoch 3 [Batch 20/40]: Loss: 1.7834
  Epoch 3 [Batch 24/40]: Loss: 0.6054
  Epoch 3 [Batch 28/40]: Loss: 0.8916
  Epoch 3 [Batch 32/40]: Loss: 0.8493
  Epoch 3 [Batch 36/40]: Loss: 1.1395
  Epoch 3 Train Summary: Avg Loss: 0.8668, Accuracy: 0.5771
  Validation Summary: Avg Loss: 1.6965, Accuracy: 0.3333, F1 (Macro): 0.3285

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 0.9591
  Epoch 4 [Batch 4/40]: Loss: 0.6814
  Epoch 4 [Batch 8/40]: Loss: 0.8586
  Epoch 4 [Batch 12/40]: Loss: 0.3790
  Epoch 4 [Batch 16/40]: Loss: 0.4686
  Epoch 4 [Batch 20/40]: Loss: 0.8299
  Epoch 4 [Batch 24/40]: Loss: 0.7342
  Epoch 4 [Batch 28/40]: Loss: 0.8778
  Epoch 4 [Batch 32/40]: Loss: 0.5894
  Epoch 4 [Batch 36/40]: Loss: 0.5304
  Epoch 4 Train Summary: Avg Loss: 0.7118, Accuracy: 0.6430
  Validation Summary: Avg Loss: 1.5260, Accuracy: 0.3611, F1 (Macro): 0.3196

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 0.6629
  Epoch 5 [Batch 4/40]: Loss: 0.6091
  Epoch 5 [Batch 8/40]: Loss: 1.4979
  Epoch 5 [Batch 12/40]: Loss: 1.5519
  Epoch 5 [Batch 16/40]: Loss: 0.3528
  Epoch 5 [Batch 20/40]: Loss: 0.2869
  Epoch 5 [Batch 24/40]: Loss: 1.0647
  Epoch 5 [Batch 28/40]: Loss: 0.9540
  Epoch 5 [Batch 32/40]: Loss: 0.3608
  Epoch 5 [Batch 36/40]: Loss: 0.1969
  Epoch 5 Train Summary: Avg Loss: 0.6593, Accuracy: 0.6990
  Validation Summary: Avg Loss: 1.3095, Accuracy: 0.2917, F1 (Macro): 0.2872
  New best model! Val loss improved from 1.4696 to 1.3095. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 0.6280
  Epoch 6 [Batch 4/40]: Loss: 0.4768
  Epoch 6 [Batch 8/40]: Loss: 0.3383
  Epoch 6 [Batch 12/40]: Loss: 0.3322
  Epoch 6 [Batch 16/40]: Loss: 0.3529
  Epoch 6 [Batch 20/40]: Loss: 0.1951
  Epoch 6 [Batch 24/40]: Loss: 0.2888
  Epoch 6 [Batch 28/40]: Loss: 0.1649
  Epoch 6 [Batch 32/40]: Loss: 0.3664
  Epoch 6 [Batch 36/40]: Loss: 0.3747
  Epoch 6 Train Summary: Avg Loss: 0.5562, Accuracy: 0.7287
  Validation Summary: Avg Loss: 1.4180, Accuracy: 0.3750, F1 (Macro): 0.3431

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 0.8071
  Epoch 7 [Batch 4/40]: Loss: 0.9871
  Epoch 7 [Batch 8/40]: Loss: 1.1235
  Epoch 7 [Batch 12/40]: Loss: 0.1919
  Epoch 7 [Batch 16/40]: Loss: 0.5296
  Epoch 7 [Batch 20/40]: Loss: 0.6069
  Epoch 7 [Batch 24/40]: Loss: 0.5331
  Epoch 7 [Batch 28/40]: Loss: 1.2384
  Epoch 7 [Batch 32/40]: Loss: 0.6260
  Epoch 7 [Batch 36/40]: Loss: 0.6126
  Epoch 7 Train Summary: Avg Loss: 0.5583, Accuracy: 0.7448
  Validation Summary: Avg Loss: 1.4701, Accuracy: 0.3056, F1 (Macro): 0.2814

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.1496
  Epoch 8 [Batch 4/40]: Loss: 0.4964
  Epoch 8 [Batch 8/40]: Loss: 0.2691
  Epoch 8 [Batch 12/40]: Loss: 0.0828
  Epoch 8 [Batch 16/40]: Loss: 0.3389
  Epoch 8 [Batch 20/40]: Loss: 0.1300
  Epoch 8 [Batch 24/40]: Loss: 1.0813
  Epoch 8 [Batch 28/40]: Loss: 0.3695
  Epoch 8 [Batch 32/40]: Loss: 0.1102
  Epoch 8 [Batch 36/40]: Loss: 0.5611
  Epoch 8 Train Summary: Avg Loss: 0.4124, Accuracy: 0.8120
  Validation Summary: Avg Loss: 1.1950, Accuracy: 0.3333, F1 (Macro): 0.3311
  New best model! Val loss improved from 1.3095 to 1.1950. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.0903
  Epoch 9 [Batch 4/40]: Loss: 0.2869
  Epoch 9 [Batch 8/40]: Loss: 0.2874
  Epoch 9 [Batch 12/40]: Loss: 0.7266
  Epoch 9 [Batch 16/40]: Loss: 0.2429
  Epoch 9 [Batch 20/40]: Loss: 0.9140
  Epoch 9 [Batch 24/40]: Loss: 0.3077
  Epoch 9 [Batch 28/40]: Loss: 0.2007
  Epoch 9 [Batch 32/40]: Loss: 0.2479
  Epoch 9 [Batch 36/40]: Loss: 0.0695
  Epoch 9 Train Summary: Avg Loss: 0.3523, Accuracy: 0.8561
  Validation Summary: Avg Loss: 1.1850, Accuracy: 0.3056, F1 (Macro): 0.3069
  New best model! Val loss improved from 1.1950 to 1.1850. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 0.1700
  Epoch 10 [Batch 4/40]: Loss: 0.2535
  Epoch 10 [Batch 8/40]: Loss: 0.0499
  Epoch 10 [Batch 12/40]: Loss: 0.7087
  Epoch 10 [Batch 16/40]: Loss: 0.1469
  Epoch 10 [Batch 20/40]: Loss: 0.8708
  Epoch 10 [Batch 24/40]: Loss: 0.1715
  Epoch 10 [Batch 28/40]: Loss: 0.0630
  Epoch 10 [Batch 32/40]: Loss: 0.3094
  Epoch 10 [Batch 36/40]: Loss: 0.1050
  Epoch 10 Train Summary: Avg Loss: 0.3296, Accuracy: 0.8300
  Validation Summary: Avg Loss: 1.5886, Accuracy: 0.3333, F1 (Macro): 0.3289

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.2449
  Epoch 11 [Batch 4/40]: Loss: 0.1949
  Epoch 11 [Batch 8/40]: Loss: 0.3543
  Epoch 11 [Batch 12/40]: Loss: 0.0783
  Epoch 11 [Batch 16/40]: Loss: 0.5542
  Epoch 11 [Batch 20/40]: Loss: 0.1667
  Epoch 11 [Batch 24/40]: Loss: 0.3507
  Epoch 11 [Batch 28/40]: Loss: 0.3109
  Epoch 11 [Batch 32/40]: Loss: 0.2855
  Epoch 11 [Batch 36/40]: Loss: 0.3096
  Epoch 11 Train Summary: Avg Loss: 0.3452, Accuracy: 0.8206
  Validation Summary: Avg Loss: 1.3588, Accuracy: 0.4028, F1 (Macro): 0.3851

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.2572
  Epoch 12 [Batch 4/40]: Loss: 0.1717
  Epoch 12 [Batch 8/40]: Loss: 0.2687
  Epoch 12 [Batch 12/40]: Loss: 0.6372
  Epoch 12 [Batch 16/40]: Loss: 0.4125
  Epoch 12 [Batch 20/40]: Loss: 0.7772
  Epoch 12 [Batch 24/40]: Loss: 0.2506
  Epoch 12 [Batch 28/40]: Loss: 0.0654
  Epoch 12 [Batch 32/40]: Loss: 0.2179
  Epoch 12 [Batch 36/40]: Loss: 0.5200
  Epoch 12 Train Summary: Avg Loss: 0.3328, Accuracy: 0.8893
  Validation Summary: Avg Loss: 1.2131, Accuracy: 0.4306, F1 (Macro): 0.3943

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.4273
  Epoch 13 [Batch 4/40]: Loss: 0.3628
  Epoch 13 [Batch 8/40]: Loss: 0.1324
  Epoch 13 [Batch 12/40]: Loss: 0.2786
  Epoch 13 [Batch 16/40]: Loss: 0.2520
  Epoch 13 [Batch 20/40]: Loss: 0.4493
  Epoch 13 [Batch 24/40]: Loss: 0.0902
  Epoch 13 [Batch 28/40]: Loss: 0.5231
  Epoch 13 [Batch 32/40]: Loss: 0.1186
  Epoch 13 [Batch 36/40]: Loss: 0.1734
  Epoch 13 Train Summary: Avg Loss: 0.2886, Accuracy: 0.8375
  Validation Summary: Avg Loss: 1.3236, Accuracy: 0.3889, F1 (Macro): 0.3630

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 0.0415
  Epoch 14 [Batch 4/40]: Loss: 0.0651
  Epoch 14 [Batch 8/40]: Loss: 0.1229
  Epoch 14 [Batch 12/40]: Loss: 0.6142
  Epoch 14 [Batch 16/40]: Loss: 0.2116
  Epoch 14 [Batch 20/40]: Loss: 0.1100
  Epoch 14 [Batch 24/40]: Loss: 0.0435
  Epoch 14 [Batch 28/40]: Loss: 0.7134
  Epoch 14 [Batch 32/40]: Loss: 0.7450
  Epoch 14 [Batch 36/40]: Loss: 0.1136
  Epoch 14 Train Summary: Avg Loss: 0.2905, Accuracy: 0.8416
  Validation Summary: Avg Loss: 1.5830, Accuracy: 0.3194, F1 (Macro): 0.3200
Training finished in 5.49 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.1850, Accuracy: 0.3056, F1 (Macro): 0.3069
Final Best Model Stats: Acc: 0.3056, F1: 0.3069, Loss: 1.1850
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=384x384 lr=1e-05 drop=0.0 seed=42
================================================================================
Starting experiment: efficientnet_b0__384x384__lr-1e-05__drop-0.0__seed-42
Output directory: results_opg/efficientnet_b0__384x384__lr-1e-05__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 2.0517
  Epoch 0 [Batch 4/40]: Loss: 2.7853
  Epoch 0 [Batch 8/40]: Loss: 2.0091
  Epoch 0 [Batch 12/40]: Loss: 2.0853
  Epoch 0 [Batch 16/40]: Loss: 1.6541
  Epoch 0 [Batch 20/40]: Loss: 2.3919
  Epoch 0 [Batch 24/40]: Loss: 2.3928
  Epoch 0 [Batch 28/40]: Loss: 1.3402
  Epoch 0 [Batch 32/40]: Loss: 2.6536
  Epoch 0 [Batch 36/40]: Loss: 1.5573
  Epoch 0 Train Summary: Avg Loss: 2.2213, Accuracy: 0.3274
  Validation Summary: Avg Loss: 4.3977, Accuracy: 0.3194, F1 (Macro): 0.1753
  New best model! Val loss improved from inf to 4.3977. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 1.4340
  Epoch 1 [Batch 4/40]: Loss: 1.6860
  Epoch 1 [Batch 8/40]: Loss: 1.3073
  Epoch 1 [Batch 12/40]: Loss: 1.4991
  Epoch 1 [Batch 16/40]: Loss: 1.8114
  Epoch 1 [Batch 20/40]: Loss: 2.4800
  Epoch 1 [Batch 24/40]: Loss: 1.8859
  Epoch 1 [Batch 28/40]: Loss: 1.5120
  Epoch 1 [Batch 32/40]: Loss: 0.9672
  Epoch 1 [Batch 36/40]: Loss: 2.7631
  Epoch 1 Train Summary: Avg Loss: 1.6257, Accuracy: 0.3537
  Validation Summary: Avg Loss: 3.0507, Accuracy: 0.2778, F1 (Macro): 0.1515
  New best model! Val loss improved from 4.3977 to 3.0507. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 2.8033
  Epoch 2 [Batch 4/40]: Loss: 1.1589
  Epoch 2 [Batch 8/40]: Loss: 2.6596
  Epoch 2 [Batch 12/40]: Loss: 2.5502
  Epoch 2 [Batch 16/40]: Loss: 1.8085
  Epoch 2 [Batch 20/40]: Loss: 2.8165
  Epoch 2 [Batch 24/40]: Loss: 1.6125
  Epoch 2 [Batch 28/40]: Loss: 1.8746
  Epoch 2 [Batch 32/40]: Loss: 0.5152
  Epoch 2 [Batch 36/40]: Loss: 1.8210
  Epoch 2 Train Summary: Avg Loss: 1.5705, Accuracy: 0.3998
  Validation Summary: Avg Loss: 3.1376, Accuracy: 0.2639, F1 (Macro): 0.1652

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 1.1834
  Epoch 3 [Batch 4/40]: Loss: 0.9192
  Epoch 3 [Batch 8/40]: Loss: 0.9711
  Epoch 3 [Batch 12/40]: Loss: 1.7289
  Epoch 3 [Batch 16/40]: Loss: 1.9585
  Epoch 3 [Batch 20/40]: Loss: 1.9624
  Epoch 3 [Batch 24/40]: Loss: 1.6542
  Epoch 3 [Batch 28/40]: Loss: 1.0986
  Epoch 3 [Batch 32/40]: Loss: 1.4130
  Epoch 3 [Batch 36/40]: Loss: 0.8443
  Epoch 3 Train Summary: Avg Loss: 1.3838, Accuracy: 0.3481
  Validation Summary: Avg Loss: 2.3609, Accuracy: 0.3056, F1 (Macro): 0.2317
  New best model! Val loss improved from 3.0507 to 2.3609. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 1.5762
  Epoch 4 [Batch 4/40]: Loss: 1.1083
  Epoch 4 [Batch 8/40]: Loss: 1.4209
  Epoch 4 [Batch 12/40]: Loss: 0.7582
  Epoch 4 [Batch 16/40]: Loss: 1.1625
  Epoch 4 [Batch 20/40]: Loss: 0.6209
  Epoch 4 [Batch 24/40]: Loss: 0.7988
  Epoch 4 [Batch 28/40]: Loss: 1.4895
  Epoch 4 [Batch 32/40]: Loss: 1.3618
  Epoch 4 [Batch 36/40]: Loss: 1.6187
  Epoch 4 Train Summary: Avg Loss: 1.2368, Accuracy: 0.4132
  Validation Summary: Avg Loss: 2.4181, Accuracy: 0.3056, F1 (Macro): 0.2044

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 1.1965
  Epoch 5 [Batch 4/40]: Loss: 1.2156
  Epoch 5 [Batch 8/40]: Loss: 0.7769
  Epoch 5 [Batch 12/40]: Loss: 1.3681
  Epoch 5 [Batch 16/40]: Loss: 0.4771
  Epoch 5 [Batch 20/40]: Loss: 2.2424
  Epoch 5 [Batch 24/40]: Loss: 1.8177
  Epoch 5 [Batch 28/40]: Loss: 0.8407
  Epoch 5 [Batch 32/40]: Loss: 1.6548
  Epoch 5 [Batch 36/40]: Loss: 1.9727
  Epoch 5 Train Summary: Avg Loss: 1.1406, Accuracy: 0.4835
  Validation Summary: Avg Loss: 2.0235, Accuracy: 0.3194, F1 (Macro): 0.2814
  New best model! Val loss improved from 2.3609 to 2.0235. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 0.9295
  Epoch 6 [Batch 4/40]: Loss: 0.9788
  Epoch 6 [Batch 8/40]: Loss: 1.1340
  Epoch 6 [Batch 12/40]: Loss: 0.9087
  Epoch 6 [Batch 16/40]: Loss: 1.2348
  Epoch 6 [Batch 20/40]: Loss: 1.1974
  Epoch 6 [Batch 24/40]: Loss: 1.8782
  Epoch 6 [Batch 28/40]: Loss: 1.6106
  Epoch 6 [Batch 32/40]: Loss: 1.1680
  Epoch 6 [Batch 36/40]: Loss: 1.0455
  Epoch 6 Train Summary: Avg Loss: 1.1675, Accuracy: 0.4525
  Validation Summary: Avg Loss: 2.3485, Accuracy: 0.2778, F1 (Macro): 0.2228

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 2.3187
  Epoch 7 [Batch 4/40]: Loss: 1.3423
  Epoch 7 [Batch 8/40]: Loss: 1.0022
  Epoch 7 [Batch 12/40]: Loss: 1.1533
  Epoch 7 [Batch 16/40]: Loss: 0.9659
  Epoch 7 [Batch 20/40]: Loss: 1.3341
  Epoch 7 [Batch 24/40]: Loss: 1.2839
  Epoch 7 [Batch 28/40]: Loss: 0.9840
  Epoch 7 [Batch 32/40]: Loss: 0.5514
  Epoch 7 [Batch 36/40]: Loss: 1.2000
  Epoch 7 Train Summary: Avg Loss: 1.0516, Accuracy: 0.4457
  Validation Summary: Avg Loss: 2.2904, Accuracy: 0.3333, F1 (Macro): 0.2629

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 1.3361
  Epoch 8 [Batch 4/40]: Loss: 1.1771
  Epoch 8 [Batch 8/40]: Loss: 0.7950
  Epoch 8 [Batch 12/40]: Loss: 0.5323
  Epoch 8 [Batch 16/40]: Loss: 0.7493
  Epoch 8 [Batch 20/40]: Loss: 1.2200
  Epoch 8 [Batch 24/40]: Loss: 1.2813
  Epoch 8 [Batch 28/40]: Loss: 0.9556
  Epoch 8 [Batch 32/40]: Loss: 1.2608
  Epoch 8 [Batch 36/40]: Loss: 1.5140
  Epoch 8 Train Summary: Avg Loss: 1.0532, Accuracy: 0.4764
  Validation Summary: Avg Loss: 2.0763, Accuracy: 0.2917, F1 (Macro): 0.2445

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 1.0388
  Epoch 9 [Batch 4/40]: Loss: 1.2525
  Epoch 9 [Batch 8/40]: Loss: 0.9394
  Epoch 9 [Batch 12/40]: Loss: 0.6535
  Epoch 9 [Batch 16/40]: Loss: 0.9137
  Epoch 9 [Batch 20/40]: Loss: 0.8064
  Epoch 9 [Batch 24/40]: Loss: 0.7970
  Epoch 9 [Batch 28/40]: Loss: 0.8766
  Epoch 9 [Batch 32/40]: Loss: 0.3030
  Epoch 9 [Batch 36/40]: Loss: 0.6131
  Epoch 9 Train Summary: Avg Loss: 0.8874, Accuracy: 0.5268
  Validation Summary: Avg Loss: 2.7256, Accuracy: 0.3472, F1 (Macro): 0.2381

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 0.8181
  Epoch 10 [Batch 4/40]: Loss: 1.3095
  Epoch 10 [Batch 8/40]: Loss: 0.4527
  Epoch 10 [Batch 12/40]: Loss: 0.6214
  Epoch 10 [Batch 16/40]: Loss: 0.7829
  Epoch 10 [Batch 20/40]: Loss: 0.7127
  Epoch 10 [Batch 24/40]: Loss: 0.7548
  Epoch 10 [Batch 28/40]: Loss: 1.1491
  Epoch 10 [Batch 32/40]: Loss: 0.7009
  Epoch 10 [Batch 36/40]: Loss: 0.6127
  Epoch 10 Train Summary: Avg Loss: 0.9932, Accuracy: 0.5154
  Validation Summary: Avg Loss: 2.0202, Accuracy: 0.2917, F1 (Macro): 0.2634
  New best model! Val loss improved from 2.0235 to 2.0202. Saving...

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 1.3985
  Epoch 11 [Batch 4/40]: Loss: 0.8040
  Epoch 11 [Batch 8/40]: Loss: 1.0613
  Epoch 11 [Batch 12/40]: Loss: 0.6655
  Epoch 11 [Batch 16/40]: Loss: 0.8143
  Epoch 11 [Batch 20/40]: Loss: 1.4534
  Epoch 11 [Batch 24/40]: Loss: 0.6900
  Epoch 11 [Batch 28/40]: Loss: 1.1997
  Epoch 11 [Batch 32/40]: Loss: 1.6169
  Epoch 11 [Batch 36/40]: Loss: 0.1680
  Epoch 11 Train Summary: Avg Loss: 0.9047, Accuracy: 0.5779
  Validation Summary: Avg Loss: 2.4472, Accuracy: 0.3583, F1 (Macro): 0.2751

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 0.4479
  Epoch 12 [Batch 4/40]: Loss: 0.7509
  Epoch 12 [Batch 8/40]: Loss: 0.7232
  Epoch 12 [Batch 12/40]: Loss: 0.8807
  Epoch 12 [Batch 16/40]: Loss: 0.7925
  Epoch 12 [Batch 20/40]: Loss: 0.8432
  Epoch 12 [Batch 24/40]: Loss: 0.1973
  Epoch 12 [Batch 28/40]: Loss: 0.8204
  Epoch 12 [Batch 32/40]: Loss: 1.0553
  Epoch 12 [Batch 36/40]: Loss: 1.2089
  Epoch 12 Train Summary: Avg Loss: 0.7802, Accuracy: 0.5363
  Validation Summary: Avg Loss: 1.8357, Accuracy: 0.3306, F1 (Macro): 0.3040
  New best model! Val loss improved from 2.0202 to 1.8357. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 1.4656
  Epoch 13 [Batch 4/40]: Loss: 0.8049
  Epoch 13 [Batch 8/40]: Loss: 0.6406
  Epoch 13 [Batch 12/40]: Loss: 0.6440
  Epoch 13 [Batch 16/40]: Loss: 0.9340
  Epoch 13 [Batch 20/40]: Loss: 0.4129
  Epoch 13 [Batch 24/40]: Loss: 0.5656
  Epoch 13 [Batch 28/40]: Loss: 0.4444
  Epoch 13 [Batch 32/40]: Loss: 0.5519
  Epoch 13 [Batch 36/40]: Loss: 0.6381
  Epoch 13 Train Summary: Avg Loss: 0.8121, Accuracy: 0.5636
  Validation Summary: Avg Loss: 1.2686, Accuracy: 0.3056, F1 (Macro): 0.3005
  New best model! Val loss improved from 1.8357 to 1.2686. Saving...

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 0.3736
  Epoch 14 [Batch 4/40]: Loss: 0.4589
  Epoch 14 [Batch 8/40]: Loss: 0.6849
  Epoch 14 [Batch 12/40]: Loss: 0.4312
  Epoch 14 [Batch 16/40]: Loss: 0.6338
  Epoch 14 [Batch 20/40]: Loss: 1.1256
  Epoch 14 [Batch 24/40]: Loss: 0.7883
  Epoch 14 [Batch 28/40]: Loss: 1.2766
  Epoch 14 [Batch 32/40]: Loss: 1.4439
  Epoch 14 [Batch 36/40]: Loss: 0.6785
  Epoch 14 Train Summary: Avg Loss: 0.8352, Accuracy: 0.5832
  Validation Summary: Avg Loss: 2.0923, Accuracy: 0.3861, F1 (Macro): 0.2970
Training finished in 5.28 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.2686, Accuracy: 0.3056, F1 (Macro): 0.3005
Final Best Model Stats: Acc: 0.3056, F1: 0.3005, Loss: 1.2686
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=384x384 lr=1e-05 drop=0.0 seed=123
================================================================================
Starting experiment: efficientnet_b0__384x384__lr-1e-05__drop-0.0__seed-123
Output directory: results_opg/efficientnet_b0__384x384__lr-1e-05__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 2.2355
  Epoch 0 [Batch 4/40]: Loss: 2.2046
  Epoch 0 [Batch 8/40]: Loss: 1.2231
  Epoch 0 [Batch 12/40]: Loss: 2.4912
  Epoch 0 [Batch 16/40]: Loss: 1.2950
  Epoch 0 [Batch 20/40]: Loss: 2.1090
  Epoch 0 [Batch 24/40]: Loss: 2.1567
  Epoch 0 [Batch 28/40]: Loss: 1.5234
  Epoch 0 [Batch 32/40]: Loss: 2.7727
  Epoch 0 [Batch 36/40]: Loss: 2.4814
  Epoch 0 Train Summary: Avg Loss: 2.3446, Accuracy: 0.3248
  Validation Summary: Avg Loss: 3.3809, Accuracy: 0.3250, F1 (Macro): 0.2383
  New best model! Val loss improved from inf to 3.3809. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 2.1024
  Epoch 1 [Batch 4/40]: Loss: 2.3221
  Epoch 1 [Batch 8/40]: Loss: 2.9049
  Epoch 1 [Batch 12/40]: Loss: 2.8416
  Epoch 1 [Batch 16/40]: Loss: 2.3847
  Epoch 1 [Batch 20/40]: Loss: 2.1126
  Epoch 1 [Batch 24/40]: Loss: 2.1905
  Epoch 1 [Batch 28/40]: Loss: 2.1541
  Epoch 1 [Batch 32/40]: Loss: 1.3418
  Epoch 1 [Batch 36/40]: Loss: 1.9686
  Epoch 1 Train Summary: Avg Loss: 1.9204, Accuracy: 0.3577
  Validation Summary: Avg Loss: 3.1673, Accuracy: 0.3389, F1 (Macro): 0.2606
  New best model! Val loss improved from 3.3809 to 3.1673. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 2.0522
  Epoch 2 [Batch 4/40]: Loss: 1.9845
  Epoch 2 [Batch 8/40]: Loss: 1.1203
  Epoch 2 [Batch 12/40]: Loss: 1.0370
  Epoch 2 [Batch 16/40]: Loss: 1.6141
  Epoch 2 [Batch 20/40]: Loss: 1.4797
  Epoch 2 [Batch 24/40]: Loss: 3.2340
  Epoch 2 [Batch 28/40]: Loss: 1.8220
  Epoch 2 [Batch 32/40]: Loss: 1.8314
  Epoch 2 [Batch 36/40]: Loss: 1.8239
  Epoch 2 Train Summary: Avg Loss: 1.6975, Accuracy: 0.3854
  Validation Summary: Avg Loss: 2.7829, Accuracy: 0.3806, F1 (Macro): 0.3103
  New best model! Val loss improved from 3.1673 to 2.7829. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 1.5465
  Epoch 3 [Batch 4/40]: Loss: 1.1752
  Epoch 3 [Batch 8/40]: Loss: 1.8594
  Epoch 3 [Batch 12/40]: Loss: 0.6773
  Epoch 3 [Batch 16/40]: Loss: 1.1990
  Epoch 3 [Batch 20/40]: Loss: 1.9342
  Epoch 3 [Batch 24/40]: Loss: 1.6444
  Epoch 3 [Batch 28/40]: Loss: 1.3303
  Epoch 3 [Batch 32/40]: Loss: 1.1824
  Epoch 3 [Batch 36/40]: Loss: 0.9558
  Epoch 3 Train Summary: Avg Loss: 1.4338, Accuracy: 0.3577
  Validation Summary: Avg Loss: 2.9278, Accuracy: 0.3528, F1 (Macro): 0.2784

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 1.4061
  Epoch 4 [Batch 4/40]: Loss: 1.0516
  Epoch 4 [Batch 8/40]: Loss: 0.8243
  Epoch 4 [Batch 12/40]: Loss: 2.8557
  Epoch 4 [Batch 16/40]: Loss: 0.7555
  Epoch 4 [Batch 20/40]: Loss: 2.1496
  Epoch 4 [Batch 24/40]: Loss: 0.8086
  Epoch 4 [Batch 28/40]: Loss: 1.1542
  Epoch 4 [Batch 32/40]: Loss: 1.8126
  Epoch 4 [Batch 36/40]: Loss: 0.9955
  Epoch 4 Train Summary: Avg Loss: 1.4484, Accuracy: 0.3781
  Validation Summary: Avg Loss: 2.3061, Accuracy: 0.4083, F1 (Macro): 0.3409
  New best model! Val loss improved from 2.7829 to 2.3061. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 0.5994
  Epoch 5 [Batch 4/40]: Loss: 1.3164
  Epoch 5 [Batch 8/40]: Loss: 1.2011
  Epoch 5 [Batch 12/40]: Loss: 1.3979
  Epoch 5 [Batch 16/40]: Loss: 0.3805
  Epoch 5 [Batch 20/40]: Loss: 1.5158
  Epoch 5 [Batch 24/40]: Loss: 1.7554
  Epoch 5 [Batch 28/40]: Loss: 0.5070
  Epoch 5 [Batch 32/40]: Loss: 1.1898
  Epoch 5 [Batch 36/40]: Loss: 1.3141
  Epoch 5 Train Summary: Avg Loss: 1.2347, Accuracy: 0.4350
  Validation Summary: Avg Loss: 2.1759, Accuracy: 0.4083, F1 (Macro): 0.3399
  New best model! Val loss improved from 2.3061 to 2.1759. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 1.4590
  Epoch 6 [Batch 4/40]: Loss: 1.6133
  Epoch 6 [Batch 8/40]: Loss: 1.0433
  Epoch 6 [Batch 12/40]: Loss: 1.3872
  Epoch 6 [Batch 16/40]: Loss: 1.2251
  Epoch 6 [Batch 20/40]: Loss: 0.4767
  Epoch 6 [Batch 24/40]: Loss: 0.7235
  Epoch 6 [Batch 28/40]: Loss: 2.3785
  Epoch 6 [Batch 32/40]: Loss: 0.3254
  Epoch 6 [Batch 36/40]: Loss: 0.5752
  Epoch 6 Train Summary: Avg Loss: 1.1110, Accuracy: 0.4976
  Validation Summary: Avg Loss: 2.4332, Accuracy: 0.3667, F1 (Macro): 0.2929

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 1.8686
  Epoch 7 [Batch 4/40]: Loss: 0.7367
  Epoch 7 [Batch 8/40]: Loss: 0.7422
  Epoch 7 [Batch 12/40]: Loss: 1.0863
  Epoch 7 [Batch 16/40]: Loss: 0.4853
  Epoch 7 [Batch 20/40]: Loss: 1.1412
  Epoch 7 [Batch 24/40]: Loss: 0.4781
  Epoch 7 [Batch 28/40]: Loss: 0.8256
  Epoch 7 [Batch 32/40]: Loss: 1.0520
  Epoch 7 [Batch 36/40]: Loss: 0.9586
  Epoch 7 Train Summary: Avg Loss: 1.1148, Accuracy: 0.5098
  Validation Summary: Avg Loss: 2.0411, Accuracy: 0.4639, F1 (Macro): 0.4106
  New best model! Val loss improved from 2.1759 to 2.0411. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 1.4614
  Epoch 8 [Batch 4/40]: Loss: 0.7154
  Epoch 8 [Batch 8/40]: Loss: 0.8775
  Epoch 8 [Batch 12/40]: Loss: 1.3895
  Epoch 8 [Batch 16/40]: Loss: 0.6969
  Epoch 8 [Batch 20/40]: Loss: 1.2097
  Epoch 8 [Batch 24/40]: Loss: 2.2210
  Epoch 8 [Batch 28/40]: Loss: 1.2028
  Epoch 8 [Batch 32/40]: Loss: 0.7645
  Epoch 8 [Batch 36/40]: Loss: 1.4830
  Epoch 8 Train Summary: Avg Loss: 1.1021, Accuracy: 0.4923
  Validation Summary: Avg Loss: 2.1352, Accuracy: 0.4083, F1 (Macro): 0.3400

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.5785
  Epoch 9 [Batch 4/40]: Loss: 1.2678
  Epoch 9 [Batch 8/40]: Loss: 1.4136
  Epoch 9 [Batch 12/40]: Loss: 1.3476
  Epoch 9 [Batch 16/40]: Loss: 1.3740
  Epoch 9 [Batch 20/40]: Loss: 0.4161
  Epoch 9 [Batch 24/40]: Loss: 1.0648
  Epoch 9 [Batch 28/40]: Loss: 2.2040
  Epoch 9 [Batch 32/40]: Loss: 1.0444
  Epoch 9 [Batch 36/40]: Loss: 0.8810
  Epoch 9 Train Summary: Avg Loss: 1.0374, Accuracy: 0.5180
  Validation Summary: Avg Loss: 2.2591, Accuracy: 0.4500, F1 (Macro): 0.3917

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 1.3129
  Epoch 10 [Batch 4/40]: Loss: 0.6731
  Epoch 10 [Batch 8/40]: Loss: 0.8938
  Epoch 10 [Batch 12/40]: Loss: 0.9116
  Epoch 10 [Batch 16/40]: Loss: 0.6866
  Epoch 10 [Batch 20/40]: Loss: 1.8191
  Epoch 10 [Batch 24/40]: Loss: 1.0000
  Epoch 10 [Batch 28/40]: Loss: 0.3915
  Epoch 10 [Batch 32/40]: Loss: 1.0114
  Epoch 10 [Batch 36/40]: Loss: 1.0046
  Epoch 10 Train Summary: Avg Loss: 1.0294, Accuracy: 0.5233
  Validation Summary: Avg Loss: 1.7985, Accuracy: 0.4917, F1 (Macro): 0.4446
  New best model! Val loss improved from 2.0411 to 1.7985. Saving...

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 0.6714
  Epoch 11 [Batch 4/40]: Loss: 1.5259
  Epoch 11 [Batch 8/40]: Loss: 0.8032
  Epoch 11 [Batch 12/40]: Loss: 0.9664
  Epoch 11 [Batch 16/40]: Loss: 1.3019
  Epoch 11 [Batch 20/40]: Loss: 1.4322
  Epoch 11 [Batch 24/40]: Loss: 0.5229
  Epoch 11 [Batch 28/40]: Loss: 0.8431
  Epoch 11 [Batch 32/40]: Loss: 1.0256
  Epoch 11 [Batch 36/40]: Loss: 0.4249
  Epoch 11 Train Summary: Avg Loss: 0.8798, Accuracy: 0.5744
  Validation Summary: Avg Loss: 2.2721, Accuracy: 0.3944, F1 (Macro): 0.3259

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 1.5408
  Epoch 12 [Batch 4/40]: Loss: 0.8853
  Epoch 12 [Batch 8/40]: Loss: 0.9447
  Epoch 12 [Batch 12/40]: Loss: 0.2149
  Epoch 12 [Batch 16/40]: Loss: 1.0455
  Epoch 12 [Batch 20/40]: Loss: 0.5347
  Epoch 12 [Batch 24/40]: Loss: 1.0084
  Epoch 12 [Batch 28/40]: Loss: 1.4632
  Epoch 12 [Batch 32/40]: Loss: 1.4817
  Epoch 12 [Batch 36/40]: Loss: 0.6537
  Epoch 12 Train Summary: Avg Loss: 0.9353, Accuracy: 0.5372
  Validation Summary: Avg Loss: 2.1073, Accuracy: 0.4222, F1 (Macro): 0.3570

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 0.9305
  Epoch 13 [Batch 4/40]: Loss: 1.9299
  Epoch 13 [Batch 8/40]: Loss: 1.0891
  Epoch 13 [Batch 12/40]: Loss: 0.4884
  Epoch 13 [Batch 16/40]: Loss: 0.4050
  Epoch 13 [Batch 20/40]: Loss: 1.0388
  Epoch 13 [Batch 24/40]: Loss: 0.9175
  Epoch 13 [Batch 28/40]: Loss: 1.4583
  Epoch 13 [Batch 32/40]: Loss: 1.1893
  Epoch 13 [Batch 36/40]: Loss: 0.9004
  Epoch 13 Train Summary: Avg Loss: 0.9045, Accuracy: 0.5866
  Validation Summary: Avg Loss: 1.9217, Accuracy: 0.4778, F1 (Macro): 0.4295

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 0.6455
  Epoch 14 [Batch 4/40]: Loss: 0.6797
  Epoch 14 [Batch 8/40]: Loss: 0.7478
  Epoch 14 [Batch 12/40]: Loss: 0.6593
  Epoch 14 [Batch 16/40]: Loss: 0.9239
  Epoch 14 [Batch 20/40]: Loss: 0.3502
  Epoch 14 [Batch 24/40]: Loss: 0.7626
  Epoch 14 [Batch 28/40]: Loss: 0.4126
  Epoch 14 [Batch 32/40]: Loss: 0.4908
  Epoch 14 [Batch 36/40]: Loss: 0.2604
  Epoch 14 Train Summary: Avg Loss: 0.6894, Accuracy: 0.6204
  Validation Summary: Avg Loss: 2.1678, Accuracy: 0.3944, F1 (Macro): 0.3307
Training finished in 5.22 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.7985, Accuracy: 0.4917, F1 (Macro): 0.4446
Final Best Model Stats: Acc: 0.4917, F1: 0.4446, Loss: 1.7985
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=384x384 lr=1e-05 drop=0.0 seed=999
================================================================================
Starting experiment: efficientnet_b0__384x384__lr-1e-05__drop-0.0__seed-999
Output directory: results_opg/efficientnet_b0__384x384__lr-1e-05__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 314 images from processed_datasets/opg_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 41 images from processed_datasets/opg_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/40]: Loss: 1.6707
  Epoch 0 [Batch 4/40]: Loss: 1.5640
  Epoch 0 [Batch 8/40]: Loss: 0.9846
  Epoch 0 [Batch 12/40]: Loss: 1.2933
  Epoch 0 [Batch 16/40]: Loss: 1.0295
  Epoch 0 [Batch 20/40]: Loss: 2.2022
  Epoch 0 [Batch 24/40]: Loss: 2.3621
  Epoch 0 [Batch 28/40]: Loss: 1.6407
  Epoch 0 [Batch 32/40]: Loss: 1.7216
  Epoch 0 [Batch 36/40]: Loss: 1.8275
  Epoch 0 Train Summary: Avg Loss: 1.8132, Accuracy: 0.3567
  Validation Summary: Avg Loss: 2.4011, Accuracy: 0.3167, F1 (Macro): 0.3274
  New best model! Val loss improved from inf to 2.4011. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/40]: Loss: 2.3020
  Epoch 1 [Batch 4/40]: Loss: 2.5535
  Epoch 1 [Batch 8/40]: Loss: 1.1445
  Epoch 1 [Batch 12/40]: Loss: 1.9616
  Epoch 1 [Batch 16/40]: Loss: 1.3728
  Epoch 1 [Batch 20/40]: Loss: 1.2597
  Epoch 1 [Batch 24/40]: Loss: 0.8447
  Epoch 1 [Batch 28/40]: Loss: 2.0334
  Epoch 1 [Batch 32/40]: Loss: 3.1095
  Epoch 1 [Batch 36/40]: Loss: 0.8581
  Epoch 1 Train Summary: Avg Loss: 1.5905, Accuracy: 0.3974
  Validation Summary: Avg Loss: 1.7221, Accuracy: 0.3194, F1 (Macro): 0.3346
  New best model! Val loss improved from 2.4011 to 1.7221. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/40]: Loss: 1.6910
  Epoch 2 [Batch 4/40]: Loss: 1.0774
  Epoch 2 [Batch 8/40]: Loss: 0.6868
  Epoch 2 [Batch 12/40]: Loss: 1.6671
  Epoch 2 [Batch 16/40]: Loss: 1.3232
  Epoch 2 [Batch 20/40]: Loss: 1.1502
  Epoch 2 [Batch 24/40]: Loss: 0.8976
  Epoch 2 [Batch 28/40]: Loss: 1.9765
  Epoch 2 [Batch 32/40]: Loss: 2.7002
  Epoch 2 [Batch 36/40]: Loss: 0.9308
  Epoch 2 Train Summary: Avg Loss: 1.5444, Accuracy: 0.3698
  Validation Summary: Avg Loss: 1.5967, Accuracy: 0.3972, F1 (Macro): 0.3662
  New best model! Val loss improved from 1.7221 to 1.5967. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/40]: Loss: 1.1525
  Epoch 3 [Batch 4/40]: Loss: 1.3930
  Epoch 3 [Batch 8/40]: Loss: 1.6117
  Epoch 3 [Batch 12/40]: Loss: 1.1006
  Epoch 3 [Batch 16/40]: Loss: 1.2979
  Epoch 3 [Batch 20/40]: Loss: 2.1482
  Epoch 3 [Batch 24/40]: Loss: 1.2688
  Epoch 3 [Batch 28/40]: Loss: 1.2077
  Epoch 3 [Batch 32/40]: Loss: 1.3759
  Epoch 3 [Batch 36/40]: Loss: 2.1586
  Epoch 3 Train Summary: Avg Loss: 1.3741, Accuracy: 0.3848
  Validation Summary: Avg Loss: 2.0858, Accuracy: 0.3472, F1 (Macro): 0.3591

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/40]: Loss: 1.4520
  Epoch 4 [Batch 4/40]: Loss: 1.1747
  Epoch 4 [Batch 8/40]: Loss: 1.2625
  Epoch 4 [Batch 12/40]: Loss: 1.0268
  Epoch 4 [Batch 16/40]: Loss: 0.9993
  Epoch 4 [Batch 20/40]: Loss: 1.7547
  Epoch 4 [Batch 24/40]: Loss: 1.4736
  Epoch 4 [Batch 28/40]: Loss: 1.6987
  Epoch 4 [Batch 32/40]: Loss: 0.7886
  Epoch 4 [Batch 36/40]: Loss: 1.2757
  Epoch 4 Train Summary: Avg Loss: 1.2649, Accuracy: 0.4396
  Validation Summary: Avg Loss: 1.7722, Accuracy: 0.3167, F1 (Macro): 0.2829

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/40]: Loss: 1.2021
  Epoch 5 [Batch 4/40]: Loss: 1.1420
  Epoch 5 [Batch 8/40]: Loss: 2.0560
  Epoch 5 [Batch 12/40]: Loss: 1.6575
  Epoch 5 [Batch 16/40]: Loss: 1.0816
  Epoch 5 [Batch 20/40]: Loss: 0.7691
  Epoch 5 [Batch 24/40]: Loss: 1.6811
  Epoch 5 [Batch 28/40]: Loss: 1.3350
  Epoch 5 [Batch 32/40]: Loss: 0.8310
  Epoch 5 [Batch 36/40]: Loss: 0.8595
  Epoch 5 Train Summary: Avg Loss: 1.2302, Accuracy: 0.4464
  Validation Summary: Avg Loss: 1.7022, Accuracy: 0.2639, F1 (Macro): 0.2667

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/40]: Loss: 1.4487
  Epoch 6 [Batch 4/40]: Loss: 0.9117
  Epoch 6 [Batch 8/40]: Loss: 1.1474
  Epoch 6 [Batch 12/40]: Loss: 0.9916
  Epoch 6 [Batch 16/40]: Loss: 1.3867
  Epoch 6 [Batch 20/40]: Loss: 0.9445
  Epoch 6 [Batch 24/40]: Loss: 0.6902
  Epoch 6 [Batch 28/40]: Loss: 0.9671
  Epoch 6 [Batch 32/40]: Loss: 0.3902
  Epoch 6 [Batch 36/40]: Loss: 1.3587
  Epoch 6 Train Summary: Avg Loss: 1.1230, Accuracy: 0.4861
  Validation Summary: Avg Loss: 1.7505, Accuracy: 0.2778, F1 (Macro): 0.2546

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/40]: Loss: 1.3673
  Epoch 7 [Batch 4/40]: Loss: 2.0011
  Epoch 7 [Batch 8/40]: Loss: 2.1003
  Epoch 7 [Batch 12/40]: Loss: 1.0026
  Epoch 7 [Batch 16/40]: Loss: 1.5609
  Epoch 7 [Batch 20/40]: Loss: 0.9400
  Epoch 7 [Batch 24/40]: Loss: 0.9587
  Epoch 7 [Batch 28/40]: Loss: 1.4974
  Epoch 7 [Batch 32/40]: Loss: 0.9674
  Epoch 7 [Batch 36/40]: Loss: 1.0141
  Epoch 7 Train Summary: Avg Loss: 1.1869, Accuracy: 0.4720
  Validation Summary: Avg Loss: 1.7857, Accuracy: 0.3056, F1 (Macro): 0.2731

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/40]: Loss: 0.6675
  Epoch 8 [Batch 4/40]: Loss: 0.5666
  Epoch 8 [Batch 8/40]: Loss: 1.5203
  Epoch 8 [Batch 12/40]: Loss: 0.6668
  Epoch 8 [Batch 16/40]: Loss: 1.5023
  Epoch 8 [Batch 20/40]: Loss: 0.5149
  Epoch 8 [Batch 24/40]: Loss: 1.2394
  Epoch 8 [Batch 28/40]: Loss: 0.7882
  Epoch 8 [Batch 32/40]: Loss: 0.4122
  Epoch 8 [Batch 36/40]: Loss: 1.0586
  Epoch 8 Train Summary: Avg Loss: 0.9783, Accuracy: 0.4906
  Validation Summary: Avg Loss: 1.4379, Accuracy: 0.3583, F1 (Macro): 0.3524
  New best model! Val loss improved from 1.5967 to 1.4379. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/40]: Loss: 0.5701
  Epoch 9 [Batch 4/40]: Loss: 1.3120
  Epoch 9 [Batch 8/40]: Loss: 1.2808
  Epoch 9 [Batch 12/40]: Loss: 1.2675
  Epoch 9 [Batch 16/40]: Loss: 1.1449
  Epoch 9 [Batch 20/40]: Loss: 1.8200
  Epoch 9 [Batch 24/40]: Loss: 0.7539
  Epoch 9 [Batch 28/40]: Loss: 0.7159
  Epoch 9 [Batch 32/40]: Loss: 0.5359
  Epoch 9 [Batch 36/40]: Loss: 0.3883
  Epoch 9 Train Summary: Avg Loss: 0.9686, Accuracy: 0.5108
  Validation Summary: Avg Loss: 1.5140, Accuracy: 0.3583, F1 (Macro): 0.3403

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/40]: Loss: 0.6107
  Epoch 10 [Batch 4/40]: Loss: 0.8973
  Epoch 10 [Batch 8/40]: Loss: 0.1851
  Epoch 10 [Batch 12/40]: Loss: 1.4263
  Epoch 10 [Batch 16/40]: Loss: 0.9096
  Epoch 10 [Batch 20/40]: Loss: 0.9937
  Epoch 10 [Batch 24/40]: Loss: 0.8555
  Epoch 10 [Batch 28/40]: Loss: 0.6864
  Epoch 10 [Batch 32/40]: Loss: 0.9779
  Epoch 10 [Batch 36/40]: Loss: 0.6667
  Epoch 10 Train Summary: Avg Loss: 0.9270, Accuracy: 0.5179
  Validation Summary: Avg Loss: 2.0019, Accuracy: 0.3861, F1 (Macro): 0.3616

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/40]: Loss: 1.3027
  Epoch 11 [Batch 4/40]: Loss: 1.4243
  Epoch 11 [Batch 8/40]: Loss: 0.9531
  Epoch 11 [Batch 12/40]: Loss: 0.4106
  Epoch 11 [Batch 16/40]: Loss: 1.1144
  Epoch 11 [Batch 20/40]: Loss: 0.6681
  Epoch 11 [Batch 24/40]: Loss: 0.8072
  Epoch 11 [Batch 28/40]: Loss: 0.9600
  Epoch 11 [Batch 32/40]: Loss: 0.7037
  Epoch 11 [Batch 36/40]: Loss: 1.0272
  Epoch 11 Train Summary: Avg Loss: 0.9941, Accuracy: 0.5066
  Validation Summary: Avg Loss: 1.7878, Accuracy: 0.2500, F1 (Macro): 0.2594

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/40]: Loss: 1.4479
  Epoch 12 [Batch 4/40]: Loss: 0.6771
  Epoch 12 [Batch 8/40]: Loss: 1.0204
  Epoch 12 [Batch 12/40]: Loss: 0.9460
  Epoch 12 [Batch 16/40]: Loss: 1.2382
  Epoch 12 [Batch 20/40]: Loss: 1.4765
  Epoch 12 [Batch 24/40]: Loss: 1.0385
  Epoch 12 [Batch 28/40]: Loss: 0.5144
  Epoch 12 [Batch 32/40]: Loss: 0.9171
  Epoch 12 [Batch 36/40]: Loss: 0.8458
  Epoch 12 Train Summary: Avg Loss: 0.8972, Accuracy: 0.5492
  Validation Summary: Avg Loss: 1.5671, Accuracy: 0.3056, F1 (Macro): 0.3000

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/40]: Loss: 1.2166
  Epoch 13 [Batch 4/40]: Loss: 0.9613
  Epoch 13 [Batch 8/40]: Loss: 0.7023
  Epoch 13 [Batch 12/40]: Loss: 1.3181
  Epoch 13 [Batch 16/40]: Loss: 0.5189
  Epoch 13 [Batch 20/40]: Loss: 1.7285
  Epoch 13 [Batch 24/40]: Loss: 1.2427
  Epoch 13 [Batch 28/40]: Loss: 0.8703
  Epoch 13 [Batch 32/40]: Loss: 0.9893
  Epoch 13 [Batch 36/40]: Loss: 0.3332
  Epoch 13 Train Summary: Avg Loss: 0.9006, Accuracy: 0.5723
  Validation Summary: Avg Loss: 1.6033, Accuracy: 0.2778, F1 (Macro): 0.2731

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/40]: Loss: 0.4784
  Epoch 14 [Batch 4/40]: Loss: 0.3958
  Epoch 14 [Batch 8/40]: Loss: 1.0638
  Epoch 14 [Batch 12/40]: Loss: 1.3748
  Epoch 14 [Batch 16/40]: Loss: 0.9477
  Epoch 14 [Batch 20/40]: Loss: 1.2122
  Epoch 14 [Batch 24/40]: Loss: 0.3032
  Epoch 14 [Batch 28/40]: Loss: 1.5606
  Epoch 14 [Batch 32/40]: Loss: 0.8497
  Epoch 14 [Batch 36/40]: Loss: 0.6796
  Epoch 14 Train Summary: Avg Loss: 0.8403, Accuracy: 0.5640
  Validation Summary: Avg Loss: 1.9244, Accuracy: 0.2500, F1 (Macro): 0.2667
Training finished in 6.20 minutes.
Loading best model for final evaluation...
  Validation Summary: Avg Loss: 1.4379, Accuracy: 0.3583, F1 (Macro): 0.3524
Final Best Model Stats: Acc: 0.3583, F1: 0.3524, Loss: 1.4379
Matplotlib not available. Skipping plot generation.
================================================================================

Aggregating results from all runs...
Successfully saved aggregate results to results_opg/all_runs.csv
All experiments complete.
--- OPG runs complete. ---

=====================================================
Running CEPH (36 experiments)...
Data: processed_datasets/ceph_classification.csv
Output: ./results_ceph
=====================================================
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
Warning: 'matplotlib' or 'seaborn' not found. Install them to generate plots.
================================================================================
Starting Baseline Experiment Runner
CSV File: processed_datasets/ceph_classification.csv
Output Dir: ./results_ceph
Epochs: 15, Batch Size: 8
Grid Search Parameters:
  Architectures: ['resnet50', 'efficientnet_b0']
  Sizes: ['224x224', '384x384']
  Learning Rates: ['1e-4', '5e-5', '1e-5']
  Dropouts: ['0.0']
  Seeds: ['42', '123', '999']
Total experiments: 36
================================================================================
Using device: cuda

================================================================================
STARTING RUN: arch=resnet50 size=224x224 lr=0.0001 drop=0.0 seed=42
================================================================================
Starting experiment: resnet50__224x224__lr-0.0001__drop-0.0__seed-42
Output directory: results_ceph/resnet50__224x224__lr-0.0001__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.1220
  Epoch 0 [Batch 1/11]: Loss: 1.1033
  Epoch 0 [Batch 2/11]: Loss: 1.0825
  Epoch 0 [Batch 3/11]: Loss: 1.0957
  Epoch 0 [Batch 4/11]: Loss: 1.1049
  Epoch 0 [Batch 5/11]: Loss: 1.1092
  Epoch 0 [Batch 6/11]: Loss: 1.1036
  Epoch 0 [Batch 7/11]: Loss: 1.0912
  Epoch 0 [Batch 8/11]: Loss: 1.0980
  Epoch 0 [Batch 9/11]: Loss: 1.0779
  Epoch 0 [Batch 10/11]: Loss: 1.0401
  Epoch 0 Train Summary: Avg Loss: 1.0935, Accuracy: 0.3975
  Validation Summary: Avg Loss: 1.0775, Accuracy: 0.3500, F1 (Macro): 0.3175
  New best model! Val loss improved from inf to 1.0775. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.0799
  Epoch 1 [Batch 1/11]: Loss: 1.0717
  Epoch 1 [Batch 2/11]: Loss: 1.0173
  Epoch 1 [Batch 3/11]: Loss: 1.0522
  Epoch 1 [Batch 4/11]: Loss: 1.0429
  Epoch 1 [Batch 5/11]: Loss: 1.1431
  Epoch 1 [Batch 6/11]: Loss: 0.9717
  Epoch 1 [Batch 7/11]: Loss: 1.0466
  Epoch 1 [Batch 8/11]: Loss: 0.9879
  Epoch 1 [Batch 9/11]: Loss: 1.0413
  Epoch 1 [Batch 10/11]: Loss: 1.1562
  Epoch 1 Train Summary: Avg Loss: 1.0555, Accuracy: 0.3313
  Validation Summary: Avg Loss: 1.0963, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 1.0310
  Epoch 2 [Batch 1/11]: Loss: 1.0443
  Epoch 2 [Batch 2/11]: Loss: 1.0598
  Epoch 2 [Batch 3/11]: Loss: 1.0736
  Epoch 2 [Batch 4/11]: Loss: 1.0378
  Epoch 2 [Batch 5/11]: Loss: 1.0571
  Epoch 2 [Batch 6/11]: Loss: 1.0093
  Epoch 2 [Batch 7/11]: Loss: 0.9246
  Epoch 2 [Batch 8/11]: Loss: 0.8677
  Epoch 2 [Batch 9/11]: Loss: 0.9751
  Epoch 2 [Batch 10/11]: Loss: 0.8786
  Epoch 2 Train Summary: Avg Loss: 0.9963, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1188, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 0.9971
  Epoch 3 [Batch 1/11]: Loss: 0.9394
  Epoch 3 [Batch 2/11]: Loss: 0.9773
  Epoch 3 [Batch 3/11]: Loss: 0.8461
  Epoch 3 [Batch 4/11]: Loss: 1.0403
  Epoch 3 [Batch 5/11]: Loss: 1.1163
  Epoch 3 [Batch 6/11]: Loss: 0.8238
  Epoch 3 [Batch 7/11]: Loss: 0.9629
  Epoch 3 [Batch 8/11]: Loss: 0.9679
  Epoch 3 [Batch 9/11]: Loss: 1.0443
  Epoch 3 [Batch 10/11]: Loss: 1.0867
  Epoch 3 Train Summary: Avg Loss: 0.9820, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1073, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 0.8789
  Epoch 4 [Batch 1/11]: Loss: 1.1294
  Epoch 4 [Batch 2/11]: Loss: 1.2234
  Epoch 4 [Batch 3/11]: Loss: 0.8743
  Epoch 4 [Batch 4/11]: Loss: 0.9129
  Epoch 4 [Batch 5/11]: Loss: 0.9645
  Epoch 4 [Batch 6/11]: Loss: 0.7358
  Epoch 4 [Batch 7/11]: Loss: 1.0710
  Epoch 4 [Batch 8/11]: Loss: 0.8730
  Epoch 4 [Batch 9/11]: Loss: 0.8138
  Epoch 4 [Batch 10/11]: Loss: 1.3533
  Epoch 4 Train Summary: Avg Loss: 0.9846, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1213, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 0.9844
  Epoch 5 [Batch 1/11]: Loss: 0.8711
  Epoch 5 [Batch 2/11]: Loss: 0.8639
  Epoch 5 [Batch 3/11]: Loss: 0.8584
  Epoch 5 [Batch 4/11]: Loss: 1.0986
  Epoch 5 [Batch 5/11]: Loss: 0.8997
  Epoch 5 [Batch 6/11]: Loss: 0.8948
  Epoch 5 [Batch 7/11]: Loss: 0.8202
  Epoch 5 [Batch 8/11]: Loss: 1.0118
  Epoch 5 [Batch 9/11]: Loss: 0.9917
  Epoch 5 [Batch 10/11]: Loss: 1.1907
  Epoch 5 Train Summary: Avg Loss: 0.9532, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.2132, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 0.7822
  Epoch 6 [Batch 1/11]: Loss: 0.9894
  Epoch 6 [Batch 2/11]: Loss: 1.0779
  Epoch 6 [Batch 3/11]: Loss: 1.0925
  Epoch 6 [Batch 4/11]: Loss: 0.8483
  Epoch 6 [Batch 5/11]: Loss: 0.8970
  Epoch 6 [Batch 6/11]: Loss: 1.1427
  Epoch 6 [Batch 7/11]: Loss: 0.6500
  Epoch 6 [Batch 8/11]: Loss: 1.0861
  Epoch 6 [Batch 9/11]: Loss: 0.8567
  Epoch 6 [Batch 10/11]: Loss: 0.6620
  Epoch 6 Train Summary: Avg Loss: 0.9168, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.2148, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.9721
  Epoch 7 [Batch 1/11]: Loss: 0.8281
  Epoch 7 [Batch 2/11]: Loss: 0.6670
  Epoch 7 [Batch 3/11]: Loss: 0.9726
  Epoch 7 [Batch 4/11]: Loss: 0.9608
  Epoch 7 [Batch 5/11]: Loss: 1.0524
  Epoch 7 [Batch 6/11]: Loss: 0.7905
  Epoch 7 [Batch 7/11]: Loss: 0.9841
  Epoch 7 [Batch 8/11]: Loss: 0.9458
  Epoch 7 [Batch 9/11]: Loss: 0.9059
  Epoch 7 [Batch 10/11]: Loss: 1.0819
  Epoch 7 Train Summary: Avg Loss: 0.9237, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1877, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 1.2045
  Epoch 8 [Batch 1/11]: Loss: 1.1116
  Epoch 8 [Batch 2/11]: Loss: 0.8246
  Epoch 8 [Batch 3/11]: Loss: 0.8559
  Epoch 8 [Batch 4/11]: Loss: 0.7480
  Epoch 8 [Batch 5/11]: Loss: 1.0664
  Epoch 8 [Batch 6/11]: Loss: 0.9426
  Epoch 8 [Batch 7/11]: Loss: 1.0609
  Epoch 8 [Batch 8/11]: Loss: 0.6338
  Epoch 8 [Batch 9/11]: Loss: 0.9416
  Epoch 8 [Batch 10/11]: Loss: 0.6532
  Epoch 8 Train Summary: Avg Loss: 0.9130, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1933, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 0.9834
  Epoch 9 [Batch 1/11]: Loss: 0.9051
  Epoch 9 [Batch 2/11]: Loss: 0.7911
  Epoch 9 [Batch 3/11]: Loss: 1.0698
  Epoch 9 [Batch 4/11]: Loss: 0.8844
  Epoch 9 [Batch 5/11]: Loss: 0.8506
  Epoch 9 [Batch 6/11]: Loss: 0.9290
  Epoch 9 [Batch 7/11]: Loss: 0.8991
  Epoch 9 [Batch 8/11]: Loss: 0.9174
  Epoch 9 [Batch 9/11]: Loss: 0.9549
  Epoch 9 [Batch 10/11]: Loss: 0.6563
  Epoch 9 Train Summary: Avg Loss: 0.8946, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1842, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 0.7582
  Epoch 10 [Batch 1/11]: Loss: 0.7473
  Epoch 10 [Batch 2/11]: Loss: 0.9458
  Epoch 10 [Batch 3/11]: Loss: 0.9629
  Epoch 10 [Batch 4/11]: Loss: 1.2520
  Epoch 10 [Batch 5/11]: Loss: 0.8685
  Epoch 10 [Batch 6/11]: Loss: 0.8217
  Epoch 10 [Batch 7/11]: Loss: 0.7768
  Epoch 10 [Batch 8/11]: Loss: 1.0036
  Epoch 10 [Batch 9/11]: Loss: 1.1274
  Epoch 10 [Batch 10/11]: Loss: 0.6417
  Epoch 10 Train Summary: Avg Loss: 0.9005, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1909, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 1.0474
  Epoch 11 [Batch 1/11]: Loss: 0.9298
  Epoch 11 [Batch 2/11]: Loss: 0.8537
  Epoch 11 [Batch 3/11]: Loss: 0.9774
  Epoch 11 [Batch 4/11]: Loss: 0.6557
  Epoch 11 [Batch 5/11]: Loss: 0.9032
  Epoch 11 [Batch 6/11]: Loss: 0.7583
  Epoch 11 [Batch 7/11]: Loss: 0.8912
  Epoch 11 [Batch 8/11]: Loss: 1.2280
  Epoch 11 [Batch 9/11]: Loss: 0.9124
  Epoch 11 [Batch 10/11]: Loss: 0.6166
  Epoch 11 Train Summary: Avg Loss: 0.8885, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1761, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.9125
  Epoch 12 [Batch 1/11]: Loss: 1.1761
  Epoch 12 [Batch 2/11]: Loss: 0.6406
  Epoch 12 [Batch 3/11]: Loss: 0.9026
  Epoch 12 [Batch 4/11]: Loss: 1.0597
  Epoch 12 [Batch 5/11]: Loss: 0.7885
  Epoch 12 [Batch 6/11]: Loss: 0.9726
  Epoch 12 [Batch 7/11]: Loss: 0.9025
  Epoch 12 [Batch 8/11]: Loss: 1.0789
  Epoch 12 [Batch 9/11]: Loss: 0.8023
  Epoch 12 [Batch 10/11]: Loss: 1.2524
  Epoch 12 Train Summary: Avg Loss: 0.9535, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1786, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 0.8201
  Epoch 13 [Batch 1/11]: Loss: 0.8879
  Epoch 13 [Batch 2/11]: Loss: 0.7959
  Epoch 13 [Batch 3/11]: Loss: 0.9468
  Epoch 13 [Batch 4/11]: Loss: 0.9828
  Epoch 13 [Batch 5/11]: Loss: 0.9684
  Epoch 13 [Batch 6/11]: Loss: 1.0710
  Epoch 13 [Batch 7/11]: Loss: 0.8863
  Epoch 13 [Batch 8/11]: Loss: 0.9655
  Epoch 13 [Batch 9/11]: Loss: 0.8233
  Epoch 13 [Batch 10/11]: Loss: 0.9732
  Epoch 13 Train Summary: Avg Loss: 0.9201, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1885, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.7771
  Epoch 14 [Batch 1/11]: Loss: 1.1376
  Epoch 14 [Batch 2/11]: Loss: 0.6995
  Epoch 14 [Batch 3/11]: Loss: 0.6650
  Epoch 14 [Batch 4/11]: Loss: 0.8078
  Epoch 14 [Batch 5/11]: Loss: 0.9065
  Epoch 14 [Batch 6/11]: Loss: 1.0174
  Epoch 14 [Batch 7/11]: Loss: 1.0644
  Epoch 14 [Batch 8/11]: Loss: 0.9656
  Epoch 14 [Batch 9/11]: Loss: 0.8893
  Epoch 14 [Batch 10/11]: Loss: 1.6588
  Epoch 14 Train Summary: Avg Loss: 0.9626, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1801, Accuracy: 0.3333, F1 (Macro): 0.2222
Training finished in 1.50 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.0775, Accuracy: 0.3500, F1 (Macro): 0.3175
Final Best Model Stats: Acc: 0.3500, F1: 0.3175, Loss: 1.0775
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=0.0001 drop=0.0 seed=123
================================================================================
Starting experiment: resnet50__224x224__lr-0.0001__drop-0.0__seed-123
Output directory: results_ceph/resnet50__224x224__lr-0.0001__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.1092
  Epoch 0 [Batch 1/11]: Loss: 1.0797
  Epoch 0 [Batch 2/11]: Loss: 1.0970
  Epoch 0 [Batch 3/11]: Loss: 1.0956
  Epoch 0 [Batch 4/11]: Loss: 1.0956
  Epoch 0 [Batch 5/11]: Loss: 1.0743
  Epoch 0 [Batch 6/11]: Loss: 1.0540
  Epoch 0 [Batch 7/11]: Loss: 1.0438
  Epoch 0 [Batch 8/11]: Loss: 1.0857
  Epoch 0 [Batch 9/11]: Loss: 1.1136
  Epoch 0 [Batch 10/11]: Loss: 1.0181
  Epoch 0 Train Summary: Avg Loss: 1.0788, Accuracy: 0.3162
  Validation Summary: Avg Loss: 1.0745, Accuracy: 0.3333, F1 (Macro): 0.1905
  New best model! Val loss improved from inf to 1.0745. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.0518
  Epoch 1 [Batch 1/11]: Loss: 1.0981
  Epoch 1 [Batch 2/11]: Loss: 1.0343
  Epoch 1 [Batch 3/11]: Loss: 1.0510
  Epoch 1 [Batch 4/11]: Loss: 1.0029
  Epoch 1 [Batch 5/11]: Loss: 1.0067
  Epoch 1 [Batch 6/11]: Loss: 1.0196
  Epoch 1 [Batch 7/11]: Loss: 1.0353
  Epoch 1 [Batch 8/11]: Loss: 0.9768
  Epoch 1 [Batch 9/11]: Loss: 1.0831
  Epoch 1 [Batch 10/11]: Loss: 1.1742
  Epoch 1 Train Summary: Avg Loss: 1.0485, Accuracy: 0.3091
  Validation Summary: Avg Loss: 1.0868, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 1.0291
  Epoch 2 [Batch 1/11]: Loss: 1.0770
  Epoch 2 [Batch 2/11]: Loss: 0.9711
  Epoch 2 [Batch 3/11]: Loss: 1.1248
  Epoch 2 [Batch 4/11]: Loss: 1.0176
  Epoch 2 [Batch 5/11]: Loss: 0.8715
  Epoch 2 [Batch 6/11]: Loss: 1.0260
  Epoch 2 [Batch 7/11]: Loss: 1.0097
  Epoch 2 [Batch 8/11]: Loss: 0.9750
  Epoch 2 [Batch 9/11]: Loss: 0.9624
  Epoch 2 [Batch 10/11]: Loss: 0.9799
  Epoch 2 Train Summary: Avg Loss: 1.0040, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0677, Accuracy: 0.3333, F1 (Macro): 0.2222
  New best model! Val loss improved from 1.0745 to 1.0677. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 0.9719
  Epoch 3 [Batch 1/11]: Loss: 1.0512
  Epoch 3 [Batch 2/11]: Loss: 1.1561
  Epoch 3 [Batch 3/11]: Loss: 0.9833
  Epoch 3 [Batch 4/11]: Loss: 0.9606
  Epoch 3 [Batch 5/11]: Loss: 0.8329
  Epoch 3 [Batch 6/11]: Loss: 0.9133
  Epoch 3 [Batch 7/11]: Loss: 1.0611
  Epoch 3 [Batch 8/11]: Loss: 0.9688
  Epoch 3 [Batch 9/11]: Loss: 0.9976
  Epoch 3 [Batch 10/11]: Loss: 1.0051
  Epoch 3 Train Summary: Avg Loss: 0.9911, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0850, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 1.0810
  Epoch 4 [Batch 1/11]: Loss: 1.0352
  Epoch 4 [Batch 2/11]: Loss: 0.9574
  Epoch 4 [Batch 3/11]: Loss: 0.9001
  Epoch 4 [Batch 4/11]: Loss: 0.9342
  Epoch 4 [Batch 5/11]: Loss: 1.0080
  Epoch 4 [Batch 6/11]: Loss: 0.8987
  Epoch 4 [Batch 7/11]: Loss: 0.9440
  Epoch 4 [Batch 8/11]: Loss: 1.0136
  Epoch 4 [Batch 9/11]: Loss: 0.9407
  Epoch 4 [Batch 10/11]: Loss: 0.7479
  Epoch 4 Train Summary: Avg Loss: 0.9510, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1276, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 1.1021
  Epoch 5 [Batch 1/11]: Loss: 0.8688
  Epoch 5 [Batch 2/11]: Loss: 1.1515
  Epoch 5 [Batch 3/11]: Loss: 0.9220
  Epoch 5 [Batch 4/11]: Loss: 1.1015
  Epoch 5 [Batch 5/11]: Loss: 0.8396
  Epoch 5 [Batch 6/11]: Loss: 0.9906
  Epoch 5 [Batch 7/11]: Loss: 0.7913
  Epoch 5 [Batch 8/11]: Loss: 1.0134
  Epoch 5 [Batch 9/11]: Loss: 0.8671
  Epoch 5 [Batch 10/11]: Loss: 0.9888
  Epoch 5 Train Summary: Avg Loss: 0.9670, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.2179, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 1.0226
  Epoch 6 [Batch 1/11]: Loss: 0.8810
  Epoch 6 [Batch 2/11]: Loss: 0.8121
  Epoch 6 [Batch 3/11]: Loss: 1.1062
  Epoch 6 [Batch 4/11]: Loss: 0.9610
  Epoch 6 [Batch 5/11]: Loss: 0.9186
  Epoch 6 [Batch 6/11]: Loss: 0.7773
  Epoch 6 [Batch 7/11]: Loss: 0.7995
  Epoch 6 [Batch 8/11]: Loss: 1.1630
  Epoch 6 [Batch 9/11]: Loss: 1.1305
  Epoch 6 [Batch 10/11]: Loss: 0.6229
  Epoch 6 Train Summary: Avg Loss: 0.9268, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.3046, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.6794
  Epoch 7 [Batch 1/11]: Loss: 0.9735
  Epoch 7 [Batch 2/11]: Loss: 0.8752
  Epoch 7 [Batch 3/11]: Loss: 1.0261
  Epoch 7 [Batch 4/11]: Loss: 0.8757
  Epoch 7 [Batch 5/11]: Loss: 0.9589
  Epoch 7 [Batch 6/11]: Loss: 1.0689
  Epoch 7 [Batch 7/11]: Loss: 1.1729
  Epoch 7 [Batch 8/11]: Loss: 0.8837
  Epoch 7 [Batch 9/11]: Loss: 0.8727
  Epoch 7 [Batch 10/11]: Loss: 0.6054
  Epoch 7 Train Summary: Avg Loss: 0.9084, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.2491, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 0.7134
  Epoch 8 [Batch 1/11]: Loss: 0.8437
  Epoch 8 [Batch 2/11]: Loss: 0.9313
  Epoch 8 [Batch 3/11]: Loss: 0.7785
  Epoch 8 [Batch 4/11]: Loss: 1.2577
  Epoch 8 [Batch 5/11]: Loss: 0.9278
  Epoch 8 [Batch 6/11]: Loss: 1.1979
  Epoch 8 [Batch 7/11]: Loss: 0.8193
  Epoch 8 [Batch 8/11]: Loss: 0.8150
  Epoch 8 [Batch 9/11]: Loss: 0.9653
  Epoch 8 [Batch 10/11]: Loss: 0.8969
  Epoch 8 Train Summary: Avg Loss: 0.9224, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.2359, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 0.7449
  Epoch 9 [Batch 1/11]: Loss: 1.0538
  Epoch 9 [Batch 2/11]: Loss: 1.2192
  Epoch 9 [Batch 3/11]: Loss: 0.7341
  Epoch 9 [Batch 4/11]: Loss: 0.9001
  Epoch 9 [Batch 5/11]: Loss: 1.1638
  Epoch 9 [Batch 6/11]: Loss: 0.8969
  Epoch 9 [Batch 7/11]: Loss: 1.0427
  Epoch 9 [Batch 8/11]: Loss: 0.7882
  Epoch 9 [Batch 9/11]: Loss: 0.8414
  Epoch 9 [Batch 10/11]: Loss: 0.6116
  Epoch 9 Train Summary: Avg Loss: 0.9088, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.3191, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 1.0854
  Epoch 10 [Batch 1/11]: Loss: 0.6087
  Epoch 10 [Batch 2/11]: Loss: 0.9615
  Epoch 10 [Batch 3/11]: Loss: 1.0301
  Epoch 10 [Batch 4/11]: Loss: 0.9815
  Epoch 10 [Batch 5/11]: Loss: 0.5951
  Epoch 10 [Batch 6/11]: Loss: 1.2275
  Epoch 10 [Batch 7/11]: Loss: 1.1049
  Epoch 10 [Batch 8/11]: Loss: 0.6346
  Epoch 10 [Batch 9/11]: Loss: 0.8813
  Epoch 10 [Batch 10/11]: Loss: 1.3852
  Epoch 10 Train Summary: Avg Loss: 0.9542, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.2930, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 0.8421
  Epoch 11 [Batch 1/11]: Loss: 0.7421
  Epoch 11 [Batch 2/11]: Loss: 0.9999
  Epoch 11 [Batch 3/11]: Loss: 0.7990
  Epoch 11 [Batch 4/11]: Loss: 1.0789
  Epoch 11 [Batch 5/11]: Loss: 1.5292
  Epoch 11 [Batch 6/11]: Loss: 0.7301
  Epoch 11 [Batch 7/11]: Loss: 0.7690
  Epoch 11 [Batch 8/11]: Loss: 0.8866
  Epoch 11 [Batch 9/11]: Loss: 0.8184
  Epoch 11 [Batch 10/11]: Loss: 1.2720
  Epoch 11 Train Summary: Avg Loss: 0.9516, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.3317, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.9924
  Epoch 12 [Batch 1/11]: Loss: 1.0359
  Epoch 12 [Batch 2/11]: Loss: 0.8369
  Epoch 12 [Batch 3/11]: Loss: 0.8806
  Epoch 12 [Batch 4/11]: Loss: 0.8623
  Epoch 12 [Batch 5/11]: Loss: 0.9179
  Epoch 12 [Batch 6/11]: Loss: 0.7658
  Epoch 12 [Batch 7/11]: Loss: 0.7339
  Epoch 12 [Batch 8/11]: Loss: 0.8104
  Epoch 12 [Batch 9/11]: Loss: 1.2783
  Epoch 12 [Batch 10/11]: Loss: 0.9603
  Epoch 12 Train Summary: Avg Loss: 0.9159, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.3009, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 0.9842
  Epoch 13 [Batch 1/11]: Loss: 0.7141
  Epoch 13 [Batch 2/11]: Loss: 0.9344
  Epoch 13 [Batch 3/11]: Loss: 1.0044
  Epoch 13 [Batch 4/11]: Loss: 0.8405
  Epoch 13 [Batch 5/11]: Loss: 1.1202
  Epoch 13 [Batch 6/11]: Loss: 0.7914
  Epoch 13 [Batch 7/11]: Loss: 1.1397
  Epoch 13 [Batch 8/11]: Loss: 0.9122
  Epoch 13 [Batch 9/11]: Loss: 0.7220
  Epoch 13 [Batch 10/11]: Loss: 0.5989
  Epoch 13 Train Summary: Avg Loss: 0.8875, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.3379, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.8278
  Epoch 14 [Batch 1/11]: Loss: 0.9912
  Epoch 14 [Batch 2/11]: Loss: 0.6919
  Epoch 14 [Batch 3/11]: Loss: 1.0108
  Epoch 14 [Batch 4/11]: Loss: 0.9586
  Epoch 14 [Batch 5/11]: Loss: 0.8393
  Epoch 14 [Batch 6/11]: Loss: 0.8794
  Epoch 14 [Batch 7/11]: Loss: 0.8573
  Epoch 14 [Batch 8/11]: Loss: 1.1534
  Epoch 14 [Batch 9/11]: Loss: 0.8361
  Epoch 14 [Batch 10/11]: Loss: 1.5525
  Epoch 14 Train Summary: Avg Loss: 0.9635, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.3575, Accuracy: 0.3333, F1 (Macro): 0.2222
Training finished in 0.98 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.0677, Accuracy: 0.3333, F1 (Macro): 0.2222
Final Best Model Stats: Acc: 0.3333, F1: 0.2222, Loss: 1.0677
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=0.0001 drop=0.0 seed=999
================================================================================
Starting experiment: resnet50__224x224__lr-0.0001__drop-0.0__seed-999
Output directory: results_ceph/resnet50__224x224__lr-0.0001__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.1428
  Epoch 0 [Batch 1/11]: Loss: 1.1223
  Epoch 0 [Batch 2/11]: Loss: 1.1351
  Epoch 0 [Batch 3/11]: Loss: 1.1274
  Epoch 0 [Batch 4/11]: Loss: 1.1248
  Epoch 0 [Batch 5/11]: Loss: 1.0922
  Epoch 0 [Batch 6/11]: Loss: 1.0988
  Epoch 0 [Batch 7/11]: Loss: 1.0868
  Epoch 0 [Batch 8/11]: Loss: 1.1200
  Epoch 0 [Batch 9/11]: Loss: 1.0847
  Epoch 0 [Batch 10/11]: Loss: 1.0678
  Epoch 0 Train Summary: Avg Loss: 1.1093, Accuracy: 0.4073
  Validation Summary: Avg Loss: 1.0865, Accuracy: 0.4500, F1 (Macro): 0.4444
  New best model! Val loss improved from inf to 1.0865. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.0814
  Epoch 1 [Batch 1/11]: Loss: 1.0688
  Epoch 1 [Batch 2/11]: Loss: 1.0649
  Epoch 1 [Batch 3/11]: Loss: 1.0582
  Epoch 1 [Batch 4/11]: Loss: 1.0910
  Epoch 1 [Batch 5/11]: Loss: 1.0626
  Epoch 1 [Batch 6/11]: Loss: 1.0324
  Epoch 1 [Batch 7/11]: Loss: 1.0673
  Epoch 1 [Batch 8/11]: Loss: 1.0003
  Epoch 1 [Batch 9/11]: Loss: 1.0685
  Epoch 1 [Batch 10/11]: Loss: 0.9575
  Epoch 1 Train Summary: Avg Loss: 1.0503, Accuracy: 0.3915
  Validation Summary: Avg Loss: 1.0988, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 1.0447
  Epoch 2 [Batch 1/11]: Loss: 0.9985
  Epoch 2 [Batch 2/11]: Loss: 1.0308
  Epoch 2 [Batch 3/11]: Loss: 0.9467
  Epoch 2 [Batch 4/11]: Loss: 0.9987
  Epoch 2 [Batch 5/11]: Loss: 0.9615
  Epoch 2 [Batch 6/11]: Loss: 0.9967
  Epoch 2 [Batch 7/11]: Loss: 1.1056
  Epoch 2 [Batch 8/11]: Loss: 1.0198
  Epoch 2 [Batch 9/11]: Loss: 1.0078
  Epoch 2 [Batch 10/11]: Loss: 1.0155
  Epoch 2 Train Summary: Avg Loss: 1.0115, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1054, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 1.0700
  Epoch 3 [Batch 1/11]: Loss: 0.9847
  Epoch 3 [Batch 2/11]: Loss: 0.9970
  Epoch 3 [Batch 3/11]: Loss: 0.9547
  Epoch 3 [Batch 4/11]: Loss: 1.0389
  Epoch 3 [Batch 5/11]: Loss: 1.1087
  Epoch 3 [Batch 6/11]: Loss: 0.9371
  Epoch 3 [Batch 7/11]: Loss: 0.9748
  Epoch 3 [Batch 8/11]: Loss: 1.0067
  Epoch 3 [Batch 9/11]: Loss: 0.8820
  Epoch 3 [Batch 10/11]: Loss: 0.9888
  Epoch 3 Train Summary: Avg Loss: 0.9949, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1265, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 0.9844
  Epoch 4 [Batch 1/11]: Loss: 0.8756
  Epoch 4 [Batch 2/11]: Loss: 0.9576
  Epoch 4 [Batch 3/11]: Loss: 0.9994
  Epoch 4 [Batch 4/11]: Loss: 0.9013
  Epoch 4 [Batch 5/11]: Loss: 0.8946
  Epoch 4 [Batch 6/11]: Loss: 1.0223
  Epoch 4 [Batch 7/11]: Loss: 1.0102
  Epoch 4 [Batch 8/11]: Loss: 0.8708
  Epoch 4 [Batch 9/11]: Loss: 1.0843
  Epoch 4 [Batch 10/11]: Loss: 0.6795
  Epoch 4 Train Summary: Avg Loss: 0.9346, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1368, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 0.8588
  Epoch 5 [Batch 1/11]: Loss: 0.9941
  Epoch 5 [Batch 2/11]: Loss: 0.9568
  Epoch 5 [Batch 3/11]: Loss: 0.9166
  Epoch 5 [Batch 4/11]: Loss: 0.8987
  Epoch 5 [Batch 5/11]: Loss: 1.1193
  Epoch 5 [Batch 6/11]: Loss: 0.8010
  Epoch 5 [Batch 7/11]: Loss: 1.0233
  Epoch 5 [Batch 8/11]: Loss: 0.9053
  Epoch 5 [Batch 9/11]: Loss: 1.0360
  Epoch 5 [Batch 10/11]: Loss: 0.6700
  Epoch 5 Train Summary: Avg Loss: 0.9254, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1628, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 1.2104
  Epoch 6 [Batch 1/11]: Loss: 0.9165
  Epoch 6 [Batch 2/11]: Loss: 0.8534
  Epoch 6 [Batch 3/11]: Loss: 0.7712
  Epoch 6 [Batch 4/11]: Loss: 0.9299
  Epoch 6 [Batch 5/11]: Loss: 0.9995
  Epoch 6 [Batch 6/11]: Loss: 1.0862
  Epoch 6 [Batch 7/11]: Loss: 0.9668
  Epoch 6 [Batch 8/11]: Loss: 0.9546
  Epoch 6 [Batch 9/11]: Loss: 0.6225
  Epoch 6 [Batch 10/11]: Loss: 0.9150
  Epoch 6 Train Summary: Avg Loss: 0.9296, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.2856, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.7916
  Epoch 7 [Batch 1/11]: Loss: 0.9319
  Epoch 7 [Batch 2/11]: Loss: 1.3576
  Epoch 7 [Batch 3/11]: Loss: 0.8377
  Epoch 7 [Batch 4/11]: Loss: 0.8073
  Epoch 7 [Batch 5/11]: Loss: 0.8813
  Epoch 7 [Batch 6/11]: Loss: 1.0097
  Epoch 7 [Batch 7/11]: Loss: 0.9810
  Epoch 7 [Batch 8/11]: Loss: 0.7139
  Epoch 7 [Batch 9/11]: Loss: 0.9219
  Epoch 7 [Batch 10/11]: Loss: 0.6069
  Epoch 7 Train Summary: Avg Loss: 0.8946, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.2771, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 1.1132
  Epoch 8 [Batch 1/11]: Loss: 0.6758
  Epoch 8 [Batch 2/11]: Loss: 1.0985
  Epoch 8 [Batch 3/11]: Loss: 0.8241
  Epoch 8 [Batch 4/11]: Loss: 0.9420
  Epoch 8 [Batch 5/11]: Loss: 1.2229
  Epoch 8 [Batch 6/11]: Loss: 0.6809
  Epoch 8 [Batch 7/11]: Loss: 0.8922
  Epoch 8 [Batch 8/11]: Loss: 0.8063
  Epoch 8 [Batch 9/11]: Loss: 0.8180
  Epoch 8 [Batch 10/11]: Loss: 0.6293
  Epoch 8 Train Summary: Avg Loss: 0.8821, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.2959, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 0.9038
  Epoch 9 [Batch 1/11]: Loss: 0.6439
  Epoch 9 [Batch 2/11]: Loss: 0.9108
  Epoch 9 [Batch 3/11]: Loss: 0.8925
  Epoch 9 [Batch 4/11]: Loss: 0.9619
  Epoch 9 [Batch 5/11]: Loss: 1.0813
  Epoch 9 [Batch 6/11]: Loss: 0.7489
  Epoch 9 [Batch 7/11]: Loss: 1.1455
  Epoch 9 [Batch 8/11]: Loss: 0.7754
  Epoch 9 [Batch 9/11]: Loss: 1.0002
  Epoch 9 [Batch 10/11]: Loss: 1.5055
  Epoch 9 Train Summary: Avg Loss: 0.9609, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.3292, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 0.7860
  Epoch 10 [Batch 1/11]: Loss: 1.0540
  Epoch 10 [Batch 2/11]: Loss: 1.1150
  Epoch 10 [Batch 3/11]: Loss: 1.0912
  Epoch 10 [Batch 4/11]: Loss: 0.8285
  Epoch 10 [Batch 5/11]: Loss: 0.7969
  Epoch 10 [Batch 6/11]: Loss: 1.0403
  Epoch 10 [Batch 7/11]: Loss: 0.8303
  Epoch 10 [Batch 8/11]: Loss: 0.8486
  Epoch 10 [Batch 9/11]: Loss: 0.7548
  Epoch 10 [Batch 10/11]: Loss: 1.0523
  Epoch 10 Train Summary: Avg Loss: 0.9271, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.2497, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 0.7949
  Epoch 11 [Batch 1/11]: Loss: 0.7765
  Epoch 11 [Batch 2/11]: Loss: 0.8471
  Epoch 11 [Batch 3/11]: Loss: 0.7117
  Epoch 11 [Batch 4/11]: Loss: 0.8790
  Epoch 11 [Batch 5/11]: Loss: 1.1948
  Epoch 11 [Batch 6/11]: Loss: 0.9022
  Epoch 11 [Batch 7/11]: Loss: 1.2106
  Epoch 11 [Batch 8/11]: Loss: 0.9822
  Epoch 11 [Batch 9/11]: Loss: 0.8403
  Epoch 11 [Batch 10/11]: Loss: 1.2440
  Epoch 11 Train Summary: Avg Loss: 0.9439, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.2570, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.8779
  Epoch 12 [Batch 1/11]: Loss: 1.3903
  Epoch 12 [Batch 2/11]: Loss: 0.8172
  Epoch 12 [Batch 3/11]: Loss: 0.8544
  Epoch 12 [Batch 4/11]: Loss: 0.8543
  Epoch 12 [Batch 5/11]: Loss: 0.8560
  Epoch 12 [Batch 6/11]: Loss: 0.7010
  Epoch 12 [Batch 7/11]: Loss: 0.9800
  Epoch 12 [Batch 8/11]: Loss: 1.0152
  Epoch 12 [Batch 9/11]: Loss: 0.8834
  Epoch 12 [Batch 10/11]: Loss: 0.9197
  Epoch 12 Train Summary: Avg Loss: 0.9227, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.2555, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 0.9638
  Epoch 13 [Batch 1/11]: Loss: 1.0336
  Epoch 13 [Batch 2/11]: Loss: 0.8787
  Epoch 13 [Batch 3/11]: Loss: 0.9920
  Epoch 13 [Batch 4/11]: Loss: 1.0133
  Epoch 13 [Batch 5/11]: Loss: 0.6956
  Epoch 13 [Batch 6/11]: Loss: 0.8600
  Epoch 13 [Batch 7/11]: Loss: 0.8613
  Epoch 13 [Batch 8/11]: Loss: 0.6892
  Epoch 13 [Batch 9/11]: Loss: 1.0506
  Epoch 13 [Batch 10/11]: Loss: 0.5940
  Epoch 13 Train Summary: Avg Loss: 0.8756, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.2678, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.6626
  Epoch 14 [Batch 1/11]: Loss: 0.7699
  Epoch 14 [Batch 2/11]: Loss: 0.9047
  Epoch 14 [Batch 3/11]: Loss: 0.7982
  Epoch 14 [Batch 4/11]: Loss: 1.0679
  Epoch 14 [Batch 5/11]: Loss: 1.1492
  Epoch 14 [Batch 6/11]: Loss: 0.8288
  Epoch 14 [Batch 7/11]: Loss: 0.8002
  Epoch 14 [Batch 8/11]: Loss: 1.1068
  Epoch 14 [Batch 9/11]: Loss: 1.1920
  Epoch 14 [Batch 10/11]: Loss: 0.7911
  Epoch 14 Train Summary: Avg Loss: 0.9156, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.2467, Accuracy: 0.3333, F1 (Macro): 0.2222
Training finished in 0.80 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.0865, Accuracy: 0.4500, F1 (Macro): 0.4444
Final Best Model Stats: Acc: 0.4500, F1: 0.4444, Loss: 1.0865
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=5e-05 drop=0.0 seed=42
================================================================================
Starting experiment: resnet50__224x224__lr-5e-05__drop-0.0__seed-42
Output directory: results_ceph/resnet50__224x224__lr-5e-05__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.1220
  Epoch 0 [Batch 1/11]: Loss: 1.1055
  Epoch 0 [Batch 2/11]: Loss: 1.0971
  Epoch 0 [Batch 3/11]: Loss: 1.0969
  Epoch 0 [Batch 4/11]: Loss: 1.1185
  Epoch 0 [Batch 5/11]: Loss: 1.1048
  Epoch 0 [Batch 6/11]: Loss: 1.1178
  Epoch 0 [Batch 7/11]: Loss: 1.1141
  Epoch 0 [Batch 8/11]: Loss: 1.1001
  Epoch 0 [Batch 9/11]: Loss: 1.1140
  Epoch 0 [Batch 10/11]: Loss: 1.1039
  Epoch 0 Train Summary: Avg Loss: 1.1086, Accuracy: 0.3618
  Validation Summary: Avg Loss: 1.0790, Accuracy: 0.3500, F1 (Macro): 0.3377
  New best model! Val loss improved from inf to 1.0790. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.1160
  Epoch 1 [Batch 1/11]: Loss: 1.1005
  Epoch 1 [Batch 2/11]: Loss: 1.0597
  Epoch 1 [Batch 3/11]: Loss: 1.0837
  Epoch 1 [Batch 4/11]: Loss: 1.0856
  Epoch 1 [Batch 5/11]: Loss: 1.1160
  Epoch 1 [Batch 6/11]: Loss: 1.0644
  Epoch 1 [Batch 7/11]: Loss: 1.0726
  Epoch 1 [Batch 8/11]: Loss: 1.0374
  Epoch 1 [Batch 9/11]: Loss: 1.0760
  Epoch 1 [Batch 10/11]: Loss: 1.1335
  Epoch 1 Train Summary: Avg Loss: 1.0859, Accuracy: 0.3610
  Validation Summary: Avg Loss: 1.0899, Accuracy: 0.4167, F1 (Macro): 0.3714

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 1.0798
  Epoch 2 [Batch 1/11]: Loss: 1.0785
  Epoch 2 [Batch 2/11]: Loss: 1.0766
  Epoch 2 [Batch 3/11]: Loss: 1.0880
  Epoch 2 [Batch 4/11]: Loss: 1.0673
  Epoch 2 [Batch 5/11]: Loss: 1.0593
  Epoch 2 [Batch 6/11]: Loss: 1.0647
  Epoch 2 [Batch 7/11]: Loss: 0.9941
  Epoch 2 [Batch 8/11]: Loss: 1.0109
  Epoch 2 [Batch 9/11]: Loss: 1.0353
  Epoch 2 [Batch 10/11]: Loss: 1.0035
  Epoch 2 Train Summary: Avg Loss: 1.0507, Accuracy: 0.3259
  Validation Summary: Avg Loss: 1.0900, Accuracy: 0.2000, F1 (Macro): 0.1538

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 1.0286
  Epoch 3 [Batch 1/11]: Loss: 1.0259
  Epoch 3 [Batch 2/11]: Loss: 1.0184
  Epoch 3 [Batch 3/11]: Loss: 0.9892
  Epoch 3 [Batch 4/11]: Loss: 1.0569
  Epoch 3 [Batch 5/11]: Loss: 1.1187
  Epoch 3 [Batch 6/11]: Loss: 0.9616
  Epoch 3 [Batch 7/11]: Loss: 0.9942
  Epoch 3 [Batch 8/11]: Loss: 1.0289
  Epoch 3 [Batch 9/11]: Loss: 1.0625
  Epoch 3 [Batch 10/11]: Loss: 1.0984
  Epoch 3 Train Summary: Avg Loss: 1.0349, Accuracy: 0.3259
  Validation Summary: Avg Loss: 1.0893, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 0.9602
  Epoch 4 [Batch 1/11]: Loss: 1.0944
  Epoch 4 [Batch 2/11]: Loss: 1.1376
  Epoch 4 [Batch 3/11]: Loss: 0.9808
  Epoch 4 [Batch 4/11]: Loss: 0.9903
  Epoch 4 [Batch 5/11]: Loss: 1.0251
  Epoch 4 [Batch 6/11]: Loss: 0.8924
  Epoch 4 [Batch 7/11]: Loss: 1.0458
  Epoch 4 [Batch 8/11]: Loss: 0.9937
  Epoch 4 [Batch 9/11]: Loss: 0.9206
  Epoch 4 [Batch 10/11]: Loss: 1.2368
  Epoch 4 Train Summary: Avg Loss: 1.0252, Accuracy: 0.3462
  Validation Summary: Avg Loss: 1.1032, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 1.0046
  Epoch 5 [Batch 1/11]: Loss: 0.9610
  Epoch 5 [Batch 2/11]: Loss: 0.9269
  Epoch 5 [Batch 3/11]: Loss: 0.9703
  Epoch 5 [Batch 4/11]: Loss: 1.0520
  Epoch 5 [Batch 5/11]: Loss: 0.9732
  Epoch 5 [Batch 6/11]: Loss: 0.9522
  Epoch 5 [Batch 7/11]: Loss: 0.9396
  Epoch 5 [Batch 8/11]: Loss: 1.0404
  Epoch 5 [Batch 9/11]: Loss: 1.0296
  Epoch 5 [Batch 10/11]: Loss: 1.1200
  Epoch 5 Train Summary: Avg Loss: 0.9973, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1215, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 0.8919
  Epoch 6 [Batch 1/11]: Loss: 1.0378
  Epoch 6 [Batch 2/11]: Loss: 1.0487
  Epoch 6 [Batch 3/11]: Loss: 1.0907
  Epoch 6 [Batch 4/11]: Loss: 0.9041
  Epoch 6 [Batch 5/11]: Loss: 0.9891
  Epoch 6 [Batch 6/11]: Loss: 1.0810
  Epoch 6 [Batch 7/11]: Loss: 0.8203
  Epoch 6 [Batch 8/11]: Loss: 1.0651
  Epoch 6 [Batch 9/11]: Loss: 0.9428
  Epoch 6 [Batch 10/11]: Loss: 0.8148
  Epoch 6 Train Summary: Avg Loss: 0.9715, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0949, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.9651
  Epoch 7 [Batch 1/11]: Loss: 0.9275
  Epoch 7 [Batch 2/11]: Loss: 0.8249
  Epoch 7 [Batch 3/11]: Loss: 1.0153
  Epoch 7 [Batch 4/11]: Loss: 1.0345
  Epoch 7 [Batch 5/11]: Loss: 1.0541
  Epoch 7 [Batch 6/11]: Loss: 0.8975
  Epoch 7 [Batch 7/11]: Loss: 0.9928
  Epoch 7 [Batch 8/11]: Loss: 1.0033
  Epoch 7 [Batch 9/11]: Loss: 0.9791
  Epoch 7 [Batch 10/11]: Loss: 1.0556
  Epoch 7 Train Summary: Avg Loss: 0.9772, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0828, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 1.1226
  Epoch 8 [Batch 1/11]: Loss: 1.0797
  Epoch 8 [Batch 2/11]: Loss: 0.8930
  Epoch 8 [Batch 3/11]: Loss: 0.9368
  Epoch 8 [Batch 4/11]: Loss: 0.8623
  Epoch 8 [Batch 5/11]: Loss: 1.0662
  Epoch 8 [Batch 6/11]: Loss: 0.9810
  Epoch 8 [Batch 7/11]: Loss: 0.9858
  Epoch 8 [Batch 8/11]: Loss: 0.7960
  Epoch 8 [Batch 9/11]: Loss: 0.9698
  Epoch 8 [Batch 10/11]: Loss: 0.8155
  Epoch 8 Train Summary: Avg Loss: 0.9553, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0841, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 1.0417
  Epoch 9 [Batch 1/11]: Loss: 0.9733
  Epoch 9 [Batch 2/11]: Loss: 0.9079
  Epoch 9 [Batch 3/11]: Loss: 1.0915
  Epoch 9 [Batch 4/11]: Loss: 0.9599
  Epoch 9 [Batch 5/11]: Loss: 0.9243
  Epoch 9 [Batch 6/11]: Loss: 0.9750
  Epoch 9 [Batch 7/11]: Loss: 0.9709
  Epoch 9 [Batch 8/11]: Loss: 0.9592
  Epoch 9 [Batch 9/11]: Loss: 0.9907
  Epoch 9 [Batch 10/11]: Loss: 0.7719
  Epoch 9 Train Summary: Avg Loss: 0.9606, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1120, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 0.8561
  Epoch 10 [Batch 1/11]: Loss: 0.8594
  Epoch 10 [Batch 2/11]: Loss: 0.9943
  Epoch 10 [Batch 3/11]: Loss: 1.0300
  Epoch 10 [Batch 4/11]: Loss: 1.1843
  Epoch 10 [Batch 5/11]: Loss: 0.9115
  Epoch 10 [Batch 6/11]: Loss: 0.9228
  Epoch 10 [Batch 7/11]: Loss: 0.8550
  Epoch 10 [Batch 8/11]: Loss: 1.0167
  Epoch 10 [Batch 9/11]: Loss: 1.1130
  Epoch 10 [Batch 10/11]: Loss: 0.8047
  Epoch 10 Train Summary: Avg Loss: 0.9589, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0862, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 1.0335
  Epoch 11 [Batch 1/11]: Loss: 0.9992
  Epoch 11 [Batch 2/11]: Loss: 0.9864
  Epoch 11 [Batch 3/11]: Loss: 0.9988
  Epoch 11 [Batch 4/11]: Loss: 0.8014
  Epoch 11 [Batch 5/11]: Loss: 0.9491
  Epoch 11 [Batch 6/11]: Loss: 0.8607
  Epoch 11 [Batch 7/11]: Loss: 0.9556
  Epoch 11 [Batch 8/11]: Loss: 1.1352
  Epoch 11 [Batch 9/11]: Loss: 0.9110
  Epoch 11 [Batch 10/11]: Loss: 0.7600
  Epoch 11 Train Summary: Avg Loss: 0.9446, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0942, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.9888
  Epoch 12 [Batch 1/11]: Loss: 1.1127
  Epoch 12 [Batch 2/11]: Loss: 0.7758
  Epoch 12 [Batch 3/11]: Loss: 0.9445
  Epoch 12 [Batch 4/11]: Loss: 1.1001
  Epoch 12 [Batch 5/11]: Loss: 0.8944
  Epoch 12 [Batch 6/11]: Loss: 1.0067
  Epoch 12 [Batch 7/11]: Loss: 0.9484
  Epoch 12 [Batch 8/11]: Loss: 1.0162
  Epoch 12 [Batch 9/11]: Loss: 0.8549
  Epoch 12 [Batch 10/11]: Loss: 1.2165
  Epoch 12 Train Summary: Avg Loss: 0.9872, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1051, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 0.9178
  Epoch 13 [Batch 1/11]: Loss: 0.9536
  Epoch 13 [Batch 2/11]: Loss: 0.8974
  Epoch 13 [Batch 3/11]: Loss: 0.9811
  Epoch 13 [Batch 4/11]: Loss: 1.0136
  Epoch 13 [Batch 5/11]: Loss: 1.0074
  Epoch 13 [Batch 6/11]: Loss: 1.0319
  Epoch 13 [Batch 7/11]: Loss: 0.9303
  Epoch 13 [Batch 8/11]: Loss: 0.9753
  Epoch 13 [Batch 9/11]: Loss: 0.9045
  Epoch 13 [Batch 10/11]: Loss: 0.9482
  Epoch 13 Train Summary: Avg Loss: 0.9601, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1151, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.8613
  Epoch 14 [Batch 1/11]: Loss: 1.1129
  Epoch 14 [Batch 2/11]: Loss: 0.8340
  Epoch 14 [Batch 3/11]: Loss: 0.7955
  Epoch 14 [Batch 4/11]: Loss: 0.8954
  Epoch 14 [Batch 5/11]: Loss: 0.9626
  Epoch 14 [Batch 6/11]: Loss: 1.0121
  Epoch 14 [Batch 7/11]: Loss: 1.0691
  Epoch 14 [Batch 8/11]: Loss: 0.9709
  Epoch 14 [Batch 9/11]: Loss: 0.9839
  Epoch 14 [Batch 10/11]: Loss: 1.4179
  Epoch 14 Train Summary: Avg Loss: 0.9923, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1170, Accuracy: 0.3333, F1 (Macro): 0.2222
Training finished in 0.82 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.0790, Accuracy: 0.3500, F1 (Macro): 0.3377
Final Best Model Stats: Acc: 0.3500, F1: 0.3377, Loss: 1.0790
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=5e-05 drop=0.0 seed=123
================================================================================
Starting experiment: resnet50__224x224__lr-5e-05__drop-0.0__seed-123
Output directory: results_ceph/resnet50__224x224__lr-5e-05__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.1092
  Epoch 0 [Batch 1/11]: Loss: 1.0855
  Epoch 0 [Batch 2/11]: Loss: 1.1010
  Epoch 0 [Batch 3/11]: Loss: 1.1017
  Epoch 0 [Batch 4/11]: Loss: 1.0927
  Epoch 0 [Batch 5/11]: Loss: 1.0822
  Epoch 0 [Batch 6/11]: Loss: 1.0737
  Epoch 0 [Batch 7/11]: Loss: 1.0770
  Epoch 0 [Batch 8/11]: Loss: 1.0877
  Epoch 0 [Batch 9/11]: Loss: 1.1273
  Epoch 0 [Batch 10/11]: Loss: 1.0632
  Epoch 0 Train Summary: Avg Loss: 1.0910, Accuracy: 0.3467
  Validation Summary: Avg Loss: 1.0796, Accuracy: 0.3333, F1 (Macro): 0.1905
  New best model! Val loss improved from inf to 1.0796. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.0638
  Epoch 1 [Batch 1/11]: Loss: 1.0997
  Epoch 1 [Batch 2/11]: Loss: 1.0575
  Epoch 1 [Batch 3/11]: Loss: 1.0652
  Epoch 1 [Batch 4/11]: Loss: 1.0564
  Epoch 1 [Batch 5/11]: Loss: 1.0294
  Epoch 1 [Batch 6/11]: Loss: 1.0469
  Epoch 1 [Batch 7/11]: Loss: 1.0539
  Epoch 1 [Batch 8/11]: Loss: 1.0522
  Epoch 1 [Batch 9/11]: Loss: 1.0915
  Epoch 1 [Batch 10/11]: Loss: 1.1448
  Epoch 1 Train Summary: Avg Loss: 1.0692, Accuracy: 0.3726
  Validation Summary: Avg Loss: 1.0919, Accuracy: 0.3667, F1 (Macro): 0.3481

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 1.0496
  Epoch 2 [Batch 1/11]: Loss: 1.0927
  Epoch 2 [Batch 2/11]: Loss: 1.0107
  Epoch 2 [Batch 3/11]: Loss: 1.0929
  Epoch 2 [Batch 4/11]: Loss: 1.0743
  Epoch 2 [Batch 5/11]: Loss: 1.0008
  Epoch 2 [Batch 6/11]: Loss: 1.0435
  Epoch 2 [Batch 7/11]: Loss: 1.0637
  Epoch 2 [Batch 8/11]: Loss: 1.0280
  Epoch 2 [Batch 9/11]: Loss: 1.0197
  Epoch 2 [Batch 10/11]: Loss: 0.9995
  Epoch 2 Train Summary: Avg Loss: 1.0432, Accuracy: 0.3442
  Validation Summary: Avg Loss: 1.0858, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 1.0265
  Epoch 3 [Batch 1/11]: Loss: 1.0512
  Epoch 3 [Batch 2/11]: Loss: 1.1245
  Epoch 3 [Batch 3/11]: Loss: 1.0246
  Epoch 3 [Batch 4/11]: Loss: 1.0204
  Epoch 3 [Batch 5/11]: Loss: 0.9510
  Epoch 3 [Batch 6/11]: Loss: 0.9995
  Epoch 3 [Batch 7/11]: Loss: 1.0710
  Epoch 3 [Batch 8/11]: Loss: 1.0381
  Epoch 3 [Batch 9/11]: Loss: 1.0205
  Epoch 3 [Batch 10/11]: Loss: 0.9776
  Epoch 3 Train Summary: Avg Loss: 1.0277, Accuracy: 0.3259
  Validation Summary: Avg Loss: 1.0879, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 1.0866
  Epoch 4 [Batch 1/11]: Loss: 1.0594
  Epoch 4 [Batch 2/11]: Loss: 1.0134
  Epoch 4 [Batch 3/11]: Loss: 0.9734
  Epoch 4 [Batch 4/11]: Loss: 1.0120
  Epoch 4 [Batch 5/11]: Loss: 1.0220
  Epoch 4 [Batch 6/11]: Loss: 0.9769
  Epoch 4 [Batch 7/11]: Loss: 0.9949
  Epoch 4 [Batch 8/11]: Loss: 1.0636
  Epoch 4 [Batch 9/11]: Loss: 0.9929
  Epoch 4 [Batch 10/11]: Loss: 0.8844
  Epoch 4 Train Summary: Avg Loss: 1.0072, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0955, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 1.0873
  Epoch 5 [Batch 1/11]: Loss: 0.9816
  Epoch 5 [Batch 2/11]: Loss: 1.1155
  Epoch 5 [Batch 3/11]: Loss: 0.9962
  Epoch 5 [Batch 4/11]: Loss: 1.0783
  Epoch 5 [Batch 5/11]: Loss: 0.9567
  Epoch 5 [Batch 6/11]: Loss: 1.0357
  Epoch 5 [Batch 7/11]: Loss: 0.9156
  Epoch 5 [Batch 8/11]: Loss: 1.0307
  Epoch 5 [Batch 9/11]: Loss: 0.9506
  Epoch 5 [Batch 10/11]: Loss: 1.0305
  Epoch 5 Train Summary: Avg Loss: 1.0162, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1291, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 1.0363
  Epoch 6 [Batch 1/11]: Loss: 0.9595
  Epoch 6 [Batch 2/11]: Loss: 0.9190
  Epoch 6 [Batch 3/11]: Loss: 1.0699
  Epoch 6 [Batch 4/11]: Loss: 1.0248
  Epoch 6 [Batch 5/11]: Loss: 1.0046
  Epoch 6 [Batch 6/11]: Loss: 0.8926
  Epoch 6 [Batch 7/11]: Loss: 0.9125
  Epoch 6 [Batch 8/11]: Loss: 1.1078
  Epoch 6 [Batch 9/11]: Loss: 1.0861
  Epoch 6 [Batch 10/11]: Loss: 0.8245
  Epoch 6 Train Summary: Avg Loss: 0.9852, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1006, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.8238
  Epoch 7 [Batch 1/11]: Loss: 1.0058
  Epoch 7 [Batch 2/11]: Loss: 0.9604
  Epoch 7 [Batch 3/11]: Loss: 1.0510
  Epoch 7 [Batch 4/11]: Loss: 0.9685
  Epoch 7 [Batch 5/11]: Loss: 0.9980
  Epoch 7 [Batch 6/11]: Loss: 1.0578
  Epoch 7 [Batch 7/11]: Loss: 1.1245
  Epoch 7 [Batch 8/11]: Loss: 0.9693
  Epoch 7 [Batch 9/11]: Loss: 0.9320
  Epoch 7 [Batch 10/11]: Loss: 0.8100
  Epoch 7 Train Summary: Avg Loss: 0.9728, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1212, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 0.8661
  Epoch 8 [Batch 1/11]: Loss: 0.9575
  Epoch 8 [Batch 2/11]: Loss: 0.9800
  Epoch 8 [Batch 3/11]: Loss: 0.8858
  Epoch 8 [Batch 4/11]: Loss: 1.1755
  Epoch 8 [Batch 5/11]: Loss: 0.9505
  Epoch 8 [Batch 6/11]: Loss: 1.1242
  Epoch 8 [Batch 7/11]: Loss: 0.9168
  Epoch 8 [Batch 8/11]: Loss: 0.9369
  Epoch 8 [Batch 9/11]: Loss: 0.9862
  Epoch 8 [Batch 10/11]: Loss: 0.9958
  Epoch 8 Train Summary: Avg Loss: 0.9796, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1220, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 0.8643
  Epoch 9 [Batch 1/11]: Loss: 1.0481
  Epoch 9 [Batch 2/11]: Loss: 1.1116
  Epoch 9 [Batch 3/11]: Loss: 0.8875
  Epoch 9 [Batch 4/11]: Loss: 0.9428
  Epoch 9 [Batch 5/11]: Loss: 1.0743
  Epoch 9 [Batch 6/11]: Loss: 0.9432
  Epoch 9 [Batch 7/11]: Loss: 1.0752
  Epoch 9 [Batch 8/11]: Loss: 0.9359
  Epoch 9 [Batch 9/11]: Loss: 0.9819
  Epoch 9 [Batch 10/11]: Loss: 0.8044
  Epoch 9 Train Summary: Avg Loss: 0.9699, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1122, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 1.0604
  Epoch 10 [Batch 1/11]: Loss: 0.8009
  Epoch 10 [Batch 2/11]: Loss: 0.9897
  Epoch 10 [Batch 3/11]: Loss: 1.0162
  Epoch 10 [Batch 4/11]: Loss: 1.0058
  Epoch 10 [Batch 5/11]: Loss: 0.8130
  Epoch 10 [Batch 6/11]: Loss: 1.1707
  Epoch 10 [Batch 7/11]: Loss: 1.0805
  Epoch 10 [Batch 8/11]: Loss: 0.8337
  Epoch 10 [Batch 9/11]: Loss: 0.9752
  Epoch 10 [Batch 10/11]: Loss: 1.2015
  Epoch 10 Train Summary: Avg Loss: 0.9952, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1124, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 0.9484
  Epoch 11 [Batch 1/11]: Loss: 0.8710
  Epoch 11 [Batch 2/11]: Loss: 1.0224
  Epoch 11 [Batch 3/11]: Loss: 0.9144
  Epoch 11 [Batch 4/11]: Loss: 1.0496
  Epoch 11 [Batch 5/11]: Loss: 1.2798
  Epoch 11 [Batch 6/11]: Loss: 0.8567
  Epoch 11 [Batch 7/11]: Loss: 0.8785
  Epoch 11 [Batch 8/11]: Loss: 0.9532
  Epoch 11 [Batch 9/11]: Loss: 0.9505
  Epoch 11 [Batch 10/11]: Loss: 1.2098
  Epoch 11 Train Summary: Avg Loss: 0.9940, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1115, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 1.0118
  Epoch 12 [Batch 1/11]: Loss: 1.0182
  Epoch 12 [Batch 2/11]: Loss: 0.9644
  Epoch 12 [Batch 3/11]: Loss: 0.9326
  Epoch 12 [Batch 4/11]: Loss: 0.9450
  Epoch 12 [Batch 5/11]: Loss: 0.9651
  Epoch 12 [Batch 6/11]: Loss: 0.8911
  Epoch 12 [Batch 7/11]: Loss: 0.9102
  Epoch 12 [Batch 8/11]: Loss: 0.9515
  Epoch 12 [Batch 9/11]: Loss: 1.1581
  Epoch 12 [Batch 10/11]: Loss: 1.0933
  Epoch 12 Train Summary: Avg Loss: 0.9856, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1044, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 1.0358
  Epoch 13 [Batch 1/11]: Loss: 0.8870
  Epoch 13 [Batch 2/11]: Loss: 1.0117
  Epoch 13 [Batch 3/11]: Loss: 1.0102
  Epoch 13 [Batch 4/11]: Loss: 0.9445
  Epoch 13 [Batch 5/11]: Loss: 1.1214
  Epoch 13 [Batch 6/11]: Loss: 0.8934
  Epoch 13 [Batch 7/11]: Loss: 1.0881
  Epoch 13 [Batch 8/11]: Loss: 1.0033
  Epoch 13 [Batch 9/11]: Loss: 0.8736
  Epoch 13 [Batch 10/11]: Loss: 0.8314
  Epoch 13 Train Summary: Avg Loss: 0.9727, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1213, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.9452
  Epoch 14 [Batch 1/11]: Loss: 1.0009
  Epoch 14 [Batch 2/11]: Loss: 0.8327
  Epoch 14 [Batch 3/11]: Loss: 1.0575
  Epoch 14 [Batch 4/11]: Loss: 1.0021
  Epoch 14 [Batch 5/11]: Loss: 0.9673
  Epoch 14 [Batch 6/11]: Loss: 0.9436
  Epoch 14 [Batch 7/11]: Loss: 0.9748
  Epoch 14 [Batch 8/11]: Loss: 1.1175
  Epoch 14 [Batch 9/11]: Loss: 0.9611
  Epoch 14 [Batch 10/11]: Loss: 1.3170
  Epoch 14 Train Summary: Avg Loss: 1.0109, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1240, Accuracy: 0.3333, F1 (Macro): 0.2222
Training finished in 0.80 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.0796, Accuracy: 0.3333, F1 (Macro): 0.1905
Final Best Model Stats: Acc: 0.3333, F1: 0.1905, Loss: 1.0796
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=5e-05 drop=0.0 seed=999
================================================================================
Starting experiment: resnet50__224x224__lr-5e-05__drop-0.0__seed-999
Output directory: results_ceph/resnet50__224x224__lr-5e-05__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.1428
  Epoch 0 [Batch 1/11]: Loss: 1.1182
  Epoch 0 [Batch 2/11]: Loss: 1.1375
  Epoch 0 [Batch 3/11]: Loss: 1.1257
  Epoch 0 [Batch 4/11]: Loss: 1.1316
  Epoch 0 [Batch 5/11]: Loss: 1.0810
  Epoch 0 [Batch 6/11]: Loss: 1.1111
  Epoch 0 [Batch 7/11]: Loss: 1.1184
  Epoch 0 [Batch 8/11]: Loss: 1.1173
  Epoch 0 [Batch 9/11]: Loss: 1.1262
  Epoch 0 [Batch 10/11]: Loss: 1.0765
  Epoch 0 Train Summary: Avg Loss: 1.1169, Accuracy: 0.3594
  Validation Summary: Avg Loss: 1.0881, Accuracy: 0.1667, F1 (Macro): 0.1905
  New best model! Val loss improved from inf to 1.0881. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.0812
  Epoch 1 [Batch 1/11]: Loss: 1.1025
  Epoch 1 [Batch 2/11]: Loss: 1.1174
  Epoch 1 [Batch 3/11]: Loss: 1.1006
  Epoch 1 [Batch 4/11]: Loss: 1.1373
  Epoch 1 [Batch 5/11]: Loss: 1.0984
  Epoch 1 [Batch 6/11]: Loss: 1.0900
  Epoch 1 [Batch 7/11]: Loss: 1.0997
  Epoch 1 [Batch 8/11]: Loss: 1.0726
  Epoch 1 [Batch 9/11]: Loss: 1.0802
  Epoch 1 [Batch 10/11]: Loss: 1.0741
  Epoch 1 Train Summary: Avg Loss: 1.0958, Accuracy: 0.3068
  Validation Summary: Avg Loss: 1.0975, Accuracy: 0.2500, F1 (Macro): 0.2000

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 1.0781
  Epoch 2 [Batch 1/11]: Loss: 1.0563
  Epoch 2 [Batch 2/11]: Loss: 1.0652
  Epoch 2 [Batch 3/11]: Loss: 1.0620
  Epoch 2 [Batch 4/11]: Loss: 1.0757
  Epoch 2 [Batch 5/11]: Loss: 1.0701
  Epoch 2 [Batch 6/11]: Loss: 1.0802
  Epoch 2 [Batch 7/11]: Loss: 1.0847
  Epoch 2 [Batch 8/11]: Loss: 1.0716
  Epoch 2 [Batch 9/11]: Loss: 1.0603
  Epoch 2 [Batch 10/11]: Loss: 1.0901
  Epoch 2 Train Summary: Avg Loss: 1.0722, Accuracy: 0.3593
  Validation Summary: Avg Loss: 1.0956, Accuracy: 0.3000, F1 (Macro): 0.2963

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 1.0802
  Epoch 3 [Batch 1/11]: Loss: 1.0461
  Epoch 3 [Batch 2/11]: Loss: 1.0328
  Epoch 3 [Batch 3/11]: Loss: 1.0331
  Epoch 3 [Batch 4/11]: Loss: 1.0614
  Epoch 3 [Batch 5/11]: Loss: 1.0949
  Epoch 3 [Batch 6/11]: Loss: 1.0157
  Epoch 3 [Batch 7/11]: Loss: 1.0443
  Epoch 3 [Batch 8/11]: Loss: 1.0853
  Epoch 3 [Batch 9/11]: Loss: 0.9954
  Epoch 3 [Batch 10/11]: Loss: 1.0391
  Epoch 3 Train Summary: Avg Loss: 1.0480, Accuracy: 0.3313
  Validation Summary: Avg Loss: 1.0971, Accuracy: 0.3500, F1 (Macro): 0.3162

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 1.0391
  Epoch 4 [Batch 1/11]: Loss: 1.0147
  Epoch 4 [Batch 2/11]: Loss: 1.0299
  Epoch 4 [Batch 3/11]: Loss: 1.0584
  Epoch 4 [Batch 4/11]: Loss: 1.0087
  Epoch 4 [Batch 5/11]: Loss: 1.0053
  Epoch 4 [Batch 6/11]: Loss: 1.0702
  Epoch 4 [Batch 7/11]: Loss: 1.0512
  Epoch 4 [Batch 8/11]: Loss: 0.9897
  Epoch 4 [Batch 9/11]: Loss: 1.0825
  Epoch 4 [Batch 10/11]: Loss: 0.9120
  Epoch 4 Train Summary: Avg Loss: 1.0238, Accuracy: 0.3516
  Validation Summary: Avg Loss: 1.1073, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 0.9880
  Epoch 5 [Batch 1/11]: Loss: 1.0432
  Epoch 5 [Batch 2/11]: Loss: 1.0181
  Epoch 5 [Batch 3/11]: Loss: 1.0106
  Epoch 5 [Batch 4/11]: Loss: 0.9953
  Epoch 5 [Batch 5/11]: Loss: 1.1218
  Epoch 5 [Batch 6/11]: Loss: 0.9517
  Epoch 5 [Batch 7/11]: Loss: 1.0354
  Epoch 5 [Batch 8/11]: Loss: 0.9815
  Epoch 5 [Batch 9/11]: Loss: 1.0291
  Epoch 5 [Batch 10/11]: Loss: 0.8973
  Epoch 5 Train Summary: Avg Loss: 1.0066, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1575, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 1.1027
  Epoch 6 [Batch 1/11]: Loss: 0.9836
  Epoch 6 [Batch 2/11]: Loss: 0.9672
  Epoch 6 [Batch 3/11]: Loss: 0.9250
  Epoch 6 [Batch 4/11]: Loss: 0.9951
  Epoch 6 [Batch 5/11]: Loss: 1.0466
  Epoch 6 [Batch 6/11]: Loss: 1.0666
  Epoch 6 [Batch 7/11]: Loss: 0.9919
  Epoch 6 [Batch 8/11]: Loss: 1.0403
  Epoch 6 [Batch 9/11]: Loss: 0.8752
  Epoch 6 [Batch 10/11]: Loss: 0.9386
  Epoch 6 Train Summary: Avg Loss: 0.9939, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1591, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.9161
  Epoch 7 [Batch 1/11]: Loss: 0.9960
  Epoch 7 [Batch 2/11]: Loss: 1.1985
  Epoch 7 [Batch 3/11]: Loss: 0.9144
  Epoch 7 [Batch 4/11]: Loss: 0.9224
  Epoch 7 [Batch 5/11]: Loss: 0.9780
  Epoch 7 [Batch 6/11]: Loss: 1.1236
  Epoch 7 [Batch 7/11]: Loss: 1.0185
  Epoch 7 [Batch 8/11]: Loss: 0.8635
  Epoch 7 [Batch 9/11]: Loss: 1.0078
  Epoch 7 [Batch 10/11]: Loss: 0.8564
  Epoch 7 Train Summary: Avg Loss: 0.9814, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1361, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 1.0865
  Epoch 8 [Batch 1/11]: Loss: 0.8660
  Epoch 8 [Batch 2/11]: Loss: 1.0542
  Epoch 8 [Batch 3/11]: Loss: 0.9686
  Epoch 8 [Batch 4/11]: Loss: 1.0079
  Epoch 8 [Batch 5/11]: Loss: 1.1238
  Epoch 8 [Batch 6/11]: Loss: 0.8761
  Epoch 8 [Batch 7/11]: Loss: 0.9872
  Epoch 8 [Batch 8/11]: Loss: 0.9712
  Epoch 8 [Batch 9/11]: Loss: 0.9482
  Epoch 8 [Batch 10/11]: Loss: 0.8218
  Epoch 8 Train Summary: Avg Loss: 0.9738, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1329, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 0.9723
  Epoch 9 [Batch 1/11]: Loss: 0.8531
  Epoch 9 [Batch 2/11]: Loss: 0.9698
  Epoch 9 [Batch 3/11]: Loss: 0.9858
  Epoch 9 [Batch 4/11]: Loss: 0.9861
  Epoch 9 [Batch 5/11]: Loss: 1.0616
  Epoch 9 [Batch 6/11]: Loss: 0.8893
  Epoch 9 [Batch 7/11]: Loss: 1.1164
  Epoch 9 [Batch 8/11]: Loss: 0.9253
  Epoch 9 [Batch 9/11]: Loss: 1.0180
  Epoch 9 [Batch 10/11]: Loss: 1.2666
  Epoch 9 Train Summary: Avg Loss: 1.0040, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1183, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 0.9510
  Epoch 10 [Batch 1/11]: Loss: 1.0382
  Epoch 10 [Batch 2/11]: Loss: 1.0886
  Epoch 10 [Batch 3/11]: Loss: 1.0644
  Epoch 10 [Batch 4/11]: Loss: 0.9859
  Epoch 10 [Batch 5/11]: Loss: 0.9441
  Epoch 10 [Batch 6/11]: Loss: 1.0212
  Epoch 10 [Batch 7/11]: Loss: 0.9323
  Epoch 10 [Batch 8/11]: Loss: 0.9595
  Epoch 10 [Batch 9/11]: Loss: 0.8683
  Epoch 10 [Batch 10/11]: Loss: 1.0463
  Epoch 10 Train Summary: Avg Loss: 0.9909, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1080, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 0.8922
  Epoch 11 [Batch 1/11]: Loss: 0.9180
  Epoch 11 [Batch 2/11]: Loss: 0.9600
  Epoch 11 [Batch 3/11]: Loss: 0.8690
  Epoch 11 [Batch 4/11]: Loss: 0.9702
  Epoch 11 [Batch 5/11]: Loss: 1.1408
  Epoch 11 [Batch 6/11]: Loss: 0.9688
  Epoch 11 [Batch 7/11]: Loss: 1.1370
  Epoch 11 [Batch 8/11]: Loss: 0.9884
  Epoch 11 [Batch 9/11]: Loss: 0.9627
  Epoch 11 [Batch 10/11]: Loss: 1.1080
  Epoch 11 Train Summary: Avg Loss: 0.9923, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1003, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.9566
  Epoch 12 [Batch 1/11]: Loss: 1.2060
  Epoch 12 [Batch 2/11]: Loss: 0.9245
  Epoch 12 [Batch 3/11]: Loss: 0.9731
  Epoch 12 [Batch 4/11]: Loss: 0.9644
  Epoch 12 [Batch 5/11]: Loss: 0.9255
  Epoch 12 [Batch 6/11]: Loss: 0.8740
  Epoch 12 [Batch 7/11]: Loss: 1.0194
  Epoch 12 [Batch 8/11]: Loss: 0.9901
  Epoch 12 [Batch 9/11]: Loss: 0.9662
  Epoch 12 [Batch 10/11]: Loss: 0.9620
  Epoch 12 Train Summary: Avg Loss: 0.9783, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1122, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 1.0191
  Epoch 13 [Batch 1/11]: Loss: 1.0502
  Epoch 13 [Batch 2/11]: Loss: 0.9449
  Epoch 13 [Batch 3/11]: Loss: 1.0281
  Epoch 13 [Batch 4/11]: Loss: 1.0559
  Epoch 13 [Batch 5/11]: Loss: 0.8974
  Epoch 13 [Batch 6/11]: Loss: 0.9552
  Epoch 13 [Batch 7/11]: Loss: 0.9797
  Epoch 13 [Batch 8/11]: Loss: 0.8348
  Epoch 13 [Batch 9/11]: Loss: 1.0673
  Epoch 13 [Batch 10/11]: Loss: 0.8026
  Epoch 13 Train Summary: Avg Loss: 0.9668, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1232, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.8407
  Epoch 14 [Batch 1/11]: Loss: 0.9090
  Epoch 14 [Batch 2/11]: Loss: 1.0224
  Epoch 14 [Batch 3/11]: Loss: 0.8825
  Epoch 14 [Batch 4/11]: Loss: 1.0608
  Epoch 14 [Batch 5/11]: Loss: 1.0920
  Epoch 14 [Batch 6/11]: Loss: 0.9472
  Epoch 14 [Batch 7/11]: Loss: 0.9558
  Epoch 14 [Batch 8/11]: Loss: 1.0557
  Epoch 14 [Batch 9/11]: Loss: 1.1102
  Epoch 14 [Batch 10/11]: Loss: 0.9329
  Epoch 14 Train Summary: Avg Loss: 0.9827, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1095, Accuracy: 0.3333, F1 (Macro): 0.2222
Training finished in 0.80 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.0881, Accuracy: 0.1667, F1 (Macro): 0.1905
Final Best Model Stats: Acc: 0.1667, F1: 0.1905, Loss: 1.0881
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=1e-05 drop=0.0 seed=42
================================================================================
Starting experiment: resnet50__224x224__lr-1e-05__drop-0.0__seed-42
Output directory: results_ceph/resnet50__224x224__lr-1e-05__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.1220
  Epoch 0 [Batch 1/11]: Loss: 1.1100
  Epoch 0 [Batch 2/11]: Loss: 1.0995
  Epoch 0 [Batch 3/11]: Loss: 1.1091
  Epoch 0 [Batch 4/11]: Loss: 1.1428
  Epoch 0 [Batch 5/11]: Loss: 1.1125
  Epoch 0 [Batch 6/11]: Loss: 1.1369
  Epoch 0 [Batch 7/11]: Loss: 1.1304
  Epoch 0 [Batch 8/11]: Loss: 1.1259
  Epoch 0 [Batch 9/11]: Loss: 1.1497
  Epoch 0 [Batch 10/11]: Loss: 1.1371
  Epoch 0 Train Summary: Avg Loss: 1.1251, Accuracy: 0.3489
  Validation Summary: Avg Loss: 1.0887, Accuracy: 0.1667, F1 (Macro): 0.1481
  New best model! Val loss improved from inf to 1.0887. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.1437
  Epoch 1 [Batch 1/11]: Loss: 1.1036
  Epoch 1 [Batch 2/11]: Loss: 1.1030
  Epoch 1 [Batch 3/11]: Loss: 1.1092
  Epoch 1 [Batch 4/11]: Loss: 1.1009
  Epoch 1 [Batch 5/11]: Loss: 1.0951
  Epoch 1 [Batch 6/11]: Loss: 1.1191
  Epoch 1 [Batch 7/11]: Loss: 1.1181
  Epoch 1 [Batch 8/11]: Loss: 1.1098
  Epoch 1 [Batch 9/11]: Loss: 1.1258
  Epoch 1 [Batch 10/11]: Loss: 1.1262
  Epoch 1 Train Summary: Avg Loss: 1.1140, Accuracy: 0.2674
  Validation Summary: Avg Loss: 1.0967, Accuracy: 0.1500, F1 (Macro): 0.1481

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 1.1350
  Epoch 2 [Batch 1/11]: Loss: 1.1232
  Epoch 2 [Batch 2/11]: Loss: 1.1143
  Epoch 2 [Batch 3/11]: Loss: 1.1274
  Epoch 2 [Batch 4/11]: Loss: 1.1062
  Epoch 2 [Batch 5/11]: Loss: 1.0912
  Epoch 2 [Batch 6/11]: Loss: 1.1143
  Epoch 2 [Batch 7/11]: Loss: 1.1087
  Epoch 2 [Batch 8/11]: Loss: 1.1086
  Epoch 2 [Batch 9/11]: Loss: 1.1242
  Epoch 2 [Batch 10/11]: Loss: 1.1272
  Epoch 2 Train Summary: Avg Loss: 1.1164, Accuracy: 0.3476
  Validation Summary: Avg Loss: 1.0909, Accuracy: 0.3167, F1 (Macro): 0.3056

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 1.1093
  Epoch 3 [Batch 1/11]: Loss: 1.1017
  Epoch 3 [Batch 2/11]: Loss: 1.0930
  Epoch 3 [Batch 3/11]: Loss: 1.1208
  Epoch 3 [Batch 4/11]: Loss: 1.1157
  Epoch 3 [Batch 5/11]: Loss: 1.1165
  Epoch 3 [Batch 6/11]: Loss: 1.0917
  Epoch 3 [Batch 7/11]: Loss: 1.0970
  Epoch 3 [Batch 8/11]: Loss: 1.1002
  Epoch 3 [Batch 9/11]: Loss: 1.1103
  Epoch 3 [Batch 10/11]: Loss: 1.0975
  Epoch 3 Train Summary: Avg Loss: 1.1049, Accuracy: 0.3180
  Validation Summary: Avg Loss: 1.0889, Accuracy: 0.2167, F1 (Macro): 0.2045

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 1.0833
  Epoch 4 [Batch 1/11]: Loss: 1.1124
  Epoch 4 [Batch 2/11]: Loss: 1.1129
  Epoch 4 [Batch 3/11]: Loss: 1.1146
  Epoch 4 [Batch 4/11]: Loss: 1.0982
  Epoch 4 [Batch 5/11]: Loss: 1.0975
  Epoch 4 [Batch 6/11]: Loss: 1.0916
  Epoch 4 [Batch 7/11]: Loss: 1.0879
  Epoch 4 [Batch 8/11]: Loss: 1.1077
  Epoch 4 [Batch 9/11]: Loss: 1.1084
  Epoch 4 [Batch 10/11]: Loss: 1.0788
  Epoch 4 Train Summary: Avg Loss: 1.0994, Accuracy: 0.3624
  Validation Summary: Avg Loss: 1.0803, Accuracy: 0.4333, F1 (Macro): 0.4127
  New best model! Val loss improved from 1.0887 to 1.0803. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 1.0935
  Epoch 5 [Batch 1/11]: Loss: 1.0896
  Epoch 5 [Batch 2/11]: Loss: 1.0889
  Epoch 5 [Batch 3/11]: Loss: 1.1083
  Epoch 5 [Batch 4/11]: Loss: 1.1025
  Epoch 5 [Batch 5/11]: Loss: 1.1106
  Epoch 5 [Batch 6/11]: Loss: 1.0765
  Epoch 5 [Batch 7/11]: Loss: 1.1113
  Epoch 5 [Batch 8/11]: Loss: 1.1059
  Epoch 5 [Batch 9/11]: Loss: 1.1030
  Epoch 5 [Batch 10/11]: Loss: 1.0352
  Epoch 5 Train Summary: Avg Loss: 1.0932, Accuracy: 0.2250
  Validation Summary: Avg Loss: 1.0863, Accuracy: 0.3500, F1 (Macro): 0.3333

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 1.0783
  Epoch 6 [Batch 1/11]: Loss: 1.0819
  Epoch 6 [Batch 2/11]: Loss: 1.0965
  Epoch 6 [Batch 3/11]: Loss: 1.0965
  Epoch 6 [Batch 4/11]: Loss: 1.0816
  Epoch 6 [Batch 5/11]: Loss: 1.1050
  Epoch 6 [Batch 6/11]: Loss: 1.1135
  Epoch 6 [Batch 7/11]: Loss: 1.0842
  Epoch 6 [Batch 8/11]: Loss: 1.0965
  Epoch 6 [Batch 9/11]: Loss: 1.0945
  Epoch 6 [Batch 10/11]: Loss: 1.0664
  Epoch 6 Train Summary: Avg Loss: 1.0904, Accuracy: 0.3240
  Validation Summary: Avg Loss: 1.1117, Accuracy: 0.2000, F1 (Macro): 0.1667

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 1.0692
  Epoch 7 [Batch 1/11]: Loss: 1.0894
  Epoch 7 [Batch 2/11]: Loss: 1.0694
  Epoch 7 [Batch 3/11]: Loss: 1.0841
  Epoch 7 [Batch 4/11]: Loss: 1.0893
  Epoch 7 [Batch 5/11]: Loss: 1.1133
  Epoch 7 [Batch 6/11]: Loss: 1.0752
  Epoch 7 [Batch 7/11]: Loss: 1.0871
  Epoch 7 [Batch 8/11]: Loss: 1.0829
  Epoch 7 [Batch 9/11]: Loss: 1.0823
  Epoch 7 [Batch 10/11]: Loss: 1.0725
  Epoch 7 Train Summary: Avg Loss: 1.0831, Accuracy: 0.3004
  Validation Summary: Avg Loss: 1.0977, Accuracy: 0.2833, F1 (Macro): 0.2778

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 1.1123
  Epoch 8 [Batch 1/11]: Loss: 1.0781
  Epoch 8 [Batch 2/11]: Loss: 1.0655
  Epoch 8 [Batch 3/11]: Loss: 1.0843
  Epoch 8 [Batch 4/11]: Loss: 1.0540
  Epoch 8 [Batch 5/11]: Loss: 1.1018
  Epoch 8 [Batch 6/11]: Loss: 1.0780
  Epoch 8 [Batch 7/11]: Loss: 1.0782
  Epoch 8 [Batch 8/11]: Loss: 1.0544
  Epoch 8 [Batch 9/11]: Loss: 1.0778
  Epoch 8 [Batch 10/11]: Loss: 1.0600
  Epoch 8 Train Summary: Avg Loss: 1.0768, Accuracy: 0.3328
  Validation Summary: Avg Loss: 1.0979, Accuracy: 0.2667, F1 (Macro): 0.1905

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 1.0968
  Epoch 9 [Batch 1/11]: Loss: 1.0888
  Epoch 9 [Batch 2/11]: Loss: 1.0847
  Epoch 9 [Batch 3/11]: Loss: 1.0983
  Epoch 9 [Batch 4/11]: Loss: 1.0641
  Epoch 9 [Batch 5/11]: Loss: 1.0690
  Epoch 9 [Batch 6/11]: Loss: 1.0922
  Epoch 9 [Batch 7/11]: Loss: 1.0738
  Epoch 9 [Batch 8/11]: Loss: 1.0859
  Epoch 9 [Batch 9/11]: Loss: 1.0732
  Epoch 9 [Batch 10/11]: Loss: 1.0385
  Epoch 9 Train Summary: Avg Loss: 1.0787, Accuracy: 0.3422
  Validation Summary: Avg Loss: 1.0970, Accuracy: 0.2667, F1 (Macro): 0.1905

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 1.0488
  Epoch 10 [Batch 1/11]: Loss: 1.0658
  Epoch 10 [Batch 2/11]: Loss: 1.0789
  Epoch 10 [Batch 3/11]: Loss: 1.0909
  Epoch 10 [Batch 4/11]: Loss: 1.1093
  Epoch 10 [Batch 5/11]: Loss: 1.0609
  Epoch 10 [Batch 6/11]: Loss: 1.0651
  Epoch 10 [Batch 7/11]: Loss: 1.0581
  Epoch 10 [Batch 8/11]: Loss: 1.1017
  Epoch 10 [Batch 9/11]: Loss: 1.0936
  Epoch 10 [Batch 10/11]: Loss: 1.0306
  Epoch 10 Train Summary: Avg Loss: 1.0731, Accuracy: 0.3516
  Validation Summary: Avg Loss: 1.0996, Accuracy: 0.2667, F1 (Macro): 0.1905

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 1.0842
  Epoch 11 [Batch 1/11]: Loss: 1.0663
  Epoch 11 [Batch 2/11]: Loss: 1.0625
  Epoch 11 [Batch 3/11]: Loss: 1.0596
  Epoch 11 [Batch 4/11]: Loss: 1.0230
  Epoch 11 [Batch 5/11]: Loss: 1.0734
  Epoch 11 [Batch 6/11]: Loss: 1.0485
  Epoch 11 [Batch 7/11]: Loss: 1.0718
  Epoch 11 [Batch 8/11]: Loss: 1.0854
  Epoch 11 [Batch 9/11]: Loss: 1.0660
  Epoch 11 [Batch 10/11]: Loss: 1.0126
  Epoch 11 Train Summary: Avg Loss: 1.0594, Accuracy: 0.3488
  Validation Summary: Avg Loss: 1.0869, Accuracy: 0.2667, F1 (Macro): 0.1905

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 1.0759
  Epoch 12 [Batch 1/11]: Loss: 1.1034
  Epoch 12 [Batch 2/11]: Loss: 1.0191
  Epoch 12 [Batch 3/11]: Loss: 1.0584
  Epoch 12 [Batch 4/11]: Loss: 1.1078
  Epoch 12 [Batch 5/11]: Loss: 1.0545
  Epoch 12 [Batch 6/11]: Loss: 1.0901
  Epoch 12 [Batch 7/11]: Loss: 1.0502
  Epoch 12 [Batch 8/11]: Loss: 1.0688
  Epoch 12 [Batch 9/11]: Loss: 1.0363
  Epoch 12 [Batch 10/11]: Loss: 1.1331
  Epoch 12 Train Summary: Avg Loss: 1.0725, Accuracy: 0.3239
  Validation Summary: Avg Loss: 1.0930, Accuracy: 0.2667, F1 (Macro): 0.1905

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 1.0548
  Epoch 13 [Batch 1/11]: Loss: 1.0637
  Epoch 13 [Batch 2/11]: Loss: 1.0398
  Epoch 13 [Batch 3/11]: Loss: 1.0495
  Epoch 13 [Batch 4/11]: Loss: 1.0708
  Epoch 13 [Batch 5/11]: Loss: 1.0809
  Epoch 13 [Batch 6/11]: Loss: 1.0742
  Epoch 13 [Batch 7/11]: Loss: 1.0649
  Epoch 13 [Batch 8/11]: Loss: 1.0582
  Epoch 13 [Batch 9/11]: Loss: 1.0480
  Epoch 13 [Batch 10/11]: Loss: 1.0883
  Epoch 13 Train Summary: Avg Loss: 1.0630, Accuracy: 0.3387
  Validation Summary: Avg Loss: 1.0952, Accuracy: 0.2667, F1 (Macro): 0.1905

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 1.0502
  Epoch 14 [Batch 1/11]: Loss: 1.0981
  Epoch 14 [Batch 2/11]: Loss: 1.0274
  Epoch 14 [Batch 3/11]: Loss: 1.0199
  Epoch 14 [Batch 4/11]: Loss: 1.0438
  Epoch 14 [Batch 5/11]: Loss: 1.0693
  Epoch 14 [Batch 6/11]: Loss: 1.0775
  Epoch 14 [Batch 7/11]: Loss: 1.0836
  Epoch 14 [Batch 8/11]: Loss: 1.0753
  Epoch 14 [Batch 9/11]: Loss: 1.0884
  Epoch 14 [Batch 10/11]: Loss: 1.1487
  Epoch 14 Train Summary: Avg Loss: 1.0711, Accuracy: 0.3185
  Validation Summary: Avg Loss: 1.1039, Accuracy: 0.2667, F1 (Macro): 0.1905
Training finished in 0.88 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.0803, Accuracy: 0.4333, F1 (Macro): 0.4127
Final Best Model Stats: Acc: 0.4333, F1: 0.4127, Loss: 1.0803
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=1e-05 drop=0.0 seed=123
================================================================================
Starting experiment: resnet50__224x224__lr-1e-05__drop-0.0__seed-123
Output directory: results_ceph/resnet50__224x224__lr-1e-05__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.1092
  Epoch 0 [Batch 1/11]: Loss: 1.0871
  Epoch 0 [Batch 2/11]: Loss: 1.0989
  Epoch 0 [Batch 3/11]: Loss: 1.1076
  Epoch 0 [Batch 4/11]: Loss: 1.0721
  Epoch 0 [Batch 5/11]: Loss: 1.0795
  Epoch 0 [Batch 6/11]: Loss: 1.0965
  Epoch 0 [Batch 7/11]: Loss: 1.0993
  Epoch 0 [Batch 8/11]: Loss: 1.0948
  Epoch 0 [Batch 9/11]: Loss: 1.1139
  Epoch 0 [Batch 10/11]: Loss: 1.0605
  Epoch 0 Train Summary: Avg Loss: 1.0927, Accuracy: 0.2895
  Validation Summary: Avg Loss: 1.0863, Accuracy: 0.3333, F1 (Macro): 0.1905
  New best model! Val loss improved from inf to 1.0863. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.0773
  Epoch 1 [Batch 1/11]: Loss: 1.1178
  Epoch 1 [Batch 2/11]: Loss: 1.0929
  Epoch 1 [Batch 3/11]: Loss: 1.0832
  Epoch 1 [Batch 4/11]: Loss: 1.1014
  Epoch 1 [Batch 5/11]: Loss: 1.0492
  Epoch 1 [Batch 6/11]: Loss: 1.0856
  Epoch 1 [Batch 7/11]: Loss: 1.0593
  Epoch 1 [Batch 8/11]: Loss: 1.1080
  Epoch 1 [Batch 9/11]: Loss: 1.0936
  Epoch 1 [Batch 10/11]: Loss: 1.0958
  Epoch 1 Train Summary: Avg Loss: 1.0876, Accuracy: 0.3319
  Validation Summary: Avg Loss: 1.0883, Accuracy: 0.3333, F1 (Macro): 0.1905

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 1.0820
  Epoch 2 [Batch 1/11]: Loss: 1.1156
  Epoch 2 [Batch 2/11]: Loss: 1.0570
  Epoch 2 [Batch 3/11]: Loss: 1.1148
  Epoch 2 [Batch 4/11]: Loss: 1.0992
  Epoch 2 [Batch 5/11]: Loss: 1.0965
  Epoch 2 [Batch 6/11]: Loss: 1.0822
  Epoch 2 [Batch 7/11]: Loss: 1.0888
  Epoch 2 [Batch 8/11]: Loss: 1.0690
  Epoch 2 [Batch 9/11]: Loss: 1.0662
  Epoch 2 [Batch 10/11]: Loss: 1.0725
  Epoch 2 Train Summary: Avg Loss: 1.0858, Accuracy: 0.3635
  Validation Summary: Avg Loss: 1.0874, Accuracy: 0.2500, F1 (Macro): 0.1538

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 1.0923
  Epoch 3 [Batch 1/11]: Loss: 1.0972
  Epoch 3 [Batch 2/11]: Loss: 1.1095
  Epoch 3 [Batch 3/11]: Loss: 1.0849
  Epoch 3 [Batch 4/11]: Loss: 1.0788
  Epoch 3 [Batch 5/11]: Loss: 1.0800
  Epoch 3 [Batch 6/11]: Loss: 1.0780
  Epoch 3 [Batch 7/11]: Loss: 1.0938
  Epoch 3 [Batch 8/11]: Loss: 1.0843
  Epoch 3 [Batch 9/11]: Loss: 1.0600
  Epoch 3 [Batch 10/11]: Loss: 1.0568
  Epoch 3 Train Summary: Avg Loss: 1.0832, Accuracy: 0.3231
  Validation Summary: Avg Loss: 1.0793, Accuracy: 0.3833, F1 (Macro): 0.3485
  New best model! Val loss improved from 1.0863 to 1.0793. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 1.1053
  Epoch 4 [Batch 1/11]: Loss: 1.1011
  Epoch 4 [Batch 2/11]: Loss: 1.0980
  Epoch 4 [Batch 3/11]: Loss: 1.0722
  Epoch 4 [Batch 4/11]: Loss: 1.0884
  Epoch 4 [Batch 5/11]: Loss: 1.0588
  Epoch 4 [Batch 6/11]: Loss: 1.0873
  Epoch 4 [Batch 7/11]: Loss: 1.0582
  Epoch 4 [Batch 8/11]: Loss: 1.1078
  Epoch 4 [Batch 9/11]: Loss: 1.0745
  Epoch 4 [Batch 10/11]: Loss: 1.0687
  Epoch 4 Train Summary: Avg Loss: 1.0837, Accuracy: 0.2960
  Validation Summary: Avg Loss: 1.0796, Accuracy: 0.4667, F1 (Macro): 0.4127

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 1.0956
  Epoch 5 [Batch 1/11]: Loss: 1.0812
  Epoch 5 [Batch 2/11]: Loss: 1.1031
  Epoch 5 [Batch 3/11]: Loss: 1.0820
  Epoch 5 [Batch 4/11]: Loss: 1.0844
  Epoch 5 [Batch 5/11]: Loss: 1.0492
  Epoch 5 [Batch 6/11]: Loss: 1.0629
  Epoch 5 [Batch 7/11]: Loss: 1.0609
  Epoch 5 [Batch 8/11]: Loss: 1.0415
  Epoch 5 [Batch 9/11]: Loss: 1.0784
  Epoch 5 [Batch 10/11]: Loss: 1.0719
  Epoch 5 Train Summary: Avg Loss: 1.0737, Accuracy: 0.3464
  Validation Summary: Avg Loss: 1.0805, Accuracy: 0.3333, F1 (Macro): 0.1905

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 1.0684
  Epoch 6 [Batch 1/11]: Loss: 1.0560
  Epoch 6 [Batch 2/11]: Loss: 1.0696
  Epoch 6 [Batch 3/11]: Loss: 1.1058
  Epoch 6 [Batch 4/11]: Loss: 1.0771
  Epoch 6 [Batch 5/11]: Loss: 1.0702
  Epoch 6 [Batch 6/11]: Loss: 1.0468
  Epoch 6 [Batch 7/11]: Loss: 1.0640
  Epoch 6 [Batch 8/11]: Loss: 1.0915
  Epoch 6 [Batch 9/11]: Loss: 1.1091
  Epoch 6 [Batch 10/11]: Loss: 1.0430
  Epoch 6 Train Summary: Avg Loss: 1.0729, Accuracy: 0.2858
  Validation Summary: Avg Loss: 1.0978, Accuracy: 0.1333, F1 (Macro): 0.1212

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 1.0323
  Epoch 7 [Batch 1/11]: Loss: 1.0896
  Epoch 7 [Batch 2/11]: Loss: 1.0691
  Epoch 7 [Batch 3/11]: Loss: 1.0874
  Epoch 7 [Batch 4/11]: Loss: 1.0459
  Epoch 7 [Batch 5/11]: Loss: 1.0979
  Epoch 7 [Batch 6/11]: Loss: 1.0925
  Epoch 7 [Batch 7/11]: Loss: 1.0819
  Epoch 7 [Batch 8/11]: Loss: 1.0559
  Epoch 7 [Batch 9/11]: Loss: 1.0445
  Epoch 7 [Batch 10/11]: Loss: 1.0220
  Epoch 7 Train Summary: Avg Loss: 1.0654, Accuracy: 0.3470
  Validation Summary: Avg Loss: 1.0976, Accuracy: 0.3000, F1 (Macro): 0.2815

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 1.0273
  Epoch 8 [Batch 1/11]: Loss: 1.0666
  Epoch 8 [Batch 2/11]: Loss: 1.0512
  Epoch 8 [Batch 3/11]: Loss: 1.0385
  Epoch 8 [Batch 4/11]: Loss: 1.1187
  Epoch 8 [Batch 5/11]: Loss: 1.0348
  Epoch 8 [Batch 6/11]: Loss: 1.1116
  Epoch 8 [Batch 7/11]: Loss: 1.0505
  Epoch 8 [Batch 8/11]: Loss: 1.0611
  Epoch 8 [Batch 9/11]: Loss: 1.0480
  Epoch 8 [Batch 10/11]: Loss: 1.0436
  Epoch 8 Train Summary: Avg Loss: 1.0593, Accuracy: 0.3416
  Validation Summary: Avg Loss: 1.0942, Accuracy: 0.3500, F1 (Macro): 0.3175

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 1.0341
  Epoch 9 [Batch 1/11]: Loss: 1.0796
  Epoch 9 [Batch 2/11]: Loss: 1.0856
  Epoch 9 [Batch 3/11]: Loss: 1.0300
  Epoch 9 [Batch 4/11]: Loss: 1.0264
  Epoch 9 [Batch 5/11]: Loss: 1.0719
  Epoch 9 [Batch 6/11]: Loss: 1.0380
  Epoch 9 [Batch 7/11]: Loss: 1.0872
  Epoch 9 [Batch 8/11]: Loss: 1.0465
  Epoch 9 [Batch 9/11]: Loss: 1.0721
  Epoch 9 [Batch 10/11]: Loss: 1.0257
  Epoch 9 Train Summary: Avg Loss: 1.0543, Accuracy: 0.3766
  Validation Summary: Avg Loss: 1.0959, Accuracy: 0.2833, F1 (Macro): 0.2652

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 1.0849
  Epoch 10 [Batch 1/11]: Loss: 1.0194
  Epoch 10 [Batch 2/11]: Loss: 1.0671
  Epoch 10 [Batch 3/11]: Loss: 1.0614
  Epoch 10 [Batch 4/11]: Loss: 1.0546
  Epoch 10 [Batch 5/11]: Loss: 1.0228
  Epoch 10 [Batch 6/11]: Loss: 1.0996
  Epoch 10 [Batch 7/11]: Loss: 1.0904
  Epoch 10 [Batch 8/11]: Loss: 1.0209
  Epoch 10 [Batch 9/11]: Loss: 1.0493
  Epoch 10 [Batch 10/11]: Loss: 1.1367
  Epoch 10 Train Summary: Avg Loss: 1.0643, Accuracy: 0.3219
  Validation Summary: Avg Loss: 1.0925, Accuracy: 0.4500, F1 (Macro): 0.4222

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 1.0341
  Epoch 11 [Batch 1/11]: Loss: 1.0232
  Epoch 11 [Batch 2/11]: Loss: 1.0643
  Epoch 11 [Batch 3/11]: Loss: 1.0393
  Epoch 11 [Batch 4/11]: Loss: 1.0707
  Epoch 11 [Batch 5/11]: Loss: 1.1469
  Epoch 11 [Batch 6/11]: Loss: 1.0237
  Epoch 11 [Batch 7/11]: Loss: 1.0158
  Epoch 11 [Batch 8/11]: Loss: 1.0484
  Epoch 11 [Batch 9/11]: Loss: 1.0501
  Epoch 11 [Batch 10/11]: Loss: 1.1426
  Epoch 11 Train Summary: Avg Loss: 1.0599, Accuracy: 0.3786
  Validation Summary: Avg Loss: 1.1006, Accuracy: 0.2667, F1 (Macro): 0.2051

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 1.0690
  Epoch 12 [Batch 1/11]: Loss: 1.0426
  Epoch 12 [Batch 2/11]: Loss: 1.0413
  Epoch 12 [Batch 3/11]: Loss: 1.0255
  Epoch 12 [Batch 4/11]: Loss: 1.0229
  Epoch 12 [Batch 5/11]: Loss: 1.0630
  Epoch 12 [Batch 6/11]: Loss: 1.0366
  Epoch 12 [Batch 7/11]: Loss: 1.0433
  Epoch 12 [Batch 8/11]: Loss: 1.0528
  Epoch 12 [Batch 9/11]: Loss: 1.0942
  Epoch 12 [Batch 10/11]: Loss: 1.1423
  Epoch 12 Train Summary: Avg Loss: 1.0576, Accuracy: 0.3624
  Validation Summary: Avg Loss: 1.0957, Accuracy: 0.3500, F1 (Macro): 0.3162

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 1.0701
  Epoch 13 [Batch 1/11]: Loss: 1.0230
  Epoch 13 [Batch 2/11]: Loss: 1.0607
  Epoch 13 [Batch 3/11]: Loss: 1.0422
  Epoch 13 [Batch 4/11]: Loss: 1.0550
  Epoch 13 [Batch 5/11]: Loss: 1.1113
  Epoch 13 [Batch 6/11]: Loss: 1.0312
  Epoch 13 [Batch 7/11]: Loss: 1.0899
  Epoch 13 [Batch 8/11]: Loss: 1.0753
  Epoch 13 [Batch 9/11]: Loss: 1.0317
  Epoch 13 [Batch 10/11]: Loss: 1.0136
  Epoch 13 Train Summary: Avg Loss: 1.0549, Accuracy: 0.3091
  Validation Summary: Avg Loss: 1.0962, Accuracy: 0.3500, F1 (Macro): 0.3175

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 1.0447
  Epoch 14 [Batch 1/11]: Loss: 1.0459
  Epoch 14 [Batch 2/11]: Loss: 1.0202
  Epoch 14 [Batch 3/11]: Loss: 1.0801
  Epoch 14 [Batch 4/11]: Loss: 1.0594
  Epoch 14 [Batch 5/11]: Loss: 1.0315
  Epoch 14 [Batch 6/11]: Loss: 1.0570
  Epoch 14 [Batch 7/11]: Loss: 1.0535
  Epoch 14 [Batch 8/11]: Loss: 1.1020
  Epoch 14 [Batch 9/11]: Loss: 1.0370
  Epoch 14 [Batch 10/11]: Loss: 1.1278
  Epoch 14 Train Summary: Avg Loss: 1.0599, Accuracy: 0.3456
  Validation Summary: Avg Loss: 1.0897, Accuracy: 0.3500, F1 (Macro): 0.3175
Training finished in 0.88 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.0793, Accuracy: 0.3833, F1 (Macro): 0.3485
Final Best Model Stats: Acc: 0.3833, F1: 0.3485, Loss: 1.0793
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=1e-05 drop=0.0 seed=999
================================================================================
Starting experiment: resnet50__224x224__lr-1e-05__drop-0.0__seed-999
Output directory: results_ceph/resnet50__224x224__lr-1e-05__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.1428
  Epoch 0 [Batch 1/11]: Loss: 1.1212
  Epoch 0 [Batch 2/11]: Loss: 1.1500
  Epoch 0 [Batch 3/11]: Loss: 1.1210
  Epoch 0 [Batch 4/11]: Loss: 1.1615
  Epoch 0 [Batch 5/11]: Loss: 1.0826
  Epoch 0 [Batch 6/11]: Loss: 1.1181
  Epoch 0 [Batch 7/11]: Loss: 1.1434
  Epoch 0 [Batch 8/11]: Loss: 1.1402
  Epoch 0 [Batch 9/11]: Loss: 1.1684
  Epoch 0 [Batch 10/11]: Loss: 1.0915
  Epoch 0 Train Summary: Avg Loss: 1.1310, Accuracy: 0.3135
  Validation Summary: Avg Loss: 1.0835, Accuracy: 0.5000, F1 (Macro): 0.2963
  New best model! Val loss improved from inf to 1.0835. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.0901
  Epoch 1 [Batch 1/11]: Loss: 1.1114
  Epoch 1 [Batch 2/11]: Loss: 1.1668
  Epoch 1 [Batch 3/11]: Loss: 1.1652
  Epoch 1 [Batch 4/11]: Loss: 1.1560
  Epoch 1 [Batch 5/11]: Loss: 1.1208
  Epoch 1 [Batch 6/11]: Loss: 1.1428
  Epoch 1 [Batch 7/11]: Loss: 1.1212
  Epoch 1 [Batch 8/11]: Loss: 1.1231
  Epoch 1 [Batch 9/11]: Loss: 1.1059
  Epoch 1 [Batch 10/11]: Loss: 1.1939
  Epoch 1 Train Summary: Avg Loss: 1.1361, Accuracy: 0.2494
  Validation Summary: Avg Loss: 1.1103, Accuracy: 0.0833, F1 (Macro): 0.0833

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 1.1141
  Epoch 2 [Batch 1/11]: Loss: 1.1299
  Epoch 2 [Batch 2/11]: Loss: 1.1018
  Epoch 2 [Batch 3/11]: Loss: 1.1650
  Epoch 2 [Batch 4/11]: Loss: 1.1456
  Epoch 2 [Batch 5/11]: Loss: 1.1461
  Epoch 2 [Batch 6/11]: Loss: 1.1549
  Epoch 2 [Batch 7/11]: Loss: 1.0721
  Epoch 2 [Batch 8/11]: Loss: 1.1113
  Epoch 2 [Batch 9/11]: Loss: 1.0922
  Epoch 2 [Batch 10/11]: Loss: 1.1334
  Epoch 2 Train Summary: Avg Loss: 1.1242, Accuracy: 0.3135
  Validation Summary: Avg Loss: 1.1081, Accuracy: 0.4167, F1 (Macro): 0.1852

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 1.1071
  Epoch 3 [Batch 1/11]: Loss: 1.1338
  Epoch 3 [Batch 2/11]: Loss: 1.0947
  Epoch 3 [Batch 3/11]: Loss: 1.1178
  Epoch 3 [Batch 4/11]: Loss: 1.0909
  Epoch 3 [Batch 5/11]: Loss: 1.0951
  Epoch 3 [Batch 6/11]: Loss: 1.0950
  Epoch 3 [Batch 7/11]: Loss: 1.0894
  Epoch 3 [Batch 8/11]: Loss: 1.1433
  Epoch 3 [Batch 9/11]: Loss: 1.1077
  Epoch 3 [Batch 10/11]: Loss: 1.1197
  Epoch 3 Train Summary: Avg Loss: 1.1086, Accuracy: 0.3971
  Validation Summary: Avg Loss: 1.1083, Accuracy: 0.5000, F1 (Macro): 0.2738

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 1.0958
  Epoch 4 [Batch 1/11]: Loss: 1.1389
  Epoch 4 [Batch 2/11]: Loss: 1.1241
  Epoch 4 [Batch 3/11]: Loss: 1.1173
  Epoch 4 [Batch 4/11]: Loss: 1.0989
  Epoch 4 [Batch 5/11]: Loss: 1.0943
  Epoch 4 [Batch 6/11]: Loss: 1.0914
  Epoch 4 [Batch 7/11]: Loss: 1.0985
  Epoch 4 [Batch 8/11]: Loss: 1.1099
  Epoch 4 [Batch 9/11]: Loss: 1.0726
  Epoch 4 [Batch 10/11]: Loss: 1.1217
  Epoch 4 Train Summary: Avg Loss: 1.1058, Accuracy: 0.3904
  Validation Summary: Avg Loss: 1.0993, Accuracy: 0.1667, F1 (Macro): 0.1333

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 1.1272
  Epoch 5 [Batch 1/11]: Loss: 1.0852
  Epoch 5 [Batch 2/11]: Loss: 1.1065
  Epoch 5 [Batch 3/11]: Loss: 1.1112
  Epoch 5 [Batch 4/11]: Loss: 1.0843
  Epoch 5 [Batch 5/11]: Loss: 1.1294
  Epoch 5 [Batch 6/11]: Loss: 1.1123
  Epoch 5 [Batch 7/11]: Loss: 1.0864
  Epoch 5 [Batch 8/11]: Loss: 1.1053
  Epoch 5 [Batch 9/11]: Loss: 1.0927
  Epoch 5 [Batch 10/11]: Loss: 1.1071
  Epoch 5 Train Summary: Avg Loss: 1.1043, Accuracy: 0.3513
  Validation Summary: Avg Loss: 1.1001, Accuracy: 0.1667, F1 (Macro): 0.1481

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 1.0847
  Epoch 6 [Batch 1/11]: Loss: 1.1013
  Epoch 6 [Batch 2/11]: Loss: 1.1127
  Epoch 6 [Batch 3/11]: Loss: 1.0724
  Epoch 6 [Batch 4/11]: Loss: 1.1301
  Epoch 6 [Batch 5/11]: Loss: 1.1034
  Epoch 6 [Batch 6/11]: Loss: 1.1082
  Epoch 6 [Batch 7/11]: Loss: 1.0802
  Epoch 6 [Batch 8/11]: Loss: 1.0961
  Epoch 6 [Batch 9/11]: Loss: 1.1178
  Epoch 6 [Batch 10/11]: Loss: 1.0909
  Epoch 6 Train Summary: Avg Loss: 1.0998, Accuracy: 0.2833
  Validation Summary: Avg Loss: 1.1005, Accuracy: 0.2500, F1 (Macro): 0.1667

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 1.1034
  Epoch 7 [Batch 1/11]: Loss: 1.0878
  Epoch 7 [Batch 2/11]: Loss: 1.0897
  Epoch 7 [Batch 3/11]: Loss: 1.1236
  Epoch 7 [Batch 4/11]: Loss: 1.0826
  Epoch 7 [Batch 5/11]: Loss: 1.0422
  Epoch 7 [Batch 6/11]: Loss: 1.1143
  Epoch 7 [Batch 7/11]: Loss: 1.0818
  Epoch 7 [Batch 8/11]: Loss: 1.0918
  Epoch 7 [Batch 9/11]: Loss: 1.0959
  Epoch 7 [Batch 10/11]: Loss: 1.1019
  Epoch 7 Train Summary: Avg Loss: 1.0923, Accuracy: 0.4477
  Validation Summary: Avg Loss: 1.1101, Accuracy: 0.1667, F1 (Macro): 0.1111

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 1.1041
  Epoch 8 [Batch 1/11]: Loss: 1.0889
  Epoch 8 [Batch 2/11]: Loss: 1.1191
  Epoch 8 [Batch 3/11]: Loss: 1.0988
  Epoch 8 [Batch 4/11]: Loss: 1.0816
  Epoch 8 [Batch 5/11]: Loss: 1.0733
  Epoch 8 [Batch 6/11]: Loss: 1.0997
  Epoch 8 [Batch 7/11]: Loss: 1.0967
  Epoch 8 [Batch 8/11]: Loss: 1.0848
  Epoch 8 [Batch 9/11]: Loss: 1.0817
  Epoch 8 [Batch 10/11]: Loss: 1.1141
  Epoch 8 Train Summary: Avg Loss: 1.0948, Accuracy: 0.3143
  Validation Summary: Avg Loss: 1.0855, Accuracy: 0.3333, F1 (Macro): 0.1905

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 1.1007
  Epoch 9 [Batch 1/11]: Loss: 1.1035
  Epoch 9 [Batch 2/11]: Loss: 1.1048
  Epoch 9 [Batch 3/11]: Loss: 1.0835
  Epoch 9 [Batch 4/11]: Loss: 1.0820
  Epoch 9 [Batch 5/11]: Loss: 1.0682
  Epoch 9 [Batch 6/11]: Loss: 1.0996
  Epoch 9 [Batch 7/11]: Loss: 1.0900
  Epoch 9 [Batch 8/11]: Loss: 1.0703
  Epoch 9 [Batch 9/11]: Loss: 1.0853
  Epoch 9 [Batch 10/11]: Loss: 1.0751
  Epoch 9 Train Summary: Avg Loss: 1.0875, Accuracy: 0.4019
  Validation Summary: Avg Loss: 1.0879, Accuracy: 0.3333, F1 (Macro): 0.2051

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 1.0837
  Epoch 10 [Batch 1/11]: Loss: 1.0939
  Epoch 10 [Batch 2/11]: Loss: 1.0873
  Epoch 10 [Batch 3/11]: Loss: 1.0859
  Epoch 10 [Batch 4/11]: Loss: 1.1021
  Epoch 10 [Batch 5/11]: Loss: 1.0789
  Epoch 10 [Batch 6/11]: Loss: 1.1089
  Epoch 10 [Batch 7/11]: Loss: 1.0984
  Epoch 10 [Batch 8/11]: Loss: 1.0879
  Epoch 10 [Batch 9/11]: Loss: 1.0942
  Epoch 10 [Batch 10/11]: Loss: 1.0743
  Epoch 10 Train Summary: Avg Loss: 1.0905, Accuracy: 0.3358
  Validation Summary: Avg Loss: 1.0948, Accuracy: 0.3333, F1 (Macro): 0.2051

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 1.0892
  Epoch 11 [Batch 1/11]: Loss: 1.1085
  Epoch 11 [Batch 2/11]: Loss: 1.1036
  Epoch 11 [Batch 3/11]: Loss: 1.0877
  Epoch 11 [Batch 4/11]: Loss: 1.1012
  Epoch 11 [Batch 5/11]: Loss: 1.0943
  Epoch 11 [Batch 6/11]: Loss: 1.1195
  Epoch 11 [Batch 7/11]: Loss: 1.1120
  Epoch 11 [Batch 8/11]: Loss: 1.0965
  Epoch 11 [Batch 9/11]: Loss: 1.0712
  Epoch 11 [Batch 10/11]: Loss: 1.0717
  Epoch 11 Train Summary: Avg Loss: 1.0959, Accuracy: 0.3386
  Validation Summary: Avg Loss: 1.0965, Accuracy: 0.3333, F1 (Macro): 0.2051

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 1.1031
  Epoch 12 [Batch 1/11]: Loss: 1.0770
  Epoch 12 [Batch 2/11]: Loss: 1.0934
  Epoch 12 [Batch 3/11]: Loss: 1.0983
  Epoch 12 [Batch 4/11]: Loss: 1.0743
  Epoch 12 [Batch 5/11]: Loss: 1.0954
  Epoch 12 [Batch 6/11]: Loss: 1.0931
  Epoch 12 [Batch 7/11]: Loss: 1.0893
  Epoch 12 [Batch 8/11]: Loss: 1.0980
  Epoch 12 [Batch 9/11]: Loss: 1.0868
  Epoch 12 [Batch 10/11]: Loss: 1.1071
  Epoch 12 Train Summary: Avg Loss: 1.0923, Accuracy: 0.4828
  Validation Summary: Avg Loss: 1.0914, Accuracy: 0.3333, F1 (Macro): 0.2051

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 1.0954
  Epoch 13 [Batch 1/11]: Loss: 1.1026
  Epoch 13 [Batch 2/11]: Loss: 1.0845
  Epoch 13 [Batch 3/11]: Loss: 1.0919
  Epoch 13 [Batch 4/11]: Loss: 1.0717
  Epoch 13 [Batch 5/11]: Loss: 1.1061
  Epoch 13 [Batch 6/11]: Loss: 1.0724
  Epoch 13 [Batch 7/11]: Loss: 1.0828
  Epoch 13 [Batch 8/11]: Loss: 1.1032
  Epoch 13 [Batch 9/11]: Loss: 1.0817
  Epoch 13 [Batch 10/11]: Loss: 1.1127
  Epoch 13 Train Summary: Avg Loss: 1.0914, Accuracy: 0.4039
  Validation Summary: Avg Loss: 1.0901, Accuracy: 0.3333, F1 (Macro): 0.2051

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 1.0956
  Epoch 14 [Batch 1/11]: Loss: 1.0955
  Epoch 14 [Batch 2/11]: Loss: 1.0845
  Epoch 14 [Batch 3/11]: Loss: 1.0858
  Epoch 14 [Batch 4/11]: Loss: 1.0707
  Epoch 14 [Batch 5/11]: Loss: 1.0869
  Epoch 14 [Batch 6/11]: Loss: 1.0765
  Epoch 14 [Batch 7/11]: Loss: 1.1140
  Epoch 14 [Batch 8/11]: Loss: 1.0872
  Epoch 14 [Batch 9/11]: Loss: 1.0927
  Epoch 14 [Batch 10/11]: Loss: 1.1099
  Epoch 14 Train Summary: Avg Loss: 1.0908, Accuracy: 0.4093
  Validation Summary: Avg Loss: 1.0952, Accuracy: 0.3333, F1 (Macro): 0.2051
Training finished in 0.84 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.0835, Accuracy: 0.5000, F1 (Macro): 0.2963
Final Best Model Stats: Acc: 0.5000, F1: 0.2963, Loss: 1.0835
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=0.0001 drop=0.0 seed=42
================================================================================
Starting experiment: resnet50__384x384__lr-0.0001__drop-0.0__seed-42
Output directory: results_ceph/resnet50__384x384__lr-0.0001__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.1095
  Epoch 0 [Batch 1/11]: Loss: 1.1178
  Epoch 0 [Batch 2/11]: Loss: 1.1146
  Epoch 0 [Batch 3/11]: Loss: 1.1025
  Epoch 0 [Batch 4/11]: Loss: 1.1117
  Epoch 0 [Batch 5/11]: Loss: 1.1032
  Epoch 0 [Batch 6/11]: Loss: 1.1075
  Epoch 0 [Batch 7/11]: Loss: 1.0932
  Epoch 0 [Batch 8/11]: Loss: 1.0944
  Epoch 0 [Batch 9/11]: Loss: 1.0808
  Epoch 0 [Batch 10/11]: Loss: 1.0401
  Epoch 0 Train Summary: Avg Loss: 1.0977, Accuracy: 0.2492
  Validation Summary: Avg Loss: 1.1028, Accuracy: 0.4167, F1 (Macro): 0.3714
  New best model! Val loss improved from inf to 1.1028. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.0800
  Epoch 1 [Batch 1/11]: Loss: 1.0892
  Epoch 1 [Batch 2/11]: Loss: 1.0214
  Epoch 1 [Batch 3/11]: Loss: 1.0448
  Epoch 1 [Batch 4/11]: Loss: 1.0262
  Epoch 1 [Batch 5/11]: Loss: 1.1289
  Epoch 1 [Batch 6/11]: Loss: 0.9677
  Epoch 1 [Batch 7/11]: Loss: 1.0465
  Epoch 1 [Batch 8/11]: Loss: 0.9876
  Epoch 1 [Batch 9/11]: Loss: 1.0421
  Epoch 1 [Batch 10/11]: Loss: 1.1613
  Epoch 1 Train Summary: Avg Loss: 1.0542, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0960, Accuracy: 0.3333, F1 (Macro): 0.2222
  New best model! Val loss improved from 1.1028 to 1.0960. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 1.0184
  Epoch 2 [Batch 1/11]: Loss: 1.0383
  Epoch 2 [Batch 2/11]: Loss: 1.0427
  Epoch 2 [Batch 3/11]: Loss: 1.0510
  Epoch 2 [Batch 4/11]: Loss: 1.0583
  Epoch 2 [Batch 5/11]: Loss: 1.0267
  Epoch 2 [Batch 6/11]: Loss: 1.0004
  Epoch 2 [Batch 7/11]: Loss: 0.8984
  Epoch 2 [Batch 8/11]: Loss: 0.8746
  Epoch 2 [Batch 9/11]: Loss: 0.9491
  Epoch 2 [Batch 10/11]: Loss: 0.8283
  Epoch 2 Train Summary: Avg Loss: 0.9806, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0917, Accuracy: 0.3333, F1 (Macro): 0.2222
  New best model! Val loss improved from 1.0960 to 1.0917. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 1.0065
  Epoch 3 [Batch 1/11]: Loss: 0.9188
  Epoch 3 [Batch 2/11]: Loss: 0.9958
  Epoch 3 [Batch 3/11]: Loss: 0.8106
  Epoch 3 [Batch 4/11]: Loss: 1.0548
  Epoch 3 [Batch 5/11]: Loss: 1.1455
  Epoch 3 [Batch 6/11]: Loss: 0.7975
  Epoch 3 [Batch 7/11]: Loss: 0.9043
  Epoch 3 [Batch 8/11]: Loss: 0.9611
  Epoch 3 [Batch 9/11]: Loss: 1.0105
  Epoch 3 [Batch 10/11]: Loss: 1.1696
  Epoch 3 Train Summary: Avg Loss: 0.9796, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1009, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 0.8406
  Epoch 4 [Batch 1/11]: Loss: 1.0829
  Epoch 4 [Batch 2/11]: Loss: 1.2210
  Epoch 4 [Batch 3/11]: Loss: 0.8312
  Epoch 4 [Batch 4/11]: Loss: 0.8714
  Epoch 4 [Batch 5/11]: Loss: 1.0281
  Epoch 4 [Batch 6/11]: Loss: 0.7158
  Epoch 4 [Batch 7/11]: Loss: 1.0317
  Epoch 4 [Batch 8/11]: Loss: 0.8831
  Epoch 4 [Batch 9/11]: Loss: 0.7814
  Epoch 4 [Batch 10/11]: Loss: 1.4180
  Epoch 4 Train Summary: Avg Loss: 0.9732, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0961, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 0.9728
  Epoch 5 [Batch 1/11]: Loss: 0.8373
  Epoch 5 [Batch 2/11]: Loss: 0.7894
  Epoch 5 [Batch 3/11]: Loss: 0.8432
  Epoch 5 [Batch 4/11]: Loss: 1.0393
  Epoch 5 [Batch 5/11]: Loss: 0.8395
  Epoch 5 [Batch 6/11]: Loss: 0.8679
  Epoch 5 [Batch 7/11]: Loss: 0.8243
  Epoch 5 [Batch 8/11]: Loss: 1.0546
  Epoch 5 [Batch 9/11]: Loss: 1.0117
  Epoch 5 [Batch 10/11]: Loss: 1.2870
  Epoch 5 Train Summary: Avg Loss: 0.9424, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1241, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 0.7969
  Epoch 6 [Batch 1/11]: Loss: 1.0061
  Epoch 6 [Batch 2/11]: Loss: 1.0214
  Epoch 6 [Batch 3/11]: Loss: 1.1627
  Epoch 6 [Batch 4/11]: Loss: 0.8173
  Epoch 6 [Batch 5/11]: Loss: 0.8677
  Epoch 6 [Batch 6/11]: Loss: 1.1685
  Epoch 6 [Batch 7/11]: Loss: 0.6460
  Epoch 6 [Batch 8/11]: Loss: 1.0183
  Epoch 6 [Batch 9/11]: Loss: 0.8288
  Epoch 6 [Batch 10/11]: Loss: 0.6214
  Epoch 6 Train Summary: Avg Loss: 0.9050, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1298, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.9437
  Epoch 7 [Batch 1/11]: Loss: 0.7788
  Epoch 7 [Batch 2/11]: Loss: 0.6290
  Epoch 7 [Batch 3/11]: Loss: 0.9963
  Epoch 7 [Batch 4/11]: Loss: 1.0237
  Epoch 7 [Batch 5/11]: Loss: 1.0116
  Epoch 7 [Batch 6/11]: Loss: 0.7553
  Epoch 7 [Batch 7/11]: Loss: 0.9322
  Epoch 7 [Batch 8/11]: Loss: 0.9258
  Epoch 7 [Batch 9/11]: Loss: 0.8907
  Epoch 7 [Batch 10/11]: Loss: 1.0283
  Epoch 7 Train Summary: Avg Loss: 0.9014, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.2479, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 1.2559
  Epoch 8 [Batch 1/11]: Loss: 1.0738
  Epoch 8 [Batch 2/11]: Loss: 0.7361
  Epoch 8 [Batch 3/11]: Loss: 0.8089
  Epoch 8 [Batch 4/11]: Loss: 0.6861
  Epoch 8 [Batch 5/11]: Loss: 1.0791
  Epoch 8 [Batch 6/11]: Loss: 0.9797
  Epoch 8 [Batch 7/11]: Loss: 0.9967
  Epoch 8 [Batch 8/11]: Loss: 0.5658
  Epoch 8 [Batch 9/11]: Loss: 0.8401
  Epoch 8 [Batch 10/11]: Loss: 0.6164
  Epoch 8 Train Summary: Avg Loss: 0.8762, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.2997, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 1.0014
  Epoch 9 [Batch 1/11]: Loss: 0.8715
  Epoch 9 [Batch 2/11]: Loss: 0.7851
  Epoch 9 [Batch 3/11]: Loss: 1.0437
  Epoch 9 [Batch 4/11]: Loss: 0.8627
  Epoch 9 [Batch 5/11]: Loss: 0.7572
  Epoch 9 [Batch 6/11]: Loss: 0.9200
  Epoch 9 [Batch 7/11]: Loss: 0.9198
  Epoch 9 [Batch 8/11]: Loss: 0.8732
  Epoch 9 [Batch 9/11]: Loss: 0.9011
  Epoch 9 [Batch 10/11]: Loss: 0.5886
  Epoch 9 Train Summary: Avg Loss: 0.8659, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.2229, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 0.7241
  Epoch 10 [Batch 1/11]: Loss: 0.7158
  Epoch 10 [Batch 2/11]: Loss: 0.8749
  Epoch 10 [Batch 3/11]: Loss: 0.9881
  Epoch 10 [Batch 4/11]: Loss: 1.3999
  Epoch 10 [Batch 5/11]: Loss: 0.7728
  Epoch 10 [Batch 6/11]: Loss: 0.7106
  Epoch 10 [Batch 7/11]: Loss: 0.8385
  Epoch 10 [Batch 8/11]: Loss: 0.9139
  Epoch 10 [Batch 9/11]: Loss: 1.2191
  Epoch 10 [Batch 10/11]: Loss: 0.6086
  Epoch 10 Train Summary: Avg Loss: 0.8879, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.2413, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 0.9466
  Epoch 11 [Batch 1/11]: Loss: 0.9392
  Epoch 11 [Batch 2/11]: Loss: 0.9203
  Epoch 11 [Batch 3/11]: Loss: 0.9028
  Epoch 11 [Batch 4/11]: Loss: 0.5856
  Epoch 11 [Batch 5/11]: Loss: 0.8497
  Epoch 11 [Batch 6/11]: Loss: 0.7440
  Epoch 11 [Batch 7/11]: Loss: 0.9046
  Epoch 11 [Batch 8/11]: Loss: 1.3035
  Epoch 11 [Batch 9/11]: Loss: 0.7811
  Epoch 11 [Batch 10/11]: Loss: 0.5799
  Epoch 11 Train Summary: Avg Loss: 0.8597, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1808, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.8998
  Epoch 12 [Batch 1/11]: Loss: 1.1738
  Epoch 12 [Batch 2/11]: Loss: 0.5807
  Epoch 12 [Batch 3/11]: Loss: 0.7973
  Epoch 12 [Batch 4/11]: Loss: 1.0372
  Epoch 12 [Batch 5/11]: Loss: 0.7528
  Epoch 12 [Batch 6/11]: Loss: 0.9219
  Epoch 12 [Batch 7/11]: Loss: 0.8625
  Epoch 12 [Batch 8/11]: Loss: 0.9998
  Epoch 12 [Batch 9/11]: Loss: 0.6978
  Epoch 12 [Batch 10/11]: Loss: 1.3131
  Epoch 12 Train Summary: Avg Loss: 0.9124, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.2058, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 0.7380
  Epoch 13 [Batch 1/11]: Loss: 0.9232
  Epoch 13 [Batch 2/11]: Loss: 0.7714
  Epoch 13 [Batch 3/11]: Loss: 0.9156
  Epoch 13 [Batch 4/11]: Loss: 0.8902
  Epoch 13 [Batch 5/11]: Loss: 0.9999
  Epoch 13 [Batch 6/11]: Loss: 1.0861
  Epoch 13 [Batch 7/11]: Loss: 0.8048
  Epoch 13 [Batch 8/11]: Loss: 0.9501
  Epoch 13 [Batch 9/11]: Loss: 0.7645
  Epoch 13 [Batch 10/11]: Loss: 0.9880
  Epoch 13 Train Summary: Avg Loss: 0.8938, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.2034, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.7178
  Epoch 14 [Batch 1/11]: Loss: 1.1359
  Epoch 14 [Batch 2/11]: Loss: 0.6154
  Epoch 14 [Batch 3/11]: Loss: 0.5948
  Epoch 14 [Batch 4/11]: Loss: 0.7326
  Epoch 14 [Batch 5/11]: Loss: 0.8373
  Epoch 14 [Batch 6/11]: Loss: 1.0497
  Epoch 14 [Batch 7/11]: Loss: 1.0613
  Epoch 14 [Batch 8/11]: Loss: 0.9267
  Epoch 14 [Batch 9/11]: Loss: 0.8811
  Epoch 14 [Batch 10/11]: Loss: 1.9824
  Epoch 14 Train Summary: Avg Loss: 0.9577, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.2073, Accuracy: 0.3333, F1 (Macro): 0.2222
Training finished in 4.91 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.0917, Accuracy: 0.3333, F1 (Macro): 0.2222
Final Best Model Stats: Acc: 0.3333, F1: 0.2222, Loss: 1.0917
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=0.0001 drop=0.0 seed=123
================================================================================
Starting experiment: resnet50__384x384__lr-0.0001__drop-0.0__seed-123
Output directory: results_ceph/resnet50__384x384__lr-0.0001__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.1034
  Epoch 0 [Batch 1/11]: Loss: 1.0931
  Epoch 0 [Batch 2/11]: Loss: 1.0969
  Epoch 0 [Batch 3/11]: Loss: 1.0962
  Epoch 0 [Batch 4/11]: Loss: 1.1065
  Epoch 0 [Batch 5/11]: Loss: 1.0734
  Epoch 0 [Batch 6/11]: Loss: 1.0594
  Epoch 0 [Batch 7/11]: Loss: 1.0625
  Epoch 0 [Batch 8/11]: Loss: 1.0913
  Epoch 0 [Batch 9/11]: Loss: 1.1017
  Epoch 0 [Batch 10/11]: Loss: 1.0298
  Epoch 0 Train Summary: Avg Loss: 1.0831, Accuracy: 0.3285
  Validation Summary: Avg Loss: 1.0857, Accuracy: 0.3500, F1 (Macro): 0.3175
  New best model! Val loss improved from inf to 1.0857. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.0555
  Epoch 1 [Batch 1/11]: Loss: 1.0854
  Epoch 1 [Batch 2/11]: Loss: 1.0331
  Epoch 1 [Batch 3/11]: Loss: 1.0443
  Epoch 1 [Batch 4/11]: Loss: 1.0097
  Epoch 1 [Batch 5/11]: Loss: 1.0345
  Epoch 1 [Batch 6/11]: Loss: 1.0002
  Epoch 1 [Batch 7/11]: Loss: 1.0440
  Epoch 1 [Batch 8/11]: Loss: 0.9679
  Epoch 1 [Batch 9/11]: Loss: 1.0839
  Epoch 1 [Batch 10/11]: Loss: 1.2254
  Epoch 1 Train Summary: Avg Loss: 1.0531, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0907, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 0.9933
  Epoch 2 [Batch 1/11]: Loss: 1.0918
  Epoch 2 [Batch 2/11]: Loss: 0.9730
  Epoch 2 [Batch 3/11]: Loss: 1.1113
  Epoch 2 [Batch 4/11]: Loss: 1.0338
  Epoch 2 [Batch 5/11]: Loss: 0.8841
  Epoch 2 [Batch 6/11]: Loss: 1.0308
  Epoch 2 [Batch 7/11]: Loss: 0.9963
  Epoch 2 [Batch 8/11]: Loss: 0.9594
  Epoch 2 [Batch 9/11]: Loss: 0.9384
  Epoch 2 [Batch 10/11]: Loss: 0.9436
  Epoch 2 Train Summary: Avg Loss: 0.9960, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0926, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 0.9273
  Epoch 3 [Batch 1/11]: Loss: 1.0444
  Epoch 3 [Batch 2/11]: Loss: 1.1553
  Epoch 3 [Batch 3/11]: Loss: 0.9357
  Epoch 3 [Batch 4/11]: Loss: 0.9420
  Epoch 3 [Batch 5/11]: Loss: 0.8284
  Epoch 3 [Batch 6/11]: Loss: 0.8943
  Epoch 3 [Batch 7/11]: Loss: 1.0272
  Epoch 3 [Batch 8/11]: Loss: 0.9774
  Epoch 3 [Batch 9/11]: Loss: 0.9781
  Epoch 3 [Batch 10/11]: Loss: 0.9681
  Epoch 3 Train Summary: Avg Loss: 0.9707, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1038, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 1.0871
  Epoch 4 [Batch 1/11]: Loss: 1.0117
  Epoch 4 [Batch 2/11]: Loss: 0.9304
  Epoch 4 [Batch 3/11]: Loss: 0.8610
  Epoch 4 [Batch 4/11]: Loss: 0.9322
  Epoch 4 [Batch 5/11]: Loss: 1.0255
  Epoch 4 [Batch 6/11]: Loss: 0.8616
  Epoch 4 [Batch 7/11]: Loss: 0.8929
  Epoch 4 [Batch 8/11]: Loss: 0.9729
  Epoch 4 [Batch 9/11]: Loss: 0.9020
  Epoch 4 [Batch 10/11]: Loss: 0.6793
  Epoch 4 Train Summary: Avg Loss: 0.9233, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0898, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 1.0438
  Epoch 5 [Batch 1/11]: Loss: 0.7940
  Epoch 5 [Batch 2/11]: Loss: 1.1779
  Epoch 5 [Batch 3/11]: Loss: 0.8538
  Epoch 5 [Batch 4/11]: Loss: 1.1166
  Epoch 5 [Batch 5/11]: Loss: 0.8371
  Epoch 5 [Batch 6/11]: Loss: 1.0000
  Epoch 5 [Batch 7/11]: Loss: 0.7335
  Epoch 5 [Batch 8/11]: Loss: 1.0342
  Epoch 5 [Batch 9/11]: Loss: 0.7673
  Epoch 5 [Batch 10/11]: Loss: 1.0164
  Epoch 5 Train Summary: Avg Loss: 0.9431, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1087, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 1.0393
  Epoch 6 [Batch 1/11]: Loss: 0.8471
  Epoch 6 [Batch 2/11]: Loss: 0.7570
  Epoch 6 [Batch 3/11]: Loss: 1.1111
  Epoch 6 [Batch 4/11]: Loss: 0.8993
  Epoch 6 [Batch 5/11]: Loss: 0.8916
  Epoch 6 [Batch 6/11]: Loss: 0.6691
  Epoch 6 [Batch 7/11]: Loss: 0.7583
  Epoch 6 [Batch 8/11]: Loss: 1.1603
  Epoch 6 [Batch 9/11]: Loss: 1.0494
  Epoch 6 [Batch 10/11]: Loss: 0.5708
  Epoch 6 Train Summary: Avg Loss: 0.8867, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1337, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.6092
  Epoch 7 [Batch 1/11]: Loss: 0.9292
  Epoch 7 [Batch 2/11]: Loss: 0.9221
  Epoch 7 [Batch 3/11]: Loss: 0.9697
  Epoch 7 [Batch 4/11]: Loss: 0.9272
  Epoch 7 [Batch 5/11]: Loss: 0.9769
  Epoch 7 [Batch 6/11]: Loss: 0.9596
  Epoch 7 [Batch 7/11]: Loss: 1.2248
  Epoch 7 [Batch 8/11]: Loss: 0.8161
  Epoch 7 [Batch 9/11]: Loss: 0.8636
  Epoch 7 [Batch 10/11]: Loss: 0.5236
  Epoch 7 Train Summary: Avg Loss: 0.8838, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1376, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 0.6378
  Epoch 8 [Batch 1/11]: Loss: 0.7946
  Epoch 8 [Batch 2/11]: Loss: 0.9137
  Epoch 8 [Batch 3/11]: Loss: 0.7113
  Epoch 8 [Batch 4/11]: Loss: 1.2510
  Epoch 8 [Batch 5/11]: Loss: 0.9499
  Epoch 8 [Batch 6/11]: Loss: 1.1549
  Epoch 8 [Batch 7/11]: Loss: 0.7764
  Epoch 8 [Batch 8/11]: Loss: 0.7936
  Epoch 8 [Batch 9/11]: Loss: 0.8865
  Epoch 8 [Batch 10/11]: Loss: 1.0109
  Epoch 8 Train Summary: Avg Loss: 0.8982, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1522, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 0.6546
  Epoch 9 [Batch 1/11]: Loss: 1.0119
  Epoch 9 [Batch 2/11]: Loss: 1.1996
  Epoch 9 [Batch 3/11]: Loss: 0.6832
  Epoch 9 [Batch 4/11]: Loss: 0.8434
  Epoch 9 [Batch 5/11]: Loss: 1.0800
  Epoch 9 [Batch 6/11]: Loss: 0.8612
  Epoch 9 [Batch 7/11]: Loss: 1.0092
  Epoch 9 [Batch 8/11]: Loss: 0.8234
  Epoch 9 [Batch 9/11]: Loss: 0.8884
  Epoch 9 [Batch 10/11]: Loss: 0.5399
  Epoch 9 Train Summary: Avg Loss: 0.8723, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.2109, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 1.0874
  Epoch 10 [Batch 1/11]: Loss: 0.6017
  Epoch 10 [Batch 2/11]: Loss: 0.9331
  Epoch 10 [Batch 3/11]: Loss: 0.9585
  Epoch 10 [Batch 4/11]: Loss: 0.9669
  Epoch 10 [Batch 5/11]: Loss: 0.5943
  Epoch 10 [Batch 6/11]: Loss: 1.2379
  Epoch 10 [Batch 7/11]: Loss: 1.0812
  Epoch 10 [Batch 8/11]: Loss: 0.6170
  Epoch 10 [Batch 9/11]: Loss: 0.8415
  Epoch 10 [Batch 10/11]: Loss: 1.4292
  Epoch 10 Train Summary: Avg Loss: 0.9408, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1626, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 0.8317
  Epoch 11 [Batch 1/11]: Loss: 0.6975
  Epoch 11 [Batch 2/11]: Loss: 1.0042
  Epoch 11 [Batch 3/11]: Loss: 0.8047
  Epoch 11 [Batch 4/11]: Loss: 1.0912
  Epoch 11 [Batch 5/11]: Loss: 1.4984
  Epoch 11 [Batch 6/11]: Loss: 0.7183
  Epoch 11 [Batch 7/11]: Loss: 0.7075
  Epoch 11 [Batch 8/11]: Loss: 0.8490
  Epoch 11 [Batch 9/11]: Loss: 0.8304
  Epoch 11 [Batch 10/11]: Loss: 1.1822
  Epoch 11 Train Summary: Avg Loss: 0.9286, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1891, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.9423
  Epoch 12 [Batch 1/11]: Loss: 0.9902
  Epoch 12 [Batch 2/11]: Loss: 0.7858
  Epoch 12 [Batch 3/11]: Loss: 0.9139
  Epoch 12 [Batch 4/11]: Loss: 0.8469
  Epoch 12 [Batch 5/11]: Loss: 0.8337
  Epoch 12 [Batch 6/11]: Loss: 0.7146
  Epoch 12 [Batch 7/11]: Loss: 0.7865
  Epoch 12 [Batch 8/11]: Loss: 0.7959
  Epoch 12 [Batch 9/11]: Loss: 1.1682
  Epoch 12 [Batch 10/11]: Loss: 1.1443
  Epoch 12 Train Summary: Avg Loss: 0.9020, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1603, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 0.9988
  Epoch 13 [Batch 1/11]: Loss: 0.7026
  Epoch 13 [Batch 2/11]: Loss: 0.9696
  Epoch 13 [Batch 3/11]: Loss: 1.0368
  Epoch 13 [Batch 4/11]: Loss: 0.8164
  Epoch 13 [Batch 5/11]: Loss: 1.1378
  Epoch 13 [Batch 6/11]: Loss: 0.7114
  Epoch 13 [Batch 7/11]: Loss: 1.1753
  Epoch 13 [Batch 8/11]: Loss: 0.8572
  Epoch 13 [Batch 9/11]: Loss: 0.7153
  Epoch 13 [Batch 10/11]: Loss: 0.5498
  Epoch 13 Train Summary: Avg Loss: 0.8792, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1630, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.7841
  Epoch 14 [Batch 1/11]: Loss: 0.9481
  Epoch 14 [Batch 2/11]: Loss: 0.6968
  Epoch 14 [Batch 3/11]: Loss: 1.0586
  Epoch 14 [Batch 4/11]: Loss: 0.8955
  Epoch 14 [Batch 5/11]: Loss: 0.7422
  Epoch 14 [Batch 6/11]: Loss: 0.9206
  Epoch 14 [Batch 7/11]: Loss: 0.8434
  Epoch 14 [Batch 8/11]: Loss: 1.1328
  Epoch 14 [Batch 9/11]: Loss: 0.7874
  Epoch 14 [Batch 10/11]: Loss: 1.7264
  Epoch 14 Train Summary: Avg Loss: 0.9578, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1668, Accuracy: 0.3333, F1 (Macro): 0.2222
Training finished in 1.01 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.0857, Accuracy: 0.3500, F1 (Macro): 0.3175
Final Best Model Stats: Acc: 0.3500, F1: 0.3175, Loss: 1.0857
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=0.0001 drop=0.0 seed=999
================================================================================
Starting experiment: resnet50__384x384__lr-0.0001__drop-0.0__seed-999
Output directory: results_ceph/resnet50__384x384__lr-0.0001__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.1401
  Epoch 0 [Batch 1/11]: Loss: 1.1148
  Epoch 0 [Batch 2/11]: Loss: 1.1290
  Epoch 0 [Batch 3/11]: Loss: 1.0992
  Epoch 0 [Batch 4/11]: Loss: 1.1116
  Epoch 0 [Batch 5/11]: Loss: 1.0972
  Epoch 0 [Batch 6/11]: Loss: 1.0868
  Epoch 0 [Batch 7/11]: Loss: 1.0897
  Epoch 0 [Batch 8/11]: Loss: 1.1073
  Epoch 0 [Batch 9/11]: Loss: 1.0857
  Epoch 0 [Batch 10/11]: Loss: 1.0825
  Epoch 0 Train Summary: Avg Loss: 1.1040, Accuracy: 0.3392
  Validation Summary: Avg Loss: 1.0968, Accuracy: 0.3667, F1 (Macro): 0.3485
  New best model! Val loss improved from inf to 1.0968. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.0779
  Epoch 1 [Batch 1/11]: Loss: 1.0725
  Epoch 1 [Batch 2/11]: Loss: 1.0470
  Epoch 1 [Batch 3/11]: Loss: 1.0594
  Epoch 1 [Batch 4/11]: Loss: 1.0689
  Epoch 1 [Batch 5/11]: Loss: 1.0631
  Epoch 1 [Batch 6/11]: Loss: 1.0395
  Epoch 1 [Batch 7/11]: Loss: 1.0548
  Epoch 1 [Batch 8/11]: Loss: 1.0295
  Epoch 1 [Batch 9/11]: Loss: 1.0563
  Epoch 1 [Batch 10/11]: Loss: 0.9794
  Epoch 1 Train Summary: Avg Loss: 1.0498, Accuracy: 0.3476
  Validation Summary: Avg Loss: 1.1066, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 1.0549
  Epoch 2 [Batch 1/11]: Loss: 0.9981
  Epoch 2 [Batch 2/11]: Loss: 1.0326
  Epoch 2 [Batch 3/11]: Loss: 0.9356
  Epoch 2 [Batch 4/11]: Loss: 0.9938
  Epoch 2 [Batch 5/11]: Loss: 0.9686
  Epoch 2 [Batch 6/11]: Loss: 1.0126
  Epoch 2 [Batch 7/11]: Loss: 1.1195
  Epoch 2 [Batch 8/11]: Loss: 1.0460
  Epoch 2 [Batch 9/11]: Loss: 0.9967
  Epoch 2 [Batch 10/11]: Loss: 1.0020
  Epoch 2 Train Summary: Avg Loss: 1.0146, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1013, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 1.0363
  Epoch 3 [Batch 1/11]: Loss: 0.9532
  Epoch 3 [Batch 2/11]: Loss: 0.9769
  Epoch 3 [Batch 3/11]: Loss: 0.9448
  Epoch 3 [Batch 4/11]: Loss: 1.0534
  Epoch 3 [Batch 5/11]: Loss: 1.0824
  Epoch 3 [Batch 6/11]: Loss: 0.9444
  Epoch 3 [Batch 7/11]: Loss: 0.9783
  Epoch 3 [Batch 8/11]: Loss: 0.9910
  Epoch 3 [Batch 9/11]: Loss: 0.8866
  Epoch 3 [Batch 10/11]: Loss: 0.9090
  Epoch 3 Train Summary: Avg Loss: 0.9778, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1081, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 1.0058
  Epoch 4 [Batch 1/11]: Loss: 0.8966
  Epoch 4 [Batch 2/11]: Loss: 0.9636
  Epoch 4 [Batch 3/11]: Loss: 1.0076
  Epoch 4 [Batch 4/11]: Loss: 0.9367
  Epoch 4 [Batch 5/11]: Loss: 0.9051
  Epoch 4 [Batch 6/11]: Loss: 1.0341
  Epoch 4 [Batch 7/11]: Loss: 1.0510
  Epoch 4 [Batch 8/11]: Loss: 0.8655
  Epoch 4 [Batch 9/11]: Loss: 1.0829
  Epoch 4 [Batch 10/11]: Loss: 0.6983
  Epoch 4 Train Summary: Avg Loss: 0.9497, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1062, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 0.8740
  Epoch 5 [Batch 1/11]: Loss: 0.9538
  Epoch 5 [Batch 2/11]: Loss: 0.9094
  Epoch 5 [Batch 3/11]: Loss: 0.9124
  Epoch 5 [Batch 4/11]: Loss: 0.9200
  Epoch 5 [Batch 5/11]: Loss: 1.1062
  Epoch 5 [Batch 6/11]: Loss: 0.8639
  Epoch 5 [Batch 7/11]: Loss: 1.0412
  Epoch 5 [Batch 8/11]: Loss: 0.9082
  Epoch 5 [Batch 9/11]: Loss: 1.0484
  Epoch 5 [Batch 10/11]: Loss: 0.6607
  Epoch 5 Train Summary: Avg Loss: 0.9271, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1358, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 1.2460
  Epoch 6 [Batch 1/11]: Loss: 0.9011
  Epoch 6 [Batch 2/11]: Loss: 0.8858
  Epoch 6 [Batch 3/11]: Loss: 0.7983
  Epoch 6 [Batch 4/11]: Loss: 0.8940
  Epoch 6 [Batch 5/11]: Loss: 1.0106
  Epoch 6 [Batch 6/11]: Loss: 1.0663
  Epoch 6 [Batch 7/11]: Loss: 0.9371
  Epoch 6 [Batch 8/11]: Loss: 0.9322
  Epoch 6 [Batch 9/11]: Loss: 0.6749
  Epoch 6 [Batch 10/11]: Loss: 0.9657
  Epoch 6 Train Summary: Avg Loss: 0.9374, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1251, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.7717
  Epoch 7 [Batch 1/11]: Loss: 0.9352
  Epoch 7 [Batch 2/11]: Loss: 1.3585
  Epoch 7 [Batch 3/11]: Loss: 0.8234
  Epoch 7 [Batch 4/11]: Loss: 0.7899
  Epoch 7 [Batch 5/11]: Loss: 0.8741
  Epoch 7 [Batch 6/11]: Loss: 1.0995
  Epoch 7 [Batch 7/11]: Loss: 1.0462
  Epoch 7 [Batch 8/11]: Loss: 0.6914
  Epoch 7 [Batch 9/11]: Loss: 0.9391
  Epoch 7 [Batch 10/11]: Loss: 0.6244
  Epoch 7 Train Summary: Avg Loss: 0.9048, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1444, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 1.1261
  Epoch 8 [Batch 1/11]: Loss: 0.6603
  Epoch 8 [Batch 2/11]: Loss: 1.0697
  Epoch 8 [Batch 3/11]: Loss: 0.8637
  Epoch 8 [Batch 4/11]: Loss: 0.9619
  Epoch 8 [Batch 5/11]: Loss: 1.2511
  Epoch 8 [Batch 6/11]: Loss: 0.7063
  Epoch 8 [Batch 7/11]: Loss: 0.9209
  Epoch 8 [Batch 8/11]: Loss: 0.8439
  Epoch 8 [Batch 9/11]: Loss: 0.8475
  Epoch 8 [Batch 10/11]: Loss: 0.5701
  Epoch 8 Train Summary: Avg Loss: 0.8928, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1479, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 0.8954
  Epoch 9 [Batch 1/11]: Loss: 0.6538
  Epoch 9 [Batch 2/11]: Loss: 0.8608
  Epoch 9 [Batch 3/11]: Loss: 0.9563
  Epoch 9 [Batch 4/11]: Loss: 0.9268
  Epoch 9 [Batch 5/11]: Loss: 1.1073
  Epoch 9 [Batch 6/11]: Loss: 0.7487
  Epoch 9 [Batch 7/11]: Loss: 1.1504
  Epoch 9 [Batch 8/11]: Loss: 0.7731
  Epoch 9 [Batch 9/11]: Loss: 1.0026
  Epoch 9 [Batch 10/11]: Loss: 1.5653
  Epoch 9 Train Summary: Avg Loss: 0.9673, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1452, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 0.7991
  Epoch 10 [Batch 1/11]: Loss: 1.0539
  Epoch 10 [Batch 2/11]: Loss: 1.1212
  Epoch 10 [Batch 3/11]: Loss: 1.0843
  Epoch 10 [Batch 4/11]: Loss: 0.8285
  Epoch 10 [Batch 5/11]: Loss: 0.7928
  Epoch 10 [Batch 6/11]: Loss: 1.0161
  Epoch 10 [Batch 7/11]: Loss: 0.8366
  Epoch 10 [Batch 8/11]: Loss: 0.8584
  Epoch 10 [Batch 9/11]: Loss: 0.7263
  Epoch 10 [Batch 10/11]: Loss: 1.0965
  Epoch 10 Train Summary: Avg Loss: 0.9285, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1161, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 0.7716
  Epoch 11 [Batch 1/11]: Loss: 0.7603
  Epoch 11 [Batch 2/11]: Loss: 0.8922
  Epoch 11 [Batch 3/11]: Loss: 0.7130
  Epoch 11 [Batch 4/11]: Loss: 0.8861
  Epoch 11 [Batch 5/11]: Loss: 1.1430
  Epoch 11 [Batch 6/11]: Loss: 0.8996
  Epoch 11 [Batch 7/11]: Loss: 1.2828
  Epoch 11 [Batch 8/11]: Loss: 0.9881
  Epoch 11 [Batch 9/11]: Loss: 0.8532
  Epoch 11 [Batch 10/11]: Loss: 1.2109
  Epoch 11 Train Summary: Avg Loss: 0.9455, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1460, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.8828
  Epoch 12 [Batch 1/11]: Loss: 1.4057
  Epoch 12 [Batch 2/11]: Loss: 0.7744
  Epoch 12 [Batch 3/11]: Loss: 0.8738
  Epoch 12 [Batch 4/11]: Loss: 0.9050
  Epoch 12 [Batch 5/11]: Loss: 0.8199
  Epoch 12 [Batch 6/11]: Loss: 0.6736
  Epoch 12 [Batch 7/11]: Loss: 0.9607
  Epoch 12 [Batch 8/11]: Loss: 0.9482
  Epoch 12 [Batch 9/11]: Loss: 0.9118
  Epoch 12 [Batch 10/11]: Loss: 0.8918
  Epoch 12 Train Summary: Avg Loss: 0.9134, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1592, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 1.0432
  Epoch 13 [Batch 1/11]: Loss: 1.0943
  Epoch 13 [Batch 2/11]: Loss: 0.8452
  Epoch 13 [Batch 3/11]: Loss: 0.9944
  Epoch 13 [Batch 4/11]: Loss: 1.0479
  Epoch 13 [Batch 5/11]: Loss: 0.7345
  Epoch 13 [Batch 6/11]: Loss: 0.8568
  Epoch 13 [Batch 7/11]: Loss: 0.8658
  Epoch 13 [Batch 8/11]: Loss: 0.6981
  Epoch 13 [Batch 9/11]: Loss: 1.1108
  Epoch 13 [Batch 10/11]: Loss: 0.6189
  Epoch 13 Train Summary: Avg Loss: 0.9009, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1484, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.6382
  Epoch 14 [Batch 1/11]: Loss: 0.7413
  Epoch 14 [Batch 2/11]: Loss: 0.8844
  Epoch 14 [Batch 3/11]: Loss: 0.8109
  Epoch 14 [Batch 4/11]: Loss: 1.0994
  Epoch 14 [Batch 5/11]: Loss: 1.0930
  Epoch 14 [Batch 6/11]: Loss: 0.8738
  Epoch 14 [Batch 7/11]: Loss: 0.8424
  Epoch 14 [Batch 8/11]: Loss: 1.0834
  Epoch 14 [Batch 9/11]: Loss: 1.1524
  Epoch 14 [Batch 10/11]: Loss: 0.7853
  Epoch 14 Train Summary: Avg Loss: 0.9095, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1514, Accuracy: 0.3333, F1 (Macro): 0.2222
Training finished in 1.04 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.0968, Accuracy: 0.3667, F1 (Macro): 0.3485
Final Best Model Stats: Acc: 0.3667, F1: 0.3485, Loss: 1.0968
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=5e-05 drop=0.0 seed=42
================================================================================
Starting experiment: resnet50__384x384__lr-5e-05__drop-0.0__seed-42
Output directory: results_ceph/resnet50__384x384__lr-5e-05__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.1095
  Epoch 0 [Batch 1/11]: Loss: 1.1210
  Epoch 0 [Batch 2/11]: Loss: 1.1144
  Epoch 0 [Batch 3/11]: Loss: 1.1069
  Epoch 0 [Batch 4/11]: Loss: 1.1303
  Epoch 0 [Batch 5/11]: Loss: 1.1122
  Epoch 0 [Batch 6/11]: Loss: 1.1223
  Epoch 0 [Batch 7/11]: Loss: 1.1075
  Epoch 0 [Batch 8/11]: Loss: 1.1119
  Epoch 0 [Batch 9/11]: Loss: 1.1126
  Epoch 0 [Batch 10/11]: Loss: 1.1029
  Epoch 0 Train Summary: Avg Loss: 1.1138, Accuracy: 0.3186
  Validation Summary: Avg Loss: 1.1031, Accuracy: 0.2833, F1 (Macro): 0.2619
  New best model! Val loss improved from inf to 1.1031. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.1007
  Epoch 1 [Batch 1/11]: Loss: 1.1003
  Epoch 1 [Batch 2/11]: Loss: 1.0836
  Epoch 1 [Batch 3/11]: Loss: 1.0835
  Epoch 1 [Batch 4/11]: Loss: 1.0861
  Epoch 1 [Batch 5/11]: Loss: 1.0877
  Epoch 1 [Batch 6/11]: Loss: 1.0686
  Epoch 1 [Batch 7/11]: Loss: 1.0749
  Epoch 1 [Batch 8/11]: Loss: 1.0629
  Epoch 1 [Batch 9/11]: Loss: 1.0742
  Epoch 1 [Batch 10/11]: Loss: 1.1235
  Epoch 1 Train Summary: Avg Loss: 1.0860, Accuracy: 0.2849
  Validation Summary: Avg Loss: 1.0954, Accuracy: 0.3333, F1 (Macro): 0.2222
  New best model! Val loss improved from 1.1031 to 1.0954. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 1.0852
  Epoch 2 [Batch 1/11]: Loss: 1.0683
  Epoch 2 [Batch 2/11]: Loss: 1.0725
  Epoch 2 [Batch 3/11]: Loss: 1.0851
  Epoch 2 [Batch 4/11]: Loss: 1.0775
  Epoch 2 [Batch 5/11]: Loss: 1.0594
  Epoch 2 [Batch 6/11]: Loss: 1.0586
  Epoch 2 [Batch 7/11]: Loss: 1.0121
  Epoch 2 [Batch 8/11]: Loss: 1.0061
  Epoch 2 [Batch 9/11]: Loss: 1.0388
  Epoch 2 [Batch 10/11]: Loss: 0.9753
  Epoch 2 Train Summary: Avg Loss: 1.0490, Accuracy: 0.3462
  Validation Summary: Avg Loss: 1.0925, Accuracy: 0.3333, F1 (Macro): 0.2222
  New best model! Val loss improved from 1.0954 to 1.0925. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 1.0530
  Epoch 3 [Batch 1/11]: Loss: 1.0100
  Epoch 3 [Batch 2/11]: Loss: 1.0524
  Epoch 3 [Batch 3/11]: Loss: 0.9483
  Epoch 3 [Batch 4/11]: Loss: 1.0835
  Epoch 3 [Batch 5/11]: Loss: 1.1164
  Epoch 3 [Batch 6/11]: Loss: 0.9600
  Epoch 3 [Batch 7/11]: Loss: 0.9895
  Epoch 3 [Batch 8/11]: Loss: 1.0119
  Epoch 3 [Batch 9/11]: Loss: 1.0219
  Epoch 3 [Batch 10/11]: Loss: 1.0960
  Epoch 3 Train Summary: Avg Loss: 1.0312, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0873, Accuracy: 0.3333, F1 (Macro): 0.2222
  New best model! Val loss improved from 1.0925 to 1.0873. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 0.9724
  Epoch 4 [Batch 1/11]: Loss: 1.0821
  Epoch 4 [Batch 2/11]: Loss: 1.1435
  Epoch 4 [Batch 3/11]: Loss: 0.9464
  Epoch 4 [Batch 4/11]: Loss: 0.9649
  Epoch 4 [Batch 5/11]: Loss: 1.0388
  Epoch 4 [Batch 6/11]: Loss: 0.8940
  Epoch 4 [Batch 7/11]: Loss: 1.0460
  Epoch 4 [Batch 8/11]: Loss: 0.9601
  Epoch 4 [Batch 9/11]: Loss: 0.9187
  Epoch 4 [Batch 10/11]: Loss: 1.2484
  Epoch 4 Train Summary: Avg Loss: 1.0196, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0899, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 1.0289
  Epoch 5 [Batch 1/11]: Loss: 0.9364
  Epoch 5 [Batch 2/11]: Loss: 0.9329
  Epoch 5 [Batch 3/11]: Loss: 0.9531
  Epoch 5 [Batch 4/11]: Loss: 1.0695
  Epoch 5 [Batch 5/11]: Loss: 0.9527
  Epoch 5 [Batch 6/11]: Loss: 0.9695
  Epoch 5 [Batch 7/11]: Loss: 0.9374
  Epoch 5 [Batch 8/11]: Loss: 1.0530
  Epoch 5 [Batch 9/11]: Loss: 1.0357
  Epoch 5 [Batch 10/11]: Loss: 1.1457
  Epoch 5 Train Summary: Avg Loss: 1.0014, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1057, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 0.8890
  Epoch 6 [Batch 1/11]: Loss: 1.0354
  Epoch 6 [Batch 2/11]: Loss: 1.0448
  Epoch 6 [Batch 3/11]: Loss: 1.1069
  Epoch 6 [Batch 4/11]: Loss: 0.8926
  Epoch 6 [Batch 5/11]: Loss: 0.9439
  Epoch 6 [Batch 6/11]: Loss: 1.0925
  Epoch 6 [Batch 7/11]: Loss: 0.8213
  Epoch 6 [Batch 8/11]: Loss: 1.0652
  Epoch 6 [Batch 9/11]: Loss: 0.8967
  Epoch 6 [Batch 10/11]: Loss: 0.7843
  Epoch 6 Train Summary: Avg Loss: 0.9611, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1017, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.9606
  Epoch 7 [Batch 1/11]: Loss: 0.8944
  Epoch 7 [Batch 2/11]: Loss: 0.7803
  Epoch 7 [Batch 3/11]: Loss: 1.0094
  Epoch 7 [Batch 4/11]: Loss: 1.0525
  Epoch 7 [Batch 5/11]: Loss: 1.0250
  Epoch 7 [Batch 6/11]: Loss: 0.8754
  Epoch 7 [Batch 7/11]: Loss: 1.0095
  Epoch 7 [Batch 8/11]: Loss: 0.9916
  Epoch 7 [Batch 9/11]: Loss: 0.9520
  Epoch 7 [Batch 10/11]: Loss: 1.0803
  Epoch 7 Train Summary: Avg Loss: 0.9665, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1126, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 1.1814
  Epoch 8 [Batch 1/11]: Loss: 1.0524
  Epoch 8 [Batch 2/11]: Loss: 0.8372
  Epoch 8 [Batch 3/11]: Loss: 0.9061
  Epoch 8 [Batch 4/11]: Loss: 0.8304
  Epoch 8 [Batch 5/11]: Loss: 1.0892
  Epoch 8 [Batch 6/11]: Loss: 1.0053
  Epoch 8 [Batch 7/11]: Loss: 0.9891
  Epoch 8 [Batch 8/11]: Loss: 0.7151
  Epoch 8 [Batch 9/11]: Loss: 0.9212
  Epoch 8 [Batch 10/11]: Loss: 0.7087
  Epoch 8 Train Summary: Avg Loss: 0.9306, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1172, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 1.0047
  Epoch 9 [Batch 1/11]: Loss: 0.9487
  Epoch 9 [Batch 2/11]: Loss: 0.8424
  Epoch 9 [Batch 3/11]: Loss: 1.0483
  Epoch 9 [Batch 4/11]: Loss: 0.9041
  Epoch 9 [Batch 5/11]: Loss: 0.8524
  Epoch 9 [Batch 6/11]: Loss: 0.9343
  Epoch 9 [Batch 7/11]: Loss: 0.9496
  Epoch 9 [Batch 8/11]: Loss: 0.9335
  Epoch 9 [Batch 9/11]: Loss: 0.9169
  Epoch 9 [Batch 10/11]: Loss: 0.7322
  Epoch 9 Train Summary: Avg Loss: 0.9152, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1240, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 0.8019
  Epoch 10 [Batch 1/11]: Loss: 0.7775
  Epoch 10 [Batch 2/11]: Loss: 0.9509
  Epoch 10 [Batch 3/11]: Loss: 0.9716
  Epoch 10 [Batch 4/11]: Loss: 1.2470
  Epoch 10 [Batch 5/11]: Loss: 0.8617
  Epoch 10 [Batch 6/11]: Loss: 0.8386
  Epoch 10 [Batch 7/11]: Loss: 0.8826
  Epoch 10 [Batch 8/11]: Loss: 0.9919
  Epoch 10 [Batch 9/11]: Loss: 1.1276
  Epoch 10 [Batch 10/11]: Loss: 0.6731
  Epoch 10 Train Summary: Avg Loss: 0.9204, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1254, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 0.9847
  Epoch 11 [Batch 1/11]: Loss: 0.9867
  Epoch 11 [Batch 2/11]: Loss: 0.9623
  Epoch 11 [Batch 3/11]: Loss: 0.9465
  Epoch 11 [Batch 4/11]: Loss: 0.6866
  Epoch 11 [Batch 5/11]: Loss: 0.9233
  Epoch 11 [Batch 6/11]: Loss: 0.8074
  Epoch 11 [Batch 7/11]: Loss: 0.9628
  Epoch 11 [Batch 8/11]: Loss: 1.2160
  Epoch 11 [Batch 9/11]: Loss: 0.8814
  Epoch 11 [Batch 10/11]: Loss: 0.7037
  Epoch 11 Train Summary: Avg Loss: 0.9147, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1283, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.9433
  Epoch 12 [Batch 1/11]: Loss: 1.0868
  Epoch 12 [Batch 2/11]: Loss: 0.6757
  Epoch 12 [Batch 3/11]: Loss: 0.8785
  Epoch 12 [Batch 4/11]: Loss: 1.0692
  Epoch 12 [Batch 5/11]: Loss: 0.8084
  Epoch 12 [Batch 6/11]: Loss: 0.9517
  Epoch 12 [Batch 7/11]: Loss: 0.8862
  Epoch 12 [Batch 8/11]: Loss: 1.0450
  Epoch 12 [Batch 9/11]: Loss: 0.7580
  Epoch 12 [Batch 10/11]: Loss: 1.2436
  Epoch 12 Train Summary: Avg Loss: 0.9406, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1424, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 0.8280
  Epoch 13 [Batch 1/11]: Loss: 0.9093
  Epoch 13 [Batch 2/11]: Loss: 0.8164
  Epoch 13 [Batch 3/11]: Loss: 1.0008
  Epoch 13 [Batch 4/11]: Loss: 0.9524
  Epoch 13 [Batch 5/11]: Loss: 1.0030
  Epoch 13 [Batch 6/11]: Loss: 1.0931
  Epoch 13 [Batch 7/11]: Loss: 0.8924
  Epoch 13 [Batch 8/11]: Loss: 0.9309
  Epoch 13 [Batch 9/11]: Loss: 0.8414
  Epoch 13 [Batch 10/11]: Loss: 0.9538
  Epoch 13 Train Summary: Avg Loss: 0.9292, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1465, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.7755
  Epoch 14 [Batch 1/11]: Loss: 1.0860
  Epoch 14 [Batch 2/11]: Loss: 0.7221
  Epoch 14 [Batch 3/11]: Loss: 0.7043
  Epoch 14 [Batch 4/11]: Loss: 0.7977
  Epoch 14 [Batch 5/11]: Loss: 0.8878
  Epoch 14 [Batch 6/11]: Loss: 1.0333
  Epoch 14 [Batch 7/11]: Loss: 1.0339
  Epoch 14 [Batch 8/11]: Loss: 0.9695
  Epoch 14 [Batch 9/11]: Loss: 0.9310
  Epoch 14 [Batch 10/11]: Loss: 1.6685
  Epoch 14 Train Summary: Avg Loss: 0.9645, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1497, Accuracy: 0.3333, F1 (Macro): 0.2222
Training finished in 1.17 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.0873, Accuracy: 0.3333, F1 (Macro): 0.2222
Final Best Model Stats: Acc: 0.3333, F1: 0.2222, Loss: 1.0873
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=5e-05 drop=0.0 seed=123
================================================================================
Starting experiment: resnet50__384x384__lr-5e-05__drop-0.0__seed-123
Output directory: results_ceph/resnet50__384x384__lr-5e-05__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.1034
  Epoch 0 [Batch 1/11]: Loss: 1.0961
  Epoch 0 [Batch 2/11]: Loss: 1.1062
  Epoch 0 [Batch 3/11]: Loss: 1.1054
  Epoch 0 [Batch 4/11]: Loss: 1.0906
  Epoch 0 [Batch 5/11]: Loss: 1.0920
  Epoch 0 [Batch 6/11]: Loss: 1.0848
  Epoch 0 [Batch 7/11]: Loss: 1.0903
  Epoch 0 [Batch 8/11]: Loss: 1.0929
  Epoch 0 [Batch 9/11]: Loss: 1.1191
  Epoch 0 [Batch 10/11]: Loss: 1.0597
  Epoch 0 Train Summary: Avg Loss: 1.0946, Accuracy: 0.2949
  Validation Summary: Avg Loss: 1.0857, Accuracy: 0.3333, F1 (Macro): 0.1905
  New best model! Val loss improved from inf to 1.0857. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.0787
  Epoch 1 [Batch 1/11]: Loss: 1.1079
  Epoch 1 [Batch 2/11]: Loss: 1.0735
  Epoch 1 [Batch 3/11]: Loss: 1.0696
  Epoch 1 [Batch 4/11]: Loss: 1.0584
  Epoch 1 [Batch 5/11]: Loss: 1.0479
  Epoch 1 [Batch 6/11]: Loss: 1.0410
  Epoch 1 [Batch 7/11]: Loss: 1.0556
  Epoch 1 [Batch 8/11]: Loss: 1.0464
  Epoch 1 [Batch 9/11]: Loss: 1.0875
  Epoch 1 [Batch 10/11]: Loss: 1.1527
  Epoch 1 Train Summary: Avg Loss: 1.0745, Accuracy: 0.4017
  Validation Summary: Avg Loss: 1.0865, Accuracy: 0.3667, F1 (Macro): 0.3481

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 1.0461
  Epoch 2 [Batch 1/11]: Loss: 1.0827
  Epoch 2 [Batch 2/11]: Loss: 1.0347
  Epoch 2 [Batch 3/11]: Loss: 1.1062
  Epoch 2 [Batch 4/11]: Loss: 1.0726
  Epoch 2 [Batch 5/11]: Loss: 0.9880
  Epoch 2 [Batch 6/11]: Loss: 1.0562
  Epoch 2 [Batch 7/11]: Loss: 1.0369
  Epoch 2 [Batch 8/11]: Loss: 1.0221
  Epoch 2 [Batch 9/11]: Loss: 1.0095
  Epoch 2 [Batch 10/11]: Loss: 1.0105
  Epoch 2 Train Summary: Avg Loss: 1.0423, Accuracy: 0.3313
  Validation Summary: Avg Loss: 1.0824, Accuracy: 0.4333, F1 (Macro): 0.4091
  New best model! Val loss improved from 1.0857 to 1.0824. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 1.0177
  Epoch 3 [Batch 1/11]: Loss: 1.0571
  Epoch 3 [Batch 2/11]: Loss: 1.1306
  Epoch 3 [Batch 3/11]: Loss: 1.0157
  Epoch 3 [Batch 4/11]: Loss: 1.0028
  Epoch 3 [Batch 5/11]: Loss: 0.9634
  Epoch 3 [Batch 6/11]: Loss: 1.0051
  Epoch 3 [Batch 7/11]: Loss: 1.0631
  Epoch 3 [Batch 8/11]: Loss: 1.0289
  Epoch 3 [Batch 9/11]: Loss: 1.0088
  Epoch 3 [Batch 10/11]: Loss: 0.9982
  Epoch 3 Train Summary: Avg Loss: 1.0265, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0857, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 1.0817
  Epoch 4 [Batch 1/11]: Loss: 1.0435
  Epoch 4 [Batch 2/11]: Loss: 1.0175
  Epoch 4 [Batch 3/11]: Loss: 0.9596
  Epoch 4 [Batch 4/11]: Loss: 1.0137
  Epoch 4 [Batch 5/11]: Loss: 1.0304
  Epoch 4 [Batch 6/11]: Loss: 0.9662
  Epoch 4 [Batch 7/11]: Loss: 0.9754
  Epoch 4 [Batch 8/11]: Loss: 1.0299
  Epoch 4 [Batch 9/11]: Loss: 0.9709
  Epoch 4 [Batch 10/11]: Loss: 0.8732
  Epoch 4 Train Summary: Avg Loss: 0.9966, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0770, Accuracy: 0.3333, F1 (Macro): 0.2222
  New best model! Val loss improved from 1.0824 to 1.0770. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 1.0509
  Epoch 5 [Batch 1/11]: Loss: 0.9451
  Epoch 5 [Batch 2/11]: Loss: 1.0915
  Epoch 5 [Batch 3/11]: Loss: 0.9686
  Epoch 5 [Batch 4/11]: Loss: 1.0828
  Epoch 5 [Batch 5/11]: Loss: 0.9423
  Epoch 5 [Batch 6/11]: Loss: 1.0211
  Epoch 5 [Batch 7/11]: Loss: 0.8958
  Epoch 5 [Batch 8/11]: Loss: 1.0352
  Epoch 5 [Batch 9/11]: Loss: 0.9082
  Epoch 5 [Batch 10/11]: Loss: 0.9896
  Epoch 5 Train Summary: Avg Loss: 0.9937, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0918, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 1.0337
  Epoch 6 [Batch 1/11]: Loss: 0.9351
  Epoch 6 [Batch 2/11]: Loss: 0.8918
  Epoch 6 [Batch 3/11]: Loss: 1.0734
  Epoch 6 [Batch 4/11]: Loss: 0.9752
  Epoch 6 [Batch 5/11]: Loss: 0.9710
  Epoch 6 [Batch 6/11]: Loss: 0.8582
  Epoch 6 [Batch 7/11]: Loss: 0.8804
  Epoch 6 [Batch 8/11]: Loss: 1.0874
  Epoch 6 [Batch 9/11]: Loss: 1.0846
  Epoch 6 [Batch 10/11]: Loss: 0.7630
  Epoch 6 Train Summary: Avg Loss: 0.9594, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0940, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.7990
  Epoch 7 [Batch 1/11]: Loss: 0.9720
  Epoch 7 [Batch 2/11]: Loss: 0.9604
  Epoch 7 [Batch 3/11]: Loss: 1.0148
  Epoch 7 [Batch 4/11]: Loss: 0.9634
  Epoch 7 [Batch 5/11]: Loss: 0.9859
  Epoch 7 [Batch 6/11]: Loss: 1.0059
  Epoch 7 [Batch 7/11]: Loss: 1.1509
  Epoch 7 [Batch 8/11]: Loss: 0.8871
  Epoch 7 [Batch 9/11]: Loss: 0.9231
  Epoch 7 [Batch 10/11]: Loss: 0.7199
  Epoch 7 Train Summary: Avg Loss: 0.9439, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0998, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 0.7900
  Epoch 8 [Batch 1/11]: Loss: 0.8933
  Epoch 8 [Batch 2/11]: Loss: 0.9536
  Epoch 8 [Batch 3/11]: Loss: 0.8006
  Epoch 8 [Batch 4/11]: Loss: 1.1686
  Epoch 8 [Batch 5/11]: Loss: 0.9624
  Epoch 8 [Batch 6/11]: Loss: 1.1286
  Epoch 8 [Batch 7/11]: Loss: 0.8525
  Epoch 8 [Batch 8/11]: Loss: 0.8472
  Epoch 8 [Batch 9/11]: Loss: 0.9391
  Epoch 8 [Batch 10/11]: Loss: 0.9818
  Epoch 8 Train Summary: Avg Loss: 0.9380, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0984, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 0.7691
  Epoch 9 [Batch 1/11]: Loss: 1.0458
  Epoch 9 [Batch 2/11]: Loss: 1.1600
  Epoch 9 [Batch 3/11]: Loss: 0.7811
  Epoch 9 [Batch 4/11]: Loss: 0.8894
  Epoch 9 [Batch 5/11]: Loss: 1.0957
  Epoch 9 [Batch 6/11]: Loss: 0.9279
  Epoch 9 [Batch 7/11]: Loss: 1.0392
  Epoch 9 [Batch 8/11]: Loss: 0.8765
  Epoch 9 [Batch 9/11]: Loss: 0.9133
  Epoch 9 [Batch 10/11]: Loss: 0.6406
  Epoch 9 Train Summary: Avg Loss: 0.9217, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0965, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 1.0738
  Epoch 10 [Batch 1/11]: Loss: 0.6852
  Epoch 10 [Batch 2/11]: Loss: 0.9694
  Epoch 10 [Batch 3/11]: Loss: 0.9770
  Epoch 10 [Batch 4/11]: Loss: 0.9832
  Epoch 10 [Batch 5/11]: Loss: 0.6844
  Epoch 10 [Batch 6/11]: Loss: 1.2033
  Epoch 10 [Batch 7/11]: Loss: 1.0909
  Epoch 10 [Batch 8/11]: Loss: 0.6622
  Epoch 10 [Batch 9/11]: Loss: 0.8910
  Epoch 10 [Batch 10/11]: Loss: 1.3682
  Epoch 10 Train Summary: Avg Loss: 0.9626, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1084, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 0.8743
  Epoch 11 [Batch 1/11]: Loss: 0.7765
  Epoch 11 [Batch 2/11]: Loss: 0.9927
  Epoch 11 [Batch 3/11]: Loss: 0.8486
  Epoch 11 [Batch 4/11]: Loss: 1.0845
  Epoch 11 [Batch 5/11]: Loss: 1.4196
  Epoch 11 [Batch 6/11]: Loss: 0.7793
  Epoch 11 [Batch 7/11]: Loss: 0.7481
  Epoch 11 [Batch 8/11]: Loss: 0.8896
  Epoch 11 [Batch 9/11]: Loss: 0.8647
  Epoch 11 [Batch 10/11]: Loss: 1.1709
  Epoch 11 Train Summary: Avg Loss: 0.9499, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1225, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.9757
  Epoch 12 [Batch 1/11]: Loss: 1.0081
  Epoch 12 [Batch 2/11]: Loss: 0.8278
  Epoch 12 [Batch 3/11]: Loss: 0.9034
  Epoch 12 [Batch 4/11]: Loss: 0.9170
  Epoch 12 [Batch 5/11]: Loss: 0.8768
  Epoch 12 [Batch 6/11]: Loss: 0.7709
  Epoch 12 [Batch 7/11]: Loss: 0.8360
  Epoch 12 [Batch 8/11]: Loss: 0.8513
  Epoch 12 [Batch 9/11]: Loss: 1.1287
  Epoch 12 [Batch 10/11]: Loss: 1.0696
  Epoch 12 Train Summary: Avg Loss: 0.9241, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1096, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 1.0151
  Epoch 13 [Batch 1/11]: Loss: 0.7621
  Epoch 13 [Batch 2/11]: Loss: 0.9731
  Epoch 13 [Batch 3/11]: Loss: 1.0136
  Epoch 13 [Batch 4/11]: Loss: 0.8488
  Epoch 13 [Batch 5/11]: Loss: 1.1418
  Epoch 13 [Batch 6/11]: Loss: 0.7785
  Epoch 13 [Batch 7/11]: Loss: 1.1408
  Epoch 13 [Batch 8/11]: Loss: 0.8718
  Epoch 13 [Batch 9/11]: Loss: 0.7722
  Epoch 13 [Batch 10/11]: Loss: 0.6236
  Epoch 13 Train Summary: Avg Loss: 0.9037, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1171, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.8330
  Epoch 14 [Batch 1/11]: Loss: 0.9721
  Epoch 14 [Batch 2/11]: Loss: 0.7314
  Epoch 14 [Batch 3/11]: Loss: 1.0320
  Epoch 14 [Batch 4/11]: Loss: 0.9572
  Epoch 14 [Batch 5/11]: Loss: 0.8031
  Epoch 14 [Batch 6/11]: Loss: 0.9241
  Epoch 14 [Batch 7/11]: Loss: 0.8621
  Epoch 14 [Batch 8/11]: Loss: 1.0948
  Epoch 14 [Batch 9/11]: Loss: 0.8268
  Epoch 14 [Batch 10/11]: Loss: 1.5367
  Epoch 14 Train Summary: Avg Loss: 0.9612, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1210, Accuracy: 0.3333, F1 (Macro): 0.2222
Training finished in 1.13 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.0770, Accuracy: 0.3333, F1 (Macro): 0.2222
Final Best Model Stats: Acc: 0.3333, F1: 0.2222, Loss: 1.0770
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=5e-05 drop=0.0 seed=999
================================================================================
Starting experiment: resnet50__384x384__lr-5e-05__drop-0.0__seed-999
Output directory: results_ceph/resnet50__384x384__lr-5e-05__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.1401
  Epoch 0 [Batch 1/11]: Loss: 1.1183
  Epoch 0 [Batch 2/11]: Loss: 1.1356
  Epoch 0 [Batch 3/11]: Loss: 1.1046
  Epoch 0 [Batch 4/11]: Loss: 1.1316
  Epoch 0 [Batch 5/11]: Loss: 1.1026
  Epoch 0 [Batch 6/11]: Loss: 1.0972
  Epoch 0 [Batch 7/11]: Loss: 1.1072
  Epoch 0 [Batch 8/11]: Loss: 1.1188
  Epoch 0 [Batch 9/11]: Loss: 1.1235
  Epoch 0 [Batch 10/11]: Loss: 1.1172
  Epoch 0 Train Summary: Avg Loss: 1.1179, Accuracy: 0.2960
  Validation Summary: Avg Loss: 1.0979, Accuracy: 0.1667, F1 (Macro): 0.1333
  New best model! Val loss improved from inf to 1.0979. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.0726
  Epoch 1 [Batch 1/11]: Loss: 1.1053
  Epoch 1 [Batch 2/11]: Loss: 1.1004
  Epoch 1 [Batch 3/11]: Loss: 1.0974
  Epoch 1 [Batch 4/11]: Loss: 1.0958
  Epoch 1 [Batch 5/11]: Loss: 1.0795
  Epoch 1 [Batch 6/11]: Loss: 1.0917
  Epoch 1 [Batch 7/11]: Loss: 1.0924
  Epoch 1 [Batch 8/11]: Loss: 1.0815
  Epoch 1 [Batch 9/11]: Loss: 1.0745
  Epoch 1 [Batch 10/11]: Loss: 1.0918
  Epoch 1 Train Summary: Avg Loss: 1.0894, Accuracy: 0.2786
  Validation Summary: Avg Loss: 1.1013, Accuracy: 0.3167, F1 (Macro): 0.2619

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 1.0827
  Epoch 2 [Batch 1/11]: Loss: 1.0554
  Epoch 2 [Batch 2/11]: Loss: 1.0619
  Epoch 2 [Batch 3/11]: Loss: 1.0402
  Epoch 2 [Batch 4/11]: Loss: 1.0635
  Epoch 2 [Batch 5/11]: Loss: 1.0434
  Epoch 2 [Batch 6/11]: Loss: 1.0628
  Epoch 2 [Batch 7/11]: Loss: 1.0935
  Epoch 2 [Batch 8/11]: Loss: 1.0645
  Epoch 2 [Batch 9/11]: Loss: 1.0466
  Epoch 2 [Batch 10/11]: Loss: 1.0577
  Epoch 2 Train Summary: Avg Loss: 1.0611, Accuracy: 0.3544
  Validation Summary: Avg Loss: 1.0945, Accuracy: 0.3833, F1 (Macro): 0.3481
  New best model! Val loss improved from 1.0979 to 1.0945. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 1.0660
  Epoch 3 [Batch 1/11]: Loss: 1.0312
  Epoch 3 [Batch 2/11]: Loss: 1.0496
  Epoch 3 [Batch 3/11]: Loss: 1.0220
  Epoch 3 [Batch 4/11]: Loss: 1.0715
  Epoch 3 [Batch 5/11]: Loss: 1.0719
  Epoch 3 [Batch 6/11]: Loss: 1.0256
  Epoch 3 [Batch 7/11]: Loss: 1.0351
  Epoch 3 [Batch 8/11]: Loss: 1.0541
  Epoch 3 [Batch 9/11]: Loss: 1.0048
  Epoch 3 [Batch 10/11]: Loss: 1.0056
  Epoch 3 Train Summary: Avg Loss: 1.0398, Accuracy: 0.3387
  Validation Summary: Avg Loss: 1.0928, Accuracy: 0.2667, F1 (Macro): 0.1905
  New best model! Val loss improved from 1.0945 to 1.0928. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 1.0318
  Epoch 4 [Batch 1/11]: Loss: 1.0025
  Epoch 4 [Batch 2/11]: Loss: 1.0330
  Epoch 4 [Batch 3/11]: Loss: 1.0328
  Epoch 4 [Batch 4/11]: Loss: 1.0054
  Epoch 4 [Batch 5/11]: Loss: 0.9871
  Epoch 4 [Batch 6/11]: Loss: 1.0477
  Epoch 4 [Batch 7/11]: Loss: 1.0763
  Epoch 4 [Batch 8/11]: Loss: 0.9786
  Epoch 4 [Batch 9/11]: Loss: 1.0683
  Epoch 4 [Batch 10/11]: Loss: 0.9077
  Epoch 4 Train Summary: Avg Loss: 1.0156, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.0976, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 0.9659
  Epoch 5 [Batch 1/11]: Loss: 0.9966
  Epoch 5 [Batch 2/11]: Loss: 0.9834
  Epoch 5 [Batch 3/11]: Loss: 0.9966
  Epoch 5 [Batch 4/11]: Loss: 1.0015
  Epoch 5 [Batch 5/11]: Loss: 1.0976
  Epoch 5 [Batch 6/11]: Loss: 0.9522
  Epoch 5 [Batch 7/11]: Loss: 1.0429
  Epoch 5 [Batch 8/11]: Loss: 0.9827
  Epoch 5 [Batch 9/11]: Loss: 1.0523
  Epoch 5 [Batch 10/11]: Loss: 0.8655
  Epoch 5 Train Summary: Avg Loss: 0.9943, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1015, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 1.1428
  Epoch 6 [Batch 1/11]: Loss: 0.9816
  Epoch 6 [Batch 2/11]: Loss: 0.9830
  Epoch 6 [Batch 3/11]: Loss: 0.9164
  Epoch 6 [Batch 4/11]: Loss: 0.9659
  Epoch 6 [Batch 5/11]: Loss: 1.0235
  Epoch 6 [Batch 6/11]: Loss: 1.0660
  Epoch 6 [Batch 7/11]: Loss: 0.9785
  Epoch 6 [Batch 8/11]: Loss: 1.0095
  Epoch 6 [Batch 9/11]: Loss: 0.8800
  Epoch 6 [Batch 10/11]: Loss: 0.9728
  Epoch 6 Train Summary: Avg Loss: 0.9927, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1087, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.8896
  Epoch 7 [Batch 1/11]: Loss: 0.9942
  Epoch 7 [Batch 2/11]: Loss: 1.2277
  Epoch 7 [Batch 3/11]: Loss: 0.9181
  Epoch 7 [Batch 4/11]: Loss: 0.9117
  Epoch 7 [Batch 5/11]: Loss: 0.9275
  Epoch 7 [Batch 6/11]: Loss: 1.0747
  Epoch 7 [Batch 7/11]: Loss: 1.0363
  Epoch 7 [Batch 8/11]: Loss: 0.8488
  Epoch 7 [Batch 9/11]: Loss: 0.9801
  Epoch 7 [Batch 10/11]: Loss: 0.7979
  Epoch 7 Train Summary: Avg Loss: 0.9642, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1087, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 1.0983
  Epoch 8 [Batch 1/11]: Loss: 0.8310
  Epoch 8 [Batch 2/11]: Loss: 1.0604
  Epoch 8 [Batch 3/11]: Loss: 0.9338
  Epoch 8 [Batch 4/11]: Loss: 0.9845
  Epoch 8 [Batch 5/11]: Loss: 1.1322
  Epoch 8 [Batch 6/11]: Loss: 0.8130
  Epoch 8 [Batch 7/11]: Loss: 0.9591
  Epoch 8 [Batch 8/11]: Loss: 0.8971
  Epoch 8 [Batch 9/11]: Loss: 0.8994
  Epoch 8 [Batch 10/11]: Loss: 0.7695
  Epoch 8 Train Summary: Avg Loss: 0.9435, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1271, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 0.9179
  Epoch 9 [Batch 1/11]: Loss: 0.7578
  Epoch 9 [Batch 2/11]: Loss: 0.8905
  Epoch 9 [Batch 3/11]: Loss: 0.9459
  Epoch 9 [Batch 4/11]: Loss: 0.9608
  Epoch 9 [Batch 5/11]: Loss: 1.0810
  Epoch 9 [Batch 6/11]: Loss: 0.7991
  Epoch 9 [Batch 7/11]: Loss: 1.1369
  Epoch 9 [Batch 8/11]: Loss: 0.8516
  Epoch 9 [Batch 9/11]: Loss: 1.0184
  Epoch 9 [Batch 10/11]: Loss: 1.4037
  Epoch 9 Train Summary: Avg Loss: 0.9785, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1327, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 0.8511
  Epoch 10 [Batch 1/11]: Loss: 1.0335
  Epoch 10 [Batch 2/11]: Loss: 1.0933
  Epoch 10 [Batch 3/11]: Loss: 1.0903
  Epoch 10 [Batch 4/11]: Loss: 0.9034
  Epoch 10 [Batch 5/11]: Loss: 0.8698
  Epoch 10 [Batch 6/11]: Loss: 1.0032
  Epoch 10 [Batch 7/11]: Loss: 0.8896
  Epoch 10 [Batch 8/11]: Loss: 0.9037
  Epoch 10 [Batch 9/11]: Loss: 0.7758
  Epoch 10 [Batch 10/11]: Loss: 1.1048
  Epoch 10 Train Summary: Avg Loss: 0.9562, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1181, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 0.8292
  Epoch 11 [Batch 1/11]: Loss: 0.8511
  Epoch 11 [Batch 2/11]: Loss: 0.9104
  Epoch 11 [Batch 3/11]: Loss: 0.7668
  Epoch 11 [Batch 4/11]: Loss: 0.9270
  Epoch 11 [Batch 5/11]: Loss: 1.0965
  Epoch 11 [Batch 6/11]: Loss: 0.9100
  Epoch 11 [Batch 7/11]: Loss: 1.2231
  Epoch 11 [Batch 8/11]: Loss: 1.0065
  Epoch 11 [Batch 9/11]: Loss: 0.8888
  Epoch 11 [Batch 10/11]: Loss: 1.1519
  Epoch 11 Train Summary: Avg Loss: 0.9601, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1424, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.9382
  Epoch 12 [Batch 1/11]: Loss: 1.2408
  Epoch 12 [Batch 2/11]: Loss: 0.8621
  Epoch 12 [Batch 3/11]: Loss: 0.9307
  Epoch 12 [Batch 4/11]: Loss: 0.9394
  Epoch 12 [Batch 5/11]: Loss: 0.8576
  Epoch 12 [Batch 6/11]: Loss: 0.7872
  Epoch 12 [Batch 7/11]: Loss: 0.9760
  Epoch 12 [Batch 8/11]: Loss: 0.9592
  Epoch 12 [Batch 9/11]: Loss: 0.9508
  Epoch 12 [Batch 10/11]: Loss: 0.9484
  Epoch 12 Train Summary: Avg Loss: 0.9446, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1456, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 1.0365
  Epoch 13 [Batch 1/11]: Loss: 1.1130
  Epoch 13 [Batch 2/11]: Loss: 0.8759
  Epoch 13 [Batch 3/11]: Loss: 1.0024
  Epoch 13 [Batch 4/11]: Loss: 1.0173
  Epoch 13 [Batch 5/11]: Loss: 0.8152
  Epoch 13 [Batch 6/11]: Loss: 0.8914
  Epoch 13 [Batch 7/11]: Loss: 0.9196
  Epoch 13 [Batch 8/11]: Loss: 0.7395
  Epoch 13 [Batch 9/11]: Loss: 1.0575
  Epoch 13 [Batch 10/11]: Loss: 0.6951
  Epoch 13 Train Summary: Avg Loss: 0.9239, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1432, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.7404
  Epoch 14 [Batch 1/11]: Loss: 0.8145
  Epoch 14 [Batch 2/11]: Loss: 0.9410
  Epoch 14 [Batch 3/11]: Loss: 0.8338
  Epoch 14 [Batch 4/11]: Loss: 1.0840
  Epoch 14 [Batch 5/11]: Loss: 1.0836
  Epoch 14 [Batch 6/11]: Loss: 0.8841
  Epoch 14 [Batch 7/11]: Loss: 0.8978
  Epoch 14 [Batch 8/11]: Loss: 1.0625
  Epoch 14 [Batch 9/11]: Loss: 1.1027
  Epoch 14 [Batch 10/11]: Loss: 0.8534
  Epoch 14 Train Summary: Avg Loss: 0.9362, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1515, Accuracy: 0.3333, F1 (Macro): 0.2222
Training finished in 1.06 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.0928, Accuracy: 0.2667, F1 (Macro): 0.1905
Final Best Model Stats: Acc: 0.2667, F1: 0.1905, Loss: 1.0928
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=1e-05 drop=0.0 seed=42
================================================================================
Starting experiment: resnet50__384x384__lr-1e-05__drop-0.0__seed-42
Output directory: results_ceph/resnet50__384x384__lr-1e-05__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.1095
  Epoch 0 [Batch 1/11]: Loss: 1.1247
  Epoch 0 [Batch 2/11]: Loss: 1.1102
  Epoch 0 [Batch 3/11]: Loss: 1.1151
  Epoch 0 [Batch 4/11]: Loss: 1.1308
  Epoch 0 [Batch 5/11]: Loss: 1.1177
  Epoch 0 [Batch 6/11]: Loss: 1.1315
  Epoch 0 [Batch 7/11]: Loss: 1.1207
  Epoch 0 [Batch 8/11]: Loss: 1.1159
  Epoch 0 [Batch 9/11]: Loss: 1.1437
  Epoch 0 [Batch 10/11]: Loss: 1.1455
  Epoch 0 Train Summary: Avg Loss: 1.1241, Accuracy: 0.3333
  Validation Summary: Avg Loss: 1.1007, Accuracy: 0.3167, F1 (Macro): 0.2929
  New best model! Val loss improved from inf to 1.1007. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.1294
  Epoch 1 [Batch 1/11]: Loss: 1.1098
  Epoch 1 [Batch 2/11]: Loss: 1.1278
  Epoch 1 [Batch 3/11]: Loss: 1.1154
  Epoch 1 [Batch 4/11]: Loss: 1.1261
  Epoch 1 [Batch 5/11]: Loss: 1.0755
  Epoch 1 [Batch 6/11]: Loss: 1.1400
  Epoch 1 [Batch 7/11]: Loss: 1.1252
  Epoch 1 [Batch 8/11]: Loss: 1.1227
  Epoch 1 [Batch 9/11]: Loss: 1.1146
  Epoch 1 [Batch 10/11]: Loss: 1.1207
  Epoch 1 Train Summary: Avg Loss: 1.1188, Accuracy: 0.3030
  Validation Summary: Avg Loss: 1.0998, Accuracy: 0.5667, F1 (Macro): 0.4101
  New best model! Val loss improved from 1.1007 to 1.0998. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 1.1338
  Epoch 2 [Batch 1/11]: Loss: 1.0923
  Epoch 2 [Batch 2/11]: Loss: 1.1082
  Epoch 2 [Batch 3/11]: Loss: 1.1317
  Epoch 2 [Batch 4/11]: Loss: 1.0953
  Epoch 2 [Batch 5/11]: Loss: 1.1057
  Epoch 2 [Batch 6/11]: Loss: 1.1075
  Epoch 2 [Batch 7/11]: Loss: 1.1059
  Epoch 2 [Batch 8/11]: Loss: 1.1279
  Epoch 2 [Batch 9/11]: Loss: 1.1130
  Epoch 2 [Batch 10/11]: Loss: 1.1202
  Epoch 2 Train Summary: Avg Loss: 1.1129, Accuracy: 0.3361
  Validation Summary: Avg Loss: 1.0942, Accuracy: 0.2500, F1 (Macro): 0.1818
  New best model! Val loss improved from 1.0998 to 1.0942. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 1.1014
  Epoch 3 [Batch 1/11]: Loss: 1.1117
  Epoch 3 [Batch 2/11]: Loss: 1.1054
  Epoch 3 [Batch 3/11]: Loss: 1.1075
  Epoch 3 [Batch 4/11]: Loss: 1.1107
  Epoch 3 [Batch 5/11]: Loss: 1.1112
  Epoch 3 [Batch 6/11]: Loss: 1.1107
  Epoch 3 [Batch 7/11]: Loss: 1.1028
  Epoch 3 [Batch 8/11]: Loss: 1.0865
  Epoch 3 [Batch 9/11]: Loss: 1.1016
  Epoch 3 [Batch 10/11]: Loss: 1.0994
  Epoch 3 Train Summary: Avg Loss: 1.1044, Accuracy: 0.2681
  Validation Summary: Avg Loss: 1.0895, Accuracy: 0.5667, F1 (Macro): 0.4537
  New best model! Val loss improved from 1.0942 to 1.0895. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 1.0983
  Epoch 4 [Batch 1/11]: Loss: 1.1115
  Epoch 4 [Batch 2/11]: Loss: 1.1091
  Epoch 4 [Batch 3/11]: Loss: 1.0962
  Epoch 4 [Batch 4/11]: Loss: 1.0923
  Epoch 4 [Batch 5/11]: Loss: 1.0988
  Epoch 4 [Batch 6/11]: Loss: 1.1020
  Epoch 4 [Batch 7/11]: Loss: 1.0883
  Epoch 4 [Batch 8/11]: Loss: 1.0870
  Epoch 4 [Batch 9/11]: Loss: 1.1098
  Epoch 4 [Batch 10/11]: Loss: 1.1087
  Epoch 4 Train Summary: Avg Loss: 1.1002, Accuracy: 0.3914
  Validation Summary: Avg Loss: 1.0907, Accuracy: 0.6167, F1 (Macro): 0.6104

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 1.0981
  Epoch 5 [Batch 1/11]: Loss: 1.0877
  Epoch 5 [Batch 2/11]: Loss: 1.1010
  Epoch 5 [Batch 3/11]: Loss: 1.0954
  Epoch 5 [Batch 4/11]: Loss: 1.1096
  Epoch 5 [Batch 5/11]: Loss: 1.0946
  Epoch 5 [Batch 6/11]: Loss: 1.0900
  Epoch 5 [Batch 7/11]: Loss: 1.0950
  Epoch 5 [Batch 8/11]: Loss: 1.1077
  Epoch 5 [Batch 9/11]: Loss: 1.0949
  Epoch 5 [Batch 10/11]: Loss: 1.0732
  Epoch 5 Train Summary: Avg Loss: 1.0952, Accuracy: 0.3497
  Validation Summary: Avg Loss: 1.1005, Accuracy: 0.2833, F1 (Macro): 0.2619

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 1.0783
  Epoch 6 [Batch 1/11]: Loss: 1.0921
  Epoch 6 [Batch 2/11]: Loss: 1.0942
  Epoch 6 [Batch 3/11]: Loss: 1.0939
  Epoch 6 [Batch 4/11]: Loss: 1.0934
  Epoch 6 [Batch 5/11]: Loss: 1.0974
  Epoch 6 [Batch 6/11]: Loss: 1.1050
  Epoch 6 [Batch 7/11]: Loss: 1.0842
  Epoch 6 [Batch 8/11]: Loss: 1.0955
  Epoch 6 [Batch 9/11]: Loss: 1.0882
  Epoch 6 [Batch 10/11]: Loss: 1.0789
  Epoch 6 Train Summary: Avg Loss: 1.0910, Accuracy: 0.3873
  Validation Summary: Avg Loss: 1.1074, Accuracy: 0.2833, F1 (Macro): 0.2771

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 1.0924
  Epoch 7 [Batch 1/11]: Loss: 1.0937
  Epoch 7 [Batch 2/11]: Loss: 1.0788
  Epoch 7 [Batch 3/11]: Loss: 1.0870
  Epoch 7 [Batch 4/11]: Loss: 1.0884
  Epoch 7 [Batch 5/11]: Loss: 1.0895
  Epoch 7 [Batch 6/11]: Loss: 1.0758
  Epoch 7 [Batch 7/11]: Loss: 1.0866
  Epoch 7 [Batch 8/11]: Loss: 1.0823
  Epoch 7 [Batch 9/11]: Loss: 1.0765
  Epoch 7 [Batch 10/11]: Loss: 1.0834
  Epoch 7 Train Summary: Avg Loss: 1.0849, Accuracy: 0.3118
  Validation Summary: Avg Loss: 1.1130, Accuracy: 0.4333, F1 (Macro): 0.4127

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 1.1126
  Epoch 8 [Batch 1/11]: Loss: 1.0850
  Epoch 8 [Batch 2/11]: Loss: 1.0598
  Epoch 8 [Batch 3/11]: Loss: 1.0744
  Epoch 8 [Batch 4/11]: Loss: 1.0791
  Epoch 8 [Batch 5/11]: Loss: 1.1098
  Epoch 8 [Batch 6/11]: Loss: 1.0906
  Epoch 8 [Batch 7/11]: Loss: 1.0658
  Epoch 8 [Batch 8/11]: Loss: 1.0570
  Epoch 8 [Batch 9/11]: Loss: 1.0761
  Epoch 8 [Batch 10/11]: Loss: 1.0538
  Epoch 8 Train Summary: Avg Loss: 1.0785, Accuracy: 0.3313
  Validation Summary: Avg Loss: 1.1117, Accuracy: 0.2667, F1 (Macro): 0.1905

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 1.0849
  Epoch 9 [Batch 1/11]: Loss: 1.0847
  Epoch 9 [Batch 2/11]: Loss: 1.0687
  Epoch 9 [Batch 3/11]: Loss: 1.0894
  Epoch 9 [Batch 4/11]: Loss: 1.0624
  Epoch 9 [Batch 5/11]: Loss: 1.0592
  Epoch 9 [Batch 6/11]: Loss: 1.0721
  Epoch 9 [Batch 7/11]: Loss: 1.0643
  Epoch 9 [Batch 8/11]: Loss: 1.0638
  Epoch 9 [Batch 9/11]: Loss: 1.0648
  Epoch 9 [Batch 10/11]: Loss: 1.0446
  Epoch 9 Train Summary: Avg Loss: 1.0690, Accuracy: 0.3570
  Validation Summary: Avg Loss: 1.1058, Accuracy: 0.3500, F1 (Macro): 0.3162

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 1.0488
  Epoch 10 [Batch 1/11]: Loss: 1.0460
  Epoch 10 [Batch 2/11]: Loss: 1.0724
  Epoch 10 [Batch 3/11]: Loss: 1.0640
  Epoch 10 [Batch 4/11]: Loss: 1.1136
  Epoch 10 [Batch 5/11]: Loss: 1.0507
  Epoch 10 [Batch 6/11]: Loss: 1.0645
  Epoch 10 [Batch 7/11]: Loss: 1.0654
  Epoch 10 [Batch 8/11]: Loss: 1.0870
  Epoch 10 [Batch 9/11]: Loss: 1.1059
  Epoch 10 [Batch 10/11]: Loss: 1.0393
  Epoch 10 Train Summary: Avg Loss: 1.0689, Accuracy: 0.3462
  Validation Summary: Avg Loss: 1.1072, Accuracy: 0.3500, F1 (Macro): 0.3162

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 1.0817
  Epoch 11 [Batch 1/11]: Loss: 1.0774
  Epoch 11 [Batch 2/11]: Loss: 1.0581
  Epoch 11 [Batch 3/11]: Loss: 1.0531
  Epoch 11 [Batch 4/11]: Loss: 1.0281
  Epoch 11 [Batch 5/11]: Loss: 1.0761
  Epoch 11 [Batch 6/11]: Loss: 1.0417
  Epoch 11 [Batch 7/11]: Loss: 1.0824
  Epoch 11 [Batch 8/11]: Loss: 1.1046
  Epoch 11 [Batch 9/11]: Loss: 1.0455
  Epoch 11 [Batch 10/11]: Loss: 1.0033
  Epoch 11 Train Summary: Avg Loss: 1.0593, Accuracy: 0.3387
  Validation Summary: Avg Loss: 1.1045, Accuracy: 0.4167, F1 (Macro): 0.3714

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 1.0859
  Epoch 12 [Batch 1/11]: Loss: 1.1031
  Epoch 12 [Batch 2/11]: Loss: 1.0124
  Epoch 12 [Batch 3/11]: Loss: 1.0497
  Epoch 12 [Batch 4/11]: Loss: 1.0982
  Epoch 12 [Batch 5/11]: Loss: 1.0580
  Epoch 12 [Batch 6/11]: Loss: 1.0730
  Epoch 12 [Batch 7/11]: Loss: 1.0658
  Epoch 12 [Batch 8/11]: Loss: 1.0835
  Epoch 12 [Batch 9/11]: Loss: 1.0426
  Epoch 12 [Batch 10/11]: Loss: 1.1139
  Epoch 12 Train Summary: Avg Loss: 1.0715, Accuracy: 0.3259
  Validation Summary: Avg Loss: 1.1088, Accuracy: 0.3500, F1 (Macro): 0.3162

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 1.0776
  Epoch 13 [Batch 1/11]: Loss: 1.0576
  Epoch 13 [Batch 2/11]: Loss: 1.0437
  Epoch 13 [Batch 3/11]: Loss: 1.0676
  Epoch 13 [Batch 4/11]: Loss: 1.0870
  Epoch 13 [Batch 5/11]: Loss: 1.0828
  Epoch 13 [Batch 6/11]: Loss: 1.0928
  Epoch 13 [Batch 7/11]: Loss: 1.0534
  Epoch 13 [Batch 8/11]: Loss: 1.0543
  Epoch 13 [Batch 9/11]: Loss: 1.0510
  Epoch 13 [Batch 10/11]: Loss: 1.0745
  Epoch 13 Train Summary: Avg Loss: 1.0675, Accuracy: 0.3387
  Validation Summary: Avg Loss: 1.1084, Accuracy: 0.3500, F1 (Macro): 0.3162

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 1.0580
  Epoch 14 [Batch 1/11]: Loss: 1.0862
  Epoch 14 [Batch 2/11]: Loss: 1.0452
  Epoch 14 [Batch 3/11]: Loss: 1.0323
  Epoch 14 [Batch 4/11]: Loss: 1.0410
  Epoch 14 [Batch 5/11]: Loss: 1.0467
  Epoch 14 [Batch 6/11]: Loss: 1.0825
  Epoch 14 [Batch 7/11]: Loss: 1.0885
  Epoch 14 [Batch 8/11]: Loss: 1.0703
  Epoch 14 [Batch 9/11]: Loss: 1.0595
  Epoch 14 [Batch 10/11]: Loss: 1.1644
  Epoch 14 Train Summary: Avg Loss: 1.0704, Accuracy: 0.3590
  Validation Summary: Avg Loss: 1.1087, Accuracy: 0.3500, F1 (Macro): 0.3162
Training finished in 1.10 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.0895, Accuracy: 0.5667, F1 (Macro): 0.4537
Final Best Model Stats: Acc: 0.5667, F1: 0.4537, Loss: 1.0895
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=1e-05 drop=0.0 seed=123
================================================================================
Starting experiment: resnet50__384x384__lr-1e-05__drop-0.0__seed-123
Output directory: results_ceph/resnet50__384x384__lr-1e-05__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.1034
  Epoch 0 [Batch 1/11]: Loss: 1.0995
  Epoch 0 [Batch 2/11]: Loss: 1.1032
  Epoch 0 [Batch 3/11]: Loss: 1.1197
  Epoch 0 [Batch 4/11]: Loss: 1.0795
  Epoch 0 [Batch 5/11]: Loss: 1.0966
  Epoch 0 [Batch 6/11]: Loss: 1.0998
  Epoch 0 [Batch 7/11]: Loss: 1.1174
  Epoch 0 [Batch 8/11]: Loss: 1.0963
  Epoch 0 [Batch 9/11]: Loss: 1.1123
  Epoch 0 [Batch 10/11]: Loss: 1.0724
  Epoch 0 Train Summary: Avg Loss: 1.1000, Accuracy: 0.3205
  Validation Summary: Avg Loss: 1.0820, Accuracy: 0.3333, F1 (Macro): 0.1905
  New best model! Val loss improved from inf to 1.0820. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.0938
  Epoch 1 [Batch 1/11]: Loss: 1.1163
  Epoch 1 [Batch 2/11]: Loss: 1.1045
  Epoch 1 [Batch 3/11]: Loss: 1.0963
  Epoch 1 [Batch 4/11]: Loss: 1.1039
  Epoch 1 [Batch 5/11]: Loss: 1.0798
  Epoch 1 [Batch 6/11]: Loss: 1.0766
  Epoch 1 [Batch 7/11]: Loss: 1.0622
  Epoch 1 [Batch 8/11]: Loss: 1.1127
  Epoch 1 [Batch 9/11]: Loss: 1.0947
  Epoch 1 [Batch 10/11]: Loss: 1.0914
  Epoch 1 Train Summary: Avg Loss: 1.0939, Accuracy: 0.3077
  Validation Summary: Avg Loss: 1.0838, Accuracy: 0.3333, F1 (Macro): 0.1905

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 1.0929
  Epoch 2 [Batch 1/11]: Loss: 1.0936
  Epoch 2 [Batch 2/11]: Loss: 1.0740
  Epoch 2 [Batch 3/11]: Loss: 1.1154
  Epoch 2 [Batch 4/11]: Loss: 1.1055
  Epoch 2 [Batch 5/11]: Loss: 1.0943
  Epoch 2 [Batch 6/11]: Loss: 1.0869
  Epoch 2 [Batch 7/11]: Loss: 1.0818
  Epoch 2 [Batch 8/11]: Loss: 1.0756
  Epoch 2 [Batch 9/11]: Loss: 1.0820
  Epoch 2 [Batch 10/11]: Loss: 1.0671
  Epoch 2 Train Summary: Avg Loss: 1.0881, Accuracy: 0.3225
  Validation Summary: Avg Loss: 1.0839, Accuracy: 0.3333, F1 (Macro): 0.1905

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 1.0879
  Epoch 3 [Batch 1/11]: Loss: 1.1036
  Epoch 3 [Batch 2/11]: Loss: 1.1134
  Epoch 3 [Batch 3/11]: Loss: 1.0706
  Epoch 3 [Batch 4/11]: Loss: 1.0735
  Epoch 3 [Batch 5/11]: Loss: 1.0809
  Epoch 3 [Batch 6/11]: Loss: 1.0871
  Epoch 3 [Batch 7/11]: Loss: 1.1039
  Epoch 3 [Batch 8/11]: Loss: 1.0669
  Epoch 3 [Batch 9/11]: Loss: 1.0531
  Epoch 3 [Batch 10/11]: Loss: 1.0626
  Epoch 3 Train Summary: Avg Loss: 1.0821, Accuracy: 0.3670
  Validation Summary: Avg Loss: 1.0800, Accuracy: 0.3333, F1 (Macro): 0.1905
  New best model! Val loss improved from 1.0820 to 1.0800. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 1.0955
  Epoch 4 [Batch 1/11]: Loss: 1.0956
  Epoch 4 [Batch 2/11]: Loss: 1.0954
  Epoch 4 [Batch 3/11]: Loss: 1.0616
  Epoch 4 [Batch 4/11]: Loss: 1.0922
  Epoch 4 [Batch 5/11]: Loss: 1.0554
  Epoch 4 [Batch 6/11]: Loss: 1.0776
  Epoch 4 [Batch 7/11]: Loss: 1.0659
  Epoch 4 [Batch 8/11]: Loss: 1.0868
  Epoch 4 [Batch 9/11]: Loss: 1.0778
  Epoch 4 [Batch 10/11]: Loss: 1.0742
  Epoch 4 Train Summary: Avg Loss: 1.0798, Accuracy: 0.3729
  Validation Summary: Avg Loss: 1.0814, Accuracy: 0.2333, F1 (Macro): 0.2045

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 1.0892
  Epoch 5 [Batch 1/11]: Loss: 1.0834
  Epoch 5 [Batch 2/11]: Loss: 1.0834
  Epoch 5 [Batch 3/11]: Loss: 1.0732
  Epoch 5 [Batch 4/11]: Loss: 1.1090
  Epoch 5 [Batch 5/11]: Loss: 1.0570
  Epoch 5 [Batch 6/11]: Loss: 1.0622
  Epoch 5 [Batch 7/11]: Loss: 1.0604
  Epoch 5 [Batch 8/11]: Loss: 1.0547
  Epoch 5 [Batch 9/11]: Loss: 1.0650
  Epoch 5 [Batch 10/11]: Loss: 1.0479
  Epoch 5 Train Summary: Avg Loss: 1.0714, Accuracy: 0.3937
  Validation Summary: Avg Loss: 1.0883, Accuracy: 0.3167, F1 (Macro): 0.2619

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 1.0666
  Epoch 6 [Batch 1/11]: Loss: 1.0578
  Epoch 6 [Batch 2/11]: Loss: 1.0488
  Epoch 6 [Batch 3/11]: Loss: 1.0825
  Epoch 6 [Batch 4/11]: Loss: 1.0697
  Epoch 6 [Batch 5/11]: Loss: 1.0788
  Epoch 6 [Batch 6/11]: Loss: 1.0507
  Epoch 6 [Batch 7/11]: Loss: 1.0709
  Epoch 6 [Batch 8/11]: Loss: 1.0772
  Epoch 6 [Batch 9/11]: Loss: 1.1163
  Epoch 6 [Batch 10/11]: Loss: 1.0329
  Epoch 6 Train Summary: Avg Loss: 1.0684, Accuracy: 0.3889
  Validation Summary: Avg Loss: 1.0926, Accuracy: 0.3667, F1 (Macro): 0.3481

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 1.0465
  Epoch 7 [Batch 1/11]: Loss: 1.0769
  Epoch 7 [Batch 2/11]: Loss: 1.0759
  Epoch 7 [Batch 3/11]: Loss: 1.0749
  Epoch 7 [Batch 4/11]: Loss: 1.0605
  Epoch 7 [Batch 5/11]: Loss: 1.0785
  Epoch 7 [Batch 6/11]: Loss: 1.0732
  Epoch 7 [Batch 7/11]: Loss: 1.0904
  Epoch 7 [Batch 8/11]: Loss: 1.0584
  Epoch 7 [Batch 9/11]: Loss: 1.0507
  Epoch 7 [Batch 10/11]: Loss: 1.0282
  Epoch 7 Train Summary: Avg Loss: 1.0649, Accuracy: 0.3707
  Validation Summary: Avg Loss: 1.0947, Accuracy: 0.4333, F1 (Macro): 0.4091

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 1.0450
  Epoch 8 [Batch 1/11]: Loss: 1.0674
  Epoch 8 [Batch 2/11]: Loss: 1.0495
  Epoch 8 [Batch 3/11]: Loss: 1.0490
  Epoch 8 [Batch 4/11]: Loss: 1.1032
  Epoch 8 [Batch 5/11]: Loss: 1.0514
  Epoch 8 [Batch 6/11]: Loss: 1.1001
  Epoch 8 [Batch 7/11]: Loss: 1.0433
  Epoch 8 [Batch 8/11]: Loss: 1.0415
  Epoch 8 [Batch 9/11]: Loss: 1.0310
  Epoch 8 [Batch 10/11]: Loss: 1.0483
  Epoch 8 Train Summary: Avg Loss: 1.0572, Accuracy: 0.3638
  Validation Summary: Avg Loss: 1.0881, Accuracy: 0.4167, F1 (Macro): 0.3714

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 1.0315
  Epoch 9 [Batch 1/11]: Loss: 1.0993
  Epoch 9 [Batch 2/11]: Loss: 1.0866
  Epoch 9 [Batch 3/11]: Loss: 1.0331
  Epoch 9 [Batch 4/11]: Loss: 1.0486
  Epoch 9 [Batch 5/11]: Loss: 1.0799
  Epoch 9 [Batch 6/11]: Loss: 1.0350
  Epoch 9 [Batch 7/11]: Loss: 1.0843
  Epoch 9 [Batch 8/11]: Loss: 1.0464
  Epoch 9 [Batch 9/11]: Loss: 1.0612
  Epoch 9 [Batch 10/11]: Loss: 1.0356
  Epoch 9 Train Summary: Avg Loss: 1.0583, Accuracy: 0.3860
  Validation Summary: Avg Loss: 1.0854, Accuracy: 0.3500, F1 (Macro): 0.3162

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 1.0778
  Epoch 10 [Batch 1/11]: Loss: 1.0193
  Epoch 10 [Batch 2/11]: Loss: 1.0663
  Epoch 10 [Batch 3/11]: Loss: 1.0565
  Epoch 10 [Batch 4/11]: Loss: 1.0600
  Epoch 10 [Batch 5/11]: Loss: 1.0252
  Epoch 10 [Batch 6/11]: Loss: 1.1060
  Epoch 10 [Batch 7/11]: Loss: 1.0736
  Epoch 10 [Batch 8/11]: Loss: 1.0242
  Epoch 10 [Batch 9/11]: Loss: 1.0397
  Epoch 10 [Batch 10/11]: Loss: 1.1419
  Epoch 10 Train Summary: Avg Loss: 1.0628, Accuracy: 0.3644
  Validation Summary: Avg Loss: 1.0868, Accuracy: 0.3500, F1 (Macro): 0.3175

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 1.0329
  Epoch 11 [Batch 1/11]: Loss: 1.0279
  Epoch 11 [Batch 2/11]: Loss: 1.0557
  Epoch 11 [Batch 3/11]: Loss: 1.0490
  Epoch 11 [Batch 4/11]: Loss: 1.0805
  Epoch 11 [Batch 5/11]: Loss: 1.1477
  Epoch 11 [Batch 6/11]: Loss: 1.0272
  Epoch 11 [Batch 7/11]: Loss: 1.0192
  Epoch 11 [Batch 8/11]: Loss: 1.0529
  Epoch 11 [Batch 9/11]: Loss: 1.0483
  Epoch 11 [Batch 10/11]: Loss: 1.1183
  Epoch 11 Train Summary: Avg Loss: 1.0600, Accuracy: 0.3239
  Validation Summary: Avg Loss: 1.0843, Accuracy: 0.3500, F1 (Macro): 0.3175

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 1.0665
  Epoch 12 [Batch 1/11]: Loss: 1.0541
  Epoch 12 [Batch 2/11]: Loss: 1.0395
  Epoch 12 [Batch 3/11]: Loss: 1.0381
  Epoch 12 [Batch 4/11]: Loss: 1.0441
  Epoch 12 [Batch 5/11]: Loss: 1.0508
  Epoch 12 [Batch 6/11]: Loss: 1.0229
  Epoch 12 [Batch 7/11]: Loss: 1.0264
  Epoch 12 [Batch 8/11]: Loss: 1.0596
  Epoch 12 [Batch 9/11]: Loss: 1.0857
  Epoch 12 [Batch 10/11]: Loss: 1.1078
  Epoch 12 Train Summary: Avg Loss: 1.0541, Accuracy: 0.3570
  Validation Summary: Avg Loss: 1.0835, Accuracy: 0.5000, F1 (Macro): 0.4683

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 1.0882
  Epoch 13 [Batch 1/11]: Loss: 1.0292
  Epoch 13 [Batch 2/11]: Loss: 1.0632
  Epoch 13 [Batch 3/11]: Loss: 1.0466
  Epoch 13 [Batch 4/11]: Loss: 1.0374
  Epoch 13 [Batch 5/11]: Loss: 1.0913
  Epoch 13 [Batch 6/11]: Loss: 1.0254
  Epoch 13 [Batch 7/11]: Loss: 1.0860
  Epoch 13 [Batch 8/11]: Loss: 1.0728
  Epoch 13 [Batch 9/11]: Loss: 1.0363
  Epoch 13 [Batch 10/11]: Loss: 0.9968
  Epoch 13 Train Summary: Avg Loss: 1.0521, Accuracy: 0.3313
  Validation Summary: Avg Loss: 1.0848, Accuracy: 0.4167, F1 (Macro): 0.3675

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 1.0383
  Epoch 14 [Batch 1/11]: Loss: 1.0401
  Epoch 14 [Batch 2/11]: Loss: 1.0127
  Epoch 14 [Batch 3/11]: Loss: 1.0733
  Epoch 14 [Batch 4/11]: Loss: 1.0594
  Epoch 14 [Batch 5/11]: Loss: 1.0358
  Epoch 14 [Batch 6/11]: Loss: 1.0510
  Epoch 14 [Batch 7/11]: Loss: 1.0693
  Epoch 14 [Batch 8/11]: Loss: 1.0859
  Epoch 14 [Batch 9/11]: Loss: 1.0242
  Epoch 14 [Batch 10/11]: Loss: 1.1497
  Epoch 14 Train Summary: Avg Loss: 1.0582, Accuracy: 0.3442
  Validation Summary: Avg Loss: 1.0850, Accuracy: 0.3500, F1 (Macro): 0.3175
Training finished in 1.05 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.0800, Accuracy: 0.3333, F1 (Macro): 0.1905
Final Best Model Stats: Acc: 0.3333, F1: 0.1905, Loss: 1.0800
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=1e-05 drop=0.0 seed=999
================================================================================
Starting experiment: resnet50__384x384__lr-1e-05__drop-0.0__seed-999
Output directory: results_ceph/resnet50__384x384__lr-1e-05__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.1401
  Epoch 0 [Batch 1/11]: Loss: 1.1224
  Epoch 0 [Batch 2/11]: Loss: 1.1463
  Epoch 0 [Batch 3/11]: Loss: 1.1055
  Epoch 0 [Batch 4/11]: Loss: 1.1497
  Epoch 0 [Batch 5/11]: Loss: 1.1040
  Epoch 0 [Batch 6/11]: Loss: 1.1009
  Epoch 0 [Batch 7/11]: Loss: 1.1353
  Epoch 0 [Batch 8/11]: Loss: 1.1290
  Epoch 0 [Batch 9/11]: Loss: 1.1646
  Epoch 0 [Batch 10/11]: Loss: 1.1226
  Epoch 0 Train Summary: Avg Loss: 1.1291, Accuracy: 0.2448
  Validation Summary: Avg Loss: 1.0973, Accuracy: 0.4167, F1 (Macro): 0.2000
  New best model! Val loss improved from inf to 1.0973. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.0819
  Epoch 1 [Batch 1/11]: Loss: 1.1243
  Epoch 1 [Batch 2/11]: Loss: 1.1435
  Epoch 1 [Batch 3/11]: Loss: 1.1354
  Epoch 1 [Batch 4/11]: Loss: 1.1182
  Epoch 1 [Batch 5/11]: Loss: 1.0924
  Epoch 1 [Batch 6/11]: Loss: 1.1404
  Epoch 1 [Batch 7/11]: Loss: 1.1089
  Epoch 1 [Batch 8/11]: Loss: 1.1168
  Epoch 1 [Batch 9/11]: Loss: 1.0915
  Epoch 1 [Batch 10/11]: Loss: 1.1815
  Epoch 1 Train Summary: Avg Loss: 1.1213, Accuracy: 0.3904
  Validation Summary: Avg Loss: 1.1082, Accuracy: 0.0833, F1 (Macro): 0.1111

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 1.1075
  Epoch 2 [Batch 1/11]: Loss: 1.1094
  Epoch 2 [Batch 2/11]: Loss: 1.1052
  Epoch 2 [Batch 3/11]: Loss: 1.1414
  Epoch 2 [Batch 4/11]: Loss: 1.1286
  Epoch 2 [Batch 5/11]: Loss: 1.1212
  Epoch 2 [Batch 6/11]: Loss: 1.1385
  Epoch 2 [Batch 7/11]: Loss: 1.0766
  Epoch 2 [Batch 8/11]: Loss: 1.1020
  Epoch 2 [Batch 9/11]: Loss: 1.0941
  Epoch 2 [Batch 10/11]: Loss: 1.0992
  Epoch 2 Train Summary: Avg Loss: 1.1112, Accuracy: 0.3555
  Validation Summary: Avg Loss: 1.1078, Accuracy: 0.0833, F1 (Macro): 0.1111

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 1.0968
  Epoch 3 [Batch 1/11]: Loss: 1.1239
  Epoch 3 [Batch 2/11]: Loss: 1.1156
  Epoch 3 [Batch 3/11]: Loss: 1.1145
  Epoch 3 [Batch 4/11]: Loss: 1.1031
  Epoch 3 [Batch 5/11]: Loss: 1.1004
  Epoch 3 [Batch 6/11]: Loss: 1.1146
  Epoch 3 [Batch 7/11]: Loss: 1.0978
  Epoch 3 [Batch 8/11]: Loss: 1.1308
  Epoch 3 [Batch 9/11]: Loss: 1.1034
  Epoch 3 [Batch 10/11]: Loss: 1.1067
  Epoch 3 Train Summary: Avg Loss: 1.1098, Accuracy: 0.3124
  Validation Summary: Avg Loss: 1.1038, Accuracy: 0.0833, F1 (Macro): 0.1111

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 1.0900
  Epoch 4 [Batch 1/11]: Loss: 1.1332
  Epoch 4 [Batch 2/11]: Loss: 1.1141
  Epoch 4 [Batch 3/11]: Loss: 1.1008
  Epoch 4 [Batch 4/11]: Loss: 1.1017
  Epoch 4 [Batch 5/11]: Loss: 1.0850
  Epoch 4 [Batch 6/11]: Loss: 1.0949
  Epoch 4 [Batch 7/11]: Loss: 1.1064
  Epoch 4 [Batch 8/11]: Loss: 1.1046
  Epoch 4 [Batch 9/11]: Loss: 1.0904
  Epoch 4 [Batch 10/11]: Loss: 1.1354
  Epoch 4 Train Summary: Avg Loss: 1.1051, Accuracy: 0.3380
  Validation Summary: Avg Loss: 1.1051, Accuracy: 0.2500, F1 (Macro): 0.2222

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 1.1038
  Epoch 5 [Batch 1/11]: Loss: 1.0615
  Epoch 5 [Batch 2/11]: Loss: 1.1099
  Epoch 5 [Batch 3/11]: Loss: 1.0955
  Epoch 5 [Batch 4/11]: Loss: 1.0965
  Epoch 5 [Batch 5/11]: Loss: 1.1022
  Epoch 5 [Batch 6/11]: Loss: 1.1095
  Epoch 5 [Batch 7/11]: Loss: 1.0746
  Epoch 5 [Batch 8/11]: Loss: 1.0974
  Epoch 5 [Batch 9/11]: Loss: 1.0996
  Epoch 5 [Batch 10/11]: Loss: 1.1070
  Epoch 5 Train Summary: Avg Loss: 1.0961, Accuracy: 0.3710
  Validation Summary: Avg Loss: 1.1012, Accuracy: 0.3333, F1 (Macro): 0.2051

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 1.0952
  Epoch 6 [Batch 1/11]: Loss: 1.0921
  Epoch 6 [Batch 2/11]: Loss: 1.0987
  Epoch 6 [Batch 3/11]: Loss: 1.0801
  Epoch 6 [Batch 4/11]: Loss: 1.0843
  Epoch 6 [Batch 5/11]: Loss: 1.0775
  Epoch 6 [Batch 6/11]: Loss: 1.0946
  Epoch 6 [Batch 7/11]: Loss: 1.0654
  Epoch 6 [Batch 8/11]: Loss: 1.1002
  Epoch 6 [Batch 9/11]: Loss: 1.1048
  Epoch 6 [Batch 10/11]: Loss: 1.0848
  Epoch 6 Train Summary: Avg Loss: 1.0889, Accuracy: 0.3879
  Validation Summary: Avg Loss: 1.1017, Accuracy: 0.3333, F1 (Macro): 0.1905

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 1.0864
  Epoch 7 [Batch 1/11]: Loss: 1.0811
  Epoch 7 [Batch 2/11]: Loss: 1.0895
  Epoch 7 [Batch 3/11]: Loss: 1.1204
  Epoch 7 [Batch 4/11]: Loss: 1.0888
  Epoch 7 [Batch 5/11]: Loss: 1.0529
  Epoch 7 [Batch 6/11]: Loss: 1.0970
  Epoch 7 [Batch 7/11]: Loss: 1.0978
  Epoch 7 [Batch 8/11]: Loss: 1.0784
  Epoch 7 [Batch 9/11]: Loss: 1.0727
  Epoch 7 [Batch 10/11]: Loss: 1.0882
  Epoch 7 Train Summary: Avg Loss: 1.0866, Accuracy: 0.3723
  Validation Summary: Avg Loss: 1.1057, Accuracy: 0.2500, F1 (Macro): 0.1538

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 1.0809
  Epoch 8 [Batch 1/11]: Loss: 1.0865
  Epoch 8 [Batch 2/11]: Loss: 1.1022
  Epoch 8 [Batch 3/11]: Loss: 1.0949
  Epoch 8 [Batch 4/11]: Loss: 1.0914
  Epoch 8 [Batch 5/11]: Loss: 1.0840
  Epoch 8 [Batch 6/11]: Loss: 1.0981
  Epoch 8 [Batch 7/11]: Loss: 1.0910
  Epoch 8 [Batch 8/11]: Loss: 1.0817
  Epoch 8 [Batch 9/11]: Loss: 1.0742
  Epoch 8 [Batch 10/11]: Loss: 1.0836
  Epoch 8 Train Summary: Avg Loss: 1.0880, Accuracy: 0.3427
  Validation Summary: Avg Loss: 1.0955, Accuracy: 0.2500, F1 (Macro): 0.1538
  New best model! Val loss improved from 1.0973 to 1.0955. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 1.1009
  Epoch 9 [Batch 1/11]: Loss: 1.0845
  Epoch 9 [Batch 2/11]: Loss: 1.0842
  Epoch 9 [Batch 3/11]: Loss: 1.0900
  Epoch 9 [Batch 4/11]: Loss: 1.0943
  Epoch 9 [Batch 5/11]: Loss: 1.0843
  Epoch 9 [Batch 6/11]: Loss: 1.0810
  Epoch 9 [Batch 7/11]: Loss: 1.0960
  Epoch 9 [Batch 8/11]: Loss: 1.0770
  Epoch 9 [Batch 9/11]: Loss: 1.0910
  Epoch 9 [Batch 10/11]: Loss: 1.0955
  Epoch 9 Train Summary: Avg Loss: 1.0890, Accuracy: 0.3696
  Validation Summary: Avg Loss: 1.0953, Accuracy: 0.2500, F1 (Macro): 0.1538
  New best model! Val loss improved from 1.0955 to 1.0953. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 1.0775
  Epoch 10 [Batch 1/11]: Loss: 1.0897
  Epoch 10 [Batch 2/11]: Loss: 1.0941
  Epoch 10 [Batch 3/11]: Loss: 1.0961
  Epoch 10 [Batch 4/11]: Loss: 1.0899
  Epoch 10 [Batch 5/11]: Loss: 1.0919
  Epoch 10 [Batch 6/11]: Loss: 1.0981
  Epoch 10 [Batch 7/11]: Loss: 1.0772
  Epoch 10 [Batch 8/11]: Loss: 1.0782
  Epoch 10 [Batch 9/11]: Loss: 1.0975
  Epoch 10 [Batch 10/11]: Loss: 1.1045
  Epoch 10 Train Summary: Avg Loss: 1.0904, Accuracy: 0.3778
  Validation Summary: Avg Loss: 1.0923, Accuracy: 0.2500, F1 (Macro): 0.1538
  New best model! Val loss improved from 1.0953 to 1.0923. Saving...

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 1.0719
  Epoch 11 [Batch 1/11]: Loss: 1.1030
  Epoch 11 [Batch 2/11]: Loss: 1.1083
  Epoch 11 [Batch 3/11]: Loss: 1.0766
  Epoch 11 [Batch 4/11]: Loss: 1.0920
  Epoch 11 [Batch 5/11]: Loss: 1.0975
  Epoch 11 [Batch 6/11]: Loss: 1.0960
  Epoch 11 [Batch 7/11]: Loss: 1.1206
  Epoch 11 [Batch 8/11]: Loss: 1.0726
  Epoch 11 [Batch 9/11]: Loss: 1.0613
  Epoch 11 [Batch 10/11]: Loss: 1.0542
  Epoch 11 Train Summary: Avg Loss: 1.0867, Accuracy: 0.3670
  Validation Summary: Avg Loss: 1.0982, Accuracy: 0.2500, F1 (Macro): 0.1538

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 1.0990
  Epoch 12 [Batch 1/11]: Loss: 1.0971
  Epoch 12 [Batch 2/11]: Loss: 1.1034
  Epoch 12 [Batch 3/11]: Loss: 1.0811
  Epoch 12 [Batch 4/11]: Loss: 1.0825
  Epoch 12 [Batch 5/11]: Loss: 1.0817
  Epoch 12 [Batch 6/11]: Loss: 1.0649
  Epoch 12 [Batch 7/11]: Loss: 1.0783
  Epoch 12 [Batch 8/11]: Loss: 1.0802
  Epoch 12 [Batch 9/11]: Loss: 1.0946
  Epoch 12 [Batch 10/11]: Loss: 1.0879
  Epoch 12 Train Summary: Avg Loss: 1.0864, Accuracy: 0.3440
  Validation Summary: Avg Loss: 1.0966, Accuracy: 0.2500, F1 (Macro): 0.1538

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 1.0960
  Epoch 13 [Batch 1/11]: Loss: 1.0946
  Epoch 13 [Batch 2/11]: Loss: 1.0774
  Epoch 13 [Batch 3/11]: Loss: 1.0820
  Epoch 13 [Batch 4/11]: Loss: 1.0831
  Epoch 13 [Batch 5/11]: Loss: 1.0926
  Epoch 13 [Batch 6/11]: Loss: 1.0639
  Epoch 13 [Batch 7/11]: Loss: 1.0842
  Epoch 13 [Batch 8/11]: Loss: 1.0909
  Epoch 13 [Batch 9/11]: Loss: 1.0958
  Epoch 13 [Batch 10/11]: Loss: 1.0812
  Epoch 13 Train Summary: Avg Loss: 1.0856, Accuracy: 0.3676
  Validation Summary: Avg Loss: 1.1005, Accuracy: 0.2500, F1 (Macro): 0.1538

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 1.0904
  Epoch 14 [Batch 1/11]: Loss: 1.0947
  Epoch 14 [Batch 2/11]: Loss: 1.0702
  Epoch 14 [Batch 3/11]: Loss: 1.0915
  Epoch 14 [Batch 4/11]: Loss: 1.0843
  Epoch 14 [Batch 5/11]: Loss: 1.0860
  Epoch 14 [Batch 6/11]: Loss: 1.0624
  Epoch 14 [Batch 7/11]: Loss: 1.1120
  Epoch 14 [Batch 8/11]: Loss: 1.0912
  Epoch 14 [Batch 9/11]: Loss: 1.1131
  Epoch 14 [Batch 10/11]: Loss: 1.0774
  Epoch 14 Train Summary: Avg Loss: 1.0885, Accuracy: 0.3568
  Validation Summary: Avg Loss: 1.0998, Accuracy: 0.2500, F1 (Macro): 0.1538
Training finished in 1.11 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 1.0923, Accuracy: 0.2500, F1 (Macro): 0.1538
Final Best Model Stats: Acc: 0.2500, F1: 0.1538, Loss: 1.0923
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=224x224 lr=0.0001 drop=0.0 seed=42
================================================================================
Starting experiment: efficientnet_b0__224x224__lr-0.0001__drop-0.0__seed-42
Output directory: results_ceph/efficientnet_b0__224x224__lr-0.0001__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.4837
  Epoch 0 [Batch 1/11]: Loss: 2.6717
  Epoch 0 [Batch 2/11]: Loss: 2.4384
  Epoch 0 [Batch 3/11]: Loss: 1.8987
  Epoch 0 [Batch 4/11]: Loss: 3.2327
  Epoch 0 [Batch 5/11]: Loss: 1.3123
  Epoch 0 [Batch 6/11]: Loss: 3.6451
  Epoch 0 [Batch 7/11]: Loss: 2.4763
  Epoch 0 [Batch 8/11]: Loss: 2.7228
  Epoch 0 [Batch 9/11]: Loss: 1.8047
  Epoch 0 [Batch 10/11]: Loss: 0.6356
  Epoch 0 Train Summary: Avg Loss: 2.2111, Accuracy: 0.3897
  Validation Summary: Avg Loss: 7.3345, Accuracy: 0.1500, F1 (Macro): 0.1407
  New best model! Val loss improved from inf to 7.3345. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 0.9703
  Epoch 1 [Batch 1/11]: Loss: 1.4868
  Epoch 1 [Batch 2/11]: Loss: 1.3178
  Epoch 1 [Batch 3/11]: Loss: 2.0536
  Epoch 1 [Batch 4/11]: Loss: 3.2682
  Epoch 1 [Batch 5/11]: Loss: 1.2745
  Epoch 1 [Batch 6/11]: Loss: 1.2045
  Epoch 1 [Batch 7/11]: Loss: 0.9447
  Epoch 1 [Batch 8/11]: Loss: 1.1672
  Epoch 1 [Batch 9/11]: Loss: 1.1282
  Epoch 1 [Batch 10/11]: Loss: 0.8203
  Epoch 1 Train Summary: Avg Loss: 1.4214, Accuracy: 0.5392
  Validation Summary: Avg Loss: 7.5736, Accuracy: 0.0833, F1 (Macro): 0.0667

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 1.9333
  Epoch 2 [Batch 1/11]: Loss: 0.5147
  Epoch 2 [Batch 2/11]: Loss: 0.6502
  Epoch 2 [Batch 3/11]: Loss: 0.4625
  Epoch 2 [Batch 4/11]: Loss: 1.4907
  Epoch 2 [Batch 5/11]: Loss: 2.2171
  Epoch 2 [Batch 6/11]: Loss: 1.5268
  Epoch 2 [Batch 7/11]: Loss: 0.9484
  Epoch 2 [Batch 8/11]: Loss: 0.0291
  Epoch 2 [Batch 9/11]: Loss: 0.5452
  Epoch 2 [Batch 10/11]: Loss: 0.1639
  Epoch 2 Train Summary: Avg Loss: 0.9529, Accuracy: 0.6469
  Validation Summary: Avg Loss: 6.9651, Accuracy: 0.0833, F1 (Macro): 0.0606
  New best model! Val loss improved from 7.3345 to 6.9651. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 1.4805
  Epoch 3 [Batch 1/11]: Loss: 1.8163
  Epoch 3 [Batch 2/11]: Loss: 0.4107
  Epoch 3 [Batch 3/11]: Loss: 1.2119
  Epoch 3 [Batch 4/11]: Loss: 0.9669
  Epoch 3 [Batch 5/11]: Loss: 2.1771
  Epoch 3 [Batch 6/11]: Loss: 1.3887
  Epoch 3 [Batch 7/11]: Loss: 0.5019
  Epoch 3 [Batch 8/11]: Loss: 1.5694
  Epoch 3 [Batch 9/11]: Loss: 1.0731
  Epoch 3 [Batch 10/11]: Loss: 2.6509
  Epoch 3 Train Summary: Avg Loss: 1.3861, Accuracy: 0.6139
  Validation Summary: Avg Loss: 5.8171, Accuracy: 0.0833, F1 (Macro): 0.0606
  New best model! Val loss improved from 6.9651 to 5.8171. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 0.9297
  Epoch 4 [Batch 1/11]: Loss: 1.4819
  Epoch 4 [Batch 2/11]: Loss: 0.6004
  Epoch 4 [Batch 3/11]: Loss: 1.1587
  Epoch 4 [Batch 4/11]: Loss: 1.0607
  Epoch 4 [Batch 5/11]: Loss: 1.9325
  Epoch 4 [Batch 6/11]: Loss: 0.4785
  Epoch 4 [Batch 7/11]: Loss: 0.5765
  Epoch 4 [Batch 8/11]: Loss: 0.1708
  Epoch 4 [Batch 9/11]: Loss: 1.2738
  Epoch 4 [Batch 10/11]: Loss: 1.1186
  Epoch 4 Train Summary: Avg Loss: 0.9802, Accuracy: 0.6590
  Validation Summary: Avg Loss: 4.9719, Accuracy: 0.1500, F1 (Macro): 0.1407
  New best model! Val loss improved from 5.8171 to 4.9719. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 0.1231
  Epoch 5 [Batch 1/11]: Loss: 1.2041
  Epoch 5 [Batch 2/11]: Loss: 0.8202
  Epoch 5 [Batch 3/11]: Loss: 1.6751
  Epoch 5 [Batch 4/11]: Loss: 0.7973
  Epoch 5 [Batch 5/11]: Loss: 1.9308
  Epoch 5 [Batch 6/11]: Loss: 0.0136
  Epoch 5 [Batch 7/11]: Loss: 1.1680
  Epoch 5 [Batch 8/11]: Loss: 1.6283
  Epoch 5 [Batch 9/11]: Loss: 0.7640
  Epoch 5 [Batch 10/11]: Loss: 0.6080
  Epoch 5 Train Summary: Avg Loss: 0.9757, Accuracy: 0.6590
  Validation Summary: Avg Loss: 6.4493, Accuracy: 0.2167, F1 (Macro): 0.2045

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 0.8423
  Epoch 6 [Batch 1/11]: Loss: 0.4761
  Epoch 6 [Batch 2/11]: Loss: 1.1090
  Epoch 6 [Batch 3/11]: Loss: 1.1868
  Epoch 6 [Batch 4/11]: Loss: 0.4352
  Epoch 6 [Batch 5/11]: Loss: 0.3656
  Epoch 6 [Batch 6/11]: Loss: 0.3438
  Epoch 6 [Batch 7/11]: Loss: 0.0321
  Epoch 6 [Batch 8/11]: Loss: 0.0778
  Epoch 6 [Batch 9/11]: Loss: 0.1448
  Epoch 6 [Batch 10/11]: Loss: 1.1698
  Epoch 6 Train Summary: Avg Loss: 0.5621, Accuracy: 0.8302
  Validation Summary: Avg Loss: 7.4420, Accuracy: 0.2833, F1 (Macro): 0.2619

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.9618
  Epoch 7 [Batch 1/11]: Loss: 1.1804
  Epoch 7 [Batch 2/11]: Loss: 0.3756
  Epoch 7 [Batch 3/11]: Loss: 1.1248
  Epoch 7 [Batch 4/11]: Loss: 0.5289
  Epoch 7 [Batch 5/11]: Loss: 0.6252
  Epoch 7 [Batch 6/11]: Loss: 0.1831
  Epoch 7 [Batch 7/11]: Loss: 0.8480
  Epoch 7 [Batch 8/11]: Loss: 0.5490
  Epoch 7 [Batch 9/11]: Loss: 0.4826
  Epoch 7 [Batch 10/11]: Loss: 0.5973
  Epoch 7 Train Summary: Avg Loss: 0.6779, Accuracy: 0.7453
  Validation Summary: Avg Loss: 8.1055, Accuracy: 0.2833, F1 (Macro): 0.2619

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 0.1373
  Epoch 8 [Batch 1/11]: Loss: 0.6630
  Epoch 8 [Batch 2/11]: Loss: 0.6258
  Epoch 8 [Batch 3/11]: Loss: 0.9569
  Epoch 8 [Batch 4/11]: Loss: 0.2028
  Epoch 8 [Batch 5/11]: Loss: 1.4225
  Epoch 8 [Batch 6/11]: Loss: 0.0077
  Epoch 8 [Batch 7/11]: Loss: 0.1040
  Epoch 8 [Batch 8/11]: Loss: 1.0250
  Epoch 8 [Batch 9/11]: Loss: 0.9736
  Epoch 8 [Batch 10/11]: Loss: 1.7242
  Epoch 8 Train Summary: Avg Loss: 0.7130, Accuracy: 0.7803
  Validation Summary: Avg Loss: 8.2075, Accuracy: 0.2833, F1 (Macro): 0.2619

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 1.1505
  Epoch 9 [Batch 1/11]: Loss: 0.6025
  Epoch 9 [Batch 2/11]: Loss: 0.1022
  Epoch 9 [Batch 3/11]: Loss: 0.5946
  Epoch 9 [Batch 4/11]: Loss: 0.7810
  Epoch 9 [Batch 5/11]: Loss: 0.7990
  Epoch 9 [Batch 6/11]: Loss: 0.8447
  Epoch 9 [Batch 7/11]: Loss: 0.8879
  Epoch 9 [Batch 8/11]: Loss: 0.3163
  Epoch 9 [Batch 9/11]: Loss: 0.5777
  Epoch 9 [Batch 10/11]: Loss: 1.5095
  Epoch 9 Train Summary: Avg Loss: 0.7424, Accuracy: 0.7041
  Validation Summary: Avg Loss: 9.1769, Accuracy: 0.2833, F1 (Macro): 0.2619

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 0.5933
  Epoch 10 [Batch 1/11]: Loss: 1.6156
  Epoch 10 [Batch 2/11]: Loss: 0.3367
  Epoch 10 [Batch 3/11]: Loss: 0.1290
  Epoch 10 [Batch 4/11]: Loss: 0.1823
  Epoch 10 [Batch 5/11]: Loss: 1.4076
  Epoch 10 [Batch 6/11]: Loss: 0.1103
  Epoch 10 [Batch 7/11]: Loss: 0.9937
  Epoch 10 [Batch 8/11]: Loss: 0.0705
  Epoch 10 [Batch 9/11]: Loss: 0.6482
  Epoch 10 [Batch 10/11]: Loss: 0.2079
  Epoch 10 Train Summary: Avg Loss: 0.5723, Accuracy: 0.8301
  Validation Summary: Avg Loss: 8.8633, Accuracy: 0.2833, F1 (Macro): 0.2619

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 0.0245
  Epoch 11 [Batch 1/11]: Loss: 0.0554
  Epoch 11 [Batch 2/11]: Loss: 0.0178
  Epoch 11 [Batch 3/11]: Loss: 0.6647
  Epoch 11 [Batch 4/11]: Loss: 0.0105
  Epoch 11 [Batch 5/11]: Loss: 0.1191
  Epoch 11 [Batch 6/11]: Loss: 0.2206
  Epoch 11 [Batch 7/11]: Loss: 0.0237
  Epoch 11 [Batch 8/11]: Loss: 0.4195
  Epoch 11 [Batch 9/11]: Loss: 0.6734
  Epoch 11 [Batch 10/11]: Loss: 0.0876
  Epoch 11 Train Summary: Avg Loss: 0.2106, Accuracy: 0.9393
  Validation Summary: Avg Loss: 8.2146, Accuracy: 0.2833, F1 (Macro): 0.2619

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.3224
  Epoch 12 [Batch 1/11]: Loss: 0.1042
  Epoch 12 [Batch 2/11]: Loss: 0.1802
  Epoch 12 [Batch 3/11]: Loss: 0.0732
  Epoch 12 [Batch 4/11]: Loss: 0.6183
  Epoch 12 [Batch 5/11]: Loss: 0.0903
  Epoch 12 [Batch 6/11]: Loss: 0.1801
  Epoch 12 [Batch 7/11]: Loss: 0.0224
  Epoch 12 [Batch 8/11]: Loss: 0.3553
  Epoch 12 [Batch 9/11]: Loss: 0.0863
  Epoch 12 [Batch 10/11]: Loss: 1.0064
  Epoch 12 Train Summary: Avg Loss: 0.2763, Accuracy: 0.9090
  Validation Summary: Avg Loss: 8.0976, Accuracy: 0.2833, F1 (Macro): 0.2619

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 0.3760
  Epoch 13 [Batch 1/11]: Loss: 0.5926
  Epoch 13 [Batch 2/11]: Loss: 0.6351
  Epoch 13 [Batch 3/11]: Loss: 0.0319
  Epoch 13 [Batch 4/11]: Loss: 0.5382
  Epoch 13 [Batch 5/11]: Loss: 0.2442
  Epoch 13 [Batch 6/11]: Loss: 0.2135
  Epoch 13 [Batch 7/11]: Loss: 0.3327
  Epoch 13 [Batch 8/11]: Loss: 0.8091
  Epoch 13 [Batch 9/11]: Loss: 0.0717
  Epoch 13 [Batch 10/11]: Loss: 2.0844
  Epoch 13 Train Summary: Avg Loss: 0.5390, Accuracy: 0.8530
  Validation Summary: Avg Loss: 8.0040, Accuracy: 0.2833, F1 (Macro): 0.2619

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.3067
  Epoch 14 [Batch 1/11]: Loss: 0.1934
  Epoch 14 [Batch 2/11]: Loss: 0.0028
  Epoch 14 [Batch 3/11]: Loss: 0.0804
  Epoch 14 [Batch 4/11]: Loss: 0.4002
  Epoch 14 [Batch 5/11]: Loss: 0.0706
  Epoch 14 [Batch 6/11]: Loss: 0.5055
  Epoch 14 [Batch 7/11]: Loss: 0.4771
  Epoch 14 [Batch 8/11]: Loss: 0.6504
  Epoch 14 [Batch 9/11]: Loss: 0.1505
  Epoch 14 [Batch 10/11]: Loss: 0.5137
  Epoch 14 Train Summary: Avg Loss: 0.3047, Accuracy: 0.9447
  Validation Summary: Avg Loss: 7.9938, Accuracy: 0.2833, F1 (Macro): 0.2619
Training finished in 0.93 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 4.9719, Accuracy: 0.1500, F1 (Macro): 0.1407
Final Best Model Stats: Acc: 0.1500, F1: 0.1407, Loss: 4.9719
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=224x224 lr=0.0001 drop=0.0 seed=123
================================================================================
Starting experiment: efficientnet_b0__224x224__lr-0.0001__drop-0.0__seed-123
Output directory: results_ceph/efficientnet_b0__224x224__lr-0.0001__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 2.4162
  Epoch 0 [Batch 1/11]: Loss: 4.9126
  Epoch 0 [Batch 2/11]: Loss: 3.7010
  Epoch 0 [Batch 3/11]: Loss: 3.4113
  Epoch 0 [Batch 4/11]: Loss: 1.9648
  Epoch 0 [Batch 5/11]: Loss: 3.3819
  Epoch 0 [Batch 6/11]: Loss: 2.2422
  Epoch 0 [Batch 7/11]: Loss: 1.7998
  Epoch 0 [Batch 8/11]: Loss: 1.0556
  Epoch 0 [Batch 9/11]: Loss: 4.5555
  Epoch 0 [Batch 10/11]: Loss: 0.1751
  Epoch 0 Train Summary: Avg Loss: 2.6924, Accuracy: 0.3970
  Validation Summary: Avg Loss: 4.1288, Accuracy: 0.2667, F1 (Macro): 0.2051
  New best model! Val loss improved from inf to 4.1288. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 2.4366
  Epoch 1 [Batch 1/11]: Loss: 3.5515
  Epoch 1 [Batch 2/11]: Loss: 2.0925
  Epoch 1 [Batch 3/11]: Loss: 1.8413
  Epoch 1 [Batch 4/11]: Loss: 1.1560
  Epoch 1 [Batch 5/11]: Loss: 1.0533
  Epoch 1 [Batch 6/11]: Loss: 1.3917
  Epoch 1 [Batch 7/11]: Loss: 2.8374
  Epoch 1 [Batch 8/11]: Loss: 1.5531
  Epoch 1 [Batch 9/11]: Loss: 1.5506
  Epoch 1 [Batch 10/11]: Loss: 1.3688
  Epoch 1 Train Summary: Avg Loss: 1.8939, Accuracy: 0.5061
  Validation Summary: Avg Loss: 3.4323, Accuracy: 0.2667, F1 (Macro): 0.2051
  New best model! Val loss improved from 4.1288 to 3.4323. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 0.9625
  Epoch 2 [Batch 1/11]: Loss: 1.9008
  Epoch 2 [Batch 2/11]: Loss: 2.1952
  Epoch 2 [Batch 3/11]: Loss: 1.2587
  Epoch 2 [Batch 4/11]: Loss: 1.4277
  Epoch 2 [Batch 5/11]: Loss: 1.3767
  Epoch 2 [Batch 6/11]: Loss: 0.2519
  Epoch 2 [Batch 7/11]: Loss: 2.0409
  Epoch 2 [Batch 8/11]: Loss: 0.3767
  Epoch 2 [Batch 9/11]: Loss: 1.5671
  Epoch 2 [Batch 10/11]: Loss: 2.3460
  Epoch 2 Train Summary: Avg Loss: 1.4276, Accuracy: 0.5217
  Validation Summary: Avg Loss: 3.5220, Accuracy: 0.4167, F1 (Macro): 0.3897

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 1.3985
  Epoch 3 [Batch 1/11]: Loss: 1.1203
  Epoch 3 [Batch 2/11]: Loss: 1.3198
  Epoch 3 [Batch 3/11]: Loss: 0.7782
  Epoch 3 [Batch 4/11]: Loss: 1.6153
  Epoch 3 [Batch 5/11]: Loss: 1.5355
  Epoch 3 [Batch 6/11]: Loss: 2.4920
  Epoch 3 [Batch 7/11]: Loss: 0.3693
  Epoch 3 [Batch 8/11]: Loss: 1.8034
  Epoch 3 [Batch 9/11]: Loss: 0.8854
  Epoch 3 [Batch 10/11]: Loss: 1.2938
  Epoch 3 Train Summary: Avg Loss: 1.3283, Accuracy: 0.5875
  Validation Summary: Avg Loss: 4.3907, Accuracy: 0.3500, F1 (Macro): 0.3556

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 2.5249
  Epoch 4 [Batch 1/11]: Loss: 0.6849
  Epoch 4 [Batch 2/11]: Loss: 0.9616
  Epoch 4 [Batch 3/11]: Loss: 0.8215
  Epoch 4 [Batch 4/11]: Loss: 1.2898
  Epoch 4 [Batch 5/11]: Loss: 0.9450
  Epoch 4 [Batch 6/11]: Loss: 0.0535
  Epoch 4 [Batch 7/11]: Loss: 1.8931
  Epoch 4 [Batch 8/11]: Loss: 0.4706
  Epoch 4 [Batch 9/11]: Loss: 1.0412
  Epoch 4 [Batch 10/11]: Loss: 0.0133
  Epoch 4 Train Summary: Avg Loss: 0.9727, Accuracy: 0.7344
  Validation Summary: Avg Loss: 3.3939, Accuracy: 0.2833, F1 (Macro): 0.2619
  New best model! Val loss improved from 3.4323 to 3.3939. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 0.3146
  Epoch 5 [Batch 1/11]: Loss: 0.2879
  Epoch 5 [Batch 2/11]: Loss: 0.5124
  Epoch 5 [Batch 3/11]: Loss: 0.3127
  Epoch 5 [Batch 4/11]: Loss: 0.4699
  Epoch 5 [Batch 5/11]: Loss: 0.6343
  Epoch 5 [Batch 6/11]: Loss: 1.1818
  Epoch 5 [Batch 7/11]: Loss: 1.8666
  Epoch 5 [Batch 8/11]: Loss: 0.4587
  Epoch 5 [Batch 9/11]: Loss: 0.2184
  Epoch 5 [Batch 10/11]: Loss: 0.0189
  Epoch 5 Train Summary: Avg Loss: 0.5706, Accuracy: 0.7675
  Validation Summary: Avg Loss: 2.9401, Accuracy: 0.4167, F1 (Macro): 0.3714
  New best model! Val loss improved from 3.3939 to 2.9401. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 0.3359
  Epoch 6 [Batch 1/11]: Loss: 1.0134
  Epoch 6 [Batch 2/11]: Loss: 1.4161
  Epoch 6 [Batch 3/11]: Loss: 1.2225
  Epoch 6 [Batch 4/11]: Loss: 0.3008
  Epoch 6 [Batch 5/11]: Loss: 1.0353
  Epoch 6 [Batch 6/11]: Loss: 0.3936
  Epoch 6 [Batch 7/11]: Loss: 0.0716
  Epoch 6 [Batch 8/11]: Loss: 0.2690
  Epoch 6 [Batch 9/11]: Loss: 0.0707
  Epoch 6 [Batch 10/11]: Loss: 0.7472
  Epoch 6 Train Summary: Avg Loss: 0.6251, Accuracy: 0.7608
  Validation Summary: Avg Loss: 3.2472, Accuracy: 0.4167, F1 (Macro): 0.3714

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.2275
  Epoch 7 [Batch 1/11]: Loss: 0.1030
  Epoch 7 [Batch 2/11]: Loss: 0.0543
  Epoch 7 [Batch 3/11]: Loss: 0.1606
  Epoch 7 [Batch 4/11]: Loss: 0.7371
  Epoch 7 [Batch 5/11]: Loss: 0.0589
  Epoch 7 [Batch 6/11]: Loss: 0.5842
  Epoch 7 [Batch 7/11]: Loss: 0.0752
  Epoch 7 [Batch 8/11]: Loss: 0.9132
  Epoch 7 [Batch 9/11]: Loss: 0.4648
  Epoch 7 [Batch 10/11]: Loss: 0.5749
  Epoch 7 Train Summary: Avg Loss: 0.3594, Accuracy: 0.9063
  Validation Summary: Avg Loss: 4.5716, Accuracy: 0.4167, F1 (Macro): 0.3714

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 0.1888
  Epoch 8 [Batch 1/11]: Loss: 0.3241
  Epoch 8 [Batch 2/11]: Loss: 0.3672
  Epoch 8 [Batch 3/11]: Loss: 1.1772
  Epoch 8 [Batch 4/11]: Loss: 0.7724
  Epoch 8 [Batch 5/11]: Loss: 0.1910
  Epoch 8 [Batch 6/11]: Loss: 0.7409
  Epoch 8 [Batch 7/11]: Loss: 0.7647
  Epoch 8 [Batch 8/11]: Loss: 0.6878
  Epoch 8 [Batch 9/11]: Loss: 0.2339
  Epoch 8 [Batch 10/11]: Loss: 0.2156
  Epoch 8 Train Summary: Avg Loss: 0.5149, Accuracy: 0.8005
  Validation Summary: Avg Loss: 4.3951, Accuracy: 0.3500, F1 (Macro): 0.3385

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 0.1106
  Epoch 9 [Batch 1/11]: Loss: 0.0320
  Epoch 9 [Batch 2/11]: Loss: 0.1260
  Epoch 9 [Batch 3/11]: Loss: 0.0112
  Epoch 9 [Batch 4/11]: Loss: 0.7172
  Epoch 9 [Batch 5/11]: Loss: 0.8113
  Epoch 9 [Batch 6/11]: Loss: 0.2991
  Epoch 9 [Batch 7/11]: Loss: 0.1058
  Epoch 9 [Batch 8/11]: Loss: 0.8786
  Epoch 9 [Batch 9/11]: Loss: 0.1101
  Epoch 9 [Batch 10/11]: Loss: 0.1934
  Epoch 9 Train Summary: Avg Loss: 0.3087, Accuracy: 0.8605
  Validation Summary: Avg Loss: 2.8607, Accuracy: 0.3500, F1 (Macro): 0.3385
  New best model! Val loss improved from 2.9401 to 2.8607. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 0.3516
  Epoch 10 [Batch 1/11]: Loss: 0.0199
  Epoch 10 [Batch 2/11]: Loss: 1.4390
  Epoch 10 [Batch 3/11]: Loss: 0.1978
  Epoch 10 [Batch 4/11]: Loss: 0.5681
  Epoch 10 [Batch 5/11]: Loss: 0.2003
  Epoch 10 [Batch 6/11]: Loss: 0.3062
  Epoch 10 [Batch 7/11]: Loss: 0.1288
  Epoch 10 [Batch 8/11]: Loss: 1.1241
  Epoch 10 [Batch 9/11]: Loss: 1.7257
  Epoch 10 [Batch 10/11]: Loss: 2.5631
  Epoch 10 Train Summary: Avg Loss: 0.7841, Accuracy: 0.7574
  Validation Summary: Avg Loss: 4.1488, Accuracy: 0.4167, F1 (Macro): 0.3714

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 0.4781
  Epoch 11 [Batch 1/11]: Loss: 0.0933
  Epoch 11 [Batch 2/11]: Loss: 0.2005
  Epoch 11 [Batch 3/11]: Loss: 0.6009
  Epoch 11 [Batch 4/11]: Loss: 0.4329
  Epoch 11 [Batch 5/11]: Loss: 0.0877
  Epoch 11 [Batch 6/11]: Loss: 1.1645
  Epoch 11 [Batch 7/11]: Loss: 0.0831
  Epoch 11 [Batch 8/11]: Loss: 0.2703
  Epoch 11 [Batch 9/11]: Loss: 0.0372
  Epoch 11 [Batch 10/11]: Loss: 0.4361
  Epoch 11 Train Summary: Avg Loss: 0.3531, Accuracy: 0.8942
  Validation Summary: Avg Loss: 7.1641, Accuracy: 0.4167, F1 (Macro): 0.3714

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.1105
  Epoch 12 [Batch 1/11]: Loss: 0.9333
  Epoch 12 [Batch 2/11]: Loss: 0.0901
  Epoch 12 [Batch 3/11]: Loss: 0.0796
  Epoch 12 [Batch 4/11]: Loss: 0.9633
  Epoch 12 [Batch 5/11]: Loss: 0.5683
  Epoch 12 [Batch 6/11]: Loss: 0.3869
  Epoch 12 [Batch 7/11]: Loss: 0.3504
  Epoch 12 [Batch 8/11]: Loss: 0.0361
  Epoch 12 [Batch 9/11]: Loss: 0.1435
  Epoch 12 [Batch 10/11]: Loss: 0.1266
  Epoch 12 Train Summary: Avg Loss: 0.3444, Accuracy: 0.8996
  Validation Summary: Avg Loss: 6.1888, Accuracy: 0.4167, F1 (Macro): 0.3714

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 1.2351
  Epoch 13 [Batch 1/11]: Loss: 0.2462
  Epoch 13 [Batch 2/11]: Loss: 0.1492
  Epoch 13 [Batch 3/11]: Loss: 0.4349
  Epoch 13 [Batch 4/11]: Loss: 0.1907
  Epoch 13 [Batch 5/11]: Loss: 0.0125
  Epoch 13 [Batch 6/11]: Loss: 0.0606
  Epoch 13 [Batch 7/11]: Loss: 0.1198
  Epoch 13 [Batch 8/11]: Loss: 0.2072
  Epoch 13 [Batch 9/11]: Loss: 0.0195
  Epoch 13 [Batch 10/11]: Loss: 3.7100
  Epoch 13 Train Summary: Avg Loss: 0.5805, Accuracy: 0.8794
  Validation Summary: Avg Loss: 5.2315, Accuracy: 0.4167, F1 (Macro): 0.3714

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.0129
  Epoch 14 [Batch 1/11]: Loss: 0.0447
  Epoch 14 [Batch 2/11]: Loss: 0.3242
  Epoch 14 [Batch 3/11]: Loss: 0.1132
  Epoch 14 [Batch 4/11]: Loss: 0.6970
  Epoch 14 [Batch 5/11]: Loss: 0.6719
  Epoch 14 [Batch 6/11]: Loss: 0.7697
  Epoch 14 [Batch 7/11]: Loss: 0.5283
  Epoch 14 [Batch 8/11]: Loss: 0.1514
  Epoch 14 [Batch 9/11]: Loss: 0.0695
  Epoch 14 [Batch 10/11]: Loss: 0.6050
  Epoch 14 Train Summary: Avg Loss: 0.3625, Accuracy: 0.8531
  Validation Summary: Avg Loss: 4.2383, Accuracy: 0.2833, F1 (Macro): 0.2619
Training finished in 1.04 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 2.8607, Accuracy: 0.3500, F1 (Macro): 0.3385
Final Best Model Stats: Acc: 0.3500, F1: 0.3385, Loss: 2.8607
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=224x224 lr=0.0001 drop=0.0 seed=999
================================================================================
Starting experiment: efficientnet_b0__224x224__lr-0.0001__drop-0.0__seed-999
Output directory: results_ceph/efficientnet_b0__224x224__lr-0.0001__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 2.5511
  Epoch 0 [Batch 1/11]: Loss: 2.7541
  Epoch 0 [Batch 2/11]: Loss: 2.4845
  Epoch 0 [Batch 3/11]: Loss: 2.0810
  Epoch 0 [Batch 4/11]: Loss: 2.2760
  Epoch 0 [Batch 5/11]: Loss: 2.1385
  Epoch 0 [Batch 6/11]: Loss: 1.0117
  Epoch 0 [Batch 7/11]: Loss: 3.0881
  Epoch 0 [Batch 8/11]: Loss: 3.4210
  Epoch 0 [Batch 9/11]: Loss: 2.7474
  Epoch 0 [Batch 10/11]: Loss: 3.3942
  Epoch 0 Train Summary: Avg Loss: 2.5407, Accuracy: 0.3779
  Validation Summary: Avg Loss: 8.2041, Accuracy: 0.2667, F1 (Macro): 0.1905
  New best model! Val loss improved from inf to 8.2041. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 0.6479
  Epoch 1 [Batch 1/11]: Loss: 2.1115
  Epoch 1 [Batch 2/11]: Loss: 0.8304
  Epoch 1 [Batch 3/11]: Loss: 0.9764
  Epoch 1 [Batch 4/11]: Loss: 0.2065
  Epoch 1 [Batch 5/11]: Loss: 1.1567
  Epoch 1 [Batch 6/11]: Loss: 1.8873
  Epoch 1 [Batch 7/11]: Loss: 1.3311
  Epoch 1 [Batch 8/11]: Loss: 2.6077
  Epoch 1 [Batch 9/11]: Loss: 0.5618
  Epoch 1 [Batch 10/11]: Loss: 0.8133
  Epoch 1 Train Summary: Avg Loss: 1.1937, Accuracy: 0.5836
  Validation Summary: Avg Loss: 7.1024, Accuracy: 0.2000, F1 (Macro): 0.1538
  New best model! Val loss improved from 8.2041 to 7.1024. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 1.7497
  Epoch 2 [Batch 1/11]: Loss: 1.7923
  Epoch 2 [Batch 2/11]: Loss: 0.4998
  Epoch 2 [Batch 3/11]: Loss: 0.8361
  Epoch 2 [Batch 4/11]: Loss: 0.7341
  Epoch 2 [Batch 5/11]: Loss: 1.4442
  Epoch 2 [Batch 6/11]: Loss: 2.0435
  Epoch 2 [Batch 7/11]: Loss: 1.1875
  Epoch 2 [Batch 8/11]: Loss: 1.5732
  Epoch 2 [Batch 9/11]: Loss: 1.2849
  Epoch 2 [Batch 10/11]: Loss: 1.3626
  Epoch 2 Train Summary: Avg Loss: 1.3189, Accuracy: 0.5715
  Validation Summary: Avg Loss: 5.2114, Accuracy: 0.2833, F1 (Macro): 0.2619
  New best model! Val loss improved from 7.1024 to 5.2114. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 0.5870
  Epoch 3 [Batch 1/11]: Loss: 0.6837
  Epoch 3 [Batch 2/11]: Loss: 1.4859
  Epoch 3 [Batch 3/11]: Loss: 0.7558
  Epoch 3 [Batch 4/11]: Loss: 1.1213
  Epoch 3 [Batch 5/11]: Loss: 1.2821
  Epoch 3 [Batch 6/11]: Loss: 0.9809
  Epoch 3 [Batch 7/11]: Loss: 1.4098
  Epoch 3 [Batch 8/11]: Loss: 2.0400
  Epoch 3 [Batch 9/11]: Loss: 0.4436
  Epoch 3 [Batch 10/11]: Loss: 0.4530
  Epoch 3 Train Summary: Avg Loss: 1.0221, Accuracy: 0.6146
  Validation Summary: Avg Loss: 4.4690, Accuracy: 0.2667, F1 (Macro): 0.1905
  New best model! Val loss improved from 5.2114 to 4.4690. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 0.7836
  Epoch 4 [Batch 1/11]: Loss: 0.9551
  Epoch 4 [Batch 2/11]: Loss: 0.2057
  Epoch 4 [Batch 3/11]: Loss: 1.3730
  Epoch 4 [Batch 4/11]: Loss: 0.3384
  Epoch 4 [Batch 5/11]: Loss: 0.0404
  Epoch 4 [Batch 6/11]: Loss: 0.7476
  Epoch 4 [Batch 7/11]: Loss: 0.2994
  Epoch 4 [Batch 8/11]: Loss: 0.9641
  Epoch 4 [Batch 9/11]: Loss: 0.8021
  Epoch 4 [Batch 10/11]: Loss: 2.4204
  Epoch 4 Train Summary: Avg Loss: 0.8118, Accuracy: 0.7244
  Validation Summary: Avg Loss: 5.6784, Accuracy: 0.1333, F1 (Macro): 0.1212

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 0.9608
  Epoch 5 [Batch 1/11]: Loss: 1.3452
  Epoch 5 [Batch 2/11]: Loss: 0.1769
  Epoch 5 [Batch 3/11]: Loss: 2.2372
  Epoch 5 [Batch 4/11]: Loss: 0.6180
  Epoch 5 [Batch 5/11]: Loss: 0.6283
  Epoch 5 [Batch 6/11]: Loss: 0.3109
  Epoch 5 [Batch 7/11]: Loss: 0.3869
  Epoch 5 [Batch 8/11]: Loss: 0.1394
  Epoch 5 [Batch 9/11]: Loss: 0.7025
  Epoch 5 [Batch 10/11]: Loss: 1.9069
  Epoch 5 Train Summary: Avg Loss: 0.8557, Accuracy: 0.6793
  Validation Summary: Avg Loss: 7.8151, Accuracy: 0.2167, F1 (Macro): 0.2323

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 0.3120
  Epoch 6 [Batch 1/11]: Loss: 0.7385
  Epoch 6 [Batch 2/11]: Loss: 0.4567
  Epoch 6 [Batch 3/11]: Loss: 0.4096
  Epoch 6 [Batch 4/11]: Loss: 0.1460
  Epoch 6 [Batch 5/11]: Loss: 0.2615
  Epoch 6 [Batch 6/11]: Loss: 0.4380
  Epoch 6 [Batch 7/11]: Loss: 1.3155
  Epoch 6 [Batch 8/11]: Loss: 0.3653
  Epoch 6 [Batch 9/11]: Loss: 0.9393
  Epoch 6 [Batch 10/11]: Loss: 1.5808
  Epoch 6 Train Summary: Avg Loss: 0.6330, Accuracy: 0.7709
  Validation Summary: Avg Loss: 9.1392, Accuracy: 0.2167, F1 (Macro): 0.2323

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.2784
  Epoch 7 [Batch 1/11]: Loss: 0.9218
  Epoch 7 [Batch 2/11]: Loss: 0.4587
  Epoch 7 [Batch 3/11]: Loss: 0.5558
  Epoch 7 [Batch 4/11]: Loss: 0.2720
  Epoch 7 [Batch 5/11]: Loss: 0.2792
  Epoch 7 [Batch 6/11]: Loss: 1.8062
  Epoch 7 [Batch 7/11]: Loss: 0.2562
  Epoch 7 [Batch 8/11]: Loss: 0.6031
  Epoch 7 [Batch 9/11]: Loss: 1.0032
  Epoch 7 [Batch 10/11]: Loss: 0.5811
  Epoch 7 Train Summary: Avg Loss: 0.6378, Accuracy: 0.7453
  Validation Summary: Avg Loss: 11.1466, Accuracy: 0.2167, F1 (Macro): 0.2323

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 2.3934
  Epoch 8 [Batch 1/11]: Loss: 0.5758
  Epoch 8 [Batch 2/11]: Loss: 0.9737
  Epoch 8 [Batch 3/11]: Loss: 0.5732
  Epoch 8 [Batch 4/11]: Loss: 0.8607
  Epoch 8 [Batch 5/11]: Loss: 0.6219
  Epoch 8 [Batch 6/11]: Loss: 0.5517
  Epoch 8 [Batch 7/11]: Loss: 0.9915
  Epoch 8 [Batch 8/11]: Loss: 0.1449
  Epoch 8 [Batch 9/11]: Loss: 0.0054
  Epoch 8 [Batch 10/11]: Loss: 0.0831
  Epoch 8 Train Summary: Avg Loss: 0.7068, Accuracy: 0.7763
  Validation Summary: Avg Loss: 9.1272, Accuracy: 0.1500, F1 (Macro): 0.1778

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 0.7319
  Epoch 9 [Batch 1/11]: Loss: 0.3886
  Epoch 9 [Batch 2/11]: Loss: 0.7651
  Epoch 9 [Batch 3/11]: Loss: 0.0340
  Epoch 9 [Batch 4/11]: Loss: 0.1989
  Epoch 9 [Batch 5/11]: Loss: 0.4258
  Epoch 9 [Batch 6/11]: Loss: 0.2268
  Epoch 9 [Batch 7/11]: Loss: 0.2963
  Epoch 9 [Batch 8/11]: Loss: 0.1825
  Epoch 9 [Batch 9/11]: Loss: 0.8423
  Epoch 9 [Batch 10/11]: Loss: 0.0060
  Epoch 9 Train Summary: Avg Loss: 0.3726, Accuracy: 0.9171
  Validation Summary: Avg Loss: 7.6474, Accuracy: 0.1500, F1 (Macro): 0.1778

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 0.1790
  Epoch 10 [Batch 1/11]: Loss: 0.2680
  Epoch 10 [Batch 2/11]: Loss: 0.3334
  Epoch 10 [Batch 3/11]: Loss: 1.1036
  Epoch 10 [Batch 4/11]: Loss: 0.4611
  Epoch 10 [Batch 5/11]: Loss: 0.2394
  Epoch 10 [Batch 6/11]: Loss: 1.5645
  Epoch 10 [Batch 7/11]: Loss: 0.3325
  Epoch 10 [Batch 8/11]: Loss: 1.0721
  Epoch 10 [Batch 9/11]: Loss: 1.3826
  Epoch 10 [Batch 10/11]: Loss: 0.0120
  Epoch 10 Train Summary: Avg Loss: 0.6316, Accuracy: 0.7170
  Validation Summary: Avg Loss: 7.3564, Accuracy: 0.1500, F1 (Macro): 0.1778

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 1.0334
  Epoch 11 [Batch 1/11]: Loss: 1.2211
  Epoch 11 [Batch 2/11]: Loss: 0.0214
  Epoch 11 [Batch 3/11]: Loss: 0.0446
  Epoch 11 [Batch 4/11]: Loss: 0.6192
  Epoch 11 [Batch 5/11]: Loss: 0.3591
  Epoch 11 [Batch 6/11]: Loss: 0.1985
  Epoch 11 [Batch 7/11]: Loss: 0.4388
  Epoch 11 [Batch 8/11]: Loss: 0.7978
  Epoch 11 [Batch 9/11]: Loss: 0.6968
  Epoch 11 [Batch 10/11]: Loss: 1.0949
  Epoch 11 Train Summary: Avg Loss: 0.5932, Accuracy: 0.8942
  Validation Summary: Avg Loss: 7.8507, Accuracy: 0.1500, F1 (Macro): 0.1778

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.3912
  Epoch 12 [Batch 1/11]: Loss: 1.6018
  Epoch 12 [Batch 2/11]: Loss: 0.2368
  Epoch 12 [Batch 3/11]: Loss: 0.0149
  Epoch 12 [Batch 4/11]: Loss: 0.0412
  Epoch 12 [Batch 5/11]: Loss: 0.5889
  Epoch 12 [Batch 6/11]: Loss: 0.6828
  Epoch 12 [Batch 7/11]: Loss: 0.6956
  Epoch 12 [Batch 8/11]: Loss: 0.5754
  Epoch 12 [Batch 9/11]: Loss: 0.4880
  Epoch 12 [Batch 10/11]: Loss: 0.1817
  Epoch 12 Train Summary: Avg Loss: 0.4998, Accuracy: 0.8106
  Validation Summary: Avg Loss: 7.5292, Accuracy: 0.1500, F1 (Macro): 0.1778

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 0.2158
  Epoch 13 [Batch 1/11]: Loss: 0.0181
  Epoch 13 [Batch 2/11]: Loss: 0.4805
  Epoch 13 [Batch 3/11]: Loss: 0.3496
  Epoch 13 [Batch 4/11]: Loss: 0.9644
  Epoch 13 [Batch 5/11]: Loss: 0.6051
  Epoch 13 [Batch 6/11]: Loss: 0.1712
  Epoch 13 [Batch 7/11]: Loss: 0.0833
  Epoch 13 [Batch 8/11]: Loss: 0.1379
  Epoch 13 [Batch 9/11]: Loss: 0.1946
  Epoch 13 [Batch 10/11]: Loss: 0.4876
  Epoch 13 Train Summary: Avg Loss: 0.3371, Accuracy: 0.8908
  Validation Summary: Avg Loss: 8.2766, Accuracy: 0.1500, F1 (Macro): 0.1778

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.9707
  Epoch 14 [Batch 1/11]: Loss: 0.4348
  Epoch 14 [Batch 2/11]: Loss: 0.8471
  Epoch 14 [Batch 3/11]: Loss: 0.5850
  Epoch 14 [Batch 4/11]: Loss: 0.2464
  Epoch 14 [Batch 5/11]: Loss: 0.0591
  Epoch 14 [Batch 6/11]: Loss: 0.8171
  Epoch 14 [Batch 7/11]: Loss: 0.0296
  Epoch 14 [Batch 8/11]: Loss: 0.2102
  Epoch 14 [Batch 9/11]: Loss: 0.2707
  Epoch 14 [Batch 10/11]: Loss: 3.5193
  Epoch 14 Train Summary: Avg Loss: 0.7264, Accuracy: 0.7823
  Validation Summary: Avg Loss: 7.5648, Accuracy: 0.1500, F1 (Macro): 0.1778
Training finished in 0.85 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 4.4690, Accuracy: 0.2667, F1 (Macro): 0.1905
Final Best Model Stats: Acc: 0.2667, F1: 0.1905, Loss: 4.4690
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=224x224 lr=5e-05 drop=0.0 seed=42
================================================================================
Starting experiment: efficientnet_b0__224x224__lr-5e-05__drop-0.0__seed-42
Output directory: results_ceph/efficientnet_b0__224x224__lr-5e-05__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.4837
  Epoch 0 [Batch 1/11]: Loss: 2.6607
  Epoch 0 [Batch 2/11]: Loss: 2.4571
  Epoch 0 [Batch 3/11]: Loss: 2.0420
  Epoch 0 [Batch 4/11]: Loss: 3.0517
  Epoch 0 [Batch 5/11]: Loss: 1.3035
  Epoch 0 [Batch 6/11]: Loss: 3.9728
  Epoch 0 [Batch 7/11]: Loss: 2.7352
  Epoch 0 [Batch 8/11]: Loss: 2.8369
  Epoch 0 [Batch 9/11]: Loss: 1.5006
  Epoch 0 [Batch 10/11]: Loss: 0.7443
  Epoch 0 Train Summary: Avg Loss: 2.2535, Accuracy: 0.3823
  Validation Summary: Avg Loss: 6.9008, Accuracy: 0.1500, F1 (Macro): 0.1407
  New best model! Val loss improved from inf to 6.9008. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.1343
  Epoch 1 [Batch 1/11]: Loss: 1.8372
  Epoch 1 [Batch 2/11]: Loss: 1.8468
  Epoch 1 [Batch 3/11]: Loss: 1.9392
  Epoch 1 [Batch 4/11]: Loss: 3.0305
  Epoch 1 [Batch 5/11]: Loss: 1.4680
  Epoch 1 [Batch 6/11]: Loss: 1.3606
  Epoch 1 [Batch 7/11]: Loss: 0.9761
  Epoch 1 [Batch 8/11]: Loss: 2.0785
  Epoch 1 [Batch 9/11]: Loss: 1.2852
  Epoch 1 [Batch 10/11]: Loss: 1.4492
  Epoch 1 Train Summary: Avg Loss: 1.6732, Accuracy: 0.5372
  Validation Summary: Avg Loss: 6.7506, Accuracy: 0.0833, F1 (Macro): 0.0606
  New best model! Val loss improved from 6.9008 to 6.7506. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 2.5734
  Epoch 2 [Batch 1/11]: Loss: 1.2593
  Epoch 2 [Batch 2/11]: Loss: 0.8160
  Epoch 2 [Batch 3/11]: Loss: 0.9262
  Epoch 2 [Batch 4/11]: Loss: 1.0176
  Epoch 2 [Batch 5/11]: Loss: 3.2858
  Epoch 2 [Batch 6/11]: Loss: 1.6350
  Epoch 2 [Batch 7/11]: Loss: 0.7483
  Epoch 2 [Batch 8/11]: Loss: 0.3023
  Epoch 2 [Batch 9/11]: Loss: 0.3572
  Epoch 2 [Batch 10/11]: Loss: 0.4084
  Epoch 2 Train Summary: Avg Loss: 1.2118, Accuracy: 0.5803
  Validation Summary: Avg Loss: 6.6258, Accuracy: 0.0833, F1 (Macro): 0.0606
  New best model! Val loss improved from 6.7506 to 6.6258. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 1.7663
  Epoch 3 [Batch 1/11]: Loss: 1.2578
  Epoch 3 [Batch 2/11]: Loss: 0.3110
  Epoch 3 [Batch 3/11]: Loss: 1.4823
  Epoch 3 [Batch 4/11]: Loss: 0.8450
  Epoch 3 [Batch 5/11]: Loss: 1.8005
  Epoch 3 [Batch 6/11]: Loss: 1.5959
  Epoch 3 [Batch 7/11]: Loss: 1.4593
  Epoch 3 [Batch 8/11]: Loss: 1.7335
  Epoch 3 [Batch 9/11]: Loss: 1.3885
  Epoch 3 [Batch 10/11]: Loss: 3.0011
  Epoch 3 Train Summary: Avg Loss: 1.5128, Accuracy: 0.5412
  Validation Summary: Avg Loss: 6.1119, Accuracy: 0.0833, F1 (Macro): 0.0606
  New best model! Val loss improved from 6.6258 to 6.1119. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 1.3437
  Epoch 4 [Batch 1/11]: Loss: 2.0035
  Epoch 4 [Batch 2/11]: Loss: 0.6121
  Epoch 4 [Batch 3/11]: Loss: 1.2604
  Epoch 4 [Batch 4/11]: Loss: 0.8132
  Epoch 4 [Batch 5/11]: Loss: 2.4010
  Epoch 4 [Batch 6/11]: Loss: 0.5046
  Epoch 4 [Batch 7/11]: Loss: 1.2211
  Epoch 4 [Batch 8/11]: Loss: 0.1717
  Epoch 4 [Batch 9/11]: Loss: 1.7339
  Epoch 4 [Batch 10/11]: Loss: 2.0103
  Epoch 4 Train Summary: Avg Loss: 1.2796, Accuracy: 0.5897
  Validation Summary: Avg Loss: 5.1417, Accuracy: 0.1500, F1 (Macro): 0.1407
  New best model! Val loss improved from 6.1119 to 5.1417. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 0.7645
  Epoch 5 [Batch 1/11]: Loss: 1.3440
  Epoch 5 [Batch 2/11]: Loss: 1.4388
  Epoch 5 [Batch 3/11]: Loss: 1.3455
  Epoch 5 [Batch 4/11]: Loss: 0.2063
  Epoch 5 [Batch 5/11]: Loss: 2.2751
  Epoch 5 [Batch 6/11]: Loss: 0.2954
  Epoch 5 [Batch 7/11]: Loss: 0.8473
  Epoch 5 [Batch 8/11]: Loss: 1.5246
  Epoch 5 [Batch 9/11]: Loss: 0.6770
  Epoch 5 [Batch 10/11]: Loss: 0.4083
  Epoch 5 Train Summary: Avg Loss: 1.0115, Accuracy: 0.5183
  Validation Summary: Avg Loss: 5.2477, Accuracy: 0.3000, F1 (Macro): 0.2815

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 1.2031
  Epoch 6 [Batch 1/11]: Loss: 1.2245
  Epoch 6 [Batch 2/11]: Loss: 1.0321
  Epoch 6 [Batch 3/11]: Loss: 1.1018
  Epoch 6 [Batch 4/11]: Loss: 0.8874
  Epoch 6 [Batch 5/11]: Loss: 0.4526
  Epoch 6 [Batch 6/11]: Loss: 0.5298
  Epoch 6 [Batch 7/11]: Loss: 0.5563
  Epoch 6 [Batch 8/11]: Loss: 0.1875
  Epoch 6 [Batch 9/11]: Loss: 0.6284
  Epoch 6 [Batch 10/11]: Loss: 1.3533
  Epoch 6 Train Summary: Avg Loss: 0.8324, Accuracy: 0.6032
  Validation Summary: Avg Loss: 5.3161, Accuracy: 0.2833, F1 (Macro): 0.2619

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.7797
  Epoch 7 [Batch 1/11]: Loss: 1.3805
  Epoch 7 [Batch 2/11]: Loss: 0.6064
  Epoch 7 [Batch 3/11]: Loss: 1.1297
  Epoch 7 [Batch 4/11]: Loss: 0.2179
  Epoch 7 [Batch 5/11]: Loss: 0.9454
  Epoch 7 [Batch 6/11]: Loss: 0.2211
  Epoch 7 [Batch 7/11]: Loss: 0.6152
  Epoch 7 [Batch 8/11]: Loss: 0.6837
  Epoch 7 [Batch 9/11]: Loss: 0.2044
  Epoch 7 [Batch 10/11]: Loss: 1.7325
  Epoch 7 Train Summary: Avg Loss: 0.7742, Accuracy: 0.7278
  Validation Summary: Avg Loss: 5.6852, Accuracy: 0.2833, F1 (Macro): 0.2619

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 0.2502
  Epoch 8 [Batch 1/11]: Loss: 0.8960
  Epoch 8 [Batch 2/11]: Loss: 0.5151
  Epoch 8 [Batch 3/11]: Loss: 1.7771
  Epoch 8 [Batch 4/11]: Loss: 0.5227
  Epoch 8 [Batch 5/11]: Loss: 1.9826
  Epoch 8 [Batch 6/11]: Loss: 0.1520
  Epoch 8 [Batch 7/11]: Loss: 0.1126
  Epoch 8 [Batch 8/11]: Loss: 0.8310
  Epoch 8 [Batch 9/11]: Loss: 0.6995
  Epoch 8 [Batch 10/11]: Loss: 1.7742
  Epoch 8 Train Summary: Avg Loss: 0.8648, Accuracy: 0.7130
  Validation Summary: Avg Loss: 5.6168, Accuracy: 0.2833, F1 (Macro): 0.2619

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 1.2841
  Epoch 9 [Batch 1/11]: Loss: 0.4335
  Epoch 9 [Batch 2/11]: Loss: 0.2656
  Epoch 9 [Batch 3/11]: Loss: 1.0215
  Epoch 9 [Batch 4/11]: Loss: 1.0570
  Epoch 9 [Batch 5/11]: Loss: 1.2039
  Epoch 9 [Batch 6/11]: Loss: 2.0250
  Epoch 9 [Batch 7/11]: Loss: 0.4695
  Epoch 9 [Batch 8/11]: Loss: 0.9277
  Epoch 9 [Batch 9/11]: Loss: 1.1783
  Epoch 9 [Batch 10/11]: Loss: 1.9791
  Epoch 9 Train Summary: Avg Loss: 1.0768, Accuracy: 0.5128
  Validation Summary: Avg Loss: 6.3995, Accuracy: 0.2833, F1 (Macro): 0.2619

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 0.5011
  Epoch 10 [Batch 1/11]: Loss: 1.6076
  Epoch 10 [Batch 2/11]: Loss: 0.1714
  Epoch 10 [Batch 3/11]: Loss: 0.6459
  Epoch 10 [Batch 4/11]: Loss: 0.1987
  Epoch 10 [Batch 5/11]: Loss: 0.8157
  Epoch 10 [Batch 6/11]: Loss: 0.3753
  Epoch 10 [Batch 7/11]: Loss: 0.9583
  Epoch 10 [Batch 8/11]: Loss: 0.2597
  Epoch 10 [Batch 9/11]: Loss: 0.4650
  Epoch 10 [Batch 10/11]: Loss: 0.4063
  Epoch 10 Train Summary: Avg Loss: 0.5823, Accuracy: 0.7722
  Validation Summary: Avg Loss: 6.0929, Accuracy: 0.2833, F1 (Macro): 0.2619

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 0.2835
  Epoch 11 [Batch 1/11]: Loss: 0.3003
  Epoch 11 [Batch 2/11]: Loss: 0.2248
  Epoch 11 [Batch 3/11]: Loss: 0.5654
  Epoch 11 [Batch 4/11]: Loss: 0.0729
  Epoch 11 [Batch 5/11]: Loss: 0.3787
  Epoch 11 [Batch 6/11]: Loss: 0.5934
  Epoch 11 [Batch 7/11]: Loss: 0.1266
  Epoch 11 [Batch 8/11]: Loss: 0.4363
  Epoch 11 [Batch 9/11]: Loss: 0.8391
  Epoch 11 [Batch 10/11]: Loss: 0.0616
  Epoch 11 Train Summary: Avg Loss: 0.3530, Accuracy: 0.8577
  Validation Summary: Avg Loss: 5.7695, Accuracy: 0.2833, F1 (Macro): 0.2619

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.8375
  Epoch 12 [Batch 1/11]: Loss: 0.0570
  Epoch 12 [Batch 2/11]: Loss: 0.1577
  Epoch 12 [Batch 3/11]: Loss: 0.1058
  Epoch 12 [Batch 4/11]: Loss: 0.7966
  Epoch 12 [Batch 5/11]: Loss: 0.1180
  Epoch 12 [Batch 6/11]: Loss: 0.2960
  Epoch 12 [Batch 7/11]: Loss: 0.1468
  Epoch 12 [Batch 8/11]: Loss: 0.5516
  Epoch 12 [Batch 9/11]: Loss: 0.1409
  Epoch 12 [Batch 10/11]: Loss: 0.9873
  Epoch 12 Train Summary: Avg Loss: 0.3814, Accuracy: 0.9036
  Validation Summary: Avg Loss: 5.5522, Accuracy: 0.2833, F1 (Macro): 0.2619

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 0.6522
  Epoch 13 [Batch 1/11]: Loss: 0.9253
  Epoch 13 [Batch 2/11]: Loss: 1.3521
  Epoch 13 [Batch 3/11]: Loss: 0.2013
  Epoch 13 [Batch 4/11]: Loss: 0.5936
  Epoch 13 [Batch 5/11]: Loss: 1.0821
  Epoch 13 [Batch 6/11]: Loss: 0.2184
  Epoch 13 [Batch 7/11]: Loss: 0.4319
  Epoch 13 [Batch 8/11]: Loss: 0.6060
  Epoch 13 [Batch 9/11]: Loss: 0.4921
  Epoch 13 [Batch 10/11]: Loss: 2.9946
  Epoch 13 Train Summary: Avg Loss: 0.8681, Accuracy: 0.7352
  Validation Summary: Avg Loss: 5.5348, Accuracy: 0.2833, F1 (Macro): 0.2619

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.4417
  Epoch 14 [Batch 1/11]: Loss: 0.1707
  Epoch 14 [Batch 2/11]: Loss: 0.0453
  Epoch 14 [Batch 3/11]: Loss: 0.2267
  Epoch 14 [Batch 4/11]: Loss: 0.3393
  Epoch 14 [Batch 5/11]: Loss: 0.3079
  Epoch 14 [Batch 6/11]: Loss: 0.4720
  Epoch 14 [Batch 7/11]: Loss: 0.6758
  Epoch 14 [Batch 8/11]: Loss: 0.6779
  Epoch 14 [Batch 9/11]: Loss: 0.8453
  Epoch 14 [Batch 10/11]: Loss: 0.9415
  Epoch 14 Train Summary: Avg Loss: 0.4676, Accuracy: 0.7621
  Validation Summary: Avg Loss: 5.6050, Accuracy: 0.2833, F1 (Macro): 0.2619
Training finished in 0.88 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 5.1417, Accuracy: 0.1500, F1 (Macro): 0.1407
Final Best Model Stats: Acc: 0.1500, F1: 0.1407, Loss: 5.1417
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=224x224 lr=5e-05 drop=0.0 seed=123
================================================================================
Starting experiment: efficientnet_b0__224x224__lr-5e-05__drop-0.0__seed-123
Output directory: results_ceph/efficientnet_b0__224x224__lr-5e-05__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 2.4162
  Epoch 0 [Batch 1/11]: Loss: 4.8757
  Epoch 0 [Batch 2/11]: Loss: 3.5724
  Epoch 0 [Batch 3/11]: Loss: 3.6197
  Epoch 0 [Batch 4/11]: Loss: 2.1305
  Epoch 0 [Batch 5/11]: Loss: 3.9502
  Epoch 0 [Batch 6/11]: Loss: 2.2671
  Epoch 0 [Batch 7/11]: Loss: 1.5769
  Epoch 0 [Batch 8/11]: Loss: 1.3839
  Epoch 0 [Batch 9/11]: Loss: 4.9403
  Epoch 0 [Batch 10/11]: Loss: 0.5098
  Epoch 0 Train Summary: Avg Loss: 2.8403, Accuracy: 0.3262
  Validation Summary: Avg Loss: 4.1311, Accuracy: 0.4000, F1 (Macro): 0.1693
  New best model! Val loss improved from inf to 4.1311. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 2.4366
  Epoch 1 [Batch 1/11]: Loss: 2.7836
  Epoch 1 [Batch 2/11]: Loss: 2.4325
  Epoch 1 [Batch 3/11]: Loss: 2.5323
  Epoch 1 [Batch 4/11]: Loss: 1.2730
  Epoch 1 [Batch 5/11]: Loss: 1.8951
  Epoch 1 [Batch 6/11]: Loss: 1.2717
  Epoch 1 [Batch 7/11]: Loss: 3.3471
  Epoch 1 [Batch 8/11]: Loss: 2.3996
  Epoch 1 [Batch 9/11]: Loss: 1.2421
  Epoch 1 [Batch 10/11]: Loss: 0.4544
  Epoch 1 Train Summary: Avg Loss: 2.0062, Accuracy: 0.4799
  Validation Summary: Avg Loss: 3.0752, Accuracy: 0.2833, F1 (Macro): 0.3333
  New best model! Val loss improved from 4.1311 to 3.0752. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 1.8391
  Epoch 2 [Batch 1/11]: Loss: 2.1466
  Epoch 2 [Batch 2/11]: Loss: 2.4163
  Epoch 2 [Batch 3/11]: Loss: 0.9708
  Epoch 2 [Batch 4/11]: Loss: 1.6991
  Epoch 2 [Batch 5/11]: Loss: 2.7191
  Epoch 2 [Batch 6/11]: Loss: 1.1521
  Epoch 2 [Batch 7/11]: Loss: 2.5820
  Epoch 2 [Batch 8/11]: Loss: 0.4817
  Epoch 2 [Batch 9/11]: Loss: 2.5721
  Epoch 2 [Batch 10/11]: Loss: 2.6055
  Epoch 2 Train Summary: Avg Loss: 1.9259, Accuracy: 0.4598
  Validation Summary: Avg Loss: 2.8836, Accuracy: 0.3667, F1 (Macro): 0.3905
  New best model! Val loss improved from 3.0752 to 2.8836. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 1.7262
  Epoch 3 [Batch 1/11]: Loss: 0.7420
  Epoch 3 [Batch 2/11]: Loss: 1.1407
  Epoch 3 [Batch 3/11]: Loss: 1.0255
  Epoch 3 [Batch 4/11]: Loss: 1.8138
  Epoch 3 [Batch 5/11]: Loss: 2.8612
  Epoch 3 [Batch 6/11]: Loss: 1.8789
  Epoch 3 [Batch 7/11]: Loss: 0.2038
  Epoch 3 [Batch 8/11]: Loss: 2.4504
  Epoch 3 [Batch 9/11]: Loss: 1.4530
  Epoch 3 [Batch 10/11]: Loss: 0.7380
  Epoch 3 Train Summary: Avg Loss: 1.4576, Accuracy: 0.4987
  Validation Summary: Avg Loss: 3.9423, Accuracy: 0.3500, F1 (Macro): 0.3556

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 2.7220
  Epoch 4 [Batch 1/11]: Loss: 1.0189
  Epoch 4 [Batch 2/11]: Loss: 1.2478
  Epoch 4 [Batch 3/11]: Loss: 0.9277
  Epoch 4 [Batch 4/11]: Loss: 0.9388
  Epoch 4 [Batch 5/11]: Loss: 0.9406
  Epoch 4 [Batch 6/11]: Loss: 0.8411
  Epoch 4 [Batch 7/11]: Loss: 1.5693
  Epoch 4 [Batch 8/11]: Loss: 0.9015
  Epoch 4 [Batch 9/11]: Loss: 1.1317
  Epoch 4 [Batch 10/11]: Loss: 0.0054
  Epoch 4 Train Summary: Avg Loss: 1.1132, Accuracy: 0.6422
  Validation Summary: Avg Loss: 3.9973, Accuracy: 0.2167, F1 (Macro): 0.2165

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 0.6124
  Epoch 5 [Batch 1/11]: Loss: 0.5874
  Epoch 5 [Batch 2/11]: Loss: 0.3489
  Epoch 5 [Batch 3/11]: Loss: 0.4631
  Epoch 5 [Batch 4/11]: Loss: 1.3092
  Epoch 5 [Batch 5/11]: Loss: 0.8076
  Epoch 5 [Batch 6/11]: Loss: 1.4487
  Epoch 5 [Batch 7/11]: Loss: 1.8160
  Epoch 5 [Batch 8/11]: Loss: 0.9229
  Epoch 5 [Batch 9/11]: Loss: 1.0270
  Epoch 5 [Batch 10/11]: Loss: 0.0910
  Epoch 5 Train Summary: Avg Loss: 0.8577, Accuracy: 0.6301
  Validation Summary: Avg Loss: 3.5888, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 0.4946
  Epoch 6 [Batch 1/11]: Loss: 1.8007
  Epoch 6 [Batch 2/11]: Loss: 1.0842
  Epoch 6 [Batch 3/11]: Loss: 1.6754
  Epoch 6 [Batch 4/11]: Loss: 0.5989
  Epoch 6 [Batch 5/11]: Loss: 0.3373
  Epoch 6 [Batch 6/11]: Loss: 0.3912
  Epoch 6 [Batch 7/11]: Loss: 0.7884
  Epoch 6 [Batch 8/11]: Loss: 0.5837
  Epoch 6 [Batch 9/11]: Loss: 0.1543
  Epoch 6 [Batch 10/11]: Loss: 1.9533
  Epoch 6 Train Summary: Avg Loss: 0.8965, Accuracy: 0.6921
  Validation Summary: Avg Loss: 3.7904, Accuracy: 0.4167, F1 (Macro): 0.3714

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.4799
  Epoch 7 [Batch 1/11]: Loss: 0.7559
  Epoch 7 [Batch 2/11]: Loss: 0.2940
  Epoch 7 [Batch 3/11]: Loss: 0.2818
  Epoch 7 [Batch 4/11]: Loss: 0.8848
  Epoch 7 [Batch 5/11]: Loss: 0.0609
  Epoch 7 [Batch 6/11]: Loss: 0.4971
  Epoch 7 [Batch 7/11]: Loss: 0.3087
  Epoch 7 [Batch 8/11]: Loss: 1.5234
  Epoch 7 [Batch 9/11]: Loss: 1.3730
  Epoch 7 [Batch 10/11]: Loss: 1.1312
  Epoch 7 Train Summary: Avg Loss: 0.6901, Accuracy: 0.7635
  Validation Summary: Avg Loss: 4.8076, Accuracy: 0.4167, F1 (Macro): 0.3714

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 0.2130
  Epoch 8 [Batch 1/11]: Loss: 0.6550
  Epoch 8 [Batch 2/11]: Loss: 0.6995
  Epoch 8 [Batch 3/11]: Loss: 1.2936
  Epoch 8 [Batch 4/11]: Loss: 0.8079
  Epoch 8 [Batch 5/11]: Loss: 0.4462
  Epoch 8 [Batch 6/11]: Loss: 1.1533
  Epoch 8 [Batch 7/11]: Loss: 0.8645
  Epoch 8 [Batch 8/11]: Loss: 0.2216
  Epoch 8 [Batch 9/11]: Loss: 0.2997
  Epoch 8 [Batch 10/11]: Loss: 0.7016
  Epoch 8 Train Summary: Avg Loss: 0.6687, Accuracy: 0.7419
  Validation Summary: Avg Loss: 4.5637, Accuracy: 0.4167, F1 (Macro): 0.3714

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 0.4992
  Epoch 9 [Batch 1/11]: Loss: 0.2543
  Epoch 9 [Batch 2/11]: Loss: 0.5529
  Epoch 9 [Batch 3/11]: Loss: 0.3455
  Epoch 9 [Batch 4/11]: Loss: 0.6616
  Epoch 9 [Batch 5/11]: Loss: 0.7751
  Epoch 9 [Batch 6/11]: Loss: 0.4947
  Epoch 9 [Batch 7/11]: Loss: 0.5357
  Epoch 9 [Batch 8/11]: Loss: 0.9841
  Epoch 9 [Batch 9/11]: Loss: 0.4987
  Epoch 9 [Batch 10/11]: Loss: 1.1803
  Epoch 9 Train Summary: Avg Loss: 0.6166, Accuracy: 0.6921
  Validation Summary: Avg Loss: 3.8584, Accuracy: 0.4167, F1 (Macro): 0.3714

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 0.3878
  Epoch 10 [Batch 1/11]: Loss: 0.0307
  Epoch 10 [Batch 2/11]: Loss: 1.3375
  Epoch 10 [Batch 3/11]: Loss: 0.4382
  Epoch 10 [Batch 4/11]: Loss: 0.5992
  Epoch 10 [Batch 5/11]: Loss: 0.4077
  Epoch 10 [Batch 6/11]: Loss: 0.9694
  Epoch 10 [Batch 7/11]: Loss: 0.3227
  Epoch 10 [Batch 8/11]: Loss: 1.1845
  Epoch 10 [Batch 9/11]: Loss: 1.9821
  Epoch 10 [Batch 10/11]: Loss: 2.5375
  Epoch 10 Train Summary: Avg Loss: 0.9270, Accuracy: 0.6307
  Validation Summary: Avg Loss: 4.9550, Accuracy: 0.4167, F1 (Macro): 0.3714

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 0.2356
  Epoch 11 [Batch 1/11]: Loss: 0.2240
  Epoch 11 [Batch 2/11]: Loss: 1.1000
  Epoch 11 [Batch 3/11]: Loss: 0.3515
  Epoch 11 [Batch 4/11]: Loss: 0.5767
  Epoch 11 [Batch 5/11]: Loss: 0.6600
  Epoch 11 [Batch 6/11]: Loss: 1.1385
  Epoch 11 [Batch 7/11]: Loss: 0.4825
  Epoch 11 [Batch 8/11]: Loss: 0.0778
  Epoch 11 [Batch 9/11]: Loss: 0.1627
  Epoch 11 [Batch 10/11]: Loss: 1.0875
  Epoch 11 Train Summary: Avg Loss: 0.5543, Accuracy: 0.7648
  Validation Summary: Avg Loss: 6.2990, Accuracy: 0.4167, F1 (Macro): 0.3714

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.5424
  Epoch 12 [Batch 1/11]: Loss: 1.0308
  Epoch 12 [Batch 2/11]: Loss: 0.1189
  Epoch 12 [Batch 3/11]: Loss: 0.4694
  Epoch 12 [Batch 4/11]: Loss: 0.6901
  Epoch 12 [Batch 5/11]: Loss: 0.7477
  Epoch 12 [Batch 6/11]: Loss: 0.6246
  Epoch 12 [Batch 7/11]: Loss: 0.8013
  Epoch 12 [Batch 8/11]: Loss: 0.6967
  Epoch 12 [Batch 9/11]: Loss: 0.1921
  Epoch 12 [Batch 10/11]: Loss: 0.9318
  Epoch 12 Train Summary: Avg Loss: 0.6224, Accuracy: 0.7325
  Validation Summary: Avg Loss: 4.8906, Accuracy: 0.4167, F1 (Macro): 0.3714

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 1.0592
  Epoch 13 [Batch 1/11]: Loss: 0.9131
  Epoch 13 [Batch 2/11]: Loss: 0.3813
  Epoch 13 [Batch 3/11]: Loss: 0.4889
  Epoch 13 [Batch 4/11]: Loss: 0.1553
  Epoch 13 [Batch 5/11]: Loss: 0.2592
  Epoch 13 [Batch 6/11]: Loss: 0.5270
  Epoch 13 [Batch 7/11]: Loss: 0.2960
  Epoch 13 [Batch 8/11]: Loss: 0.5219
  Epoch 13 [Batch 9/11]: Loss: 0.0721
  Epoch 13 [Batch 10/11]: Loss: 2.8795
  Epoch 13 Train Summary: Avg Loss: 0.6867, Accuracy: 0.7573
  Validation Summary: Avg Loss: 5.3483, Accuracy: 0.4167, F1 (Macro): 0.3714

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.3406
  Epoch 14 [Batch 1/11]: Loss: 0.1847
  Epoch 14 [Batch 2/11]: Loss: 1.3468
  Epoch 14 [Batch 3/11]: Loss: 0.3093
  Epoch 14 [Batch 4/11]: Loss: 1.3623
  Epoch 14 [Batch 5/11]: Loss: 0.4921
  Epoch 14 [Batch 6/11]: Loss: 0.5559
  Epoch 14 [Batch 7/11]: Loss: 0.7439
  Epoch 14 [Batch 8/11]: Loss: 0.7941
  Epoch 14 [Batch 9/11]: Loss: 0.1607
  Epoch 14 [Batch 10/11]: Loss: 0.6386
  Epoch 14 Train Summary: Avg Loss: 0.6299, Accuracy: 0.7061
  Validation Summary: Avg Loss: 4.4603, Accuracy: 0.4167, F1 (Macro): 0.3714
Training finished in 0.84 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 2.8836, Accuracy: 0.3667, F1 (Macro): 0.3905
Final Best Model Stats: Acc: 0.3667, F1: 0.3905, Loss: 2.8836
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=224x224 lr=5e-05 drop=0.0 seed=999
================================================================================
Starting experiment: efficientnet_b0__224x224__lr-5e-05__drop-0.0__seed-999
Output directory: results_ceph/efficientnet_b0__224x224__lr-5e-05__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 2.5511
  Epoch 0 [Batch 1/11]: Loss: 2.7924
  Epoch 0 [Batch 2/11]: Loss: 2.6527
  Epoch 0 [Batch 3/11]: Loss: 2.2021
  Epoch 0 [Batch 4/11]: Loss: 2.1999
  Epoch 0 [Batch 5/11]: Loss: 2.0672
  Epoch 0 [Batch 6/11]: Loss: 0.8577
  Epoch 0 [Batch 7/11]: Loss: 2.5161
  Epoch 0 [Batch 8/11]: Loss: 3.0764
  Epoch 0 [Batch 9/11]: Loss: 3.0120
  Epoch 0 [Batch 10/11]: Loss: 3.1138
  Epoch 0 Train Summary: Avg Loss: 2.4583, Accuracy: 0.3853
  Validation Summary: Avg Loss: 7.1928, Accuracy: 0.2667, F1 (Macro): 0.1905
  New best model! Val loss improved from inf to 7.1928. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 0.7088
  Epoch 1 [Batch 1/11]: Loss: 2.5605
  Epoch 1 [Batch 2/11]: Loss: 1.1388
  Epoch 1 [Batch 3/11]: Loss: 1.1199
  Epoch 1 [Batch 4/11]: Loss: 0.2308
  Epoch 1 [Batch 5/11]: Loss: 1.5011
  Epoch 1 [Batch 6/11]: Loss: 1.7075
  Epoch 1 [Batch 7/11]: Loss: 1.3432
  Epoch 1 [Batch 8/11]: Loss: 2.4712
  Epoch 1 [Batch 9/11]: Loss: 0.9116
  Epoch 1 [Batch 10/11]: Loss: 1.1531
  Epoch 1 Train Summary: Avg Loss: 1.3497, Accuracy: 0.5404
  Validation Summary: Avg Loss: 6.9458, Accuracy: 0.2667, F1 (Macro): 0.1905
  New best model! Val loss improved from 7.1928 to 6.9458. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 2.2933
  Epoch 2 [Batch 1/11]: Loss: 1.8648
  Epoch 2 [Batch 2/11]: Loss: 1.0229
  Epoch 2 [Batch 3/11]: Loss: 1.5115
  Epoch 2 [Batch 4/11]: Loss: 0.7749
  Epoch 2 [Batch 5/11]: Loss: 2.2153
  Epoch 2 [Batch 6/11]: Loss: 1.9325
  Epoch 2 [Batch 7/11]: Loss: 1.6786
  Epoch 2 [Batch 8/11]: Loss: 1.8364
  Epoch 2 [Batch 9/11]: Loss: 1.5622
  Epoch 2 [Batch 10/11]: Loss: 1.4791
  Epoch 2 Train Summary: Avg Loss: 1.6519, Accuracy: 0.5034
  Validation Summary: Avg Loss: 4.7372, Accuracy: 0.3500, F1 (Macro): 0.3162
  New best model! Val loss improved from 6.9458 to 4.7372. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 0.7254
  Epoch 3 [Batch 1/11]: Loss: 0.6672
  Epoch 3 [Batch 2/11]: Loss: 1.4323
  Epoch 3 [Batch 3/11]: Loss: 0.9455
  Epoch 3 [Batch 4/11]: Loss: 1.4193
  Epoch 3 [Batch 5/11]: Loss: 1.0437
  Epoch 3 [Batch 6/11]: Loss: 1.0050
  Epoch 3 [Batch 7/11]: Loss: 2.1773
  Epoch 3 [Batch 8/11]: Loss: 2.1408
  Epoch 3 [Batch 9/11]: Loss: 0.4664
  Epoch 3 [Batch 10/11]: Loss: 0.8541
  Epoch 3 Train Summary: Avg Loss: 1.1706, Accuracy: 0.6341
  Validation Summary: Avg Loss: 4.7116, Accuracy: 0.2667, F1 (Macro): 0.2051
  New best model! Val loss improved from 4.7372 to 4.7116. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 1.4084
  Epoch 4 [Batch 1/11]: Loss: 1.9126
  Epoch 4 [Batch 2/11]: Loss: 0.7781
  Epoch 4 [Batch 3/11]: Loss: 1.5280
  Epoch 4 [Batch 4/11]: Loss: 1.0300
  Epoch 4 [Batch 5/11]: Loss: 0.1301
  Epoch 4 [Batch 6/11]: Loss: 0.7796
  Epoch 4 [Batch 7/11]: Loss: 0.8511
  Epoch 4 [Batch 8/11]: Loss: 0.8129
  Epoch 4 [Batch 9/11]: Loss: 0.8144
  Epoch 4 [Batch 10/11]: Loss: 2.2407
  Epoch 4 Train Summary: Avg Loss: 1.1169, Accuracy: 0.5545
  Validation Summary: Avg Loss: 4.9372, Accuracy: 0.1333, F1 (Macro): 0.1212

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 1.2960
  Epoch 5 [Batch 1/11]: Loss: 1.9337
  Epoch 5 [Batch 2/11]: Loss: 0.2910
  Epoch 5 [Batch 3/11]: Loss: 2.3580
  Epoch 5 [Batch 4/11]: Loss: 0.9442
  Epoch 5 [Batch 5/11]: Loss: 1.3875
  Epoch 5 [Batch 6/11]: Loss: 0.4625
  Epoch 5 [Batch 7/11]: Loss: 1.1319
  Epoch 5 [Batch 8/11]: Loss: 0.9495
  Epoch 5 [Batch 9/11]: Loss: 1.5327
  Epoch 5 [Batch 10/11]: Loss: 2.5096
  Epoch 5 Train Summary: Avg Loss: 1.3452, Accuracy: 0.5674
  Validation Summary: Avg Loss: 5.9223, Accuracy: 0.2167, F1 (Macro): 0.2545

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 0.5366
  Epoch 6 [Batch 1/11]: Loss: 0.7681
  Epoch 6 [Batch 2/11]: Loss: 0.8967
  Epoch 6 [Batch 3/11]: Loss: 1.1156
  Epoch 6 [Batch 4/11]: Loss: 0.6040
  Epoch 6 [Batch 5/11]: Loss: 0.4036
  Epoch 6 [Batch 6/11]: Loss: 0.5777
  Epoch 6 [Batch 7/11]: Loss: 1.0702
  Epoch 6 [Batch 8/11]: Loss: 0.3235
  Epoch 6 [Batch 9/11]: Loss: 0.6285
  Epoch 6 [Batch 10/11]: Loss: 0.8232
  Epoch 6 Train Summary: Avg Loss: 0.7043, Accuracy: 0.6947
  Validation Summary: Avg Loss: 6.4838, Accuracy: 0.2167, F1 (Macro): 0.2545

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.8123
  Epoch 7 [Batch 1/11]: Loss: 0.8744
  Epoch 7 [Batch 2/11]: Loss: 0.8572
  Epoch 7 [Batch 3/11]: Loss: 0.5394
  Epoch 7 [Batch 4/11]: Loss: 0.4154
  Epoch 7 [Batch 5/11]: Loss: 0.8661
  Epoch 7 [Batch 6/11]: Loss: 1.3283
  Epoch 7 [Batch 7/11]: Loss: 0.2154
  Epoch 7 [Batch 8/11]: Loss: 0.6187
  Epoch 7 [Batch 9/11]: Loss: 1.0004
  Epoch 7 [Batch 10/11]: Loss: 0.5803
  Epoch 7 Train Summary: Avg Loss: 0.7371, Accuracy: 0.6598
  Validation Summary: Avg Loss: 7.1067, Accuracy: 0.2167, F1 (Macro): 0.2323

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 2.2655
  Epoch 8 [Batch 1/11]: Loss: 0.6927
  Epoch 8 [Batch 2/11]: Loss: 0.6781
  Epoch 8 [Batch 3/11]: Loss: 0.8603
  Epoch 8 [Batch 4/11]: Loss: 0.6132
  Epoch 8 [Batch 5/11]: Loss: 0.4792
  Epoch 8 [Batch 6/11]: Loss: 0.8664
  Epoch 8 [Batch 7/11]: Loss: 0.8526
  Epoch 8 [Batch 8/11]: Loss: 0.3002
  Epoch 8 [Batch 9/11]: Loss: 0.2617
  Epoch 8 [Batch 10/11]: Loss: 0.8694
  Epoch 8 Train Summary: Avg Loss: 0.7945, Accuracy: 0.6955
  Validation Summary: Avg Loss: 6.9463, Accuracy: 0.2167, F1 (Macro): 0.2323

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 1.5025
  Epoch 9 [Batch 1/11]: Loss: 0.4837
  Epoch 9 [Batch 2/11]: Loss: 0.3581
  Epoch 9 [Batch 3/11]: Loss: 0.3136
  Epoch 9 [Batch 4/11]: Loss: 0.4307
  Epoch 9 [Batch 5/11]: Loss: 0.5198
  Epoch 9 [Batch 6/11]: Loss: 0.4648
  Epoch 9 [Batch 7/11]: Loss: 0.8544
  Epoch 9 [Batch 8/11]: Loss: 0.3343
  Epoch 9 [Batch 9/11]: Loss: 0.7013
  Epoch 9 [Batch 10/11]: Loss: 0.0601
  Epoch 9 Train Summary: Avg Loss: 0.5476, Accuracy: 0.7480
  Validation Summary: Avg Loss: 7.3020, Accuracy: 0.2833, F1 (Macro): 0.2619

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 0.2214
  Epoch 10 [Batch 1/11]: Loss: 0.3818
  Epoch 10 [Batch 2/11]: Loss: 0.5755
  Epoch 10 [Batch 3/11]: Loss: 0.8909
  Epoch 10 [Batch 4/11]: Loss: 0.7568
  Epoch 10 [Batch 5/11]: Loss: 0.1641
  Epoch 10 [Batch 6/11]: Loss: 1.6468
  Epoch 10 [Batch 7/11]: Loss: 0.6901
  Epoch 10 [Batch 8/11]: Loss: 1.0082
  Epoch 10 [Batch 9/11]: Loss: 0.8091
  Epoch 10 [Batch 10/11]: Loss: 0.0232
  Epoch 10 Train Summary: Avg Loss: 0.6516, Accuracy: 0.6793
  Validation Summary: Avg Loss: 6.9653, Accuracy: 0.2167, F1 (Macro): 0.2323

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 0.7325
  Epoch 11 [Batch 1/11]: Loss: 1.2171
  Epoch 11 [Batch 2/11]: Loss: 0.0700
  Epoch 11 [Batch 3/11]: Loss: 0.3373
  Epoch 11 [Batch 4/11]: Loss: 0.5875
  Epoch 11 [Batch 5/11]: Loss: 0.3323
  Epoch 11 [Batch 6/11]: Loss: 0.1317
  Epoch 11 [Batch 7/11]: Loss: 0.6907
  Epoch 11 [Batch 8/11]: Loss: 1.0074
  Epoch 11 [Batch 9/11]: Loss: 0.8086
  Epoch 11 [Batch 10/11]: Loss: 1.0279
  Epoch 11 Train Summary: Avg Loss: 0.6312, Accuracy: 0.7757
  Validation Summary: Avg Loss: 7.1208, Accuracy: 0.2167, F1 (Macro): 0.2323

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.5152
  Epoch 12 [Batch 1/11]: Loss: 1.5069
  Epoch 12 [Batch 2/11]: Loss: 0.4003
  Epoch 12 [Batch 3/11]: Loss: 0.0544
  Epoch 12 [Batch 4/11]: Loss: 0.1663
  Epoch 12 [Batch 5/11]: Loss: 1.5479
  Epoch 12 [Batch 6/11]: Loss: 0.6170
  Epoch 12 [Batch 7/11]: Loss: 1.0551
  Epoch 12 [Batch 8/11]: Loss: 0.5201
  Epoch 12 [Batch 9/11]: Loss: 0.9932
  Epoch 12 [Batch 10/11]: Loss: 0.1688
  Epoch 12 Train Summary: Avg Loss: 0.6859, Accuracy: 0.7904
  Validation Summary: Avg Loss: 7.0695, Accuracy: 0.2167, F1 (Macro): 0.2323

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 0.2922
  Epoch 13 [Batch 1/11]: Loss: 0.1232
  Epoch 13 [Batch 2/11]: Loss: 0.5916
  Epoch 13 [Batch 3/11]: Loss: 0.2817
  Epoch 13 [Batch 4/11]: Loss: 0.7567
  Epoch 13 [Batch 5/11]: Loss: 1.0594
  Epoch 13 [Batch 6/11]: Loss: 0.8695
  Epoch 13 [Batch 7/11]: Loss: 0.2119
  Epoch 13 [Batch 8/11]: Loss: 0.2875
  Epoch 13 [Batch 9/11]: Loss: 0.6727
  Epoch 13 [Batch 10/11]: Loss: 0.5838
  Epoch 13 Train Summary: Avg Loss: 0.5209, Accuracy: 0.7904
  Validation Summary: Avg Loss: 7.6021, Accuracy: 0.2833, F1 (Macro): 0.2778

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 1.1722
  Epoch 14 [Batch 1/11]: Loss: 0.5993
  Epoch 14 [Batch 2/11]: Loss: 0.8168
  Epoch 14 [Batch 3/11]: Loss: 0.4605
  Epoch 14 [Batch 4/11]: Loss: 0.2744
  Epoch 14 [Batch 5/11]: Loss: 0.8174
  Epoch 14 [Batch 6/11]: Loss: 0.6530
  Epoch 14 [Batch 7/11]: Loss: 0.0263
  Epoch 14 [Batch 8/11]: Loss: 0.4372
  Epoch 14 [Batch 9/11]: Loss: 0.1521
  Epoch 14 [Batch 10/11]: Loss: 2.5563
  Epoch 14 Train Summary: Avg Loss: 0.7241, Accuracy: 0.7621
  Validation Summary: Avg Loss: 7.1209, Accuracy: 0.2167, F1 (Macro): 0.2165
Training finished in 0.85 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 4.7116, Accuracy: 0.2667, F1 (Macro): 0.2051
Final Best Model Stats: Acc: 0.2667, F1: 0.2051, Loss: 4.7116
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=224x224 lr=1e-05 drop=0.0 seed=42
================================================================================
Starting experiment: efficientnet_b0__224x224__lr-1e-05__drop-0.0__seed-42
Output directory: results_ceph/efficientnet_b0__224x224__lr-1e-05__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.4837
  Epoch 0 [Batch 1/11]: Loss: 2.6601
  Epoch 0 [Batch 2/11]: Loss: 2.5339
  Epoch 0 [Batch 3/11]: Loss: 2.2113
  Epoch 0 [Batch 4/11]: Loss: 2.9051
  Epoch 0 [Batch 5/11]: Loss: 1.4541
  Epoch 0 [Batch 6/11]: Loss: 4.2546
  Epoch 0 [Batch 7/11]: Loss: 2.9593
  Epoch 0 [Batch 8/11]: Loss: 3.0842
  Epoch 0 [Batch 9/11]: Loss: 1.4791
  Epoch 0 [Batch 10/11]: Loss: 1.0062
  Epoch 0 Train Summary: Avg Loss: 2.3665, Accuracy: 0.3667
  Validation Summary: Avg Loss: 6.5992, Accuracy: 0.1500, F1 (Macro): 0.1407
  New best model! Val loss improved from inf to 6.5992. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.8931
  Epoch 1 [Batch 1/11]: Loss: 2.6625
  Epoch 1 [Batch 2/11]: Loss: 2.7438
  Epoch 1 [Batch 3/11]: Loss: 2.4201
  Epoch 1 [Batch 4/11]: Loss: 3.3302
  Epoch 1 [Batch 5/11]: Loss: 2.5383
  Epoch 1 [Batch 6/11]: Loss: 1.1693
  Epoch 1 [Batch 7/11]: Loss: 1.1437
  Epoch 1 [Batch 8/11]: Loss: 2.7293
  Epoch 1 [Batch 9/11]: Loss: 1.7046
  Epoch 1 [Batch 10/11]: Loss: 2.1041
  Epoch 1 Train Summary: Avg Loss: 2.2217, Accuracy: 0.4017
  Validation Summary: Avg Loss: 6.0266, Accuracy: 0.1667, F1 (Macro): 0.1111
  New best model! Val loss improved from 6.5992 to 6.0266. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 3.0157
  Epoch 2 [Batch 1/11]: Loss: 2.1566
  Epoch 2 [Batch 2/11]: Loss: 2.1595
  Epoch 2 [Batch 3/11]: Loss: 1.9911
  Epoch 2 [Batch 4/11]: Loss: 1.3786
  Epoch 2 [Batch 5/11]: Loss: 4.3700
  Epoch 2 [Batch 6/11]: Loss: 2.5948
  Epoch 2 [Batch 7/11]: Loss: 0.9418
  Epoch 2 [Batch 8/11]: Loss: 0.8647
  Epoch 2 [Batch 9/11]: Loss: 1.2773
  Epoch 2 [Batch 10/11]: Loss: 1.4694
  Epoch 2 Train Summary: Avg Loss: 2.0200, Accuracy: 0.4523
  Validation Summary: Avg Loss: 5.8391, Accuracy: 0.0833, F1 (Macro): 0.0606
  New best model! Val loss improved from 6.0266 to 5.8391. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 2.2516
  Epoch 3 [Batch 1/11]: Loss: 1.7576
  Epoch 3 [Batch 2/11]: Loss: 0.6173
  Epoch 3 [Batch 3/11]: Loss: 2.6918
  Epoch 3 [Batch 4/11]: Loss: 1.8115
  Epoch 3 [Batch 5/11]: Loss: 2.8511
  Epoch 3 [Batch 6/11]: Loss: 2.3527
  Epoch 3 [Batch 7/11]: Loss: 3.2551
  Epoch 3 [Batch 8/11]: Loss: 1.5012
  Epoch 3 [Batch 9/11]: Loss: 1.9666
  Epoch 3 [Batch 10/11]: Loss: 3.6312
  Epoch 3 Train Summary: Avg Loss: 2.2443, Accuracy: 0.4071
  Validation Summary: Avg Loss: 5.5182, Accuracy: 0.0833, F1 (Macro): 0.0606
  New best model! Val loss improved from 5.8391 to 5.5182. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 2.2102
  Epoch 4 [Batch 1/11]: Loss: 3.7294
  Epoch 4 [Batch 2/11]: Loss: 1.1827
  Epoch 4 [Batch 3/11]: Loss: 2.3508
  Epoch 4 [Batch 4/11]: Loss: 1.2147
  Epoch 4 [Batch 5/11]: Loss: 2.8374
  Epoch 4 [Batch 6/11]: Loss: 1.1292
  Epoch 4 [Batch 7/11]: Loss: 2.7797
  Epoch 4 [Batch 8/11]: Loss: 0.6011
  Epoch 4 [Batch 9/11]: Loss: 2.4258
  Epoch 4 [Batch 10/11]: Loss: 2.6106
  Epoch 4 Train Summary: Avg Loss: 2.0974, Accuracy: 0.4927
  Validation Summary: Avg Loss: 4.5980, Accuracy: 0.1500, F1 (Macro): 0.1481
  New best model! Val loss improved from 5.5182 to 4.5980. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 2.2010
  Epoch 5 [Batch 1/11]: Loss: 1.8469
  Epoch 5 [Batch 2/11]: Loss: 3.3690
  Epoch 5 [Batch 3/11]: Loss: 1.8626
  Epoch 5 [Batch 4/11]: Loss: 0.9565
  Epoch 5 [Batch 5/11]: Loss: 1.7259
  Epoch 5 [Batch 6/11]: Loss: 2.4631
  Epoch 5 [Batch 7/11]: Loss: 1.0738
  Epoch 5 [Batch 8/11]: Loss: 3.0192
  Epoch 5 [Batch 9/11]: Loss: 1.4072
  Epoch 5 [Batch 10/11]: Loss: 0.1486
  Epoch 5 Train Summary: Avg Loss: 1.8249, Accuracy: 0.4018
  Validation Summary: Avg Loss: 4.1175, Accuracy: 0.1500, F1 (Macro): 0.1481
  New best model! Val loss improved from 4.5980 to 4.1175. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 2.6748
  Epoch 6 [Batch 1/11]: Loss: 2.0846
  Epoch 6 [Batch 2/11]: Loss: 1.2177
  Epoch 6 [Batch 3/11]: Loss: 1.7379
  Epoch 6 [Batch 4/11]: Loss: 1.4397
  Epoch 6 [Batch 5/11]: Loss: 0.7402
  Epoch 6 [Batch 6/11]: Loss: 0.9945
  Epoch 6 [Batch 7/11]: Loss: 1.7566
  Epoch 6 [Batch 8/11]: Loss: 1.2126
  Epoch 6 [Batch 9/11]: Loss: 1.5759
  Epoch 6 [Batch 10/11]: Loss: 1.1819
  Epoch 6 Train Summary: Avg Loss: 1.5106, Accuracy: 0.4381
  Validation Summary: Avg Loss: 3.3228, Accuracy: 0.3167, F1 (Macro): 0.2833
  New best model! Val loss improved from 4.1175 to 3.3228. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 2.6646
  Epoch 7 [Batch 1/11]: Loss: 2.2046
  Epoch 7 [Batch 2/11]: Loss: 1.3430
  Epoch 7 [Batch 3/11]: Loss: 1.1722
  Epoch 7 [Batch 4/11]: Loss: 0.4479
  Epoch 7 [Batch 5/11]: Loss: 3.2071
  Epoch 7 [Batch 6/11]: Loss: 1.2472
  Epoch 7 [Batch 7/11]: Loss: 0.5910
  Epoch 7 [Batch 8/11]: Loss: 1.4292
  Epoch 7 [Batch 9/11]: Loss: 1.0495
  Epoch 7 [Batch 10/11]: Loss: 2.3977
  Epoch 7 Train Summary: Avg Loss: 1.6140, Accuracy: 0.4752
  Validation Summary: Avg Loss: 3.4015, Accuracy: 0.1500, F1 (Macro): 0.1407

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 1.0919
  Epoch 8 [Batch 1/11]: Loss: 2.2080
  Epoch 8 [Batch 2/11]: Loss: 1.2599
  Epoch 8 [Batch 3/11]: Loss: 3.7199
  Epoch 8 [Batch 4/11]: Loss: 1.7132
  Epoch 8 [Batch 5/11]: Loss: 3.8901
  Epoch 8 [Batch 6/11]: Loss: 0.4155
  Epoch 8 [Batch 7/11]: Loss: 0.7574
  Epoch 8 [Batch 8/11]: Loss: 0.6249
  Epoch 8 [Batch 9/11]: Loss: 0.6524
  Epoch 8 [Batch 10/11]: Loss: 2.9880
  Epoch 8 Train Summary: Avg Loss: 1.7565, Accuracy: 0.5399
  Validation Summary: Avg Loss: 3.2950, Accuracy: 0.4000, F1 (Macro): 0.3377
  New best model! Val loss improved from 3.3228 to 3.2950. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 2.7885
  Epoch 9 [Batch 1/11]: Loss: 0.8803
  Epoch 9 [Batch 2/11]: Loss: 0.7251
  Epoch 9 [Batch 3/11]: Loss: 1.8547
  Epoch 9 [Batch 4/11]: Loss: 1.9279
  Epoch 9 [Batch 5/11]: Loss: 2.0971
  Epoch 9 [Batch 6/11]: Loss: 2.4080
  Epoch 9 [Batch 7/11]: Loss: 1.7269
  Epoch 9 [Batch 8/11]: Loss: 1.5316
  Epoch 9 [Batch 9/11]: Loss: 2.9214
  Epoch 9 [Batch 10/11]: Loss: 1.8725
  Epoch 9 Train Summary: Avg Loss: 1.8849, Accuracy: 0.3357
  Validation Summary: Avg Loss: 3.8258, Accuracy: 0.1500, F1 (Macro): 0.1500

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 0.7403
  Epoch 10 [Batch 1/11]: Loss: 2.3918
  Epoch 10 [Batch 2/11]: Loss: 0.7402
  Epoch 10 [Batch 3/11]: Loss: 0.9512
  Epoch 10 [Batch 4/11]: Loss: 1.3724
  Epoch 10 [Batch 5/11]: Loss: 0.8548
  Epoch 10 [Batch 6/11]: Loss: 1.8197
  Epoch 10 [Batch 7/11]: Loss: 0.9749
  Epoch 10 [Batch 8/11]: Loss: 1.1457
  Epoch 10 [Batch 9/11]: Loss: 1.2826
  Epoch 10 [Batch 10/11]: Loss: 1.1773
  Epoch 10 Train Summary: Avg Loss: 1.2228, Accuracy: 0.4906
  Validation Summary: Avg Loss: 3.7113, Accuracy: 0.1500, F1 (Macro): 0.1407

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 1.1089
  Epoch 11 [Batch 1/11]: Loss: 1.7792
  Epoch 11 [Batch 2/11]: Loss: 0.8813
  Epoch 11 [Batch 3/11]: Loss: 1.5254
  Epoch 11 [Batch 4/11]: Loss: 0.7231
  Epoch 11 [Batch 5/11]: Loss: 0.4230
  Epoch 11 [Batch 6/11]: Loss: 0.9307
  Epoch 11 [Batch 7/11]: Loss: 1.4877
  Epoch 11 [Batch 8/11]: Loss: 0.5786
  Epoch 11 [Batch 9/11]: Loss: 1.3642
  Epoch 11 [Batch 10/11]: Loss: 0.0877
  Epoch 11 Train Summary: Avg Loss: 0.9900, Accuracy: 0.4980
  Validation Summary: Avg Loss: 3.4213, Accuracy: 0.1500, F1 (Macro): 0.1500

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 2.0079
  Epoch 12 [Batch 1/11]: Loss: 1.1386
  Epoch 12 [Batch 2/11]: Loss: 1.6744
  Epoch 12 [Batch 3/11]: Loss: 1.3801
  Epoch 12 [Batch 4/11]: Loss: 1.2203
  Epoch 12 [Batch 5/11]: Loss: 1.2753
  Epoch 12 [Batch 6/11]: Loss: 0.8305
  Epoch 12 [Batch 7/11]: Loss: 0.7158
  Epoch 12 [Batch 8/11]: Loss: 0.7103
  Epoch 12 [Batch 9/11]: Loss: 0.6963
  Epoch 12 [Batch 10/11]: Loss: 1.0984
  Epoch 12 Train Summary: Avg Loss: 1.1589, Accuracy: 0.5532
  Validation Summary: Avg Loss: 3.1650, Accuracy: 0.1500, F1 (Macro): 0.1500
  New best model! Val loss improved from 3.2950 to 3.1650. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 0.7088
  Epoch 13 [Batch 1/11]: Loss: 1.5386
  Epoch 13 [Batch 2/11]: Loss: 2.8268
  Epoch 13 [Batch 3/11]: Loss: 0.8680
  Epoch 13 [Batch 4/11]: Loss: 1.2982
  Epoch 13 [Batch 5/11]: Loss: 2.7947
  Epoch 13 [Batch 6/11]: Loss: 0.2946
  Epoch 13 [Batch 7/11]: Loss: 1.4774
  Epoch 13 [Batch 8/11]: Loss: 1.3914
  Epoch 13 [Batch 9/11]: Loss: 2.0289
  Epoch 13 [Batch 10/11]: Loss: 5.6198
  Epoch 13 Train Summary: Avg Loss: 1.8952, Accuracy: 0.4786
  Validation Summary: Avg Loss: 3.1736, Accuracy: 0.2167, F1 (Macro): 0.2045

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 1.8714
  Epoch 14 [Batch 1/11]: Loss: 0.0977
  Epoch 14 [Batch 2/11]: Loss: 0.7726
  Epoch 14 [Batch 3/11]: Loss: 1.8002
  Epoch 14 [Batch 4/11]: Loss: 1.1793
  Epoch 14 [Batch 5/11]: Loss: 0.7641
  Epoch 14 [Batch 6/11]: Loss: 1.2394
  Epoch 14 [Batch 7/11]: Loss: 1.2301
  Epoch 14 [Batch 8/11]: Loss: 1.1230
  Epoch 14 [Batch 9/11]: Loss: 2.2045
  Epoch 14 [Batch 10/11]: Loss: 1.9712
  Epoch 14 Train Summary: Avg Loss: 1.2958, Accuracy: 0.5438
  Validation Summary: Avg Loss: 3.4742, Accuracy: 0.2167, F1 (Macro): 0.2045
Training finished in 0.88 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 3.1650, Accuracy: 0.1500, F1 (Macro): 0.1500
Final Best Model Stats: Acc: 0.1500, F1: 0.1500, Loss: 3.1650
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=224x224 lr=1e-05 drop=0.0 seed=123
================================================================================
Starting experiment: efficientnet_b0__224x224__lr-1e-05__drop-0.0__seed-123
Output directory: results_ceph/efficientnet_b0__224x224__lr-1e-05__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 2.4162
  Epoch 0 [Batch 1/11]: Loss: 4.8476
  Epoch 0 [Batch 2/11]: Loss: 3.5185
  Epoch 0 [Batch 3/11]: Loss: 3.8254
  Epoch 0 [Batch 4/11]: Loss: 2.3386
  Epoch 0 [Batch 5/11]: Loss: 4.5169
  Epoch 0 [Batch 6/11]: Loss: 2.2989
  Epoch 0 [Batch 7/11]: Loss: 1.5443
  Epoch 0 [Batch 8/11]: Loss: 2.0149
  Epoch 0 [Batch 9/11]: Loss: 5.3846
  Epoch 0 [Batch 10/11]: Loss: 1.0401
  Epoch 0 Train Summary: Avg Loss: 3.0678, Accuracy: 0.3168
  Validation Summary: Avg Loss: 5.0114, Accuracy: 0.4000, F1 (Macro): 0.1693
  New best model! Val loss improved from inf to 5.0114. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 3.2068
  Epoch 1 [Batch 1/11]: Loss: 2.9408
  Epoch 1 [Batch 2/11]: Loss: 2.9754
  Epoch 1 [Batch 3/11]: Loss: 3.2303
  Epoch 1 [Batch 4/11]: Loss: 2.2933
  Epoch 1 [Batch 5/11]: Loss: 3.4043
  Epoch 1 [Batch 6/11]: Loss: 2.2705
  Epoch 1 [Batch 7/11]: Loss: 4.2480
  Epoch 1 [Batch 8/11]: Loss: 3.2149
  Epoch 1 [Batch 9/11]: Loss: 2.6313
  Epoch 1 [Batch 10/11]: Loss: 0.7007
  Epoch 1 Train Summary: Avg Loss: 2.8287, Accuracy: 0.3795
  Validation Summary: Avg Loss: 3.8859, Accuracy: 0.5500, F1 (Macro): 0.4071
  New best model! Val loss improved from 5.0114 to 3.8859. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 3.3709
  Epoch 2 [Batch 1/11]: Loss: 2.4076
  Epoch 2 [Batch 2/11]: Loss: 3.2745
  Epoch 2 [Batch 3/11]: Loss: 0.8881
  Epoch 2 [Batch 4/11]: Loss: 2.9421
  Epoch 2 [Batch 5/11]: Loss: 4.1469
  Epoch 2 [Batch 6/11]: Loss: 2.6973
  Epoch 2 [Batch 7/11]: Loss: 3.5152
  Epoch 2 [Batch 8/11]: Loss: 1.0884
  Epoch 2 [Batch 9/11]: Loss: 3.8237
  Epoch 2 [Batch 10/11]: Loss: 1.4231
  Epoch 2 Train Summary: Avg Loss: 2.6889, Accuracy: 0.3985
  Validation Summary: Avg Loss: 3.0156, Accuracy: 0.5500, F1 (Macro): 0.3968
  New best model! Val loss improved from 3.8859 to 3.0156. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 2.6457
  Epoch 3 [Batch 1/11]: Loss: 1.2961
  Epoch 3 [Batch 2/11]: Loss: 2.1958
  Epoch 3 [Batch 3/11]: Loss: 2.5076
  Epoch 3 [Batch 4/11]: Loss: 3.8619
  Epoch 3 [Batch 5/11]: Loss: 5.0923
  Epoch 3 [Batch 6/11]: Loss: 1.8062
  Epoch 3 [Batch 7/11]: Loss: 1.3245
  Epoch 3 [Batch 8/11]: Loss: 3.5888
  Epoch 3 [Batch 9/11]: Loss: 3.4128
  Epoch 3 [Batch 10/11]: Loss: 1.6635
  Epoch 3 Train Summary: Avg Loss: 2.6723, Accuracy: 0.3189
  Validation Summary: Avg Loss: 2.4429, Accuracy: 0.2833, F1 (Macro): 0.3111
  New best model! Val loss improved from 3.0156 to 2.4429. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 2.6009
  Epoch 4 [Batch 1/11]: Loss: 3.5326
  Epoch 4 [Batch 2/11]: Loss: 1.8101
  Epoch 4 [Batch 3/11]: Loss: 1.7872
  Epoch 4 [Batch 4/11]: Loss: 0.9399
  Epoch 4 [Batch 5/11]: Loss: 2.9536
  Epoch 4 [Batch 6/11]: Loss: 2.7494
  Epoch 4 [Batch 7/11]: Loss: 1.8862
  Epoch 4 [Batch 8/11]: Loss: 2.1408
  Epoch 4 [Batch 9/11]: Loss: 2.3171
  Epoch 4 [Batch 10/11]: Loss: 0.0079
  Epoch 4 Train Summary: Avg Loss: 2.0660, Accuracy: 0.3977
  Validation Summary: Avg Loss: 2.9491, Accuracy: 0.2167, F1 (Macro): 0.2434

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 0.6170
  Epoch 5 [Batch 1/11]: Loss: 2.3178
  Epoch 5 [Batch 2/11]: Loss: 1.7691
  Epoch 5 [Batch 3/11]: Loss: 1.9218
  Epoch 5 [Batch 4/11]: Loss: 3.0331
  Epoch 5 [Batch 5/11]: Loss: 2.0557
  Epoch 5 [Batch 6/11]: Loss: 1.7918
  Epoch 5 [Batch 7/11]: Loss: 3.0865
  Epoch 5 [Batch 8/11]: Loss: 2.7139
  Epoch 5 [Batch 9/11]: Loss: 3.2458
  Epoch 5 [Batch 10/11]: Loss: 0.8941
  Epoch 5 Train Summary: Avg Loss: 2.1315, Accuracy: 0.4032
  Validation Summary: Avg Loss: 2.5679, Accuracy: 0.0667, F1 (Macro): 0.0667

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 0.8727
  Epoch 6 [Batch 1/11]: Loss: 4.0485
  Epoch 6 [Batch 2/11]: Loss: 2.1194
  Epoch 6 [Batch 3/11]: Loss: 2.8892
  Epoch 6 [Batch 4/11]: Loss: 1.6770
  Epoch 6 [Batch 5/11]: Loss: 1.6916
  Epoch 6 [Batch 6/11]: Loss: 2.1931
  Epoch 6 [Batch 7/11]: Loss: 2.2060
  Epoch 6 [Batch 8/11]: Loss: 1.3043
  Epoch 6 [Batch 9/11]: Loss: 0.4829
  Epoch 6 [Batch 10/11]: Loss: 3.0298
  Epoch 6 Train Summary: Avg Loss: 2.0468, Accuracy: 0.4274
  Validation Summary: Avg Loss: 2.7640, Accuracy: 0.2667, F1 (Macro): 0.1905

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 1.5843
  Epoch 7 [Batch 1/11]: Loss: 2.3051
  Epoch 7 [Batch 2/11]: Loss: 1.7072
  Epoch 7 [Batch 3/11]: Loss: 0.8931
  Epoch 7 [Batch 4/11]: Loss: 1.8811
  Epoch 7 [Batch 5/11]: Loss: 0.5954
  Epoch 7 [Batch 6/11]: Loss: 0.7040
  Epoch 7 [Batch 7/11]: Loss: 2.9004
  Epoch 7 [Batch 8/11]: Loss: 2.2582
  Epoch 7 [Batch 9/11]: Loss: 4.1180
  Epoch 7 [Batch 10/11]: Loss: 2.8044
  Epoch 7 Train Summary: Avg Loss: 1.9774, Accuracy: 0.5238
  Validation Summary: Avg Loss: 3.9239, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 0.6353
  Epoch 8 [Batch 1/11]: Loss: 1.6857
  Epoch 8 [Batch 2/11]: Loss: 3.1540
  Epoch 8 [Batch 3/11]: Loss: 1.6948
  Epoch 8 [Batch 4/11]: Loss: 0.7976
  Epoch 8 [Batch 5/11]: Loss: 2.1580
  Epoch 8 [Batch 6/11]: Loss: 3.2885
  Epoch 8 [Batch 7/11]: Loss: 1.6092
  Epoch 8 [Batch 8/11]: Loss: 0.5825
  Epoch 8 [Batch 9/11]: Loss: 1.8869
  Epoch 8 [Batch 10/11]: Loss: 2.3932
  Epoch 8 Train Summary: Avg Loss: 1.8078, Accuracy: 0.4577
  Validation Summary: Avg Loss: 2.9990, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 2.8460
  Epoch 9 [Batch 1/11]: Loss: 1.8259
  Epoch 9 [Batch 2/11]: Loss: 1.0489
  Epoch 9 [Batch 3/11]: Loss: 0.9856
  Epoch 9 [Batch 4/11]: Loss: 1.3204
  Epoch 9 [Batch 5/11]: Loss: 1.7211
  Epoch 9 [Batch 6/11]: Loss: 2.0187
  Epoch 9 [Batch 7/11]: Loss: 0.9301
  Epoch 9 [Batch 8/11]: Loss: 2.3217
  Epoch 9 [Batch 9/11]: Loss: 1.2931
  Epoch 9 [Batch 10/11]: Loss: 4.3230
  Epoch 9 Train Summary: Avg Loss: 1.8759, Accuracy: 0.5029
  Validation Summary: Avg Loss: 2.4015, Accuracy: 0.4167, F1 (Macro): 0.3714
  New best model! Val loss improved from 2.4429 to 2.4015. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 1.6249
  Epoch 10 [Batch 1/11]: Loss: 0.8996
  Epoch 10 [Batch 2/11]: Loss: 2.9226
  Epoch 10 [Batch 3/11]: Loss: 1.9544
  Epoch 10 [Batch 4/11]: Loss: 0.8681
  Epoch 10 [Batch 5/11]: Loss: 1.5766
  Epoch 10 [Batch 6/11]: Loss: 2.0533
  Epoch 10 [Batch 7/11]: Loss: 1.3803
  Epoch 10 [Batch 8/11]: Loss: 0.9996
  Epoch 10 [Batch 9/11]: Loss: 2.5773
  Epoch 10 [Batch 10/11]: Loss: 1.8399
  Epoch 10 Train Summary: Avg Loss: 1.6997, Accuracy: 0.4745
  Validation Summary: Avg Loss: 3.3835, Accuracy: 0.4167, F1 (Macro): 0.3714

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 1.0149
  Epoch 11 [Batch 1/11]: Loss: 1.1166
  Epoch 11 [Batch 2/11]: Loss: 1.8030
  Epoch 11 [Batch 3/11]: Loss: 0.8447
  Epoch 11 [Batch 4/11]: Loss: 1.1399
  Epoch 11 [Batch 5/11]: Loss: 1.4690
  Epoch 11 [Batch 6/11]: Loss: 2.3722
  Epoch 11 [Batch 7/11]: Loss: 2.6507
  Epoch 11 [Batch 8/11]: Loss: 0.7419
  Epoch 11 [Batch 9/11]: Loss: 0.3697
  Epoch 11 [Batch 10/11]: Loss: 0.8373
  Epoch 11 Train Summary: Avg Loss: 1.3054, Accuracy: 0.5958
  Validation Summary: Avg Loss: 4.6579, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.7904
  Epoch 12 [Batch 1/11]: Loss: 2.1434
  Epoch 12 [Batch 2/11]: Loss: 1.0808
  Epoch 12 [Batch 3/11]: Loss: 2.2908
  Epoch 12 [Batch 4/11]: Loss: 1.5033
  Epoch 12 [Batch 5/11]: Loss: 1.2843
  Epoch 12 [Batch 6/11]: Loss: 1.6119
  Epoch 12 [Batch 7/11]: Loss: 1.5640
  Epoch 12 [Batch 8/11]: Loss: 1.3468
  Epoch 12 [Batch 9/11]: Loss: 1.2083
  Epoch 12 [Batch 10/11]: Loss: 1.4095
  Epoch 12 Train Summary: Avg Loss: 1.4758, Accuracy: 0.5655
  Validation Summary: Avg Loss: 3.4743, Accuracy: 0.4167, F1 (Macro): 0.3714

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 2.2213
  Epoch 13 [Batch 1/11]: Loss: 1.4905
  Epoch 13 [Batch 2/11]: Loss: 0.6952
  Epoch 13 [Batch 3/11]: Loss: 1.8323
  Epoch 13 [Batch 4/11]: Loss: 1.7140
  Epoch 13 [Batch 5/11]: Loss: 0.0878
  Epoch 13 [Batch 6/11]: Loss: 1.7298
  Epoch 13 [Batch 7/11]: Loss: 1.1851
  Epoch 13 [Batch 8/11]: Loss: 1.6635
  Epoch 13 [Batch 9/11]: Loss: 0.1943
  Epoch 13 [Batch 10/11]: Loss: 4.1179
  Epoch 13 Train Summary: Avg Loss: 1.5392, Accuracy: 0.5371
  Validation Summary: Avg Loss: 4.0953, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.6231
  Epoch 14 [Batch 1/11]: Loss: 1.0523
  Epoch 14 [Batch 2/11]: Loss: 2.4650
  Epoch 14 [Batch 3/11]: Loss: 1.1116
  Epoch 14 [Batch 4/11]: Loss: 2.0241
  Epoch 14 [Batch 5/11]: Loss: 1.3489
  Epoch 14 [Batch 6/11]: Loss: 0.9578
  Epoch 14 [Batch 7/11]: Loss: 1.3798
  Epoch 14 [Batch 8/11]: Loss: 1.6568
  Epoch 14 [Batch 9/11]: Loss: 1.3036
  Epoch 14 [Batch 10/11]: Loss: 0.2492
  Epoch 14 Train Summary: Avg Loss: 1.2884, Accuracy: 0.5108
  Validation Summary: Avg Loss: 3.5520, Accuracy: 0.4167, F1 (Macro): 0.3714
Training finished in 0.88 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 2.4015, Accuracy: 0.4167, F1 (Macro): 0.3714
Final Best Model Stats: Acc: 0.4167, F1: 0.3714, Loss: 2.4015
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=224x224 lr=1e-05 drop=0.0 seed=999
================================================================================
Starting experiment: efficientnet_b0__224x224__lr-1e-05__drop-0.0__seed-999
Output directory: results_ceph/efficientnet_b0__224x224__lr-1e-05__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 2.5511
  Epoch 0 [Batch 1/11]: Loss: 2.8505
  Epoch 0 [Batch 2/11]: Loss: 2.8153
  Epoch 0 [Batch 3/11]: Loss: 2.3422
  Epoch 0 [Batch 4/11]: Loss: 2.1653
  Epoch 0 [Batch 5/11]: Loss: 2.1207
  Epoch 0 [Batch 6/11]: Loss: 1.0258
  Epoch 0 [Batch 7/11]: Loss: 2.1952
  Epoch 0 [Batch 8/11]: Loss: 2.8809
  Epoch 0 [Batch 9/11]: Loss: 3.5576
  Epoch 0 [Batch 10/11]: Loss: 2.8144
  Epoch 0 Train Summary: Avg Loss: 2.4835, Accuracy: 0.4136
  Validation Summary: Avg Loss: 6.0832, Accuracy: 0.2667, F1 (Macro): 0.1905
  New best model! Val loss improved from inf to 6.0832. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.0380
  Epoch 1 [Batch 1/11]: Loss: 3.0888
  Epoch 1 [Batch 2/11]: Loss: 1.9272
  Epoch 1 [Batch 3/11]: Loss: 1.7748
  Epoch 1 [Batch 4/11]: Loss: 0.7254
  Epoch 1 [Batch 5/11]: Loss: 2.5083
  Epoch 1 [Batch 6/11]: Loss: 3.2881
  Epoch 1 [Batch 7/11]: Loss: 2.1865
  Epoch 1 [Batch 8/11]: Loss: 2.5621
  Epoch 1 [Batch 9/11]: Loss: 1.2554
  Epoch 1 [Batch 10/11]: Loss: 2.4288
  Epoch 1 Train Summary: Avg Loss: 2.0712, Accuracy: 0.5100
  Validation Summary: Avg Loss: 6.2758, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 2.6546
  Epoch 2 [Batch 1/11]: Loss: 1.9399
  Epoch 2 [Batch 2/11]: Loss: 2.1739
  Epoch 2 [Batch 3/11]: Loss: 2.4697
  Epoch 2 [Batch 4/11]: Loss: 1.6421
  Epoch 2 [Batch 5/11]: Loss: 2.5994
  Epoch 2 [Batch 6/11]: Loss: 1.6653
  Epoch 2 [Batch 7/11]: Loss: 2.3495
  Epoch 2 [Batch 8/11]: Loss: 2.7032
  Epoch 2 [Batch 9/11]: Loss: 2.6948
  Epoch 2 [Batch 10/11]: Loss: 1.2643
  Epoch 2 Train Summary: Avg Loss: 2.1961, Accuracy: 0.3470
  Validation Summary: Avg Loss: 4.5059, Accuracy: 0.3333, F1 (Macro): 0.2222
  New best model! Val loss improved from 6.0832 to 4.5059. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 1.5011
  Epoch 3 [Batch 1/11]: Loss: 0.9461
  Epoch 3 [Batch 2/11]: Loss: 1.5804
  Epoch 3 [Batch 3/11]: Loss: 2.7630
  Epoch 3 [Batch 4/11]: Loss: 2.0504
  Epoch 3 [Batch 5/11]: Loss: 2.6917
  Epoch 3 [Batch 6/11]: Loss: 1.7009
  Epoch 3 [Batch 7/11]: Loss: 3.6224
  Epoch 3 [Batch 8/11]: Loss: 3.4197
  Epoch 3 [Batch 9/11]: Loss: 0.9692
  Epoch 3 [Batch 10/11]: Loss: 0.9067
  Epoch 3 Train Summary: Avg Loss: 2.0138, Accuracy: 0.4198
  Validation Summary: Avg Loss: 4.5201, Accuracy: 0.2667, F1 (Macro): 0.2051

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 2.6527
  Epoch 4 [Batch 1/11]: Loss: 2.1797
  Epoch 4 [Batch 2/11]: Loss: 1.2345
  Epoch 4 [Batch 3/11]: Loss: 2.3988
  Epoch 4 [Batch 4/11]: Loss: 2.7432
  Epoch 4 [Batch 5/11]: Loss: 1.0169
  Epoch 4 [Batch 6/11]: Loss: 1.2758
  Epoch 4 [Batch 7/11]: Loss: 1.8299
  Epoch 4 [Batch 8/11]: Loss: 1.3429
  Epoch 4 [Batch 9/11]: Loss: 1.5008
  Epoch 4 [Batch 10/11]: Loss: 1.4598
  Epoch 4 Train Summary: Avg Loss: 1.7850, Accuracy: 0.4433
  Validation Summary: Avg Loss: 4.2380, Accuracy: 0.2000, F1 (Macro): 0.1667
  New best model! Val loss improved from 4.5059 to 4.2380. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 2.3361
  Epoch 5 [Batch 1/11]: Loss: 2.3152
  Epoch 5 [Batch 2/11]: Loss: 1.0133
  Epoch 5 [Batch 3/11]: Loss: 2.7676
  Epoch 5 [Batch 4/11]: Loss: 1.3992
  Epoch 5 [Batch 5/11]: Loss: 2.6379
  Epoch 5 [Batch 6/11]: Loss: 1.2328
  Epoch 5 [Batch 7/11]: Loss: 1.8490
  Epoch 5 [Batch 8/11]: Loss: 1.5364
  Epoch 5 [Batch 9/11]: Loss: 2.2117
  Epoch 5 [Batch 10/11]: Loss: 2.9153
  Epoch 5 Train Summary: Avg Loss: 2.0195, Accuracy: 0.3814
  Validation Summary: Avg Loss: 4.4611, Accuracy: 0.4000, F1 (Macro): 0.1693

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 1.0552
  Epoch 6 [Batch 1/11]: Loss: 1.4183
  Epoch 6 [Batch 2/11]: Loss: 2.3158
  Epoch 6 [Batch 3/11]: Loss: 2.9684
  Epoch 6 [Batch 4/11]: Loss: 1.4855
  Epoch 6 [Batch 5/11]: Loss: 1.5936
  Epoch 6 [Batch 6/11]: Loss: 1.2843
  Epoch 6 [Batch 7/11]: Loss: 1.0333
  Epoch 6 [Batch 8/11]: Loss: 0.8396
  Epoch 6 [Batch 9/11]: Loss: 1.2375
  Epoch 6 [Batch 10/11]: Loss: 1.6821
  Epoch 6 Train Summary: Avg Loss: 1.5376, Accuracy: 0.4905
  Validation Summary: Avg Loss: 4.9148, Accuracy: 0.1500, F1 (Macro): 0.2000

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 2.0421
  Epoch 7 [Batch 1/11]: Loss: 1.2282
  Epoch 7 [Batch 2/11]: Loss: 1.0970
  Epoch 7 [Batch 3/11]: Loss: 1.1264
  Epoch 7 [Batch 4/11]: Loss: 1.1526
  Epoch 7 [Batch 5/11]: Loss: 1.9056
  Epoch 7 [Batch 6/11]: Loss: 1.5856
  Epoch 7 [Batch 7/11]: Loss: 1.4178
  Epoch 7 [Batch 8/11]: Loss: 1.1398
  Epoch 7 [Batch 9/11]: Loss: 1.9887
  Epoch 7 [Batch 10/11]: Loss: 0.8051
  Epoch 7 Train Summary: Avg Loss: 1.4081, Accuracy: 0.5242
  Validation Summary: Avg Loss: 5.1799, Accuracy: 0.1500, F1 (Macro): 0.2000

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 1.7864
  Epoch 8 [Batch 1/11]: Loss: 0.8464
  Epoch 8 [Batch 2/11]: Loss: 1.9453
  Epoch 8 [Batch 3/11]: Loss: 2.3799
  Epoch 8 [Batch 4/11]: Loss: 1.1856
  Epoch 8 [Batch 5/11]: Loss: 0.7762
  Epoch 8 [Batch 6/11]: Loss: 1.8514
  Epoch 8 [Batch 7/11]: Loss: 1.2361
  Epoch 8 [Batch 8/11]: Loss: 1.9538
  Epoch 8 [Batch 9/11]: Loss: 1.6017
  Epoch 8 [Batch 10/11]: Loss: 2.5578
  Epoch 8 Train Summary: Avg Loss: 1.6473, Accuracy: 0.4494
  Validation Summary: Avg Loss: 5.3076, Accuracy: 0.1500, F1 (Macro): 0.2000

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 2.6850
  Epoch 9 [Batch 1/11]: Loss: 0.9379
  Epoch 9 [Batch 2/11]: Loss: 1.3008
  Epoch 9 [Batch 3/11]: Loss: 1.5208
  Epoch 9 [Batch 4/11]: Loss: 1.1740
  Epoch 9 [Batch 5/11]: Loss: 0.9611
  Epoch 9 [Batch 6/11]: Loss: 2.0327
  Epoch 9 [Batch 7/11]: Loss: 2.3506
  Epoch 9 [Batch 8/11]: Loss: 1.0157
  Epoch 9 [Batch 9/11]: Loss: 1.3885
  Epoch 9 [Batch 10/11]: Loss: 0.5259
  Epoch 9 Train Summary: Avg Loss: 1.4448, Accuracy: 0.4919
  Validation Summary: Avg Loss: 5.4634, Accuracy: 0.2167, F1 (Macro): 0.2545

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 1.1249
  Epoch 10 [Batch 1/11]: Loss: 1.6483
  Epoch 10 [Batch 2/11]: Loss: 1.5344
  Epoch 10 [Batch 3/11]: Loss: 1.2975
  Epoch 10 [Batch 4/11]: Loss: 1.8975
  Epoch 10 [Batch 5/11]: Loss: 1.2590
  Epoch 10 [Batch 6/11]: Loss: 2.5753
  Epoch 10 [Batch 7/11]: Loss: 1.5091
  Epoch 10 [Batch 8/11]: Loss: 1.4465
  Epoch 10 [Batch 9/11]: Loss: 0.9473
  Epoch 10 [Batch 10/11]: Loss: 0.1419
  Epoch 10 Train Summary: Avg Loss: 1.3983, Accuracy: 0.4790
  Validation Summary: Avg Loss: 5.5270, Accuracy: 0.1500, F1 (Macro): 0.2000

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 1.3429
  Epoch 11 [Batch 1/11]: Loss: 1.9371
  Epoch 11 [Batch 2/11]: Loss: 0.7269
  Epoch 11 [Batch 3/11]: Loss: 1.5951
  Epoch 11 [Batch 4/11]: Loss: 0.8048
  Epoch 11 [Batch 5/11]: Loss: 0.9924
  Epoch 11 [Batch 6/11]: Loss: 0.5729
  Epoch 11 [Batch 7/11]: Loss: 1.9018
  Epoch 11 [Batch 8/11]: Loss: 2.2788
  Epoch 11 [Batch 9/11]: Loss: 1.2816
  Epoch 11 [Batch 10/11]: Loss: 0.5419
  Epoch 11 Train Summary: Avg Loss: 1.2706, Accuracy: 0.5039
  Validation Summary: Avg Loss: 5.4556, Accuracy: 0.0833, F1 (Macro): 0.1333

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 2.6088
  Epoch 12 [Batch 1/11]: Loss: 2.0885
  Epoch 12 [Batch 2/11]: Loss: 0.8299
  Epoch 12 [Batch 3/11]: Loss: 0.8204
  Epoch 12 [Batch 4/11]: Loss: 0.5410
  Epoch 12 [Batch 5/11]: Loss: 3.6343
  Epoch 12 [Batch 6/11]: Loss: 1.1649
  Epoch 12 [Batch 7/11]: Loss: 2.4752
  Epoch 12 [Batch 8/11]: Loss: 1.0263
  Epoch 12 [Batch 9/11]: Loss: 1.5194
  Epoch 12 [Batch 10/11]: Loss: 0.6912
  Epoch 12 Train Summary: Avg Loss: 1.5818, Accuracy: 0.4879
  Validation Summary: Avg Loss: 5.5453, Accuracy: 0.2167, F1 (Macro): 0.2545

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 0.8884
  Epoch 13 [Batch 1/11]: Loss: 0.5760
  Epoch 13 [Batch 2/11]: Loss: 1.0787
  Epoch 13 [Batch 3/11]: Loss: 1.0747
  Epoch 13 [Batch 4/11]: Loss: 1.8673
  Epoch 13 [Batch 5/11]: Loss: 1.7320
  Epoch 13 [Batch 6/11]: Loss: 2.1916
  Epoch 13 [Batch 7/11]: Loss: 1.4500
  Epoch 13 [Batch 8/11]: Loss: 0.9761
  Epoch 13 [Batch 9/11]: Loss: 1.0198
  Epoch 13 [Batch 10/11]: Loss: 0.3901
  Epoch 13 Train Summary: Avg Loss: 1.2041, Accuracy: 0.5774
  Validation Summary: Avg Loss: 5.8313, Accuracy: 0.2833, F1 (Macro): 0.3000

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 2.7349
  Epoch 14 [Batch 1/11]: Loss: 1.5354
  Epoch 14 [Batch 2/11]: Loss: 1.0461
  Epoch 14 [Batch 3/11]: Loss: 1.0815
  Epoch 14 [Batch 4/11]: Loss: 0.2968
  Epoch 14 [Batch 5/11]: Loss: 2.5492
  Epoch 14 [Batch 6/11]: Loss: 0.7448
  Epoch 14 [Batch 7/11]: Loss: 0.0898
  Epoch 14 [Batch 8/11]: Loss: 0.9030
  Epoch 14 [Batch 9/11]: Loss: 1.1654
  Epoch 14 [Batch 10/11]: Loss: 2.6371
  Epoch 14 Train Summary: Avg Loss: 1.3440, Accuracy: 0.6057
  Validation Summary: Avg Loss: 5.9109, Accuracy: 0.2833, F1 (Macro): 0.3000
Training finished in 1.27 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 4.2380, Accuracy: 0.2000, F1 (Macro): 0.1667
Final Best Model Stats: Acc: 0.2000, F1: 0.1667, Loss: 4.2380
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=384x384 lr=0.0001 drop=0.0 seed=42
================================================================================
Starting experiment: efficientnet_b0__384x384__lr-0.0001__drop-0.0__seed-42
Output directory: results_ceph/efficientnet_b0__384x384__lr-0.0001__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.7930
  Epoch 0 [Batch 1/11]: Loss: 1.6658
  Epoch 0 [Batch 2/11]: Loss: 1.4646
  Epoch 0 [Batch 3/11]: Loss: 1.5123
  Epoch 0 [Batch 4/11]: Loss: 2.4221
  Epoch 0 [Batch 5/11]: Loss: 1.6812
  Epoch 0 [Batch 6/11]: Loss: 1.9257
  Epoch 0 [Batch 7/11]: Loss: 3.1526
  Epoch 0 [Batch 8/11]: Loss: 1.4998
  Epoch 0 [Batch 9/11]: Loss: 1.8156
  Epoch 0 [Batch 10/11]: Loss: 0.6096
  Epoch 0 Train Summary: Avg Loss: 1.7766, Accuracy: 0.3323
  Validation Summary: Avg Loss: 6.8926, Accuracy: 0.2000, F1 (Macro): 0.1538
  New best model! Val loss improved from inf to 6.8926. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 0.7595
  Epoch 1 [Batch 1/11]: Loss: 1.0381
  Epoch 1 [Batch 2/11]: Loss: 1.5499
  Epoch 1 [Batch 3/11]: Loss: 0.7037
  Epoch 1 [Batch 4/11]: Loss: 1.6707
  Epoch 1 [Batch 5/11]: Loss: 1.0586
  Epoch 1 [Batch 6/11]: Loss: 3.0277
  Epoch 1 [Batch 7/11]: Loss: 0.8236
  Epoch 1 [Batch 8/11]: Loss: 0.7279
  Epoch 1 [Batch 9/11]: Loss: 0.8944
  Epoch 1 [Batch 10/11]: Loss: 0.7102
  Epoch 1 Train Summary: Avg Loss: 1.1786, Accuracy: 0.5459
  Validation Summary: Avg Loss: 6.0391, Accuracy: 0.2500, F1 (Macro): 0.1667
  New best model! Val loss improved from 6.8926 to 6.0391. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 0.9972
  Epoch 2 [Batch 1/11]: Loss: 0.8635
  Epoch 2 [Batch 2/11]: Loss: 0.4434
  Epoch 2 [Batch 3/11]: Loss: 0.1717
  Epoch 2 [Batch 4/11]: Loss: 1.9352
  Epoch 2 [Batch 5/11]: Loss: 1.1433
  Epoch 2 [Batch 6/11]: Loss: 1.0745
  Epoch 2 [Batch 7/11]: Loss: 1.3976
  Epoch 2 [Batch 8/11]: Loss: 1.4076
  Epoch 2 [Batch 9/11]: Loss: 0.7514
  Epoch 2 [Batch 10/11]: Loss: 0.0322
  Epoch 2 Train Summary: Avg Loss: 0.9289, Accuracy: 0.6785
  Validation Summary: Avg Loss: 6.5579, Accuracy: 0.1667, F1 (Macro): 0.1212

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 1.1246
  Epoch 3 [Batch 1/11]: Loss: 1.7095
  Epoch 3 [Batch 2/11]: Loss: 0.2633
  Epoch 3 [Batch 3/11]: Loss: 0.4527
  Epoch 3 [Batch 4/11]: Loss: 0.1395
  Epoch 3 [Batch 5/11]: Loss: 0.6542
  Epoch 3 [Batch 6/11]: Loss: 0.5940
  Epoch 3 [Batch 7/11]: Loss: 0.2822
  Epoch 3 [Batch 8/11]: Loss: 1.5811
  Epoch 3 [Batch 9/11]: Loss: 0.9361
  Epoch 3 [Batch 10/11]: Loss: 2.5770
  Epoch 3 Train Summary: Avg Loss: 0.9376, Accuracy: 0.7620
  Validation Summary: Avg Loss: 6.1606, Accuracy: 0.3000, F1 (Macro): 0.2815

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 0.3259
  Epoch 4 [Batch 1/11]: Loss: 1.3805
  Epoch 4 [Batch 2/11]: Loss: 0.0234
  Epoch 4 [Batch 3/11]: Loss: 0.1995
  Epoch 4 [Batch 4/11]: Loss: 0.6638
  Epoch 4 [Batch 5/11]: Loss: 0.4278
  Epoch 4 [Batch 6/11]: Loss: 0.0904
  Epoch 4 [Batch 7/11]: Loss: 0.1410
  Epoch 4 [Batch 8/11]: Loss: 0.6760
  Epoch 4 [Batch 9/11]: Loss: 0.8548
  Epoch 4 [Batch 10/11]: Loss: 1.5962
  Epoch 4 Train Summary: Avg Loss: 0.5799, Accuracy: 0.7621
  Validation Summary: Avg Loss: 5.1002, Accuracy: 0.2333, F1 (Macro): 0.2074
  New best model! Val loss improved from 6.0391 to 5.1002. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 0.6986
  Epoch 5 [Batch 1/11]: Loss: 0.8749
  Epoch 5 [Batch 2/11]: Loss: 0.1346
  Epoch 5 [Batch 3/11]: Loss: 0.7430
  Epoch 5 [Batch 4/11]: Loss: 0.7529
  Epoch 5 [Batch 5/11]: Loss: 0.7923
  Epoch 5 [Batch 6/11]: Loss: 0.0136
  Epoch 5 [Batch 7/11]: Loss: 0.2598
  Epoch 5 [Batch 8/11]: Loss: 0.6086
  Epoch 5 [Batch 9/11]: Loss: 0.1804
  Epoch 5 [Batch 10/11]: Loss: 1.4380
  Epoch 5 Train Summary: Avg Loss: 0.5906, Accuracy: 0.7944
  Validation Summary: Avg Loss: 4.5190, Accuracy: 0.4333, F1 (Macro): 0.4127
  New best model! Val loss improved from 5.1002 to 4.5190. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 0.4245
  Epoch 6 [Batch 1/11]: Loss: 0.0901
  Epoch 6 [Batch 2/11]: Loss: 0.3578
  Epoch 6 [Batch 3/11]: Loss: 0.9895
  Epoch 6 [Batch 4/11]: Loss: 0.1966
  Epoch 6 [Batch 5/11]: Loss: 0.3319
  Epoch 6 [Batch 6/11]: Loss: 0.8748
  Epoch 6 [Batch 7/11]: Loss: 0.1720
  Epoch 6 [Batch 8/11]: Loss: 0.4871
  Epoch 6 [Batch 9/11]: Loss: 0.4724
  Epoch 6 [Batch 10/11]: Loss: 1.8249
  Epoch 6 Train Summary: Avg Loss: 0.5656, Accuracy: 0.8308
  Validation Summary: Avg Loss: 5.4102, Accuracy: 0.3500, F1 (Macro): 0.3385

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.4115
  Epoch 7 [Batch 1/11]: Loss: 0.5330
  Epoch 7 [Batch 2/11]: Loss: 0.3050
  Epoch 7 [Batch 3/11]: Loss: 0.3299
  Epoch 7 [Batch 4/11]: Loss: 0.5972
  Epoch 7 [Batch 5/11]: Loss: 0.3321
  Epoch 7 [Batch 6/11]: Loss: 0.1461
  Epoch 7 [Batch 7/11]: Loss: 0.3904
  Epoch 7 [Batch 8/11]: Loss: 0.2894
  Epoch 7 [Batch 9/11]: Loss: 0.1807
  Epoch 7 [Batch 10/11]: Loss: 1.1760
  Epoch 7 Train Summary: Avg Loss: 0.4265, Accuracy: 0.8208
  Validation Summary: Avg Loss: 6.2769, Accuracy: 0.2167, F1 (Macro): 0.2165

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 0.2681
  Epoch 8 [Batch 1/11]: Loss: 0.2236
  Epoch 8 [Batch 2/11]: Loss: 0.2237
  Epoch 8 [Batch 3/11]: Loss: 0.4267
  Epoch 8 [Batch 4/11]: Loss: 0.8265
  Epoch 8 [Batch 5/11]: Loss: 0.3884
  Epoch 8 [Batch 6/11]: Loss: 0.0577
  Epoch 8 [Batch 7/11]: Loss: 0.0787
  Epoch 8 [Batch 8/11]: Loss: 0.9173
  Epoch 8 [Batch 9/11]: Loss: 0.4085
  Epoch 8 [Batch 10/11]: Loss: 0.1080
  Epoch 8 Train Summary: Avg Loss: 0.3570, Accuracy: 0.8208
  Validation Summary: Avg Loss: 6.9036, Accuracy: 0.2833, F1 (Macro): 0.2778

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 0.0376
  Epoch 9 [Batch 1/11]: Loss: 0.6540
  Epoch 9 [Batch 2/11]: Loss: 0.1129
  Epoch 9 [Batch 3/11]: Loss: 0.4346
  Epoch 9 [Batch 4/11]: Loss: 0.0922
  Epoch 9 [Batch 5/11]: Loss: 0.1660
  Epoch 9 [Batch 6/11]: Loss: 0.0539
  Epoch 9 [Batch 7/11]: Loss: 0.1570
  Epoch 9 [Batch 8/11]: Loss: 0.0205
  Epoch 9 [Batch 9/11]: Loss: 0.0656
  Epoch 9 [Batch 10/11]: Loss: 2.3628
  Epoch 9 Train Summary: Avg Loss: 0.3779, Accuracy: 0.9393
  Validation Summary: Avg Loss: 7.6472, Accuracy: 0.4167, F1 (Macro): 0.3714

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 0.1028
  Epoch 10 [Batch 1/11]: Loss: 0.3059
  Epoch 10 [Batch 2/11]: Loss: 0.3790
  Epoch 10 [Batch 3/11]: Loss: 0.1678
  Epoch 10 [Batch 4/11]: Loss: 0.0543
  Epoch 10 [Batch 5/11]: Loss: 0.2202
  Epoch 10 [Batch 6/11]: Loss: 0.0155
  Epoch 10 [Batch 7/11]: Loss: 0.5088
  Epoch 10 [Batch 8/11]: Loss: 0.0232
  Epoch 10 [Batch 9/11]: Loss: 0.1325
  Epoch 10 [Batch 10/11]: Loss: 0.4906
  Epoch 10 Train Summary: Avg Loss: 0.2182, Accuracy: 0.9090
  Validation Summary: Avg Loss: 5.0759, Accuracy: 0.2833, F1 (Macro): 0.2778

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 0.0114
  Epoch 11 [Batch 1/11]: Loss: 0.0319
  Epoch 11 [Batch 2/11]: Loss: 0.0205
  Epoch 11 [Batch 3/11]: Loss: 0.1410
  Epoch 11 [Batch 4/11]: Loss: 0.3297
  Epoch 11 [Batch 5/11]: Loss: 0.2096
  Epoch 11 [Batch 6/11]: Loss: 0.1025
  Epoch 11 [Batch 7/11]: Loss: 0.0388
  Epoch 11 [Batch 8/11]: Loss: 0.0509
  Epoch 11 [Batch 9/11]: Loss: 0.0482
  Epoch 11 [Batch 10/11]: Loss: 0.0220
  Epoch 11 Train Summary: Avg Loss: 0.0915, Accuracy: 0.9495
  Validation Summary: Avg Loss: 4.4290, Accuracy: 0.2167, F1 (Macro): 0.2165
  New best model! Val loss improved from 4.5190 to 4.4290. Saving...

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.0819
  Epoch 12 [Batch 1/11]: Loss: 0.1335
  Epoch 12 [Batch 2/11]: Loss: 0.0161
  Epoch 12 [Batch 3/11]: Loss: 0.1271
  Epoch 12 [Batch 4/11]: Loss: 0.2732
  Epoch 12 [Batch 5/11]: Loss: 0.1455
  Epoch 12 [Batch 6/11]: Loss: 0.0351
  Epoch 12 [Batch 7/11]: Loss: 0.1745
  Epoch 12 [Batch 8/11]: Loss: 0.2781
  Epoch 12 [Batch 9/11]: Loss: 0.0149
  Epoch 12 [Batch 10/11]: Loss: 0.0453
  Epoch 12 Train Summary: Avg Loss: 0.1205, Accuracy: 0.9595
  Validation Summary: Avg Loss: 4.8185, Accuracy: 0.3000, F1 (Macro): 0.2815

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 0.0764
  Epoch 13 [Batch 1/11]: Loss: 0.2612
  Epoch 13 [Batch 2/11]: Loss: 0.5635
  Epoch 13 [Batch 3/11]: Loss: 0.2845
  Epoch 13 [Batch 4/11]: Loss: 0.1191
  Epoch 13 [Batch 5/11]: Loss: 0.0381
  Epoch 13 [Batch 6/11]: Loss: 0.0361
  Epoch 13 [Batch 7/11]: Loss: 0.0155
  Epoch 13 [Batch 8/11]: Loss: 0.3538
  Epoch 13 [Batch 9/11]: Loss: 0.1309
  Epoch 13 [Batch 10/11]: Loss: 0.1894
  Epoch 13 Train Summary: Avg Loss: 0.1880, Accuracy: 0.9118
  Validation Summary: Avg Loss: 5.2493, Accuracy: 0.2833, F1 (Macro): 0.2619

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.2209
  Epoch 14 [Batch 1/11]: Loss: 0.0539
  Epoch 14 [Batch 2/11]: Loss: 0.1246
  Epoch 14 [Batch 3/11]: Loss: 0.0158
  Epoch 14 [Batch 4/11]: Loss: 0.0078
  Epoch 14 [Batch 5/11]: Loss: 0.0604
  Epoch 14 [Batch 6/11]: Loss: 0.4408
  Epoch 14 [Batch 7/11]: Loss: 0.3366
  Epoch 14 [Batch 8/11]: Loss: 0.0156
  Epoch 14 [Batch 9/11]: Loss: 0.3261
  Epoch 14 [Batch 10/11]: Loss: 0.1875
  Epoch 14 Train Summary: Avg Loss: 0.1627, Accuracy: 0.9218
  Validation Summary: Avg Loss: 5.1862, Accuracy: 0.3500, F1 (Macro): 0.3162
Training finished in 1.04 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 4.4290, Accuracy: 0.2167, F1 (Macro): 0.2165
Final Best Model Stats: Acc: 0.2167, F1: 0.2165, Loss: 4.4290
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=384x384 lr=0.0001 drop=0.0 seed=123
================================================================================
Starting experiment: efficientnet_b0__384x384__lr-0.0001__drop-0.0__seed-123
Output directory: results_ceph/efficientnet_b0__384x384__lr-0.0001__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 2.6430
  Epoch 0 [Batch 1/11]: Loss: 2.6458
  Epoch 0 [Batch 2/11]: Loss: 2.9375
  Epoch 0 [Batch 3/11]: Loss: 2.8463
  Epoch 0 [Batch 4/11]: Loss: 1.2941
  Epoch 0 [Batch 5/11]: Loss: 1.8846
  Epoch 0 [Batch 6/11]: Loss: 2.8446
  Epoch 0 [Batch 7/11]: Loss: 0.7743
  Epoch 0 [Batch 8/11]: Loss: 2.0882
  Epoch 0 [Batch 9/11]: Loss: 3.8698
  Epoch 0 [Batch 10/11]: Loss: 0.1999
  Epoch 0 Train Summary: Avg Loss: 2.1844, Accuracy: 0.3310
  Validation Summary: Avg Loss: 6.0070, Accuracy: 0.2667, F1 (Macro): 0.2051
  New best model! Val loss improved from inf to 6.0070. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.9866
  Epoch 1 [Batch 1/11]: Loss: 2.5635
  Epoch 1 [Batch 2/11]: Loss: 1.2015
  Epoch 1 [Batch 3/11]: Loss: 1.2333
  Epoch 1 [Batch 4/11]: Loss: 0.8841
  Epoch 1 [Batch 5/11]: Loss: 0.6019
  Epoch 1 [Batch 6/11]: Loss: 1.4394
  Epoch 1 [Batch 7/11]: Loss: 0.9368
  Epoch 1 [Batch 8/11]: Loss: 0.3739
  Epoch 1 [Batch 9/11]: Loss: 1.3227
  Epoch 1 [Batch 10/11]: Loss: 0.3968
  Epoch 1 Train Summary: Avg Loss: 1.1764, Accuracy: 0.4791
  Validation Summary: Avg Loss: 4.1343, Accuracy: 0.6000, F1 (Macro): 0.3758
  New best model! Val loss improved from 6.0070 to 4.1343. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 0.6606
  Epoch 2 [Batch 1/11]: Loss: 0.9790
  Epoch 2 [Batch 2/11]: Loss: 0.2327
  Epoch 2 [Batch 3/11]: Loss: 0.3865
  Epoch 2 [Batch 4/11]: Loss: 1.0094
  Epoch 2 [Batch 5/11]: Loss: 0.5152
  Epoch 2 [Batch 6/11]: Loss: 0.7247
  Epoch 2 [Batch 7/11]: Loss: 0.1845
  Epoch 2 [Batch 8/11]: Loss: 0.6830
  Epoch 2 [Batch 9/11]: Loss: 0.8984
  Epoch 2 [Batch 10/11]: Loss: 2.4890
  Epoch 2 Train Summary: Avg Loss: 0.7966, Accuracy: 0.6994
  Validation Summary: Avg Loss: 4.7802, Accuracy: 0.6000, F1 (Macro): 0.3778

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 0.5871
  Epoch 3 [Batch 1/11]: Loss: 0.4609
  Epoch 3 [Batch 2/11]: Loss: 0.5606
  Epoch 3 [Batch 3/11]: Loss: 0.5713
  Epoch 3 [Batch 4/11]: Loss: 1.0412
  Epoch 3 [Batch 5/11]: Loss: 0.7657
  Epoch 3 [Batch 6/11]: Loss: 1.9971
  Epoch 3 [Batch 7/11]: Loss: 0.2158
  Epoch 3 [Batch 8/11]: Loss: 0.7514
  Epoch 3 [Batch 9/11]: Loss: 0.6903
  Epoch 3 [Batch 10/11]: Loss: 1.3349
  Epoch 3 Train Summary: Avg Loss: 0.8160, Accuracy: 0.6819
  Validation Summary: Avg Loss: 4.8895, Accuracy: 0.2667, F1 (Macro): 0.2222

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 0.9485
  Epoch 4 [Batch 1/11]: Loss: 0.1242
  Epoch 4 [Batch 2/11]: Loss: 0.7300
  Epoch 4 [Batch 3/11]: Loss: 0.7276
  Epoch 4 [Batch 4/11]: Loss: 0.8588
  Epoch 4 [Batch 5/11]: Loss: 0.5071
  Epoch 4 [Batch 6/11]: Loss: 0.2211
  Epoch 4 [Batch 7/11]: Loss: 1.2816
  Epoch 4 [Batch 8/11]: Loss: 0.0908
  Epoch 4 [Batch 9/11]: Loss: 0.3083
  Epoch 4 [Batch 10/11]: Loss: 0.0325
  Epoch 4 Train Summary: Avg Loss: 0.5300, Accuracy: 0.7850
  Validation Summary: Avg Loss: 3.4014, Accuracy: 0.2667, F1 (Macro): 0.2051
  New best model! Val loss improved from 4.1343 to 3.4014. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 0.4642
  Epoch 5 [Batch 1/11]: Loss: 0.2713
  Epoch 5 [Batch 2/11]: Loss: 0.1991
  Epoch 5 [Batch 3/11]: Loss: 0.0283
  Epoch 5 [Batch 4/11]: Loss: 0.5910
  Epoch 5 [Batch 5/11]: Loss: 0.1993
  Epoch 5 [Batch 6/11]: Loss: 0.2240
  Epoch 5 [Batch 7/11]: Loss: 0.5265
  Epoch 5 [Batch 8/11]: Loss: 0.0940
  Epoch 5 [Batch 9/11]: Loss: 0.2170
  Epoch 5 [Batch 10/11]: Loss: 0.2197
  Epoch 5 Train Summary: Avg Loss: 0.2759, Accuracy: 0.9110
  Validation Summary: Avg Loss: 2.6783, Accuracy: 0.3500, F1 (Macro): 0.3385
  New best model! Val loss improved from 3.4014 to 2.6783. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 0.1143
  Epoch 6 [Batch 1/11]: Loss: 0.5326
  Epoch 6 [Batch 2/11]: Loss: 0.0973
  Epoch 6 [Batch 3/11]: Loss: 0.7135
  Epoch 6 [Batch 4/11]: Loss: 0.1320
  Epoch 6 [Batch 5/11]: Loss: 0.5783
  Epoch 6 [Batch 6/11]: Loss: 0.1534
  Epoch 6 [Batch 7/11]: Loss: 0.1392
  Epoch 6 [Batch 8/11]: Loss: 0.0591
  Epoch 6 [Batch 9/11]: Loss: 0.6232
  Epoch 6 [Batch 10/11]: Loss: 0.9909
  Epoch 6 Train Summary: Avg Loss: 0.3758, Accuracy: 0.8612
  Validation Summary: Avg Loss: 3.1447, Accuracy: 0.3500, F1 (Macro): 0.3385

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.4502
  Epoch 7 [Batch 1/11]: Loss: 0.4618
  Epoch 7 [Batch 2/11]: Loss: 0.0597
  Epoch 7 [Batch 3/11]: Loss: 0.3380
  Epoch 7 [Batch 4/11]: Loss: 0.2550
  Epoch 7 [Batch 5/11]: Loss: 0.0775
  Epoch 7 [Batch 6/11]: Loss: 0.1458
  Epoch 7 [Batch 7/11]: Loss: 0.0221
  Epoch 7 [Batch 8/11]: Loss: 0.1666
  Epoch 7 [Batch 9/11]: Loss: 0.1460
  Epoch 7 [Batch 10/11]: Loss: 0.0965
  Epoch 7 Train Summary: Avg Loss: 0.2017, Accuracy: 0.8996
  Validation Summary: Avg Loss: 4.3044, Accuracy: 0.3333, F1 (Macro): 0.2222

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 0.4314
  Epoch 8 [Batch 1/11]: Loss: 0.0410
  Epoch 8 [Batch 2/11]: Loss: 0.2918
  Epoch 8 [Batch 3/11]: Loss: 0.4859
  Epoch 8 [Batch 4/11]: Loss: 0.2094
  Epoch 8 [Batch 5/11]: Loss: 0.1622
  Epoch 8 [Batch 6/11]: Loss: 0.2631
  Epoch 8 [Batch 7/11]: Loss: 0.0895
  Epoch 8 [Batch 8/11]: Loss: 0.1249
  Epoch 8 [Batch 9/11]: Loss: 0.0984
  Epoch 8 [Batch 10/11]: Loss: 0.6190
  Epoch 8 Train Summary: Avg Loss: 0.2560, Accuracy: 0.8733
  Validation Summary: Avg Loss: 3.7270, Accuracy: 0.2667, F1 (Macro): 0.2051

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 0.1263
  Epoch 9 [Batch 1/11]: Loss: 0.1487
  Epoch 9 [Batch 2/11]: Loss: 0.1946
  Epoch 9 [Batch 3/11]: Loss: 0.0421
  Epoch 9 [Batch 4/11]: Loss: 0.3817
  Epoch 9 [Batch 5/11]: Loss: 0.1459
  Epoch 9 [Batch 6/11]: Loss: 0.0722
  Epoch 9 [Batch 7/11]: Loss: 0.0169
  Epoch 9 [Batch 8/11]: Loss: 0.2600
  Epoch 9 [Batch 9/11]: Loss: 0.0238
  Epoch 9 [Batch 10/11]: Loss: 1.1185
  Epoch 9 Train Summary: Avg Loss: 0.2301, Accuracy: 0.9009
  Validation Summary: Avg Loss: 2.4282, Accuracy: 0.2000, F1 (Macro): 0.1667
  New best model! Val loss improved from 2.6783 to 2.4282. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 0.2485
  Epoch 10 [Batch 1/11]: Loss: 0.0247
  Epoch 10 [Batch 2/11]: Loss: 0.3482
  Epoch 10 [Batch 3/11]: Loss: 0.1179
  Epoch 10 [Batch 4/11]: Loss: 0.0544
  Epoch 10 [Batch 5/11]: Loss: 0.1189
  Epoch 10 [Batch 6/11]: Loss: 0.0407
  Epoch 10 [Batch 7/11]: Loss: 0.1403
  Epoch 10 [Batch 8/11]: Loss: 0.9828
  Epoch 10 [Batch 9/11]: Loss: 1.7916
  Epoch 10 [Batch 10/11]: Loss: 0.5797
  Epoch 10 Train Summary: Avg Loss: 0.4043, Accuracy: 0.8457
  Validation Summary: Avg Loss: 3.6904, Accuracy: 0.2667, F1 (Macro): 0.2051

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 0.1435
  Epoch 11 [Batch 1/11]: Loss: 0.0639
  Epoch 11 [Batch 2/11]: Loss: 0.0868
  Epoch 11 [Batch 3/11]: Loss: 0.0968
  Epoch 11 [Batch 4/11]: Loss: 0.2541
  Epoch 11 [Batch 5/11]: Loss: 0.4190
  Epoch 11 [Batch 6/11]: Loss: 0.4160
  Epoch 11 [Batch 7/11]: Loss: 0.1226
  Epoch 11 [Batch 8/11]: Loss: 0.2363
  Epoch 11 [Batch 9/11]: Loss: 0.0497
  Epoch 11 [Batch 10/11]: Loss: 1.3529
  Epoch 11 Train Summary: Avg Loss: 0.2947, Accuracy: 0.9245
  Validation Summary: Avg Loss: 5.2691, Accuracy: 0.2667, F1 (Macro): 0.2051

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.0331
  Epoch 12 [Batch 1/11]: Loss: 0.1928
  Epoch 12 [Batch 2/11]: Loss: 0.3399
  Epoch 12 [Batch 3/11]: Loss: 0.0242
  Epoch 12 [Batch 4/11]: Loss: 0.1719
  Epoch 12 [Batch 5/11]: Loss: 0.0757
  Epoch 12 [Batch 6/11]: Loss: 0.1033
  Epoch 12 [Batch 7/11]: Loss: 0.0622
  Epoch 12 [Batch 8/11]: Loss: 0.2288
  Epoch 12 [Batch 9/11]: Loss: 0.1339
  Epoch 12 [Batch 10/11]: Loss: 1.5467
  Epoch 12 Train Summary: Avg Loss: 0.2648, Accuracy: 0.9447
  Validation Summary: Avg Loss: 4.0225, Accuracy: 0.2000, F1 (Macro): 0.1667

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 0.1742
  Epoch 13 [Batch 1/11]: Loss: 0.0471
  Epoch 13 [Batch 2/11]: Loss: 0.1074
  Epoch 13 [Batch 3/11]: Loss: 0.3075
  Epoch 13 [Batch 4/11]: Loss: 0.0970
  Epoch 13 [Batch 5/11]: Loss: 0.0092
  Epoch 13 [Batch 6/11]: Loss: 0.2343
  Epoch 13 [Batch 7/11]: Loss: 0.3377
  Epoch 13 [Batch 8/11]: Loss: 0.3346
  Epoch 13 [Batch 9/11]: Loss: 0.0257
  Epoch 13 [Batch 10/11]: Loss: 0.2324
  Epoch 13 Train Summary: Avg Loss: 0.1734, Accuracy: 0.9401
  Validation Summary: Avg Loss: 3.6181, Accuracy: 0.2000, F1 (Macro): 0.1667

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.0381
  Epoch 14 [Batch 1/11]: Loss: 0.0156
  Epoch 14 [Batch 2/11]: Loss: 0.2197
  Epoch 14 [Batch 3/11]: Loss: 0.1500
  Epoch 14 [Batch 4/11]: Loss: 0.0635
  Epoch 14 [Batch 5/11]: Loss: 0.0713
  Epoch 14 [Batch 6/11]: Loss: 0.2795
  Epoch 14 [Batch 7/11]: Loss: 0.4263
  Epoch 14 [Batch 8/11]: Loss: 0.0083
  Epoch 14 [Batch 9/11]: Loss: 0.0021
  Epoch 14 [Batch 10/11]: Loss: 0.7947
  Epoch 14 Train Summary: Avg Loss: 0.1881, Accuracy: 0.9118
  Validation Summary: Avg Loss: 4.7718, Accuracy: 0.2000, F1 (Macro): 0.1667
Training finished in 1.01 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 2.4282, Accuracy: 0.2000, F1 (Macro): 0.1667
Final Best Model Stats: Acc: 0.2000, F1: 0.1667, Loss: 2.4282
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=384x384 lr=0.0001 drop=0.0 seed=999
================================================================================
Starting experiment: efficientnet_b0__384x384__lr-0.0001__drop-0.0__seed-999
Output directory: results_ceph/efficientnet_b0__384x384__lr-0.0001__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.7963
  Epoch 0 [Batch 1/11]: Loss: 2.4073
  Epoch 0 [Batch 2/11]: Loss: 2.9510
  Epoch 0 [Batch 3/11]: Loss: 0.6314
  Epoch 0 [Batch 4/11]: Loss: 2.8690
  Epoch 0 [Batch 5/11]: Loss: 1.4903
  Epoch 0 [Batch 6/11]: Loss: 1.1031
  Epoch 0 [Batch 7/11]: Loss: 2.2546
  Epoch 0 [Batch 8/11]: Loss: 3.4120
  Epoch 0 [Batch 9/11]: Loss: 2.2569
  Epoch 0 [Batch 10/11]: Loss: 1.3633
  Epoch 0 Train Summary: Avg Loss: 2.0486, Accuracy: 0.2978
  Validation Summary: Avg Loss: 5.0913, Accuracy: 0.2667, F1 (Macro): 0.1905
  New best model! Val loss improved from inf to 5.0913. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.4578
  Epoch 1 [Batch 1/11]: Loss: 0.6940
  Epoch 1 [Batch 2/11]: Loss: 1.2841
  Epoch 1 [Batch 3/11]: Loss: 1.3595
  Epoch 1 [Batch 4/11]: Loss: 0.5908
  Epoch 1 [Batch 5/11]: Loss: 1.2127
  Epoch 1 [Batch 6/11]: Loss: 1.1418
  Epoch 1 [Batch 7/11]: Loss: 1.5000
  Epoch 1 [Batch 8/11]: Loss: 1.7539
  Epoch 1 [Batch 9/11]: Loss: 0.7147
  Epoch 1 [Batch 10/11]: Loss: 0.2298
  Epoch 1 Train Summary: Avg Loss: 1.0854, Accuracy: 0.5761
  Validation Summary: Avg Loss: 5.6055, Accuracy: 0.3000, F1 (Macro): 0.2815

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 1.9208
  Epoch 2 [Batch 1/11]: Loss: 1.3277
  Epoch 2 [Batch 2/11]: Loss: 0.6843
  Epoch 2 [Batch 3/11]: Loss: 0.3650
  Epoch 2 [Batch 4/11]: Loss: 0.5711
  Epoch 2 [Batch 5/11]: Loss: 0.2532
  Epoch 2 [Batch 6/11]: Loss: 1.6346
  Epoch 2 [Batch 7/11]: Loss: 1.0521
  Epoch 2 [Batch 8/11]: Loss: 0.1809
  Epoch 2 [Batch 9/11]: Loss: 1.1641
  Epoch 2 [Batch 10/11]: Loss: 0.8957
  Epoch 2 Train Summary: Avg Loss: 0.9136, Accuracy: 0.6442
  Validation Summary: Avg Loss: 6.0429, Accuracy: 0.3500, F1 (Macro): 0.3162

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 0.3298
  Epoch 3 [Batch 1/11]: Loss: 0.2220
  Epoch 3 [Batch 2/11]: Loss: 1.2496
  Epoch 3 [Batch 3/11]: Loss: 1.1019
  Epoch 3 [Batch 4/11]: Loss: 0.7167
  Epoch 3 [Batch 5/11]: Loss: 0.1169
  Epoch 3 [Batch 6/11]: Loss: 0.4244
  Epoch 3 [Batch 7/11]: Loss: 1.3945
  Epoch 3 [Batch 8/11]: Loss: 1.6179
  Epoch 3 [Batch 9/11]: Loss: 0.6217
  Epoch 3 [Batch 10/11]: Loss: 0.1421
  Epoch 3 Train Summary: Avg Loss: 0.7216, Accuracy: 0.6867
  Validation Summary: Avg Loss: 5.3993, Accuracy: 0.1500, F1 (Macro): 0.2074

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 0.4034
  Epoch 4 [Batch 1/11]: Loss: 0.3728
  Epoch 4 [Batch 2/11]: Loss: 0.4485
  Epoch 4 [Batch 3/11]: Loss: 0.7561
  Epoch 4 [Batch 4/11]: Loss: 0.2068
  Epoch 4 [Batch 5/11]: Loss: 0.3968
  Epoch 4 [Batch 6/11]: Loss: 0.7389
  Epoch 4 [Batch 7/11]: Loss: 0.6113
  Epoch 4 [Batch 8/11]: Loss: 0.2052
  Epoch 4 [Batch 9/11]: Loss: 0.0685
  Epoch 4 [Batch 10/11]: Loss: 2.1495
  Epoch 4 Train Summary: Avg Loss: 0.5780, Accuracy: 0.8228
  Validation Summary: Avg Loss: 3.9836, Accuracy: 0.2333, F1 (Macro): 0.2500
  New best model! Val loss improved from 5.0913 to 3.9836. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 0.7576
  Epoch 5 [Batch 1/11]: Loss: 0.3470
  Epoch 5 [Batch 2/11]: Loss: 0.2066
  Epoch 5 [Batch 3/11]: Loss: 1.5452
  Epoch 5 [Batch 4/11]: Loss: 0.3916
  Epoch 5 [Batch 5/11]: Loss: 0.1733
  Epoch 5 [Batch 6/11]: Loss: 0.1431
  Epoch 5 [Batch 7/11]: Loss: 0.1621
  Epoch 5 [Batch 8/11]: Loss: 0.2459
  Epoch 5 [Batch 9/11]: Loss: 0.3073
  Epoch 5 [Batch 10/11]: Loss: 1.4826
  Epoch 5 Train Summary: Avg Loss: 0.5238, Accuracy: 0.8429
  Validation Summary: Avg Loss: 4.6387, Accuracy: 0.1333, F1 (Macro): 0.1333

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 0.8573
  Epoch 6 [Batch 1/11]: Loss: 0.3781
  Epoch 6 [Batch 2/11]: Loss: 0.1524
  Epoch 6 [Batch 3/11]: Loss: 0.6454
  Epoch 6 [Batch 4/11]: Loss: 0.0333
  Epoch 6 [Batch 5/11]: Loss: 0.3337
  Epoch 6 [Batch 6/11]: Loss: 0.2041
  Epoch 6 [Batch 7/11]: Loss: 0.4013
  Epoch 6 [Batch 8/11]: Loss: 0.3425
  Epoch 6 [Batch 9/11]: Loss: 0.8696
  Epoch 6 [Batch 10/11]: Loss: 0.4702
  Epoch 6 Train Summary: Avg Loss: 0.4262, Accuracy: 0.8463
  Validation Summary: Avg Loss: 4.8045, Accuracy: 0.2000, F1 (Macro): 0.1538

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.1432
  Epoch 7 [Batch 1/11]: Loss: 0.2917
  Epoch 7 [Batch 2/11]: Loss: 0.0755
  Epoch 7 [Batch 3/11]: Loss: 0.4192
  Epoch 7 [Batch 4/11]: Loss: 0.2809
  Epoch 7 [Batch 5/11]: Loss: 0.3273
  Epoch 7 [Batch 6/11]: Loss: 0.4870
  Epoch 7 [Batch 7/11]: Loss: 0.1560
  Epoch 7 [Batch 8/11]: Loss: 0.1366
  Epoch 7 [Batch 9/11]: Loss: 0.0810
  Epoch 7 [Batch 10/11]: Loss: 0.3697
  Epoch 7 Train Summary: Avg Loss: 0.2516, Accuracy: 0.9171
  Validation Summary: Avg Loss: 5.2891, Accuracy: 0.3500, F1 (Macro): 0.3162

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 0.2519
  Epoch 8 [Batch 1/11]: Loss: 0.0689
  Epoch 8 [Batch 2/11]: Loss: 0.2914
  Epoch 8 [Batch 3/11]: Loss: 0.1086
  Epoch 8 [Batch 4/11]: Loss: 0.4659
  Epoch 8 [Batch 5/11]: Loss: 0.0684
  Epoch 8 [Batch 6/11]: Loss: 0.6747
  Epoch 8 [Batch 7/11]: Loss: 0.1453
  Epoch 8 [Batch 8/11]: Loss: 0.0197
  Epoch 8 [Batch 9/11]: Loss: 0.3968
  Epoch 8 [Batch 10/11]: Loss: 0.3393
  Epoch 8 Train Summary: Avg Loss: 0.2574, Accuracy: 0.8740
  Validation Summary: Avg Loss: 4.8426, Accuracy: 0.3500, F1 (Macro): 0.3162

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 0.0455
  Epoch 9 [Batch 1/11]: Loss: 0.1139
  Epoch 9 [Batch 2/11]: Loss: 0.0376
  Epoch 9 [Batch 3/11]: Loss: 0.2304
  Epoch 9 [Batch 4/11]: Loss: 0.1064
  Epoch 9 [Batch 5/11]: Loss: 0.1029
  Epoch 9 [Batch 6/11]: Loss: 0.1693
  Epoch 9 [Batch 7/11]: Loss: 0.0214
  Epoch 9 [Batch 8/11]: Loss: 0.0329
  Epoch 9 [Batch 9/11]: Loss: 0.4205
  Epoch 9 [Batch 10/11]: Loss: 0.7857
  Epoch 9 Train Summary: Avg Loss: 0.1879, Accuracy: 0.9347
  Validation Summary: Avg Loss: 4.4656, Accuracy: 0.2667, F1 (Macro): 0.1905

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 0.2620
  Epoch 10 [Batch 1/11]: Loss: 0.1056
  Epoch 10 [Batch 2/11]: Loss: 0.0510
  Epoch 10 [Batch 3/11]: Loss: 0.0448
  Epoch 10 [Batch 4/11]: Loss: 0.1102
  Epoch 10 [Batch 5/11]: Loss: 0.0074
  Epoch 10 [Batch 6/11]: Loss: 0.3626
  Epoch 10 [Batch 7/11]: Loss: 0.0722
  Epoch 10 [Batch 8/11]: Loss: 0.1620
  Epoch 10 [Batch 9/11]: Loss: 0.4732
  Epoch 10 [Batch 10/11]: Loss: 0.0173
  Epoch 10 Train Summary: Avg Loss: 0.1517, Accuracy: 0.9172
  Validation Summary: Avg Loss: 5.1194, Accuracy: 0.2667, F1 (Macro): 0.1905

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 0.1719
  Epoch 11 [Batch 1/11]: Loss: 0.2918
  Epoch 11 [Batch 2/11]: Loss: 0.0477
  Epoch 11 [Batch 3/11]: Loss: 0.0931
  Epoch 11 [Batch 4/11]: Loss: 0.1672
  Epoch 11 [Batch 5/11]: Loss: 0.3346
  Epoch 11 [Batch 6/11]: Loss: 0.1205
  Epoch 11 [Batch 7/11]: Loss: 0.0239
  Epoch 11 [Batch 8/11]: Loss: 0.0557
  Epoch 11 [Batch 9/11]: Loss: 0.0430
  Epoch 11 [Batch 10/11]: Loss: 0.1634
  Epoch 11 Train Summary: Avg Loss: 0.1375, Accuracy: 0.9541
  Validation Summary: Avg Loss: 4.9296, Accuracy: 0.2667, F1 (Macro): 0.1905

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.0496
  Epoch 12 [Batch 1/11]: Loss: 0.1467
  Epoch 12 [Batch 2/11]: Loss: 0.1038
  Epoch 12 [Batch 3/11]: Loss: 0.0072
  Epoch 12 [Batch 4/11]: Loss: 0.1610
  Epoch 12 [Batch 5/11]: Loss: 0.1189
  Epoch 12 [Batch 6/11]: Loss: 0.0539
  Epoch 12 [Batch 7/11]: Loss: 0.0123
  Epoch 12 [Batch 8/11]: Loss: 0.0780
  Epoch 12 [Batch 9/11]: Loss: 0.2298
  Epoch 12 [Batch 10/11]: Loss: 0.1454
  Epoch 12 Train Summary: Avg Loss: 0.1006, Accuracy: 0.9495
  Validation Summary: Avg Loss: 4.8490, Accuracy: 0.2667, F1 (Macro): 0.1905

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 0.0919
  Epoch 13 [Batch 1/11]: Loss: 0.0988
  Epoch 13 [Batch 2/11]: Loss: 0.1949
  Epoch 13 [Batch 3/11]: Loss: 0.0844
  Epoch 13 [Batch 4/11]: Loss: 0.0870
  Epoch 13 [Batch 5/11]: Loss: 0.0834
  Epoch 13 [Batch 6/11]: Loss: 0.1975
  Epoch 13 [Batch 7/11]: Loss: 0.0253
  Epoch 13 [Batch 8/11]: Loss: 0.1827
  Epoch 13 [Batch 9/11]: Loss: 0.0172
  Epoch 13 [Batch 10/11]: Loss: 0.7625
  Epoch 13 Train Summary: Avg Loss: 0.1660, Accuracy: 0.9017
  Validation Summary: Avg Loss: 5.2340, Accuracy: 0.2667, F1 (Macro): 0.1905

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.3865
  Epoch 14 [Batch 1/11]: Loss: 0.0567
  Epoch 14 [Batch 2/11]: Loss: 0.2487
  Epoch 14 [Batch 3/11]: Loss: 0.1894
  Epoch 14 [Batch 4/11]: Loss: 0.0510
  Epoch 14 [Batch 5/11]: Loss: 0.1248
  Epoch 14 [Batch 6/11]: Loss: 0.6944
  Epoch 14 [Batch 7/11]: Loss: 0.0912
  Epoch 14 [Batch 8/11]: Loss: 0.1941
  Epoch 14 [Batch 9/11]: Loss: 0.0874
  Epoch 14 [Batch 10/11]: Loss: 1.3580
  Epoch 14 Train Summary: Avg Loss: 0.3166, Accuracy: 0.9339
  Validation Summary: Avg Loss: 5.2298, Accuracy: 0.2667, F1 (Macro): 0.1905
Training finished in 0.92 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 3.9836, Accuracy: 0.2333, F1 (Macro): 0.2500
Final Best Model Stats: Acc: 0.2333, F1: 0.2500, Loss: 3.9836
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=384x384 lr=5e-05 drop=0.0 seed=42
================================================================================
Starting experiment: efficientnet_b0__384x384__lr-5e-05__drop-0.0__seed-42
Output directory: results_ceph/efficientnet_b0__384x384__lr-5e-05__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.7930
  Epoch 0 [Batch 1/11]: Loss: 1.7239
  Epoch 0 [Batch 2/11]: Loss: 1.2899
  Epoch 0 [Batch 3/11]: Loss: 1.5806
  Epoch 0 [Batch 4/11]: Loss: 2.3568
  Epoch 0 [Batch 5/11]: Loss: 1.7540
  Epoch 0 [Batch 6/11]: Loss: 2.2790
  Epoch 0 [Batch 7/11]: Loss: 3.1275
  Epoch 0 [Batch 8/11]: Loss: 1.6623
  Epoch 0 [Batch 9/11]: Loss: 1.4474
  Epoch 0 [Batch 10/11]: Loss: 0.8496
  Epoch 0 Train Summary: Avg Loss: 1.8058, Accuracy: 0.3310
  Validation Summary: Avg Loss: 5.9117, Accuracy: 0.2167, F1 (Macro): 0.2444
  New best model! Val loss improved from inf to 5.9117. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 0.5236
  Epoch 1 [Batch 1/11]: Loss: 1.2328
  Epoch 1 [Batch 2/11]: Loss: 1.6214
  Epoch 1 [Batch 3/11]: Loss: 0.9328
  Epoch 1 [Batch 4/11]: Loss: 1.4613
  Epoch 1 [Batch 5/11]: Loss: 1.3653
  Epoch 1 [Batch 6/11]: Loss: 2.8161
  Epoch 1 [Batch 7/11]: Loss: 1.1220
  Epoch 1 [Batch 8/11]: Loss: 0.8986
  Epoch 1 [Batch 9/11]: Loss: 1.2870
  Epoch 1 [Batch 10/11]: Loss: 1.1835
  Epoch 1 Train Summary: Avg Loss: 1.3131, Accuracy: 0.4354
  Validation Summary: Avg Loss: 5.5068, Accuracy: 0.2500, F1 (Macro): 0.1538
  New best model! Val loss improved from 5.9117 to 5.5068. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 1.2132
  Epoch 2 [Batch 1/11]: Loss: 1.0416
  Epoch 2 [Batch 2/11]: Loss: 0.6854
  Epoch 2 [Batch 3/11]: Loss: 0.2585
  Epoch 2 [Batch 4/11]: Loss: 1.3053
  Epoch 2 [Batch 5/11]: Loss: 1.5737
  Epoch 2 [Batch 6/11]: Loss: 1.3955
  Epoch 2 [Batch 7/11]: Loss: 1.5107
  Epoch 2 [Batch 8/11]: Loss: 1.2948
  Epoch 2 [Batch 9/11]: Loss: 0.4767
  Epoch 2 [Batch 10/11]: Loss: 0.0634
  Epoch 2 Train Summary: Avg Loss: 0.9835, Accuracy: 0.5674
  Validation Summary: Avg Loss: 5.9924, Accuracy: 0.1667, F1 (Macro): 0.1212

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 1.2447
  Epoch 3 [Batch 1/11]: Loss: 1.8955
  Epoch 3 [Batch 2/11]: Loss: 0.4318
  Epoch 3 [Batch 3/11]: Loss: 0.6270
  Epoch 3 [Batch 4/11]: Loss: 0.5487
  Epoch 3 [Batch 5/11]: Loss: 0.7663
  Epoch 3 [Batch 6/11]: Loss: 0.5880
  Epoch 3 [Batch 7/11]: Loss: 0.8672
  Epoch 3 [Batch 8/11]: Loss: 1.5459
  Epoch 3 [Batch 9/11]: Loss: 0.8439
  Epoch 3 [Batch 10/11]: Loss: 2.0808
  Epoch 3 Train Summary: Avg Loss: 1.0400, Accuracy: 0.5774
  Validation Summary: Avg Loss: 5.7221, Accuracy: 0.2333, F1 (Macro): 0.2074

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 0.9815
  Epoch 4 [Batch 1/11]: Loss: 1.3359
  Epoch 4 [Batch 2/11]: Loss: 0.1296
  Epoch 4 [Batch 3/11]: Loss: 0.4659
  Epoch 4 [Batch 4/11]: Loss: 0.5345
  Epoch 4 [Batch 5/11]: Loss: 0.6058
  Epoch 4 [Batch 6/11]: Loss: 0.5325
  Epoch 4 [Batch 7/11]: Loss: 0.3532
  Epoch 4 [Batch 8/11]: Loss: 0.8355
  Epoch 4 [Batch 9/11]: Loss: 0.9381
  Epoch 4 [Batch 10/11]: Loss: 1.3924
  Epoch 4 Train Summary: Avg Loss: 0.7368, Accuracy: 0.6563
  Validation Summary: Avg Loss: 5.4633, Accuracy: 0.1500, F1 (Macro): 0.1407
  New best model! Val loss improved from 5.5068 to 5.4633. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 1.3064
  Epoch 5 [Batch 1/11]: Loss: 0.9005
  Epoch 5 [Batch 2/11]: Loss: 0.3122
  Epoch 5 [Batch 3/11]: Loss: 0.8244
  Epoch 5 [Batch 4/11]: Loss: 0.9855
  Epoch 5 [Batch 5/11]: Loss: 0.9732
  Epoch 5 [Batch 6/11]: Loss: 0.1701
  Epoch 5 [Batch 7/11]: Loss: 0.3805
  Epoch 5 [Batch 8/11]: Loss: 0.6795
  Epoch 5 [Batch 9/11]: Loss: 0.3213
  Epoch 5 [Batch 10/11]: Loss: 1.2208
  Epoch 5 Train Summary: Avg Loss: 0.7340, Accuracy: 0.6987
  Validation Summary: Avg Loss: 4.0955, Accuracy: 0.3000, F1 (Macro): 0.2815
  New best model! Val loss improved from 5.4633 to 4.0955. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 0.7481
  Epoch 6 [Batch 1/11]: Loss: 0.3323
  Epoch 6 [Batch 2/11]: Loss: 0.3664
  Epoch 6 [Batch 3/11]: Loss: 0.6609
  Epoch 6 [Batch 4/11]: Loss: 0.4219
  Epoch 6 [Batch 5/11]: Loss: 0.4777
  Epoch 6 [Batch 6/11]: Loss: 0.8051
  Epoch 6 [Batch 7/11]: Loss: 0.2255
  Epoch 6 [Batch 8/11]: Loss: 0.2986
  Epoch 6 [Batch 9/11]: Loss: 0.4336
  Epoch 6 [Batch 10/11]: Loss: 2.2683
  Epoch 6 Train Summary: Avg Loss: 0.6398, Accuracy: 0.8282
  Validation Summary: Avg Loss: 3.6419, Accuracy: 0.4333, F1 (Macro): 0.4127
  New best model! Val loss improved from 4.0955 to 3.6419. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.3357
  Epoch 7 [Batch 1/11]: Loss: 0.5614
  Epoch 7 [Batch 2/11]: Loss: 0.3374
  Epoch 7 [Batch 3/11]: Loss: 0.5976
  Epoch 7 [Batch 4/11]: Loss: 0.8241
  Epoch 7 [Batch 5/11]: Loss: 0.3707
  Epoch 7 [Batch 6/11]: Loss: 0.2941
  Epoch 7 [Batch 7/11]: Loss: 0.4410
  Epoch 7 [Batch 8/11]: Loss: 0.2854
  Epoch 7 [Batch 9/11]: Loss: 0.1743
  Epoch 7 [Batch 10/11]: Loss: 1.0947
  Epoch 7 Train Summary: Avg Loss: 0.4833, Accuracy: 0.7372
  Validation Summary: Avg Loss: 4.0791, Accuracy: 0.3000, F1 (Macro): 0.2963

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 0.2454
  Epoch 8 [Batch 1/11]: Loss: 0.2317
  Epoch 8 [Batch 2/11]: Loss: 0.1988
  Epoch 8 [Batch 3/11]: Loss: 0.7868
  Epoch 8 [Batch 4/11]: Loss: 0.7010
  Epoch 8 [Batch 5/11]: Loss: 0.3459
  Epoch 8 [Batch 6/11]: Loss: 0.1632
  Epoch 8 [Batch 7/11]: Loss: 0.2624
  Epoch 8 [Batch 8/11]: Loss: 0.6643
  Epoch 8 [Batch 9/11]: Loss: 0.2399
  Epoch 8 [Batch 10/11]: Loss: 0.2171
  Epoch 8 Train Summary: Avg Loss: 0.3688, Accuracy: 0.8383
  Validation Summary: Avg Loss: 4.2196, Accuracy: 0.3667, F1 (Macro): 0.3723

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 0.0953
  Epoch 9 [Batch 1/11]: Loss: 0.9132
  Epoch 9 [Batch 2/11]: Loss: 0.4322
  Epoch 9 [Batch 3/11]: Loss: 0.4417
  Epoch 9 [Batch 4/11]: Loss: 0.1923
  Epoch 9 [Batch 5/11]: Loss: 0.3067
  Epoch 9 [Batch 6/11]: Loss: 0.1444
  Epoch 9 [Batch 7/11]: Loss: 0.2464
  Epoch 9 [Batch 8/11]: Loss: 0.1489
  Epoch 9 [Batch 9/11]: Loss: 0.1511
  Epoch 9 [Batch 10/11]: Loss: 2.9079
  Epoch 9 Train Summary: Avg Loss: 0.5436, Accuracy: 0.8962
  Validation Summary: Avg Loss: 5.1140, Accuracy: 0.4167, F1 (Macro): 0.3714

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 0.2318
  Epoch 10 [Batch 1/11]: Loss: 0.9117
  Epoch 10 [Batch 2/11]: Loss: 0.7100
  Epoch 10 [Batch 3/11]: Loss: 0.1968
  Epoch 10 [Batch 4/11]: Loss: 0.1432
  Epoch 10 [Batch 5/11]: Loss: 0.1104
  Epoch 10 [Batch 6/11]: Loss: 0.0824
  Epoch 10 [Batch 7/11]: Loss: 0.6325
  Epoch 10 [Batch 8/11]: Loss: 0.0854
  Epoch 10 [Batch 9/11]: Loss: 0.2731
  Epoch 10 [Batch 10/11]: Loss: 0.5179
  Epoch 10 Train Summary: Avg Loss: 0.3541, Accuracy: 0.8328
  Validation Summary: Avg Loss: 4.0334, Accuracy: 0.3000, F1 (Macro): 0.2963

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 0.0411
  Epoch 11 [Batch 1/11]: Loss: 0.1367
  Epoch 11 [Batch 2/11]: Loss: 0.0930
  Epoch 11 [Batch 3/11]: Loss: 0.1167
  Epoch 11 [Batch 4/11]: Loss: 0.6719
  Epoch 11 [Batch 5/11]: Loss: 0.3332
  Epoch 11 [Batch 6/11]: Loss: 0.1030
  Epoch 11 [Batch 7/11]: Loss: 0.1183
  Epoch 11 [Batch 8/11]: Loss: 0.1755
  Epoch 11 [Batch 9/11]: Loss: 0.2341
  Epoch 11 [Batch 10/11]: Loss: 0.0651
  Epoch 11 Train Summary: Avg Loss: 0.1899, Accuracy: 0.9495
  Validation Summary: Avg Loss: 3.9110, Accuracy: 0.3000, F1 (Macro): 0.2963

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.2721
  Epoch 12 [Batch 1/11]: Loss: 0.1857
  Epoch 12 [Batch 2/11]: Loss: 0.0390
  Epoch 12 [Batch 3/11]: Loss: 0.3461
  Epoch 12 [Batch 4/11]: Loss: 0.5375
  Epoch 12 [Batch 5/11]: Loss: 0.2525
  Epoch 12 [Batch 6/11]: Loss: 0.0924
  Epoch 12 [Batch 7/11]: Loss: 0.2954
  Epoch 12 [Batch 8/11]: Loss: 0.4164
  Epoch 12 [Batch 9/11]: Loss: 0.0486
  Epoch 12 [Batch 10/11]: Loss: 0.3456
  Epoch 12 Train Summary: Avg Loss: 0.2574, Accuracy: 0.8713
  Validation Summary: Avg Loss: 3.9550, Accuracy: 0.3000, F1 (Macro): 0.2963

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 0.0914
  Epoch 13 [Batch 1/11]: Loss: 0.3894
  Epoch 13 [Batch 2/11]: Loss: 0.6801
  Epoch 13 [Batch 3/11]: Loss: 0.1887
  Epoch 13 [Batch 4/11]: Loss: 0.0978
  Epoch 13 [Batch 5/11]: Loss: 0.1325
  Epoch 13 [Batch 6/11]: Loss: 0.0412
  Epoch 13 [Batch 7/11]: Loss: 0.1017
  Epoch 13 [Batch 8/11]: Loss: 0.3204
  Epoch 13 [Batch 9/11]: Loss: 0.2556
  Epoch 13 [Batch 10/11]: Loss: 0.1741
  Epoch 13 Train Summary: Avg Loss: 0.2248, Accuracy: 0.8989
  Validation Summary: Avg Loss: 4.0218, Accuracy: 0.4333, F1 (Macro): 0.4329

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.4151
  Epoch 14 [Batch 1/11]: Loss: 0.0949
  Epoch 14 [Batch 2/11]: Loss: 0.0302
  Epoch 14 [Batch 3/11]: Loss: 0.1094
  Epoch 14 [Batch 4/11]: Loss: 0.0189
  Epoch 14 [Batch 5/11]: Loss: 0.0938
  Epoch 14 [Batch 6/11]: Loss: 0.5300
  Epoch 14 [Batch 7/11]: Loss: 0.2015
  Epoch 14 [Batch 8/11]: Loss: 0.0923
  Epoch 14 [Batch 9/11]: Loss: 0.1716
  Epoch 14 [Batch 10/11]: Loss: 0.5561
  Epoch 14 Train Summary: Avg Loss: 0.2103, Accuracy: 0.9218
  Validation Summary: Avg Loss: 3.6403, Accuracy: 0.4333, F1 (Macro): 0.4091
  New best model! Val loss improved from 3.6419 to 3.6403. Saving...
Training finished in 1.02 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 3.6403, Accuracy: 0.4333, F1 (Macro): 0.4091
Final Best Model Stats: Acc: 0.4333, F1: 0.4091, Loss: 3.6403
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=384x384 lr=5e-05 drop=0.0 seed=123
================================================================================
Starting experiment: efficientnet_b0__384x384__lr-5e-05__drop-0.0__seed-123
Output directory: results_ceph/efficientnet_b0__384x384__lr-5e-05__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 2.6430
  Epoch 0 [Batch 1/11]: Loss: 2.7172
  Epoch 0 [Batch 2/11]: Loss: 3.1133
  Epoch 0 [Batch 3/11]: Loss: 3.2885
  Epoch 0 [Batch 4/11]: Loss: 1.3768
  Epoch 0 [Batch 5/11]: Loss: 2.3577
  Epoch 0 [Batch 6/11]: Loss: 2.5733
  Epoch 0 [Batch 7/11]: Loss: 0.6337
  Epoch 0 [Batch 8/11]: Loss: 2.1770
  Epoch 0 [Batch 9/11]: Loss: 3.9066
  Epoch 0 [Batch 10/11]: Loss: 0.2083
  Epoch 0 Train Summary: Avg Loss: 2.2723, Accuracy: 0.3169
  Validation Summary: Avg Loss: 4.7741, Accuracy: 0.0000, F1 (Macro): 0.0000
  New best model! Val loss improved from inf to 4.7741. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.5833
  Epoch 1 [Batch 1/11]: Loss: 1.7835
  Epoch 1 [Batch 2/11]: Loss: 2.0756
  Epoch 1 [Batch 3/11]: Loss: 1.6768
  Epoch 1 [Batch 4/11]: Loss: 0.8331
  Epoch 1 [Batch 5/11]: Loss: 0.6358
  Epoch 1 [Batch 6/11]: Loss: 1.5572
  Epoch 1 [Batch 7/11]: Loss: 0.7421
  Epoch 1 [Batch 8/11]: Loss: 0.4986
  Epoch 1 [Batch 9/11]: Loss: 1.6300
  Epoch 1 [Batch 10/11]: Loss: 0.3992
  Epoch 1 Train Summary: Avg Loss: 1.2196, Accuracy: 0.4934
  Validation Summary: Avg Loss: 3.9634, Accuracy: 0.5333, F1 (Macro): 0.3175
  New best model! Val loss improved from 4.7741 to 3.9634. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 0.8130
  Epoch 2 [Batch 1/11]: Loss: 1.1003
  Epoch 2 [Batch 2/11]: Loss: 0.4697
  Epoch 2 [Batch 3/11]: Loss: 0.5317
  Epoch 2 [Batch 4/11]: Loss: 1.2861
  Epoch 2 [Batch 5/11]: Loss: 1.0145
  Epoch 2 [Batch 6/11]: Loss: 1.1460
  Epoch 2 [Batch 7/11]: Loss: 0.2548
  Epoch 2 [Batch 8/11]: Loss: 0.7732
  Epoch 2 [Batch 9/11]: Loss: 1.1178
  Epoch 2 [Batch 10/11]: Loss: 2.5150
  Epoch 2 Train Summary: Avg Loss: 1.0020, Accuracy: 0.6711
  Validation Summary: Avg Loss: 4.3079, Accuracy: 0.5333, F1 (Macro): 0.3175

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 0.6168
  Epoch 3 [Batch 1/11]: Loss: 0.3759
  Epoch 3 [Batch 2/11]: Loss: 0.4998
  Epoch 3 [Batch 3/11]: Loss: 0.9190
  Epoch 3 [Batch 4/11]: Loss: 0.9338
  Epoch 3 [Batch 5/11]: Loss: 0.6614
  Epoch 3 [Batch 6/11]: Loss: 1.8739
  Epoch 3 [Batch 7/11]: Loss: 0.5848
  Epoch 3 [Batch 8/11]: Loss: 0.7287
  Epoch 3 [Batch 9/11]: Loss: 1.5348
  Epoch 3 [Batch 10/11]: Loss: 1.0774
  Epoch 3 Train Summary: Avg Loss: 0.8915, Accuracy: 0.6341
  Validation Summary: Avg Loss: 4.2812, Accuracy: 0.2667, F1 (Macro): 0.2222

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 1.3966
  Epoch 4 [Batch 1/11]: Loss: 0.5025
  Epoch 4 [Batch 2/11]: Loss: 0.9832
  Epoch 4 [Batch 3/11]: Loss: 0.8171
  Epoch 4 [Batch 4/11]: Loss: 1.3280
  Epoch 4 [Batch 5/11]: Loss: 0.6967
  Epoch 4 [Batch 6/11]: Loss: 0.4844
  Epoch 4 [Batch 7/11]: Loss: 0.8203
  Epoch 4 [Batch 8/11]: Loss: 0.3770
  Epoch 4 [Batch 9/11]: Loss: 0.6012
  Epoch 4 [Batch 10/11]: Loss: 0.0366
  Epoch 4 Train Summary: Avg Loss: 0.7312, Accuracy: 0.6206
  Validation Summary: Avg Loss: 3.3466, Accuracy: 0.4333, F1 (Macro): 0.4646
  New best model! Val loss improved from 3.9634 to 3.3466. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 0.5073
  Epoch 5 [Batch 1/11]: Loss: 0.3412
  Epoch 5 [Batch 2/11]: Loss: 0.3853
  Epoch 5 [Batch 3/11]: Loss: 0.1296
  Epoch 5 [Batch 4/11]: Loss: 0.8505
  Epoch 5 [Batch 5/11]: Loss: 0.7064
  Epoch 5 [Batch 6/11]: Loss: 0.2730
  Epoch 5 [Batch 7/11]: Loss: 0.7014
  Epoch 5 [Batch 8/11]: Loss: 0.5064
  Epoch 5 [Batch 9/11]: Loss: 0.3490
  Epoch 5 [Batch 10/11]: Loss: 0.4891
  Epoch 5 Train Summary: Avg Loss: 0.4763, Accuracy: 0.7695
  Validation Summary: Avg Loss: 2.6822, Accuracy: 0.3667, F1 (Macro): 0.4040
  New best model! Val loss improved from 3.3466 to 2.6822. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 0.1839
  Epoch 6 [Batch 1/11]: Loss: 0.6182
  Epoch 6 [Batch 2/11]: Loss: 0.2942
  Epoch 6 [Batch 3/11]: Loss: 0.9943
  Epoch 6 [Batch 4/11]: Loss: 0.4917
  Epoch 6 [Batch 5/11]: Loss: 0.9436
  Epoch 6 [Batch 6/11]: Loss: 0.6122
  Epoch 6 [Batch 7/11]: Loss: 0.2652
  Epoch 6 [Batch 8/11]: Loss: 0.0580
  Epoch 6 [Batch 9/11]: Loss: 0.7513
  Epoch 6 [Batch 10/11]: Loss: 1.4576
  Epoch 6 Train Summary: Avg Loss: 0.6064, Accuracy: 0.7298
  Validation Summary: Avg Loss: 2.5487, Accuracy: 0.3500, F1 (Macro): 0.3385
  New best model! Val loss improved from 2.6822 to 2.5487. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.7127
  Epoch 7 [Batch 1/11]: Loss: 0.5901
  Epoch 7 [Batch 2/11]: Loss: 0.4479
  Epoch 7 [Batch 3/11]: Loss: 0.4885
  Epoch 7 [Batch 4/11]: Loss: 0.4846
  Epoch 7 [Batch 5/11]: Loss: 0.2188
  Epoch 7 [Batch 6/11]: Loss: 0.4110
  Epoch 7 [Batch 7/11]: Loss: 0.1732
  Epoch 7 [Batch 8/11]: Loss: 0.9791
  Epoch 7 [Batch 9/11]: Loss: 0.1773
  Epoch 7 [Batch 10/11]: Loss: 0.2028
  Epoch 7 Train Summary: Avg Loss: 0.4442, Accuracy: 0.7621
  Validation Summary: Avg Loss: 3.2903, Accuracy: 0.3500, F1 (Macro): 0.3385

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 0.3485
  Epoch 8 [Batch 1/11]: Loss: 0.1449
  Epoch 8 [Batch 2/11]: Loss: 0.3779
  Epoch 8 [Batch 3/11]: Loss: 0.6368
  Epoch 8 [Batch 4/11]: Loss: 0.2858
  Epoch 8 [Batch 5/11]: Loss: 0.3734
  Epoch 8 [Batch 6/11]: Loss: 0.2708
  Epoch 8 [Batch 7/11]: Loss: 0.2986
  Epoch 8 [Batch 8/11]: Loss: 0.2736
  Epoch 8 [Batch 9/11]: Loss: 0.1215
  Epoch 8 [Batch 10/11]: Loss: 0.4372
  Epoch 8 Train Summary: Avg Loss: 0.3245, Accuracy: 0.8787
  Validation Summary: Avg Loss: 2.9395, Accuracy: 0.2667, F1 (Macro): 0.1905

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 0.3700
  Epoch 9 [Batch 1/11]: Loss: 0.5125
  Epoch 9 [Batch 2/11]: Loss: 0.3212
  Epoch 9 [Batch 3/11]: Loss: 0.1720
  Epoch 9 [Batch 4/11]: Loss: 0.4051
  Epoch 9 [Batch 5/11]: Loss: 0.1610
  Epoch 9 [Batch 6/11]: Loss: 0.1625
  Epoch 9 [Batch 7/11]: Loss: 0.1665
  Epoch 9 [Batch 8/11]: Loss: 0.6026
  Epoch 9 [Batch 9/11]: Loss: 0.0596
  Epoch 9 [Batch 10/11]: Loss: 1.0734
  Epoch 9 Train Summary: Avg Loss: 0.3642, Accuracy: 0.8457
  Validation Summary: Avg Loss: 2.1543, Accuracy: 0.2000, F1 (Macro): 0.1667
  New best model! Val loss improved from 2.5487 to 2.1543. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 0.5401
  Epoch 10 [Batch 1/11]: Loss: 0.0601
  Epoch 10 [Batch 2/11]: Loss: 0.3393
  Epoch 10 [Batch 3/11]: Loss: 0.2424
  Epoch 10 [Batch 4/11]: Loss: 0.2661
  Epoch 10 [Batch 5/11]: Loss: 0.3283
  Epoch 10 [Batch 6/11]: Loss: 0.1406
  Epoch 10 [Batch 7/11]: Loss: 0.2698
  Epoch 10 [Batch 8/11]: Loss: 0.6251
  Epoch 10 [Batch 9/11]: Loss: 1.4250
  Epoch 10 [Batch 10/11]: Loss: 1.0555
  Epoch 10 Train Summary: Avg Loss: 0.4811, Accuracy: 0.7042
  Validation Summary: Avg Loss: 2.9537, Accuracy: 0.2667, F1 (Macro): 0.2051

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 0.2711
  Epoch 11 [Batch 1/11]: Loss: 0.1006
  Epoch 11 [Batch 2/11]: Loss: 0.4220
  Epoch 11 [Batch 3/11]: Loss: 0.2125
  Epoch 11 [Batch 4/11]: Loss: 0.1089
  Epoch 11 [Batch 5/11]: Loss: 0.5941
  Epoch 11 [Batch 6/11]: Loss: 0.5387
  Epoch 11 [Batch 7/11]: Loss: 0.1739
  Epoch 11 [Batch 8/11]: Loss: 0.2376
  Epoch 11 [Batch 9/11]: Loss: 0.0663
  Epoch 11 [Batch 10/11]: Loss: 1.0626
  Epoch 11 Train Summary: Avg Loss: 0.3444, Accuracy: 0.8934
  Validation Summary: Avg Loss: 3.8405, Accuracy: 0.2000, F1 (Macro): 0.1667

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.1183
  Epoch 12 [Batch 1/11]: Loss: 0.1582
  Epoch 12 [Batch 2/11]: Loss: 0.4244
  Epoch 12 [Batch 3/11]: Loss: 0.0775
  Epoch 12 [Batch 4/11]: Loss: 0.2755
  Epoch 12 [Batch 5/11]: Loss: 0.3364
  Epoch 12 [Batch 6/11]: Loss: 0.2538
  Epoch 12 [Batch 7/11]: Loss: 0.1472
  Epoch 12 [Batch 8/11]: Loss: 0.1687
  Epoch 12 [Batch 9/11]: Loss: 0.0791
  Epoch 12 [Batch 10/11]: Loss: 2.0822
  Epoch 12 Train Summary: Avg Loss: 0.3746, Accuracy: 0.8969
  Validation Summary: Avg Loss: 3.3521, Accuracy: 0.2000, F1 (Macro): 0.1667

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 0.2363
  Epoch 13 [Batch 1/11]: Loss: 0.0767
  Epoch 13 [Batch 2/11]: Loss: 0.1866
  Epoch 13 [Batch 3/11]: Loss: 0.3145
  Epoch 13 [Batch 4/11]: Loss: 0.2114
  Epoch 13 [Batch 5/11]: Loss: 0.0783
  Epoch 13 [Batch 6/11]: Loss: 0.1679
  Epoch 13 [Batch 7/11]: Loss: 0.3330
  Epoch 13 [Batch 8/11]: Loss: 0.3493
  Epoch 13 [Batch 9/11]: Loss: 0.0329
  Epoch 13 [Batch 10/11]: Loss: 0.7981
  Epoch 13 Train Summary: Avg Loss: 0.2532, Accuracy: 0.8915
  Validation Summary: Avg Loss: 3.1176, Accuracy: 0.2000, F1 (Macro): 0.1667

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.0459
  Epoch 14 [Batch 1/11]: Loss: 0.0700
  Epoch 14 [Batch 2/11]: Loss: 0.3531
  Epoch 14 [Batch 3/11]: Loss: 0.1324
  Epoch 14 [Batch 4/11]: Loss: 0.1642
  Epoch 14 [Batch 5/11]: Loss: 0.1677
  Epoch 14 [Batch 6/11]: Loss: 0.2129
  Epoch 14 [Batch 7/11]: Loss: 0.5896
  Epoch 14 [Batch 8/11]: Loss: 0.0954
  Epoch 14 [Batch 9/11]: Loss: 0.0123
  Epoch 14 [Batch 10/11]: Loss: 1.2200
  Epoch 14 Train Summary: Avg Loss: 0.2785, Accuracy: 0.9192
  Validation Summary: Avg Loss: 3.4743, Accuracy: 0.2000, F1 (Macro): 0.1667
Training finished in 0.97 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 2.1543, Accuracy: 0.2000, F1 (Macro): 0.1667
Final Best Model Stats: Acc: 0.2000, F1: 0.1667, Loss: 2.1543
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=384x384 lr=5e-05 drop=0.0 seed=999
================================================================================
Starting experiment: efficientnet_b0__384x384__lr-5e-05__drop-0.0__seed-999
Output directory: results_ceph/efficientnet_b0__384x384__lr-5e-05__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.7963
  Epoch 0 [Batch 1/11]: Loss: 2.5419
  Epoch 0 [Batch 2/11]: Loss: 3.1656
  Epoch 0 [Batch 3/11]: Loss: 0.6643
  Epoch 0 [Batch 4/11]: Loss: 2.6204
  Epoch 0 [Batch 5/11]: Loss: 1.2590
  Epoch 0 [Batch 6/11]: Loss: 0.9380
  Epoch 0 [Batch 7/11]: Loss: 1.8272
  Epoch 0 [Batch 8/11]: Loss: 3.1600
  Epoch 0 [Batch 9/11]: Loss: 2.0758
  Epoch 0 [Batch 10/11]: Loss: 1.3097
  Epoch 0 Train Summary: Avg Loss: 1.9416, Accuracy: 0.3072
  Validation Summary: Avg Loss: 4.9578, Accuracy: 0.2667, F1 (Macro): 0.1905
  New best model! Val loss improved from inf to 4.9578. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.5270
  Epoch 1 [Batch 1/11]: Loss: 0.9009
  Epoch 1 [Batch 2/11]: Loss: 1.3719
  Epoch 1 [Batch 3/11]: Loss: 1.7730
  Epoch 1 [Batch 4/11]: Loss: 0.5633
  Epoch 1 [Batch 5/11]: Loss: 1.3054
  Epoch 1 [Batch 6/11]: Loss: 1.4832
  Epoch 1 [Batch 7/11]: Loss: 1.3667
  Epoch 1 [Batch 8/11]: Loss: 1.9902
  Epoch 1 [Batch 9/11]: Loss: 1.0967
  Epoch 1 [Batch 10/11]: Loss: 0.3127
  Epoch 1 Train Summary: Avg Loss: 1.2446, Accuracy: 0.5175
  Validation Summary: Avg Loss: 5.1514, Accuracy: 0.3000, F1 (Macro): 0.2815

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 2.6922
  Epoch 2 [Batch 1/11]: Loss: 1.4608
  Epoch 2 [Batch 2/11]: Loss: 0.7518
  Epoch 2 [Batch 3/11]: Loss: 0.2433
  Epoch 2 [Batch 4/11]: Loss: 0.7462
  Epoch 2 [Batch 5/11]: Loss: 0.8530
  Epoch 2 [Batch 6/11]: Loss: 2.0605
  Epoch 2 [Batch 7/11]: Loss: 1.8765
  Epoch 2 [Batch 8/11]: Loss: 0.2502
  Epoch 2 [Batch 9/11]: Loss: 1.3456
  Epoch 2 [Batch 10/11]: Loss: 1.1149
  Epoch 2 Train Summary: Avg Loss: 1.2177, Accuracy: 0.6193
  Validation Summary: Avg Loss: 5.9243, Accuracy: 0.2167, F1 (Macro): 0.2165

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 0.3563
  Epoch 3 [Batch 1/11]: Loss: 0.5075
  Epoch 3 [Batch 2/11]: Loss: 1.2919
  Epoch 3 [Batch 3/11]: Loss: 1.0016
  Epoch 3 [Batch 4/11]: Loss: 0.9555
  Epoch 3 [Batch 5/11]: Loss: 0.2558
  Epoch 3 [Batch 6/11]: Loss: 0.7351
  Epoch 3 [Batch 7/11]: Loss: 1.6831
  Epoch 3 [Batch 8/11]: Loss: 1.4188
  Epoch 3 [Batch 9/11]: Loss: 0.5301
  Epoch 3 [Batch 10/11]: Loss: 0.1474
  Epoch 3 Train Summary: Avg Loss: 0.8075, Accuracy: 0.5863
  Validation Summary: Avg Loss: 6.0026, Accuracy: 0.1500, F1 (Macro): 0.2074

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 0.8379
  Epoch 4 [Batch 1/11]: Loss: 0.9495
  Epoch 4 [Batch 2/11]: Loss: 0.3156
  Epoch 4 [Batch 3/11]: Loss: 1.0876
  Epoch 4 [Batch 4/11]: Loss: 0.3861
  Epoch 4 [Batch 5/11]: Loss: 0.8936
  Epoch 4 [Batch 6/11]: Loss: 0.9431
  Epoch 4 [Batch 7/11]: Loss: 0.5456
  Epoch 4 [Batch 8/11]: Loss: 0.3955
  Epoch 4 [Batch 9/11]: Loss: 0.2114
  Epoch 4 [Batch 10/11]: Loss: 2.2996
  Epoch 4 Train Summary: Avg Loss: 0.8060, Accuracy: 0.6327
  Validation Summary: Avg Loss: 4.9952, Accuracy: 0.2333, F1 (Macro): 0.2738

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 0.7264
  Epoch 5 [Batch 1/11]: Loss: 0.7088
  Epoch 5 [Batch 2/11]: Loss: 0.6590
  Epoch 5 [Batch 3/11]: Loss: 1.5766
  Epoch 5 [Batch 4/11]: Loss: 0.6346
  Epoch 5 [Batch 5/11]: Loss: 0.6269
  Epoch 5 [Batch 6/11]: Loss: 0.3880
  Epoch 5 [Batch 7/11]: Loss: 0.2268
  Epoch 5 [Batch 8/11]: Loss: 0.7545
  Epoch 5 [Batch 9/11]: Loss: 0.5252
  Epoch 5 [Batch 10/11]: Loss: 1.4686
  Epoch 5 Train Summary: Avg Loss: 0.7541, Accuracy: 0.6253
  Validation Summary: Avg Loss: 5.2498, Accuracy: 0.2833, F1 (Macro): 0.3152

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 1.0052
  Epoch 6 [Batch 1/11]: Loss: 0.5372
  Epoch 6 [Batch 2/11]: Loss: 0.4263
  Epoch 6 [Batch 3/11]: Loss: 0.9485
  Epoch 6 [Batch 4/11]: Loss: 0.1345
  Epoch 6 [Batch 5/11]: Loss: 0.4074
  Epoch 6 [Batch 6/11]: Loss: 0.5196
  Epoch 6 [Batch 7/11]: Loss: 0.4355
  Epoch 6 [Batch 8/11]: Loss: 0.8837
  Epoch 6 [Batch 9/11]: Loss: 1.0507
  Epoch 6 [Batch 10/11]: Loss: 1.1196
  Epoch 6 Train Summary: Avg Loss: 0.6789, Accuracy: 0.7702
  Validation Summary: Avg Loss: 4.9048, Accuracy: 0.3667, F1 (Macro): 0.3905
  New best model! Val loss improved from 4.9578 to 4.9048. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 0.4077
  Epoch 7 [Batch 1/11]: Loss: 0.3532
  Epoch 7 [Batch 2/11]: Loss: 0.2572
  Epoch 7 [Batch 3/11]: Loss: 0.6638
  Epoch 7 [Batch 4/11]: Loss: 0.6209
  Epoch 7 [Batch 5/11]: Loss: 0.3335
  Epoch 7 [Batch 6/11]: Loss: 0.4003
  Epoch 7 [Batch 7/11]: Loss: 0.3911
  Epoch 7 [Batch 8/11]: Loss: 0.4250
  Epoch 7 [Batch 9/11]: Loss: 0.2679
  Epoch 7 [Batch 10/11]: Loss: 0.8433
  Epoch 7 Train Summary: Avg Loss: 0.4513, Accuracy: 0.7655
  Validation Summary: Avg Loss: 4.9141, Accuracy: 0.3667, F1 (Macro): 0.3723

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 0.6262
  Epoch 8 [Batch 1/11]: Loss: 0.0885
  Epoch 8 [Batch 2/11]: Loss: 0.5007
  Epoch 8 [Batch 3/11]: Loss: 0.2523
  Epoch 8 [Batch 4/11]: Loss: 0.5589
  Epoch 8 [Batch 5/11]: Loss: 0.0931
  Epoch 8 [Batch 6/11]: Loss: 0.3812
  Epoch 8 [Batch 7/11]: Loss: 0.5671
  Epoch 8 [Batch 8/11]: Loss: 0.0687
  Epoch 8 [Batch 9/11]: Loss: 0.7655
  Epoch 8 [Batch 10/11]: Loss: 0.3916
  Epoch 8 Train Summary: Avg Loss: 0.3904, Accuracy: 0.8154
  Validation Summary: Avg Loss: 4.0956, Accuracy: 0.3667, F1 (Macro): 0.3905
  New best model! Val loss improved from 4.9048 to 4.0956. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 0.1711
  Epoch 9 [Batch 1/11]: Loss: 0.5689
  Epoch 9 [Batch 2/11]: Loss: 0.1224
  Epoch 9 [Batch 3/11]: Loss: 0.3453
  Epoch 9 [Batch 4/11]: Loss: 0.2282
  Epoch 9 [Batch 5/11]: Loss: 0.1792
  Epoch 9 [Batch 6/11]: Loss: 0.4053
  Epoch 9 [Batch 7/11]: Loss: 0.1534
  Epoch 9 [Batch 8/11]: Loss: 0.0818
  Epoch 9 [Batch 9/11]: Loss: 0.3002
  Epoch 9 [Batch 10/11]: Loss: 0.2972
  Epoch 9 Train Summary: Avg Loss: 0.2593, Accuracy: 0.8895
  Validation Summary: Avg Loss: 3.6756, Accuracy: 0.3667, F1 (Macro): 0.3905
  New best model! Val loss improved from 4.0956 to 3.6756. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 0.3974
  Epoch 10 [Batch 1/11]: Loss: 0.2139
  Epoch 10 [Batch 2/11]: Loss: 0.1920
  Epoch 10 [Batch 3/11]: Loss: 0.2360
  Epoch 10 [Batch 4/11]: Loss: 0.4546
  Epoch 10 [Batch 5/11]: Loss: 0.0898
  Epoch 10 [Batch 6/11]: Loss: 0.6383
  Epoch 10 [Batch 7/11]: Loss: 0.1826
  Epoch 10 [Batch 8/11]: Loss: 0.3229
  Epoch 10 [Batch 9/11]: Loss: 0.3787
  Epoch 10 [Batch 10/11]: Loss: 0.0594
  Epoch 10 Train Summary: Avg Loss: 0.2878, Accuracy: 0.8309
  Validation Summary: Avg Loss: 4.2157, Accuracy: 0.3500, F1 (Macro): 0.3162

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 0.1718
  Epoch 11 [Batch 1/11]: Loss: 0.3331
  Epoch 11 [Batch 2/11]: Loss: 0.1206
  Epoch 11 [Batch 3/11]: Loss: 0.1581
  Epoch 11 [Batch 4/11]: Loss: 0.6181
  Epoch 11 [Batch 5/11]: Loss: 0.6242
  Epoch 11 [Batch 6/11]: Loss: 0.1904
  Epoch 11 [Batch 7/11]: Loss: 0.1182
  Epoch 11 [Batch 8/11]: Loss: 0.2849
  Epoch 11 [Batch 9/11]: Loss: 0.0852
  Epoch 11 [Batch 10/11]: Loss: 0.2004
  Epoch 11 Train Summary: Avg Loss: 0.2641, Accuracy: 0.9016
  Validation Summary: Avg Loss: 4.2085, Accuracy: 0.3500, F1 (Macro): 0.3333

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.1948
  Epoch 12 [Batch 1/11]: Loss: 0.2511
  Epoch 12 [Batch 2/11]: Loss: 0.3059
  Epoch 12 [Batch 3/11]: Loss: 0.0451
  Epoch 12 [Batch 4/11]: Loss: 0.2095
  Epoch 12 [Batch 5/11]: Loss: 0.1877
  Epoch 12 [Batch 6/11]: Loss: 0.2738
  Epoch 12 [Batch 7/11]: Loss: 0.0332
  Epoch 12 [Batch 8/11]: Loss: 0.3873
  Epoch 12 [Batch 9/11]: Loss: 0.3624
  Epoch 12 [Batch 10/11]: Loss: 0.2001
  Epoch 12 Train Summary: Avg Loss: 0.2228, Accuracy: 0.9016
  Validation Summary: Avg Loss: 4.0749, Accuracy: 0.3667, F1 (Macro): 0.3905

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 0.1578
  Epoch 13 [Batch 1/11]: Loss: 0.2350
  Epoch 13 [Batch 2/11]: Loss: 0.1587
  Epoch 13 [Batch 3/11]: Loss: 0.2450
  Epoch 13 [Batch 4/11]: Loss: 0.0560
  Epoch 13 [Batch 5/11]: Loss: 0.2159
  Epoch 13 [Batch 6/11]: Loss: 0.2415
  Epoch 13 [Batch 7/11]: Loss: 0.1281
  Epoch 13 [Batch 8/11]: Loss: 0.3951
  Epoch 13 [Batch 9/11]: Loss: 0.0444
  Epoch 13 [Batch 10/11]: Loss: 1.1195
  Epoch 13 Train Summary: Avg Loss: 0.2725, Accuracy: 0.8740
  Validation Summary: Avg Loss: 4.2500, Accuracy: 0.4333, F1 (Macro): 0.4127

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.4464
  Epoch 14 [Batch 1/11]: Loss: 0.1265
  Epoch 14 [Batch 2/11]: Loss: 0.7542
  Epoch 14 [Batch 3/11]: Loss: 0.3195
  Epoch 14 [Batch 4/11]: Loss: 0.0552
  Epoch 14 [Batch 5/11]: Loss: 0.2579
  Epoch 14 [Batch 6/11]: Loss: 0.8036
  Epoch 14 [Batch 7/11]: Loss: 0.1124
  Epoch 14 [Batch 8/11]: Loss: 0.1751
  Epoch 14 [Batch 9/11]: Loss: 0.1783
  Epoch 14 [Batch 10/11]: Loss: 0.4248
  Epoch 14 Train Summary: Avg Loss: 0.3322, Accuracy: 0.8786
  Validation Summary: Avg Loss: 4.2880, Accuracy: 0.2833, F1 (Macro): 0.2929
Training finished in 0.96 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 3.6756, Accuracy: 0.3667, F1 (Macro): 0.3905
Final Best Model Stats: Acc: 0.3667, F1: 0.3905, Loss: 3.6756
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=384x384 lr=1e-05 drop=0.0 seed=42
================================================================================
Starting experiment: efficientnet_b0__384x384__lr-1e-05__drop-0.0__seed-42
Output directory: results_ceph/efficientnet_b0__384x384__lr-1e-05__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.7930
  Epoch 0 [Batch 1/11]: Loss: 1.7981
  Epoch 0 [Batch 2/11]: Loss: 1.2632
  Epoch 0 [Batch 3/11]: Loss: 1.7427
  Epoch 0 [Batch 4/11]: Loss: 2.4030
  Epoch 0 [Batch 5/11]: Loss: 2.1201
  Epoch 0 [Batch 6/11]: Loss: 2.7354
  Epoch 0 [Batch 7/11]: Loss: 3.5163
  Epoch 0 [Batch 8/11]: Loss: 1.8899
  Epoch 0 [Batch 9/11]: Loss: 1.2606
  Epoch 0 [Batch 10/11]: Loss: 1.1061
  Epoch 0 Train Summary: Avg Loss: 1.9662, Accuracy: 0.4179
  Validation Summary: Avg Loss: 5.2609, Accuracy: 0.3167, F1 (Macro): 0.2619
  New best model! Val loss improved from inf to 5.2609. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 0.4220
  Epoch 1 [Batch 1/11]: Loss: 1.9011
  Epoch 1 [Batch 2/11]: Loss: 1.9546
  Epoch 1 [Batch 3/11]: Loss: 2.0349
  Epoch 1 [Batch 4/11]: Loss: 1.7260
  Epoch 1 [Batch 5/11]: Loss: 1.8919
  Epoch 1 [Batch 6/11]: Loss: 2.0365
  Epoch 1 [Batch 7/11]: Loss: 1.6542
  Epoch 1 [Batch 8/11]: Loss: 1.3757
  Epoch 1 [Batch 9/11]: Loss: 2.2233
  Epoch 1 [Batch 10/11]: Loss: 1.9136
  Epoch 1 Train Summary: Avg Loss: 1.7394, Accuracy: 0.4422
  Validation Summary: Avg Loss: 5.5185, Accuracy: 0.2500, F1 (Macro): 0.1538

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 2.0092
  Epoch 2 [Batch 1/11]: Loss: 2.2660
  Epoch 2 [Batch 2/11]: Loss: 1.3561
  Epoch 2 [Batch 3/11]: Loss: 0.7964
  Epoch 2 [Batch 4/11]: Loss: 0.8380
  Epoch 2 [Batch 5/11]: Loss: 2.4351
  Epoch 2 [Batch 6/11]: Loss: 1.9778
  Epoch 2 [Batch 7/11]: Loss: 1.7387
  Epoch 2 [Batch 8/11]: Loss: 2.0912
  Epoch 2 [Batch 9/11]: Loss: 0.8931
  Epoch 2 [Batch 10/11]: Loss: 0.3753
  Epoch 2 Train Summary: Avg Loss: 1.5252, Accuracy: 0.4469
  Validation Summary: Avg Loss: 5.3379, Accuracy: 0.2500, F1 (Macro): 0.1538

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 2.0170
  Epoch 3 [Batch 1/11]: Loss: 2.4144
  Epoch 3 [Batch 2/11]: Loss: 1.1354
  Epoch 3 [Batch 3/11]: Loss: 1.1554
  Epoch 3 [Batch 4/11]: Loss: 1.2426
  Epoch 3 [Batch 5/11]: Loss: 1.2472
  Epoch 3 [Batch 6/11]: Loss: 1.0421
  Epoch 3 [Batch 7/11]: Loss: 1.5534
  Epoch 3 [Batch 8/11]: Loss: 1.4176
  Epoch 3 [Batch 9/11]: Loss: 1.5383
  Epoch 3 [Batch 10/11]: Loss: 2.7924
  Epoch 3 Train Summary: Avg Loss: 1.5960, Accuracy: 0.3761
  Validation Summary: Avg Loss: 4.6567, Accuracy: 0.1667, F1 (Macro): 0.1111
  New best model! Val loss improved from 5.2609 to 4.6567. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 1.4377
  Epoch 4 [Batch 1/11]: Loss: 1.9400
  Epoch 4 [Batch 2/11]: Loss: 0.3906
  Epoch 4 [Batch 3/11]: Loss: 1.5022
  Epoch 4 [Batch 4/11]: Loss: 0.8419
  Epoch 4 [Batch 5/11]: Loss: 1.4028
  Epoch 4 [Batch 6/11]: Loss: 0.9190
  Epoch 4 [Batch 7/11]: Loss: 1.4106
  Epoch 4 [Batch 8/11]: Loss: 1.0275
  Epoch 4 [Batch 9/11]: Loss: 0.9400
  Epoch 4 [Batch 10/11]: Loss: 1.8200
  Epoch 4 Train Summary: Avg Loss: 1.2393, Accuracy: 0.5426
  Validation Summary: Avg Loss: 4.8597, Accuracy: 0.2333, F1 (Macro): 0.2074

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 1.9514
  Epoch 5 [Batch 1/11]: Loss: 1.1521
  Epoch 5 [Batch 2/11]: Loss: 1.3594
  Epoch 5 [Batch 3/11]: Loss: 0.8634
  Epoch 5 [Batch 4/11]: Loss: 1.0439
  Epoch 5 [Batch 5/11]: Loss: 1.7245
  Epoch 5 [Batch 6/11]: Loss: 1.6627
  Epoch 5 [Batch 7/11]: Loss: 0.6812
  Epoch 5 [Batch 8/11]: Loss: 1.9404
  Epoch 5 [Batch 9/11]: Loss: 0.7019
  Epoch 5 [Batch 10/11]: Loss: 0.7529
  Epoch 5 Train Summary: Avg Loss: 1.2576, Accuracy: 0.4334
  Validation Summary: Avg Loss: 4.2608, Accuracy: 0.2333, F1 (Macro): 0.2074
  New best model! Val loss improved from 4.6567 to 4.2608. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 1.4637
  Epoch 6 [Batch 1/11]: Loss: 1.4204
  Epoch 6 [Batch 2/11]: Loss: 0.8908
  Epoch 6 [Batch 3/11]: Loss: 0.7292
  Epoch 6 [Batch 4/11]: Loss: 1.0135
  Epoch 6 [Batch 5/11]: Loss: 1.1923
  Epoch 6 [Batch 6/11]: Loss: 1.1966
  Epoch 6 [Batch 7/11]: Loss: 0.5024
  Epoch 6 [Batch 8/11]: Loss: 1.1667
  Epoch 6 [Batch 9/11]: Loss: 1.3174
  Epoch 6 [Batch 10/11]: Loss: 2.0998
  Epoch 6 Train Summary: Avg Loss: 1.1812, Accuracy: 0.5634
  Validation Summary: Avg Loss: 3.6697, Accuracy: 0.3000, F1 (Macro): 0.2963
  New best model! Val loss improved from 4.2608 to 3.6697. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 1.0612
  Epoch 7 [Batch 1/11]: Loss: 1.2950
  Epoch 7 [Batch 2/11]: Loss: 1.2034
  Epoch 7 [Batch 3/11]: Loss: 0.8623
  Epoch 7 [Batch 4/11]: Loss: 1.1073
  Epoch 7 [Batch 5/11]: Loss: 0.6734
  Epoch 7 [Batch 6/11]: Loss: 0.5712
  Epoch 7 [Batch 7/11]: Loss: 0.5056
  Epoch 7 [Batch 8/11]: Loss: 1.0840
  Epoch 7 [Batch 9/11]: Loss: 0.8851
  Epoch 7 [Batch 10/11]: Loss: 1.4357
  Epoch 7 Train Summary: Avg Loss: 0.9713, Accuracy: 0.4914
  Validation Summary: Avg Loss: 3.8402, Accuracy: 0.2833, F1 (Macro): 0.2952

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 0.6675
  Epoch 8 [Batch 1/11]: Loss: 0.5936
  Epoch 8 [Batch 2/11]: Loss: 0.5663
  Epoch 8 [Batch 3/11]: Loss: 1.4931
  Epoch 8 [Batch 4/11]: Loss: 0.8919
  Epoch 8 [Batch 5/11]: Loss: 1.4591
  Epoch 8 [Batch 6/11]: Loss: 0.6991
  Epoch 8 [Batch 7/11]: Loss: 1.0539
  Epoch 8 [Batch 8/11]: Loss: 1.2510
  Epoch 8 [Batch 9/11]: Loss: 0.3962
  Epoch 8 [Batch 10/11]: Loss: 0.4100
  Epoch 8 Train Summary: Avg Loss: 0.8620, Accuracy: 0.5311
  Validation Summary: Avg Loss: 3.5809, Accuracy: 0.1500, F1 (Macro): 0.1574
  New best model! Val loss improved from 3.6697 to 3.5809. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 0.7011
  Epoch 9 [Batch 1/11]: Loss: 1.6571
  Epoch 9 [Batch 2/11]: Loss: 0.9604
  Epoch 9 [Batch 3/11]: Loss: 0.9497
  Epoch 9 [Batch 4/11]: Loss: 1.3561
  Epoch 9 [Batch 5/11]: Loss: 0.6221
  Epoch 9 [Batch 6/11]: Loss: 0.7871
  Epoch 9 [Batch 7/11]: Loss: 0.8324
  Epoch 9 [Batch 8/11]: Loss: 0.5956
  Epoch 9 [Batch 9/11]: Loss: 0.9116
  Epoch 9 [Batch 10/11]: Loss: 2.6284
  Epoch 9 Train Summary: Avg Loss: 1.0911, Accuracy: 0.5183
  Validation Summary: Avg Loss: 3.8439, Accuracy: 0.3500, F1 (Macro): 0.3535

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 0.5490
  Epoch 10 [Batch 1/11]: Loss: 2.2106
  Epoch 10 [Batch 2/11]: Loss: 1.1568
  Epoch 10 [Batch 3/11]: Loss: 0.5824
  Epoch 10 [Batch 4/11]: Loss: 0.6562
  Epoch 10 [Batch 5/11]: Loss: 0.2032
  Epoch 10 [Batch 6/11]: Loss: 0.6340
  Epoch 10 [Batch 7/11]: Loss: 0.7793
  Epoch 10 [Batch 8/11]: Loss: 0.5910
  Epoch 10 [Batch 9/11]: Loss: 0.4325
  Epoch 10 [Batch 10/11]: Loss: 0.9310
  Epoch 10 Train Summary: Avg Loss: 0.7933, Accuracy: 0.6166
  Validation Summary: Avg Loss: 3.8453, Accuracy: 0.2167, F1 (Macro): 0.2315

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 0.2470
  Epoch 11 [Batch 1/11]: Loss: 0.9342
  Epoch 11 [Batch 2/11]: Loss: 0.6786
  Epoch 11 [Batch 3/11]: Loss: 0.7916
  Epoch 11 [Batch 4/11]: Loss: 1.3424
  Epoch 11 [Batch 5/11]: Loss: 0.8362
  Epoch 11 [Batch 6/11]: Loss: 0.2975
  Epoch 11 [Batch 7/11]: Loss: 0.7016
  Epoch 11 [Batch 8/11]: Loss: 0.6885
  Epoch 11 [Batch 9/11]: Loss: 0.9385
  Epoch 11 [Batch 10/11]: Loss: 0.1341
  Epoch 11 Train Summary: Avg Loss: 0.6900, Accuracy: 0.6463
  Validation Summary: Avg Loss: 4.0534, Accuracy: 0.1500, F1 (Macro): 0.1574

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.8254
  Epoch 12 [Batch 1/11]: Loss: 0.5409
  Epoch 12 [Batch 2/11]: Loss: 0.8157
  Epoch 12 [Batch 3/11]: Loss: 1.0782
  Epoch 12 [Batch 4/11]: Loss: 0.8932
  Epoch 12 [Batch 5/11]: Loss: 0.8063
  Epoch 12 [Batch 6/11]: Loss: 0.6822
  Epoch 12 [Batch 7/11]: Loss: 1.0388
  Epoch 12 [Batch 8/11]: Loss: 0.8443
  Epoch 12 [Batch 9/11]: Loss: 0.6383
  Epoch 12 [Batch 10/11]: Loss: 0.9330
  Epoch 12 Train Summary: Avg Loss: 0.8269, Accuracy: 0.5782
  Validation Summary: Avg Loss: 4.2466, Accuracy: 0.2833, F1 (Macro): 0.2771

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 0.5091
  Epoch 13 [Batch 1/11]: Loss: 0.4962
  Epoch 13 [Batch 2/11]: Loss: 1.1912
  Epoch 13 [Batch 3/11]: Loss: 0.6697
  Epoch 13 [Batch 4/11]: Loss: 0.2934
  Epoch 13 [Batch 5/11]: Loss: 0.8187
  Epoch 13 [Batch 6/11]: Loss: 0.2653
  Epoch 13 [Batch 7/11]: Loss: 0.7474
  Epoch 13 [Batch 8/11]: Loss: 0.9221
  Epoch 13 [Batch 9/11]: Loss: 1.1914
  Epoch 13 [Batch 10/11]: Loss: 0.9717
  Epoch 13 Train Summary: Avg Loss: 0.7342, Accuracy: 0.6315
  Validation Summary: Avg Loss: 4.0149, Accuracy: 0.2833, F1 (Macro): 0.2771

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 1.2306
  Epoch 14 [Batch 1/11]: Loss: 0.2703
  Epoch 14 [Batch 2/11]: Loss: 0.1901
  Epoch 14 [Batch 3/11]: Loss: 0.6441
  Epoch 14 [Batch 4/11]: Loss: 0.2457
  Epoch 14 [Batch 5/11]: Loss: 0.3401
  Epoch 14 [Batch 6/11]: Loss: 0.7045
  Epoch 14 [Batch 7/11]: Loss: 0.5652
  Epoch 14 [Batch 8/11]: Loss: 0.4764
  Epoch 14 [Batch 9/11]: Loss: 0.8515
  Epoch 14 [Batch 10/11]: Loss: 1.2517
  Epoch 14 Train Summary: Avg Loss: 0.6155, Accuracy: 0.6490
  Validation Summary: Avg Loss: 3.5093, Accuracy: 0.2167, F1 (Macro): 0.2315
  New best model! Val loss improved from 3.5809 to 3.5093. Saving...
Training finished in 0.99 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 3.5093, Accuracy: 0.2167, F1 (Macro): 0.2315
Final Best Model Stats: Acc: 0.2167, F1: 0.2315, Loss: 3.5093
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=384x384 lr=1e-05 drop=0.0 seed=123
================================================================================
Starting experiment: efficientnet_b0__384x384__lr-1e-05__drop-0.0__seed-123
Output directory: results_ceph/efficientnet_b0__384x384__lr-1e-05__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 2.6430
  Epoch 0 [Batch 1/11]: Loss: 2.7846
  Epoch 0 [Batch 2/11]: Loss: 3.3111
  Epoch 0 [Batch 3/11]: Loss: 3.7268
  Epoch 0 [Batch 4/11]: Loss: 1.5229
  Epoch 0 [Batch 5/11]: Loss: 2.8730
  Epoch 0 [Batch 6/11]: Loss: 2.6668
  Epoch 0 [Batch 7/11]: Loss: 0.8105
  Epoch 0 [Batch 8/11]: Loss: 2.6937
  Epoch 0 [Batch 9/11]: Loss: 4.3321
  Epoch 0 [Batch 10/11]: Loss: 0.4056
  Epoch 0 Train Summary: Avg Loss: 2.5245, Accuracy: 0.3312
  Validation Summary: Avg Loss: 3.8817, Accuracy: 0.0833, F1 (Macro): 0.1111
  New best model! Val loss improved from inf to 3.8817. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 2.1864
  Epoch 1 [Batch 1/11]: Loss: 1.5717
  Epoch 1 [Batch 2/11]: Loss: 3.3688
  Epoch 1 [Batch 3/11]: Loss: 3.0608
  Epoch 1 [Batch 4/11]: Loss: 0.8788
  Epoch 1 [Batch 5/11]: Loss: 1.5784
  Epoch 1 [Batch 6/11]: Loss: 2.3092
  Epoch 1 [Batch 7/11]: Loss: 1.2407
  Epoch 1 [Batch 8/11]: Loss: 1.2451
  Epoch 1 [Batch 9/11]: Loss: 2.3710
  Epoch 1 [Batch 10/11]: Loss: 1.1274
  Epoch 1 Train Summary: Avg Loss: 1.9035, Accuracy: 0.3453
  Validation Summary: Avg Loss: 3.5594, Accuracy: 0.4000, F1 (Macro): 0.1786
  New best model! Val loss improved from 3.8817 to 3.5594. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 1.9419
  Epoch 2 [Batch 1/11]: Loss: 1.3040
  Epoch 2 [Batch 2/11]: Loss: 1.9647
  Epoch 2 [Batch 3/11]: Loss: 0.8040
  Epoch 2 [Batch 4/11]: Loss: 2.5471
  Epoch 2 [Batch 5/11]: Loss: 2.1961
  Epoch 2 [Batch 6/11]: Loss: 2.8436
  Epoch 2 [Batch 7/11]: Loss: 1.5981
  Epoch 2 [Batch 8/11]: Loss: 1.0554
  Epoch 2 [Batch 9/11]: Loss: 2.1065
  Epoch 2 [Batch 10/11]: Loss: 2.3281
  Epoch 2 Train Summary: Avg Loss: 1.8809, Accuracy: 0.4328
  Validation Summary: Avg Loss: 3.2649, Accuracy: 0.4667, F1 (Macro): 0.2619
  New best model! Val loss improved from 3.5594 to 3.2649. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 0.9729
  Epoch 3 [Batch 1/11]: Loss: 0.4126
  Epoch 3 [Batch 2/11]: Loss: 1.3317
  Epoch 3 [Batch 3/11]: Loss: 2.9218
  Epoch 3 [Batch 4/11]: Loss: 1.2595
  Epoch 3 [Batch 5/11]: Loss: 2.7499
  Epoch 3 [Batch 6/11]: Loss: 1.2773
  Epoch 3 [Batch 7/11]: Loss: 2.2342
  Epoch 3 [Batch 8/11]: Loss: 0.9415
  Epoch 3 [Batch 9/11]: Loss: 2.3359
  Epoch 3 [Batch 10/11]: Loss: 2.4155
  Epoch 3 Train Summary: Avg Loss: 1.7139, Accuracy: 0.4779
  Validation Summary: Avg Loss: 2.8776, Accuracy: 0.2833, F1 (Macro): 0.3556
  New best model! Val loss improved from 3.2649 to 2.8776. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 1.5751
  Epoch 4 [Batch 1/11]: Loss: 1.5112
  Epoch 4 [Batch 2/11]: Loss: 1.5972
  Epoch 4 [Batch 3/11]: Loss: 1.0392
  Epoch 4 [Batch 4/11]: Loss: 1.0443
  Epoch 4 [Batch 5/11]: Loss: 1.7676
  Epoch 4 [Batch 6/11]: Loss: 1.9543
  Epoch 4 [Batch 7/11]: Loss: 0.9373
  Epoch 4 [Batch 8/11]: Loss: 1.0546
  Epoch 4 [Batch 9/11]: Loss: 2.5342
  Epoch 4 [Batch 10/11]: Loss: 0.0655
  Epoch 4 Train Summary: Avg Loss: 1.3709, Accuracy: 0.5021
  Validation Summary: Avg Loss: 2.8210, Accuracy: 0.3667, F1 (Macro): 0.3905
  New best model! Val loss improved from 2.8776 to 2.8210. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 0.3684
  Epoch 5 [Batch 1/11]: Loss: 1.5342
  Epoch 5 [Batch 2/11]: Loss: 1.0553
  Epoch 5 [Batch 3/11]: Loss: 1.2546
  Epoch 5 [Batch 4/11]: Loss: 2.5177
  Epoch 5 [Batch 5/11]: Loss: 1.3129
  Epoch 5 [Batch 6/11]: Loss: 0.2716
  Epoch 5 [Batch 7/11]: Loss: 1.2340
  Epoch 5 [Batch 8/11]: Loss: 1.8670
  Epoch 5 [Batch 9/11]: Loss: 1.2733
  Epoch 5 [Batch 10/11]: Loss: 1.3434
  Epoch 5 Train Summary: Avg Loss: 1.2757, Accuracy: 0.4726
  Validation Summary: Avg Loss: 2.9387, Accuracy: 0.2000, F1 (Macro): 0.1667

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 0.8015
  Epoch 6 [Batch 1/11]: Loss: 2.0947
  Epoch 6 [Batch 2/11]: Loss: 1.0153
  Epoch 6 [Batch 3/11]: Loss: 1.8353
  Epoch 6 [Batch 4/11]: Loss: 2.5715
  Epoch 6 [Batch 5/11]: Loss: 1.8353
  Epoch 6 [Batch 6/11]: Loss: 2.2753
  Epoch 6 [Batch 7/11]: Loss: 0.9901
  Epoch 6 [Batch 8/11]: Loss: 0.1957
  Epoch 6 [Batch 9/11]: Loss: 1.2802
  Epoch 6 [Batch 10/11]: Loss: 1.7688
  Epoch 6 Train Summary: Avg Loss: 1.5149, Accuracy: 0.5041
  Validation Summary: Avg Loss: 2.6432, Accuracy: 0.2833, F1 (Macro): 0.3000
  New best model! Val loss improved from 2.8210 to 2.6432. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 1.7436
  Epoch 7 [Batch 1/11]: Loss: 0.9696
  Epoch 7 [Batch 2/11]: Loss: 1.0981
  Epoch 7 [Batch 3/11]: Loss: 1.3479
  Epoch 7 [Batch 4/11]: Loss: 1.0296
  Epoch 7 [Batch 5/11]: Loss: 0.6211
  Epoch 7 [Batch 6/11]: Loss: 1.5256
  Epoch 7 [Batch 7/11]: Loss: 1.6769
  Epoch 7 [Batch 8/11]: Loss: 2.2356
  Epoch 7 [Batch 9/11]: Loss: 1.1772
  Epoch 7 [Batch 10/11]: Loss: 0.7501
  Epoch 7 Train Summary: Avg Loss: 1.2887, Accuracy: 0.4536
  Validation Summary: Avg Loss: 2.8371, Accuracy: 0.3500, F1 (Macro): 0.3385

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 1.6020
  Epoch 8 [Batch 1/11]: Loss: 0.8649
  Epoch 8 [Batch 2/11]: Loss: 1.5133
  Epoch 8 [Batch 3/11]: Loss: 1.0554
  Epoch 8 [Batch 4/11]: Loss: 1.2749
  Epoch 8 [Batch 5/11]: Loss: 0.9862
  Epoch 8 [Batch 6/11]: Loss: 1.5006
  Epoch 8 [Batch 7/11]: Loss: 1.3257
  Epoch 8 [Batch 8/11]: Loss: 1.3679
  Epoch 8 [Batch 9/11]: Loss: 0.6154
  Epoch 8 [Batch 10/11]: Loss: 1.2038
  Epoch 8 Train Summary: Avg Loss: 1.2100, Accuracy: 0.5291
  Validation Summary: Avg Loss: 2.6369, Accuracy: 0.2833, F1 (Macro): 0.3000
  New best model! Val loss improved from 2.6432 to 2.6369. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 1.2949
  Epoch 9 [Batch 1/11]: Loss: 1.2958
  Epoch 9 [Batch 2/11]: Loss: 1.4248
  Epoch 9 [Batch 3/11]: Loss: 0.9325
  Epoch 9 [Batch 4/11]: Loss: 0.9559
  Epoch 9 [Batch 5/11]: Loss: 0.7388
  Epoch 9 [Batch 6/11]: Loss: 0.5102
  Epoch 9 [Batch 7/11]: Loss: 0.5348
  Epoch 9 [Batch 8/11]: Loss: 1.3633
  Epoch 9 [Batch 9/11]: Loss: 0.4926
  Epoch 9 [Batch 10/11]: Loss: 2.1903
  Epoch 9 Train Summary: Avg Loss: 1.0667, Accuracy: 0.5560
  Validation Summary: Avg Loss: 2.3831, Accuracy: 0.2833, F1 (Macro): 0.3000
  New best model! Val loss improved from 2.6369 to 2.3831. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 1.2608
  Epoch 10 [Batch 1/11]: Loss: 0.7295
  Epoch 10 [Batch 2/11]: Loss: 1.3604
  Epoch 10 [Batch 3/11]: Loss: 1.0793
  Epoch 10 [Batch 4/11]: Loss: 1.2688
  Epoch 10 [Batch 5/11]: Loss: 1.3533
  Epoch 10 [Batch 6/11]: Loss: 0.1478
  Epoch 10 [Batch 7/11]: Loss: 0.8809
  Epoch 10 [Batch 8/11]: Loss: 0.9659
  Epoch 10 [Batch 9/11]: Loss: 1.9062
  Epoch 10 [Batch 10/11]: Loss: 1.7274
  Epoch 10 Train Summary: Avg Loss: 1.1528, Accuracy: 0.5190
  Validation Summary: Avg Loss: 3.0245, Accuracy: 0.2000, F1 (Macro): 0.1538

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 0.4554
  Epoch 11 [Batch 1/11]: Loss: 0.7679
  Epoch 11 [Batch 2/11]: Loss: 1.2178
  Epoch 11 [Batch 3/11]: Loss: 0.9084
  Epoch 11 [Batch 4/11]: Loss: 0.8487
  Epoch 11 [Batch 5/11]: Loss: 0.6501
  Epoch 11 [Batch 6/11]: Loss: 0.8409
  Epoch 11 [Batch 7/11]: Loss: 0.9438
  Epoch 11 [Batch 8/11]: Loss: 0.5582
  Epoch 11 [Batch 9/11]: Loss: 0.9714
  Epoch 11 [Batch 10/11]: Loss: 0.7823
  Epoch 11 Train Summary: Avg Loss: 0.8132, Accuracy: 0.6496
  Validation Summary: Avg Loss: 3.6974, Accuracy: 0.2667, F1 (Macro): 0.1905

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 0.6104
  Epoch 12 [Batch 1/11]: Loss: 1.0145
  Epoch 12 [Batch 2/11]: Loss: 1.1801
  Epoch 12 [Batch 3/11]: Loss: 1.0988
  Epoch 12 [Batch 4/11]: Loss: 0.7633
  Epoch 12 [Batch 5/11]: Loss: 1.1813
  Epoch 12 [Batch 6/11]: Loss: 0.4834
  Epoch 12 [Batch 7/11]: Loss: 0.7961
  Epoch 12 [Batch 8/11]: Loss: 1.4910
  Epoch 12 [Batch 9/11]: Loss: 0.1376
  Epoch 12 [Batch 10/11]: Loss: 4.0595
  Epoch 12 Train Summary: Avg Loss: 1.1651, Accuracy: 0.6139
  Validation Summary: Avg Loss: 2.9525, Accuracy: 0.2667, F1 (Macro): 0.1905

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 1.0756
  Epoch 13 [Batch 1/11]: Loss: 0.5869
  Epoch 13 [Batch 2/11]: Loss: 1.0806
  Epoch 13 [Batch 3/11]: Loss: 0.8101
  Epoch 13 [Batch 4/11]: Loss: 1.3685
  Epoch 13 [Batch 5/11]: Loss: 0.8353
  Epoch 13 [Batch 6/11]: Loss: 0.7441
  Epoch 13 [Batch 7/11]: Loss: 0.9003
  Epoch 13 [Batch 8/11]: Loss: 0.7587
  Epoch 13 [Batch 9/11]: Loss: 0.4989
  Epoch 13 [Batch 10/11]: Loss: 2.3311
  Epoch 13 Train Summary: Avg Loss: 0.9991, Accuracy: 0.5155
  Validation Summary: Avg Loss: 3.1862, Accuracy: 0.2667, F1 (Macro): 0.1905

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 0.5704
  Epoch 14 [Batch 1/11]: Loss: 0.7734
  Epoch 14 [Batch 2/11]: Loss: 1.1432
  Epoch 14 [Batch 3/11]: Loss: 0.4881
  Epoch 14 [Batch 4/11]: Loss: 0.7014
  Epoch 14 [Batch 5/11]: Loss: 0.5789
  Epoch 14 [Batch 6/11]: Loss: 0.9544
  Epoch 14 [Batch 7/11]: Loss: 1.0112
  Epoch 14 [Batch 8/11]: Loss: 1.2214
  Epoch 14 [Batch 9/11]: Loss: 0.2137
  Epoch 14 [Batch 10/11]: Loss: 1.7093
  Epoch 14 Train Summary: Avg Loss: 0.8514, Accuracy: 0.6119
  Validation Summary: Avg Loss: 3.0715, Accuracy: 0.2000, F1 (Macro): 0.1667
Training finished in 1.19 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 2.3831, Accuracy: 0.2833, F1 (Macro): 0.3000
Final Best Model Stats: Acc: 0.2833, F1: 0.3000, Loss: 2.3831
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=efficientnet_b0 size=384x384 lr=1e-05 drop=0.0 seed=999
================================================================================
Starting experiment: efficientnet_b0__384x384__lr-1e-05__drop-0.0__seed-999
Output directory: results_ceph/efficientnet_b0__384x384__lr-1e-05__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 82 images from processed_datasets/ceph_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 10 images from processed_datasets/ceph_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: efficientnet_b0 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/11]: Loss: 1.7963
  Epoch 0 [Batch 1/11]: Loss: 2.6755
  Epoch 0 [Batch 2/11]: Loss: 3.3646
  Epoch 0 [Batch 3/11]: Loss: 0.7900
  Epoch 0 [Batch 4/11]: Loss: 2.5756
  Epoch 0 [Batch 5/11]: Loss: 1.5216
  Epoch 0 [Batch 6/11]: Loss: 1.3532
  Epoch 0 [Batch 7/11]: Loss: 1.7212
  Epoch 0 [Batch 8/11]: Loss: 3.1995
  Epoch 0 [Batch 9/11]: Loss: 1.9052
  Epoch 0 [Batch 10/11]: Loss: 1.2260
  Epoch 0 Train Summary: Avg Loss: 2.0117, Accuracy: 0.2310
  Validation Summary: Avg Loss: 4.3708, Accuracy: 0.3333, F1 (Macro): 0.2222
  New best model! Val loss improved from inf to 4.3708. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/11]: Loss: 1.8047
  Epoch 1 [Batch 1/11]: Loss: 1.5343
  Epoch 1 [Batch 2/11]: Loss: 1.8060
  Epoch 1 [Batch 3/11]: Loss: 1.8580
  Epoch 1 [Batch 4/11]: Loss: 1.0099
  Epoch 1 [Batch 5/11]: Loss: 1.8007
  Epoch 1 [Batch 6/11]: Loss: 1.8965
  Epoch 1 [Batch 7/11]: Loss: 1.4841
  Epoch 1 [Batch 8/11]: Loss: 2.3178
  Epoch 1 [Batch 9/11]: Loss: 1.5366
  Epoch 1 [Batch 10/11]: Loss: 2.0208
  Epoch 1 Train Summary: Avg Loss: 1.7336, Accuracy: 0.4110
  Validation Summary: Avg Loss: 4.2316, Accuracy: 0.2833, F1 (Macro): 0.2619
  New best model! Val loss improved from 4.3708 to 4.2316. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/11]: Loss: 3.4250
  Epoch 2 [Batch 1/11]: Loss: 1.4799
  Epoch 2 [Batch 2/11]: Loss: 1.4907
  Epoch 2 [Batch 3/11]: Loss: 0.7005
  Epoch 2 [Batch 4/11]: Loss: 2.1136
  Epoch 2 [Batch 5/11]: Loss: 2.1080
  Epoch 2 [Batch 6/11]: Loss: 1.6847
  Epoch 2 [Batch 7/11]: Loss: 2.4340
  Epoch 2 [Batch 8/11]: Loss: 0.4074
  Epoch 2 [Batch 9/11]: Loss: 2.0743
  Epoch 2 [Batch 10/11]: Loss: 1.4317
  Epoch 2 Train Summary: Avg Loss: 1.7591, Accuracy: 0.3484
  Validation Summary: Avg Loss: 4.6718, Accuracy: 0.2833, F1 (Macro): 0.2619

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/11]: Loss: 0.6350
  Epoch 3 [Batch 1/11]: Loss: 0.6168
  Epoch 3 [Batch 2/11]: Loss: 1.0866
  Epoch 3 [Batch 3/11]: Loss: 1.5038
  Epoch 3 [Batch 4/11]: Loss: 1.7482
  Epoch 3 [Batch 5/11]: Loss: 0.8894
  Epoch 3 [Batch 6/11]: Loss: 1.6202
  Epoch 3 [Batch 7/11]: Loss: 2.3942
  Epoch 3 [Batch 8/11]: Loss: 2.4132
  Epoch 3 [Batch 9/11]: Loss: 0.7571
  Epoch 3 [Batch 10/11]: Loss: 0.2856
  Epoch 3 Train Summary: Avg Loss: 1.2682, Accuracy: 0.3901
  Validation Summary: Avg Loss: 5.0039, Accuracy: 0.2833, F1 (Macro): 0.3152

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/11]: Loss: 1.8117
  Epoch 4 [Batch 1/11]: Loss: 1.5495
  Epoch 4 [Batch 2/11]: Loss: 0.4382
  Epoch 4 [Batch 3/11]: Loss: 1.7712
  Epoch 4 [Batch 4/11]: Loss: 1.3112
  Epoch 4 [Batch 5/11]: Loss: 1.4950
  Epoch 4 [Batch 6/11]: Loss: 1.8063
  Epoch 4 [Batch 7/11]: Loss: 1.0361
  Epoch 4 [Batch 8/11]: Loss: 1.1402
  Epoch 4 [Batch 9/11]: Loss: 1.0713
  Epoch 4 [Batch 10/11]: Loss: 2.2133
  Epoch 4 Train Summary: Avg Loss: 1.4222, Accuracy: 0.4251
  Validation Summary: Avg Loss: 4.7279, Accuracy: 0.1500, F1 (Macro): 0.2074

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/11]: Loss: 1.3779
  Epoch 5 [Batch 1/11]: Loss: 1.5236
  Epoch 5 [Batch 2/11]: Loss: 1.7733
  Epoch 5 [Batch 3/11]: Loss: 1.6910
  Epoch 5 [Batch 4/11]: Loss: 1.4459
  Epoch 5 [Batch 5/11]: Loss: 2.0185
  Epoch 5 [Batch 6/11]: Loss: 0.7396
  Epoch 5 [Batch 7/11]: Loss: 0.6142
  Epoch 5 [Batch 8/11]: Loss: 1.4958
  Epoch 5 [Batch 9/11]: Loss: 1.1614
  Epoch 5 [Batch 10/11]: Loss: 2.0652
  Epoch 5 Train Summary: Avg Loss: 1.4460, Accuracy: 0.3706
  Validation Summary: Avg Loss: 4.8848, Accuracy: 0.2833, F1 (Macro): 0.3152

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/11]: Loss: 1.3819
  Epoch 6 [Batch 1/11]: Loss: 1.3491
  Epoch 6 [Batch 2/11]: Loss: 1.1865
  Epoch 6 [Batch 3/11]: Loss: 1.9888
  Epoch 6 [Batch 4/11]: Loss: 0.6799
  Epoch 6 [Batch 5/11]: Loss: 0.6975
  Epoch 6 [Batch 6/11]: Loss: 1.4046
  Epoch 6 [Batch 7/11]: Loss: 0.7777
  Epoch 6 [Batch 8/11]: Loss: 1.7788
  Epoch 6 [Batch 9/11]: Loss: 1.3010
  Epoch 6 [Batch 10/11]: Loss: 1.8798
  Epoch 6 Train Summary: Avg Loss: 1.3114, Accuracy: 0.4413
  Validation Summary: Avg Loss: 4.6297, Accuracy: 0.2833, F1 (Macro): 0.3152

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/11]: Loss: 1.5792
  Epoch 7 [Batch 1/11]: Loss: 0.8449
  Epoch 7 [Batch 2/11]: Loss: 0.9971
  Epoch 7 [Batch 3/11]: Loss: 0.7353
  Epoch 7 [Batch 4/11]: Loss: 1.8035
  Epoch 7 [Batch 5/11]: Loss: 1.0522
  Epoch 7 [Batch 6/11]: Loss: 0.6614
  Epoch 7 [Batch 7/11]: Loss: 1.3058
  Epoch 7 [Batch 8/11]: Loss: 0.7805
  Epoch 7 [Batch 9/11]: Loss: 1.1828
  Epoch 7 [Batch 10/11]: Loss: 1.2981
  Epoch 7 Train Summary: Avg Loss: 1.1128, Accuracy: 0.4507
  Validation Summary: Avg Loss: 4.3233, Accuracy: 0.2833, F1 (Macro): 0.3152

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/11]: Loss: 1.7389
  Epoch 8 [Batch 1/11]: Loss: 0.4150
  Epoch 8 [Batch 2/11]: Loss: 0.9439
  Epoch 8 [Batch 3/11]: Loss: 1.2070
  Epoch 8 [Batch 4/11]: Loss: 0.8376
  Epoch 8 [Batch 5/11]: Loss: 0.1226
  Epoch 8 [Batch 6/11]: Loss: 0.6824
  Epoch 8 [Batch 7/11]: Loss: 1.5415
  Epoch 8 [Batch 8/11]: Loss: 0.7978
  Epoch 8 [Batch 9/11]: Loss: 1.7697
  Epoch 8 [Batch 10/11]: Loss: 0.7935
  Epoch 8 Train Summary: Avg Loss: 0.9864, Accuracy: 0.6913
  Validation Summary: Avg Loss: 4.2060, Accuracy: 0.2833, F1 (Macro): 0.3152
  New best model! Val loss improved from 4.2316 to 4.2060. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/11]: Loss: 1.3849
  Epoch 9 [Batch 1/11]: Loss: 1.1542
  Epoch 9 [Batch 2/11]: Loss: 0.5343
  Epoch 9 [Batch 3/11]: Loss: 0.9991
  Epoch 9 [Batch 4/11]: Loss: 0.5327
  Epoch 9 [Batch 5/11]: Loss: 0.5586
  Epoch 9 [Batch 6/11]: Loss: 0.6964
  Epoch 9 [Batch 7/11]: Loss: 1.9340
  Epoch 9 [Batch 8/11]: Loss: 0.5895
  Epoch 9 [Batch 9/11]: Loss: 0.5983
  Epoch 9 [Batch 10/11]: Loss: 1.3087
  Epoch 9 Train Summary: Avg Loss: 0.9355, Accuracy: 0.6112
  Validation Summary: Avg Loss: 4.1680, Accuracy: 0.2833, F1 (Macro): 0.3152
  New best model! Val loss improved from 4.2060 to 4.1680. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/11]: Loss: 1.5779
  Epoch 10 [Batch 1/11]: Loss: 0.8865
  Epoch 10 [Batch 2/11]: Loss: 0.4268
  Epoch 10 [Batch 3/11]: Loss: 0.8953
  Epoch 10 [Batch 4/11]: Loss: 1.7506
  Epoch 10 [Batch 5/11]: Loss: 1.3455
  Epoch 10 [Batch 6/11]: Loss: 1.5115
  Epoch 10 [Batch 7/11]: Loss: 0.8053
  Epoch 10 [Batch 8/11]: Loss: 0.8244
  Epoch 10 [Batch 9/11]: Loss: 0.5980
  Epoch 10 [Batch 10/11]: Loss: 0.7007
  Epoch 10 Train Summary: Avg Loss: 1.0293, Accuracy: 0.5553
  Validation Summary: Avg Loss: 4.4063, Accuracy: 0.2833, F1 (Macro): 0.3152

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/11]: Loss: 1.0520
  Epoch 11 [Batch 1/11]: Loss: 0.9966
  Epoch 11 [Batch 2/11]: Loss: 0.5351
  Epoch 11 [Batch 3/11]: Loss: 0.5392
  Epoch 11 [Batch 4/11]: Loss: 1.4687
  Epoch 11 [Batch 5/11]: Loss: 1.1626
  Epoch 11 [Batch 6/11]: Loss: 0.3099
  Epoch 11 [Batch 7/11]: Loss: 1.1137
  Epoch 11 [Batch 8/11]: Loss: 1.8350
  Epoch 11 [Batch 9/11]: Loss: 0.9252
  Epoch 11 [Batch 10/11]: Loss: 0.3171
  Epoch 11 Train Summary: Avg Loss: 0.9323, Accuracy: 0.5410
  Validation Summary: Avg Loss: 4.3811, Accuracy: 0.2833, F1 (Macro): 0.3152

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/11]: Loss: 2.3763
  Epoch 12 [Batch 1/11]: Loss: 1.6225
  Epoch 12 [Batch 2/11]: Loss: 0.5148
  Epoch 12 [Batch 3/11]: Loss: 0.8472
  Epoch 12 [Batch 4/11]: Loss: 0.6866
  Epoch 12 [Batch 5/11]: Loss: 1.3606
  Epoch 12 [Batch 6/11]: Loss: 0.4617
  Epoch 12 [Batch 7/11]: Loss: 1.4755
  Epoch 12 [Batch 8/11]: Loss: 0.9861
  Epoch 12 [Batch 9/11]: Loss: 1.0393
  Epoch 12 [Batch 10/11]: Loss: 0.2993
  Epoch 12 Train Summary: Avg Loss: 1.0609, Accuracy: 0.5343
  Validation Summary: Avg Loss: 4.2673, Accuracy: 0.2833, F1 (Macro): 0.3152

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/11]: Loss: 0.4710
  Epoch 13 [Batch 1/11]: Loss: 0.7239
  Epoch 13 [Batch 2/11]: Loss: 1.2201
  Epoch 13 [Batch 3/11]: Loss: 1.4519
  Epoch 13 [Batch 4/11]: Loss: 0.7854
  Epoch 13 [Batch 5/11]: Loss: 0.6723
  Epoch 13 [Batch 6/11]: Loss: 1.6052
  Epoch 13 [Batch 7/11]: Loss: 1.0543
  Epoch 13 [Batch 8/11]: Loss: 0.8862
  Epoch 13 [Batch 9/11]: Loss: 0.6803
  Epoch 13 [Batch 10/11]: Loss: 2.5616
  Epoch 13 Train Summary: Avg Loss: 1.1011, Accuracy: 0.5269
  Validation Summary: Avg Loss: 4.4901, Accuracy: 0.2833, F1 (Macro): 0.3152

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/11]: Loss: 1.6121
  Epoch 14 [Batch 1/11]: Loss: 0.6979
  Epoch 14 [Batch 2/11]: Loss: 1.6958
  Epoch 14 [Batch 3/11]: Loss: 1.1269
  Epoch 14 [Batch 4/11]: Loss: 0.6485
  Epoch 14 [Batch 5/11]: Loss: 1.8974
  Epoch 14 [Batch 6/11]: Loss: 0.9540
  Epoch 14 [Batch 7/11]: Loss: 1.1854
  Epoch 14 [Batch 8/11]: Loss: 0.7999
  Epoch 14 [Batch 9/11]: Loss: 0.4895
  Epoch 14 [Batch 10/11]: Loss: 0.8718
  Epoch 14 Train Summary: Avg Loss: 1.0890, Accuracy: 0.5855
  Validation Summary: Avg Loss: 4.5942, Accuracy: 0.2833, F1 (Macro): 0.3152
Training finished in 0.98 minutes.
Loading best model for final evaluation...
  Validation Summary: Avg Loss: 4.1680, Accuracy: 0.2833, F1 (Macro): 0.3152
Final Best Model Stats: Acc: 0.2833, F1: 0.3152, Loss: 4.1680
Matplotlib not available. Skipping plot generation.
================================================================================

Aggregating results from all runs...
Successfully saved aggregate results to results_ceph/all_runs.csv
All experiments complete.
--- CEPH runs complete. ---

=====================================================
Running RGB (36 experiments)...
Data: processed_datasets/rgb_classification.csv
Output: ./results_rgb
=====================================================
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
Warning: 'matplotlib' or 'seaborn' not found. Install them to generate plots.
================================================================================
Starting Baseline Experiment Runner
CSV File: processed_datasets/rgb_classification.csv
Output Dir: ./results_rgb
Epochs: 15, Batch Size: 8
Grid Search Parameters:
  Architectures: ['resnet50', 'efficientnet_b0']
  Sizes: ['224x224', '384x384']
  Learning Rates: ['1e-4', '5e-5', '1e-5']
  Dropouts: ['0.0']
  Seeds: ['42', '123', '999']
Total experiments: 36
================================================================================
Using device: cuda

================================================================================
STARTING RUN: arch=resnet50 size=224x224 lr=0.0001 drop=0.0 seed=42
================================================================================
Starting experiment: resnet50__224x224__lr-0.0001__drop-0.0__seed-42
Output directory: results_rgb/resnet50__224x224__lr-0.0001__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 3124 images from processed_datasets/rgb_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 390 images from processed_datasets/rgb_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/391]: Loss: 1.1112
  Epoch 0 [Batch 39/391]: Loss: 0.8097
  Epoch 0 [Batch 78/391]: Loss: 0.8886
  Epoch 0 [Batch 117/391]: Loss: 1.1785
  Epoch 0 [Batch 156/391]: Loss: 0.7759
  Epoch 0 [Batch 195/391]: Loss: 1.2353
  Epoch 0 [Batch 234/391]: Loss: 0.8504
  Epoch 0 [Batch 273/391]: Loss: 0.8510
  Epoch 0 [Batch 312/391]: Loss: 0.6773
  Epoch 0 [Batch 351/391]: Loss: 0.7184
  Epoch 0 [Batch 390/391]: Loss: 0.6551
  Epoch 0 Train Summary: Avg Loss: 0.9349, Accuracy: 0.3330
  Validation Summary: Avg Loss: 0.9102, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from inf to 0.9102. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/391]: Loss: 1.0896
  Epoch 1 [Batch 39/391]: Loss: 0.9073
  Epoch 1 [Batch 78/391]: Loss: 0.5915
  Epoch 1 [Batch 117/391]: Loss: 0.7564
  Epoch 1 [Batch 156/391]: Loss: 1.0581
  Epoch 1 [Batch 195/391]: Loss: 0.7410
  Epoch 1 [Batch 234/391]: Loss: 0.9180
  Epoch 1 [Batch 273/391]: Loss: 1.0640
  Epoch 1 [Batch 312/391]: Loss: 0.6113
  Epoch 1 [Batch 351/391]: Loss: 0.8381
  Epoch 1 [Batch 390/391]: Loss: 0.8886
  Epoch 1 Train Summary: Avg Loss: 0.8853, Accuracy: 0.3349
  Validation Summary: Avg Loss: 0.8758, Accuracy: 0.3572, F1 (Macro): 0.3041
  New best model! Val loss improved from 0.9102 to 0.8758. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/391]: Loss: 0.5484
  Epoch 2 [Batch 39/391]: Loss: 1.1983
  Epoch 2 [Batch 78/391]: Loss: 0.7534
  Epoch 2 [Batch 117/391]: Loss: 1.2303
  Epoch 2 [Batch 156/391]: Loss: 0.8823
  Epoch 2 [Batch 195/391]: Loss: 0.5999
  Epoch 2 [Batch 234/391]: Loss: 0.8065
  Epoch 2 [Batch 273/391]: Loss: 1.1126
  Epoch 2 [Batch 312/391]: Loss: 1.0561
  Epoch 2 [Batch 351/391]: Loss: 0.9629
  Epoch 2 [Batch 390/391]: Loss: 1.1627
  Epoch 2 Train Summary: Avg Loss: 0.8567, Accuracy: 0.3571
  Validation Summary: Avg Loss: 0.8778, Accuracy: 0.3988, F1 (Macro): 0.3744

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/391]: Loss: 0.9275
  Epoch 3 [Batch 39/391]: Loss: 0.7748
  Epoch 3 [Batch 78/391]: Loss: 0.6145
  Epoch 3 [Batch 117/391]: Loss: 0.9165
  Epoch 3 [Batch 156/391]: Loss: 0.6685
  Epoch 3 [Batch 195/391]: Loss: 1.2296
  Epoch 3 [Batch 234/391]: Loss: 0.9818
  Epoch 3 [Batch 273/391]: Loss: 0.7025
  Epoch 3 [Batch 312/391]: Loss: 0.6180
  Epoch 3 [Batch 351/391]: Loss: 0.4906
  Epoch 3 [Batch 390/391]: Loss: 0.5771
  Epoch 3 Train Summary: Avg Loss: 0.8285, Accuracy: 0.4028
  Validation Summary: Avg Loss: 0.8395, Accuracy: 0.3986, F1 (Macro): 0.3744
  New best model! Val loss improved from 0.8758 to 0.8395. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/391]: Loss: 0.7461
  Epoch 4 [Batch 39/391]: Loss: 0.6882
  Epoch 4 [Batch 78/391]: Loss: 0.9913
  Epoch 4 [Batch 117/391]: Loss: 0.5000
  Epoch 4 [Batch 156/391]: Loss: 0.4789
  Epoch 4 [Batch 195/391]: Loss: 0.7971
  Epoch 4 [Batch 234/391]: Loss: 0.7882
  Epoch 4 [Batch 273/391]: Loss: 1.1707
  Epoch 4 [Batch 312/391]: Loss: 0.6763
  Epoch 4 [Batch 351/391]: Loss: 0.7920
  Epoch 4 [Batch 390/391]: Loss: 0.6291
  Epoch 4 Train Summary: Avg Loss: 0.7973, Accuracy: 0.4266
  Validation Summary: Avg Loss: 0.8528, Accuracy: 0.4337, F1 (Macro): 0.4071

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/391]: Loss: 0.7094
  Epoch 5 [Batch 39/391]: Loss: 0.6474
  Epoch 5 [Batch 78/391]: Loss: 0.8119
  Epoch 5 [Batch 117/391]: Loss: 0.5682
  Epoch 5 [Batch 156/391]: Loss: 0.6313
  Epoch 5 [Batch 195/391]: Loss: 0.5209
  Epoch 5 [Batch 234/391]: Loss: 0.5963
  Epoch 5 [Batch 273/391]: Loss: 0.5218
  Epoch 5 [Batch 312/391]: Loss: 0.9916
  Epoch 5 [Batch 351/391]: Loss: 0.5230
  Epoch 5 [Batch 390/391]: Loss: 0.5642
  Epoch 5 Train Summary: Avg Loss: 0.7584, Accuracy: 0.4552
  Validation Summary: Avg Loss: 0.8075, Accuracy: 0.4501, F1 (Macro): 0.4344
  New best model! Val loss improved from 0.8395 to 0.8075. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/391]: Loss: 0.5714
  Epoch 6 [Batch 39/391]: Loss: 0.5466
  Epoch 6 [Batch 78/391]: Loss: 0.6305
  Epoch 6 [Batch 117/391]: Loss: 0.6778
  Epoch 6 [Batch 156/391]: Loss: 0.4738
  Epoch 6 [Batch 195/391]: Loss: 0.8368
  Epoch 6 [Batch 234/391]: Loss: 0.9001
  Epoch 6 [Batch 273/391]: Loss: 1.7150
  Epoch 6 [Batch 312/391]: Loss: 0.6854
  Epoch 6 [Batch 351/391]: Loss: 0.5667
  Epoch 6 [Batch 390/391]: Loss: 0.7011
  Epoch 6 Train Summary: Avg Loss: 0.7245, Accuracy: 0.5166
  Validation Summary: Avg Loss: 0.7926, Accuracy: 0.4547, F1 (Macro): 0.4513
  New best model! Val loss improved from 0.8075 to 0.7926. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/391]: Loss: 0.6756
  Epoch 7 [Batch 39/391]: Loss: 1.1287
  Epoch 7 [Batch 78/391]: Loss: 0.3925
  Epoch 7 [Batch 117/391]: Loss: 1.1657
  Epoch 7 [Batch 156/391]: Loss: 0.6620
  Epoch 7 [Batch 195/391]: Loss: 0.6091
  Epoch 7 [Batch 234/391]: Loss: 0.9782
  Epoch 7 [Batch 273/391]: Loss: 0.4631
  Epoch 7 [Batch 312/391]: Loss: 0.4657
  Epoch 7 [Batch 351/391]: Loss: 0.4139
  Epoch 7 [Batch 390/391]: Loss: 1.0582
  Epoch 7 Train Summary: Avg Loss: 0.6872, Accuracy: 0.5657
  Validation Summary: Avg Loss: 0.8103, Accuracy: 0.5255, F1 (Macro): 0.5290

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/391]: Loss: 0.4295
  Epoch 8 [Batch 39/391]: Loss: 0.7191
  Epoch 8 [Batch 78/391]: Loss: 0.5341
  Epoch 8 [Batch 117/391]: Loss: 0.5089
  Epoch 8 [Batch 156/391]: Loss: 0.6381
  Epoch 8 [Batch 195/391]: Loss: 0.6192
  Epoch 8 [Batch 234/391]: Loss: 0.5734
  Epoch 8 [Batch 273/391]: Loss: 0.3692
  Epoch 8 [Batch 312/391]: Loss: 0.5913
  Epoch 8 [Batch 351/391]: Loss: 0.9587
  Epoch 8 [Batch 390/391]: Loss: 0.5931
  Epoch 8 Train Summary: Avg Loss: 0.6348, Accuracy: 0.6019
  Validation Summary: Avg Loss: 0.7701, Accuracy: 0.5069, F1 (Macro): 0.5276
  New best model! Val loss improved from 0.7926 to 0.7701. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/391]: Loss: 0.5944
  Epoch 9 [Batch 39/391]: Loss: 0.3511
  Epoch 9 [Batch 78/391]: Loss: 0.2628
  Epoch 9 [Batch 117/391]: Loss: 1.1050
  Epoch 9 [Batch 156/391]: Loss: 0.7761
  Epoch 9 [Batch 195/391]: Loss: 0.7773
  Epoch 9 [Batch 234/391]: Loss: 0.4449
  Epoch 9 [Batch 273/391]: Loss: 0.7304
  Epoch 9 [Batch 312/391]: Loss: 0.5660
  Epoch 9 [Batch 351/391]: Loss: 0.6040
  Epoch 9 [Batch 390/391]: Loss: 0.3098
  Epoch 9 Train Summary: Avg Loss: 0.5813, Accuracy: 0.6491
  Validation Summary: Avg Loss: 0.7874, Accuracy: 0.5571, F1 (Macro): 0.5813

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/391]: Loss: 0.2757
  Epoch 10 [Batch 39/391]: Loss: 0.5601
  Epoch 10 [Batch 78/391]: Loss: 0.5242
  Epoch 10 [Batch 117/391]: Loss: 0.8046
  Epoch 10 [Batch 156/391]: Loss: 0.2357
  Epoch 10 [Batch 195/391]: Loss: 0.5074
  Epoch 10 [Batch 234/391]: Loss: 0.2719
  Epoch 10 [Batch 273/391]: Loss: 0.4305
  Epoch 10 [Batch 312/391]: Loss: 0.5033
  Epoch 10 [Batch 351/391]: Loss: 0.3824
  Epoch 10 [Batch 390/391]: Loss: 0.4376
  Epoch 10 Train Summary: Avg Loss: 0.5371, Accuracy: 0.6835
  Validation Summary: Avg Loss: 0.8005, Accuracy: 0.5613, F1 (Macro): 0.5863

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/391]: Loss: 0.4925
  Epoch 11 [Batch 39/391]: Loss: 0.5220
  Epoch 11 [Batch 78/391]: Loss: 0.5668
  Epoch 11 [Batch 117/391]: Loss: 0.7416
  Epoch 11 [Batch 156/391]: Loss: 0.3862
  Epoch 11 [Batch 195/391]: Loss: 0.4719
  Epoch 11 [Batch 234/391]: Loss: 0.4393
  Epoch 11 [Batch 273/391]: Loss: 0.5024
  Epoch 11 [Batch 312/391]: Loss: 0.4923
  Epoch 11 [Batch 351/391]: Loss: 0.5347
  Epoch 11 [Batch 390/391]: Loss: 0.5683
  Epoch 11 Train Summary: Avg Loss: 0.4971, Accuracy: 0.7160
  Validation Summary: Avg Loss: 0.8114, Accuracy: 0.5678, F1 (Macro): 0.5838

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/391]: Loss: 0.5884
  Epoch 12 [Batch 39/391]: Loss: 0.3679
  Epoch 12 [Batch 78/391]: Loss: 0.4543
  Epoch 12 [Batch 117/391]: Loss: 0.5155
  Epoch 12 [Batch 156/391]: Loss: 0.4904
  Epoch 12 [Batch 195/391]: Loss: 0.6607
  Epoch 12 [Batch 234/391]: Loss: 0.3671
  Epoch 12 [Batch 273/391]: Loss: 0.3851
  Epoch 12 [Batch 312/391]: Loss: 0.1747
  Epoch 12 [Batch 351/391]: Loss: 0.2230
  Epoch 12 [Batch 390/391]: Loss: 0.1230
  Epoch 12 Train Summary: Avg Loss: 0.4451, Accuracy: 0.7549
  Validation Summary: Avg Loss: 0.8337, Accuracy: 0.5674, F1 (Macro): 0.5950

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/391]: Loss: 0.2791
  Epoch 13 [Batch 39/391]: Loss: 0.7184
  Epoch 13 [Batch 78/391]: Loss: 0.1578
  Epoch 13 [Batch 117/391]: Loss: 0.2780
  Epoch 13 [Batch 156/391]: Loss: 0.3019
  Epoch 13 [Batch 195/391]: Loss: 1.1059
  Epoch 13 [Batch 234/391]: Loss: 0.2697
  Epoch 13 [Batch 273/391]: Loss: 0.8898
  Epoch 13 [Batch 312/391]: Loss: 0.4117
  Epoch 13 [Batch 351/391]: Loss: 0.2944
  Epoch 13 [Batch 390/391]: Loss: 0.5184
  Epoch 13 Train Summary: Avg Loss: 0.4355, Accuracy: 0.7690
  Validation Summary: Avg Loss: 0.7688, Accuracy: 0.5875, F1 (Macro): 0.6002
  New best model! Val loss improved from 0.7701 to 0.7688. Saving...

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/391]: Loss: 0.3309
  Epoch 14 [Batch 39/391]: Loss: 0.6622
  Epoch 14 [Batch 78/391]: Loss: 0.4819
  Epoch 14 [Batch 117/391]: Loss: 0.5548
  Epoch 14 [Batch 156/391]: Loss: 0.4171
  Epoch 14 [Batch 195/391]: Loss: 0.2922
  Epoch 14 [Batch 234/391]: Loss: 0.3017
  Epoch 14 [Batch 273/391]: Loss: 0.4105
  Epoch 14 [Batch 312/391]: Loss: 1.2124
  Epoch 14 [Batch 351/391]: Loss: 0.2627
  Epoch 14 [Batch 390/391]: Loss: 0.7072
  Epoch 14 Train Summary: Avg Loss: 0.3910, Accuracy: 0.7896
  Validation Summary: Avg Loss: 0.8638, Accuracy: 0.5689, F1 (Macro): 0.5988
Training finished in 31.44 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.7688, Accuracy: 0.5875, F1 (Macro): 0.6002
Final Best Model Stats: Acc: 0.5875, F1: 0.6002, Loss: 0.7688
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=0.0001 drop=0.0 seed=123
================================================================================
Starting experiment: resnet50__224x224__lr-0.0001__drop-0.0__seed-123
Output directory: results_rgb/resnet50__224x224__lr-0.0001__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 3124 images from processed_datasets/rgb_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 390 images from processed_datasets/rgb_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/391]: Loss: 1.1092
  Epoch 0 [Batch 39/391]: Loss: 0.9354
  Epoch 0 [Batch 78/391]: Loss: 1.0788
  Epoch 0 [Batch 117/391]: Loss: 0.9482
  Epoch 0 [Batch 156/391]: Loss: 0.7661
  Epoch 0 [Batch 195/391]: Loss: 0.6457
  Epoch 0 [Batch 234/391]: Loss: 1.2278
  Epoch 0 [Batch 273/391]: Loss: 0.7364
  Epoch 0 [Batch 312/391]: Loss: 0.7283
  Epoch 0 [Batch 351/391]: Loss: 1.4836
  Epoch 0 [Batch 390/391]: Loss: 1.0762
  Epoch 0 Train Summary: Avg Loss: 0.9302, Accuracy: 0.3320
  Validation Summary: Avg Loss: 0.9061, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from inf to 0.9061. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/391]: Loss: 0.9668
  Epoch 1 [Batch 39/391]: Loss: 0.9115
  Epoch 1 [Batch 78/391]: Loss: 0.7433
  Epoch 1 [Batch 117/391]: Loss: 0.8262
  Epoch 1 [Batch 156/391]: Loss: 1.0589
  Epoch 1 [Batch 195/391]: Loss: 0.6915
  Epoch 1 [Batch 234/391]: Loss: 0.6708
  Epoch 1 [Batch 273/391]: Loss: 1.1813
  Epoch 1 [Batch 312/391]: Loss: 0.8627
  Epoch 1 [Batch 351/391]: Loss: 0.8297
  Epoch 1 [Batch 390/391]: Loss: 0.9525
  Epoch 1 Train Summary: Avg Loss: 0.8891, Accuracy: 0.3360
  Validation Summary: Avg Loss: 0.8780, Accuracy: 0.3685, F1 (Macro): 0.3263
  New best model! Val loss improved from 0.9061 to 0.8780. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/391]: Loss: 0.9889
  Epoch 2 [Batch 39/391]: Loss: 0.8300
  Epoch 2 [Batch 78/391]: Loss: 0.6822
  Epoch 2 [Batch 117/391]: Loss: 0.7475
  Epoch 2 [Batch 156/391]: Loss: 0.9391
  Epoch 2 [Batch 195/391]: Loss: 0.5179
  Epoch 2 [Batch 234/391]: Loss: 0.5808
  Epoch 2 [Batch 273/391]: Loss: 0.7476
  Epoch 2 [Batch 312/391]: Loss: 0.5765
  Epoch 2 [Batch 351/391]: Loss: 0.8323
  Epoch 2 [Batch 390/391]: Loss: 0.5301
  Epoch 2 Train Summary: Avg Loss: 0.8572, Accuracy: 0.3708
  Validation Summary: Avg Loss: 0.8681, Accuracy: 0.3917, F1 (Macro): 0.3665
  New best model! Val loss improved from 0.8780 to 0.8681. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/391]: Loss: 1.0612
  Epoch 3 [Batch 39/391]: Loss: 0.6119
  Epoch 3 [Batch 78/391]: Loss: 0.5196
  Epoch 3 [Batch 117/391]: Loss: 1.0216
  Epoch 3 [Batch 156/391]: Loss: 0.7895
  Epoch 3 [Batch 195/391]: Loss: 0.5844
  Epoch 3 [Batch 234/391]: Loss: 0.7349
  Epoch 3 [Batch 273/391]: Loss: 1.2242
  Epoch 3 [Batch 312/391]: Loss: 0.6773
  Epoch 3 [Batch 351/391]: Loss: 1.1312
  Epoch 3 [Batch 390/391]: Loss: 1.3574
  Epoch 3 Train Summary: Avg Loss: 0.8330, Accuracy: 0.3990
  Validation Summary: Avg Loss: 0.8450, Accuracy: 0.3945, F1 (Macro): 0.3695
  New best model! Val loss improved from 0.8681 to 0.8450. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/391]: Loss: 0.9205
  Epoch 4 [Batch 39/391]: Loss: 0.7599
  Epoch 4 [Batch 78/391]: Loss: 0.6663
  Epoch 4 [Batch 117/391]: Loss: 1.2489
  Epoch 4 [Batch 156/391]: Loss: 1.0010
  Epoch 4 [Batch 195/391]: Loss: 1.2867
  Epoch 4 [Batch 234/391]: Loss: 0.6425
  Epoch 4 [Batch 273/391]: Loss: 1.1997
  Epoch 4 [Batch 312/391]: Loss: 0.7504
  Epoch 4 [Batch 351/391]: Loss: 0.6663
  Epoch 4 [Batch 390/391]: Loss: 0.3448
  Epoch 4 Train Summary: Avg Loss: 0.7899, Accuracy: 0.4240
  Validation Summary: Avg Loss: 0.8083, Accuracy: 0.4260, F1 (Macro): 0.4033
  New best model! Val loss improved from 0.8450 to 0.8083. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/391]: Loss: 1.5363
  Epoch 5 [Batch 39/391]: Loss: 0.7280
  Epoch 5 [Batch 78/391]: Loss: 0.4534
  Epoch 5 [Batch 117/391]: Loss: 0.5898
  Epoch 5 [Batch 156/391]: Loss: 0.7417
  Epoch 5 [Batch 195/391]: Loss: 0.8751
  Epoch 5 [Batch 234/391]: Loss: 0.6692
  Epoch 5 [Batch 273/391]: Loss: 0.6505
  Epoch 5 [Batch 312/391]: Loss: 0.8643
  Epoch 5 [Batch 351/391]: Loss: 0.3622
  Epoch 5 [Batch 390/391]: Loss: 1.2468
  Epoch 5 Train Summary: Avg Loss: 0.7542, Accuracy: 0.4594
  Validation Summary: Avg Loss: 0.7800, Accuracy: 0.4688, F1 (Macro): 0.4656
  New best model! Val loss improved from 0.8083 to 0.7800. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/391]: Loss: 0.6707
  Epoch 6 [Batch 39/391]: Loss: 0.5667
  Epoch 6 [Batch 78/391]: Loss: 0.9010
  Epoch 6 [Batch 117/391]: Loss: 0.8511
  Epoch 6 [Batch 156/391]: Loss: 0.6355
  Epoch 6 [Batch 195/391]: Loss: 0.7226
  Epoch 6 [Batch 234/391]: Loss: 0.3795
  Epoch 6 [Batch 273/391]: Loss: 0.5966
  Epoch 6 [Batch 312/391]: Loss: 1.1747
  Epoch 6 [Batch 351/391]: Loss: 1.2830
  Epoch 6 [Batch 390/391]: Loss: 0.4744
  Epoch 6 Train Summary: Avg Loss: 0.6991, Accuracy: 0.5371
  Validation Summary: Avg Loss: 0.8089, Accuracy: 0.4860, F1 (Macro): 0.4949

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/391]: Loss: 0.8516
  Epoch 7 [Batch 39/391]: Loss: 0.7306
  Epoch 7 [Batch 78/391]: Loss: 0.5390
  Epoch 7 [Batch 117/391]: Loss: 0.8009
  Epoch 7 [Batch 156/391]: Loss: 0.5810
  Epoch 7 [Batch 195/391]: Loss: 0.5490
  Epoch 7 [Batch 234/391]: Loss: 0.4314
  Epoch 7 [Batch 273/391]: Loss: 0.4504
  Epoch 7 [Batch 312/391]: Loss: 0.5947
  Epoch 7 [Batch 351/391]: Loss: 0.4548
  Epoch 7 [Batch 390/391]: Loss: 2.1309
  Epoch 7 Train Summary: Avg Loss: 0.6577, Accuracy: 0.5879
  Validation Summary: Avg Loss: 0.7761, Accuracy: 0.5047, F1 (Macro): 0.5153
  New best model! Val loss improved from 0.7800 to 0.7761. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/391]: Loss: 0.6976
  Epoch 8 [Batch 39/391]: Loss: 0.4668
  Epoch 8 [Batch 78/391]: Loss: 1.2412
  Epoch 8 [Batch 117/391]: Loss: 0.8955
  Epoch 8 [Batch 156/391]: Loss: 0.3964
  Epoch 8 [Batch 195/391]: Loss: 1.4638
  Epoch 8 [Batch 234/391]: Loss: 0.4050
  Epoch 8 [Batch 273/391]: Loss: 0.3937
  Epoch 8 [Batch 312/391]: Loss: 0.5652
  Epoch 8 [Batch 351/391]: Loss: 0.3715
  Epoch 8 [Batch 390/391]: Loss: 1.5545
  Epoch 8 Train Summary: Avg Loss: 0.6090, Accuracy: 0.6255
  Validation Summary: Avg Loss: 0.7458, Accuracy: 0.5888, F1 (Macro): 0.6126
  New best model! Val loss improved from 0.7761 to 0.7458. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/391]: Loss: 0.2132
  Epoch 9 [Batch 39/391]: Loss: 0.8120
  Epoch 9 [Batch 78/391]: Loss: 0.2850
  Epoch 9 [Batch 117/391]: Loss: 0.4758
  Epoch 9 [Batch 156/391]: Loss: 0.5915
  Epoch 9 [Batch 195/391]: Loss: 0.6567
  Epoch 9 [Batch 234/391]: Loss: 0.3598
  Epoch 9 [Batch 273/391]: Loss: 0.3357
  Epoch 9 [Batch 312/391]: Loss: 0.7851
  Epoch 9 [Batch 351/391]: Loss: 0.3408
  Epoch 9 [Batch 390/391]: Loss: 0.6310
  Epoch 9 Train Summary: Avg Loss: 0.5651, Accuracy: 0.6688
  Validation Summary: Avg Loss: 0.8749, Accuracy: 0.5529, F1 (Macro): 0.5662

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/391]: Loss: 0.3119
  Epoch 10 [Batch 39/391]: Loss: 1.0665
  Epoch 10 [Batch 78/391]: Loss: 0.6362
  Epoch 10 [Batch 117/391]: Loss: 0.6697
  Epoch 10 [Batch 156/391]: Loss: 0.7198
  Epoch 10 [Batch 195/391]: Loss: 0.3424
  Epoch 10 [Batch 234/391]: Loss: 0.4572
  Epoch 10 [Batch 273/391]: Loss: 0.5300
  Epoch 10 [Batch 312/391]: Loss: 0.4785
  Epoch 10 [Batch 351/391]: Loss: 0.8170
  Epoch 10 [Batch 390/391]: Loss: 1.0710
  Epoch 10 Train Summary: Avg Loss: 0.5243, Accuracy: 0.6970
  Validation Summary: Avg Loss: 0.7391, Accuracy: 0.5992, F1 (Macro): 0.6183
  New best model! Val loss improved from 0.7458 to 0.7391. Saving...

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/391]: Loss: 0.7506
  Epoch 11 [Batch 39/391]: Loss: 0.1831
  Epoch 11 [Batch 78/391]: Loss: 0.4101
  Epoch 11 [Batch 117/391]: Loss: 0.8460
  Epoch 11 [Batch 156/391]: Loss: 0.6554
  Epoch 11 [Batch 195/391]: Loss: 0.3246
  Epoch 11 [Batch 234/391]: Loss: 0.3519
  Epoch 11 [Batch 273/391]: Loss: 0.5591
  Epoch 11 [Batch 312/391]: Loss: 0.4536
  Epoch 11 [Batch 351/391]: Loss: 0.4040
  Epoch 11 [Batch 390/391]: Loss: 1.6964
  Epoch 11 Train Summary: Avg Loss: 0.4802, Accuracy: 0.7323
  Validation Summary: Avg Loss: 0.8135, Accuracy: 0.5949, F1 (Macro): 0.6161

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/391]: Loss: 0.2424
  Epoch 12 [Batch 39/391]: Loss: 0.4621
  Epoch 12 [Batch 78/391]: Loss: 0.1449
  Epoch 12 [Batch 117/391]: Loss: 0.4090
  Epoch 12 [Batch 156/391]: Loss: 0.2318
  Epoch 12 [Batch 195/391]: Loss: 0.1360
  Epoch 12 [Batch 234/391]: Loss: 0.4398
  Epoch 12 [Batch 273/391]: Loss: 0.1961
  Epoch 12 [Batch 312/391]: Loss: 0.2964
  Epoch 12 [Batch 351/391]: Loss: 1.3156
  Epoch 12 [Batch 390/391]: Loss: 0.7933
  Epoch 12 Train Summary: Avg Loss: 0.4286, Accuracy: 0.7670
  Validation Summary: Avg Loss: 0.8003, Accuracy: 0.5782, F1 (Macro): 0.6010

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/391]: Loss: 0.2517
  Epoch 13 [Batch 39/391]: Loss: 1.0659
  Epoch 13 [Batch 78/391]: Loss: 0.3783
  Epoch 13 [Batch 117/391]: Loss: 0.2367
  Epoch 13 [Batch 156/391]: Loss: 0.1652
  Epoch 13 [Batch 195/391]: Loss: 0.2168
  Epoch 13 [Batch 234/391]: Loss: 0.2528
  Epoch 13 [Batch 273/391]: Loss: 0.1065
  Epoch 13 [Batch 312/391]: Loss: 0.2718
  Epoch 13 [Batch 351/391]: Loss: 0.2460
  Epoch 13 [Batch 390/391]: Loss: 0.2529
  Epoch 13 Train Summary: Avg Loss: 0.4173, Accuracy: 0.7783
  Validation Summary: Avg Loss: 0.7362, Accuracy: 0.6042, F1 (Macro): 0.6150
  New best model! Val loss improved from 0.7391 to 0.7362. Saving...

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/391]: Loss: 0.2872
  Epoch 14 [Batch 39/391]: Loss: 0.2180
  Epoch 14 [Batch 78/391]: Loss: 0.4041
  Epoch 14 [Batch 117/391]: Loss: 0.2587
  Epoch 14 [Batch 156/391]: Loss: 0.7005
  Epoch 14 [Batch 195/391]: Loss: 1.3157
  Epoch 14 [Batch 234/391]: Loss: 0.5873
  Epoch 14 [Batch 273/391]: Loss: 0.5033
  Epoch 14 [Batch 312/391]: Loss: 0.7405
  Epoch 14 [Batch 351/391]: Loss: 0.0727
  Epoch 14 [Batch 390/391]: Loss: 0.2917
  Epoch 14 Train Summary: Avg Loss: 0.3902, Accuracy: 0.7908
  Validation Summary: Avg Loss: 0.7861, Accuracy: 0.6231, F1 (Macro): 0.6487
Training finished in 29.94 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.7362, Accuracy: 0.6042, F1 (Macro): 0.6150
Final Best Model Stats: Acc: 0.6042, F1: 0.6150, Loss: 0.7362
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=0.0001 drop=0.0 seed=999
================================================================================
Starting experiment: resnet50__224x224__lr-0.0001__drop-0.0__seed-999
Output directory: results_rgb/resnet50__224x224__lr-0.0001__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 3124 images from processed_datasets/rgb_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 390 images from processed_datasets/rgb_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/391]: Loss: 1.1444
  Epoch 0 [Batch 39/391]: Loss: 1.1378
  Epoch 0 [Batch 78/391]: Loss: 0.7432
  Epoch 0 [Batch 117/391]: Loss: 0.8579
  Epoch 0 [Batch 156/391]: Loss: 0.9433
  Epoch 0 [Batch 195/391]: Loss: 0.8509
  Epoch 0 [Batch 234/391]: Loss: 1.2002
  Epoch 0 [Batch 273/391]: Loss: 1.2519
  Epoch 0 [Batch 312/391]: Loss: 1.0999
  Epoch 0 [Batch 351/391]: Loss: 0.5884
  Epoch 0 [Batch 390/391]: Loss: 0.6909
  Epoch 0 Train Summary: Avg Loss: 0.9366, Accuracy: 0.3310
  Validation Summary: Avg Loss: 0.9124, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from inf to 0.9124. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/391]: Loss: 1.1247
  Epoch 1 [Batch 39/391]: Loss: 1.0516
  Epoch 1 [Batch 78/391]: Loss: 0.8702
  Epoch 1 [Batch 117/391]: Loss: 0.7564
  Epoch 1 [Batch 156/391]: Loss: 0.7482
  Epoch 1 [Batch 195/391]: Loss: 0.9385
  Epoch 1 [Batch 234/391]: Loss: 0.5738
  Epoch 1 [Batch 273/391]: Loss: 0.8533
  Epoch 1 [Batch 312/391]: Loss: 0.7515
  Epoch 1 [Batch 351/391]: Loss: 1.0051
  Epoch 1 [Batch 390/391]: Loss: 1.0251
  Epoch 1 Train Summary: Avg Loss: 0.8876, Accuracy: 0.3344
  Validation Summary: Avg Loss: 0.8935, Accuracy: 0.3441, F1 (Macro): 0.2923
  New best model! Val loss improved from 0.9124 to 0.8935. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/391]: Loss: 0.8438
  Epoch 2 [Batch 39/391]: Loss: 0.9306
  Epoch 2 [Batch 78/391]: Loss: 0.7595
  Epoch 2 [Batch 117/391]: Loss: 1.0511
  Epoch 2 [Batch 156/391]: Loss: 1.0139
  Epoch 2 [Batch 195/391]: Loss: 0.9378
  Epoch 2 [Batch 234/391]: Loss: 0.6381
  Epoch 2 [Batch 273/391]: Loss: 0.6241
  Epoch 2 [Batch 312/391]: Loss: 0.8272
  Epoch 2 [Batch 351/391]: Loss: 1.0708
  Epoch 2 [Batch 390/391]: Loss: 0.8269
  Epoch 2 Train Summary: Avg Loss: 0.8584, Accuracy: 0.3543
  Validation Summary: Avg Loss: 0.8758, Accuracy: 0.3651, F1 (Macro): 0.3310
  New best model! Val loss improved from 0.8935 to 0.8758. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/391]: Loss: 0.9150
  Epoch 3 [Batch 39/391]: Loss: 0.9001
  Epoch 3 [Batch 78/391]: Loss: 0.8142
  Epoch 3 [Batch 117/391]: Loss: 0.7571
  Epoch 3 [Batch 156/391]: Loss: 0.7801
  Epoch 3 [Batch 195/391]: Loss: 0.9508
  Epoch 3 [Batch 234/391]: Loss: 1.0401
  Epoch 3 [Batch 273/391]: Loss: 0.6524
  Epoch 3 [Batch 312/391]: Loss: 0.7826
  Epoch 3 [Batch 351/391]: Loss: 0.6962
  Epoch 3 [Batch 390/391]: Loss: 0.5831
  Epoch 3 Train Summary: Avg Loss: 0.8293, Accuracy: 0.3983
  Validation Summary: Avg Loss: 0.8630, Accuracy: 0.3899, F1 (Macro): 0.3656
  New best model! Val loss improved from 0.8758 to 0.8630. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/391]: Loss: 0.6364
  Epoch 4 [Batch 39/391]: Loss: 0.9007
  Epoch 4 [Batch 78/391]: Loss: 0.6785
  Epoch 4 [Batch 117/391]: Loss: 1.0744
  Epoch 4 [Batch 156/391]: Loss: 1.3072
  Epoch 4 [Batch 195/391]: Loss: 0.7388
  Epoch 4 [Batch 234/391]: Loss: 0.8557
  Epoch 4 [Batch 273/391]: Loss: 0.9480
  Epoch 4 [Batch 312/391]: Loss: 0.7269
  Epoch 4 [Batch 351/391]: Loss: 0.5866
  Epoch 4 [Batch 390/391]: Loss: 0.4340
  Epoch 4 Train Summary: Avg Loss: 0.8013, Accuracy: 0.4267
  Validation Summary: Avg Loss: 0.8700, Accuracy: 0.3974, F1 (Macro): 0.3816

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/391]: Loss: 0.5870
  Epoch 5 [Batch 39/391]: Loss: 0.5493
  Epoch 5 [Batch 78/391]: Loss: 0.6257
  Epoch 5 [Batch 117/391]: Loss: 1.1601
  Epoch 5 [Batch 156/391]: Loss: 1.3617
  Epoch 5 [Batch 195/391]: Loss: 0.5069
  Epoch 5 [Batch 234/391]: Loss: 0.5648
  Epoch 5 [Batch 273/391]: Loss: 0.5869
  Epoch 5 [Batch 312/391]: Loss: 0.6025
  Epoch 5 [Batch 351/391]: Loss: 1.2020
  Epoch 5 [Batch 390/391]: Loss: 0.4166
  Epoch 5 Train Summary: Avg Loss: 0.7610, Accuracy: 0.4551
  Validation Summary: Avg Loss: 0.8482, Accuracy: 0.4771, F1 (Macro): 0.4957
  New best model! Val loss improved from 0.8630 to 0.8482. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/391]: Loss: 0.9264
  Epoch 6 [Batch 39/391]: Loss: 0.8142
  Epoch 6 [Batch 78/391]: Loss: 0.7467
  Epoch 6 [Batch 117/391]: Loss: 0.6011
  Epoch 6 [Batch 156/391]: Loss: 0.6790
  Epoch 6 [Batch 195/391]: Loss: 0.4662
  Epoch 6 [Batch 234/391]: Loss: 0.5268
  Epoch 6 [Batch 273/391]: Loss: 0.4568
  Epoch 6 [Batch 312/391]: Loss: 0.5035
  Epoch 6 [Batch 351/391]: Loss: 1.0064
  Epoch 6 [Batch 390/391]: Loss: 0.9844
  Epoch 6 Train Summary: Avg Loss: 0.7151, Accuracy: 0.5221
  Validation Summary: Avg Loss: 0.8557, Accuracy: 0.5124, F1 (Macro): 0.5325

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/391]: Loss: 0.5369
  Epoch 7 [Batch 39/391]: Loss: 0.6910
  Epoch 7 [Batch 78/391]: Loss: 0.7589
  Epoch 7 [Batch 117/391]: Loss: 0.4649
  Epoch 7 [Batch 156/391]: Loss: 0.5542
  Epoch 7 [Batch 195/391]: Loss: 0.7040
  Epoch 7 [Batch 234/391]: Loss: 0.6317
  Epoch 7 [Batch 273/391]: Loss: 0.5240
  Epoch 7 [Batch 312/391]: Loss: 0.4653
  Epoch 7 [Batch 351/391]: Loss: 0.5216
  Epoch 7 [Batch 390/391]: Loss: 0.6098
  Epoch 7 Train Summary: Avg Loss: 0.6601, Accuracy: 0.5744
  Validation Summary: Avg Loss: 0.8387, Accuracy: 0.5446, F1 (Macro): 0.5444
  New best model! Val loss improved from 0.8482 to 0.8387. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/391]: Loss: 0.5214
  Epoch 8 [Batch 39/391]: Loss: 0.5283
  Epoch 8 [Batch 78/391]: Loss: 0.5842
  Epoch 8 [Batch 117/391]: Loss: 0.5648
  Epoch 8 [Batch 156/391]: Loss: 0.7494
  Epoch 8 [Batch 195/391]: Loss: 0.7520
  Epoch 8 [Batch 234/391]: Loss: 0.7027
  Epoch 8 [Batch 273/391]: Loss: 0.6490
  Epoch 8 [Batch 312/391]: Loss: 0.2773
  Epoch 8 [Batch 351/391]: Loss: 0.6893
  Epoch 8 [Batch 390/391]: Loss: 0.6399
  Epoch 8 Train Summary: Avg Loss: 0.6259, Accuracy: 0.6279
  Validation Summary: Avg Loss: 0.8332, Accuracy: 0.5341, F1 (Macro): 0.5545
  New best model! Val loss improved from 0.8387 to 0.8332. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/391]: Loss: 0.6868
  Epoch 9 [Batch 39/391]: Loss: 0.6780
  Epoch 9 [Batch 78/391]: Loss: 0.3332
  Epoch 9 [Batch 117/391]: Loss: 0.5753
  Epoch 9 [Batch 156/391]: Loss: 0.4569
  Epoch 9 [Batch 195/391]: Loss: 0.5238
  Epoch 9 [Batch 234/391]: Loss: 0.7256
  Epoch 9 [Batch 273/391]: Loss: 0.6217
  Epoch 9 [Batch 312/391]: Loss: 0.8154
  Epoch 9 [Batch 351/391]: Loss: 1.0092
  Epoch 9 [Batch 390/391]: Loss: 0.5122
  Epoch 9 Train Summary: Avg Loss: 0.5816, Accuracy: 0.6572
  Validation Summary: Avg Loss: 0.7985, Accuracy: 0.5786, F1 (Macro): 0.5986
  New best model! Val loss improved from 0.8332 to 0.7985. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/391]: Loss: 0.4424
  Epoch 10 [Batch 39/391]: Loss: 0.6113
  Epoch 10 [Batch 78/391]: Loss: 0.1508
  Epoch 10 [Batch 117/391]: Loss: 1.2979
  Epoch 10 [Batch 156/391]: Loss: 0.8270
  Epoch 10 [Batch 195/391]: Loss: 0.9176
  Epoch 10 [Batch 234/391]: Loss: 0.9863
  Epoch 10 [Batch 273/391]: Loss: 1.2108
  Epoch 10 [Batch 312/391]: Loss: 0.7940
  Epoch 10 [Batch 351/391]: Loss: 0.7274
  Epoch 10 [Batch 390/391]: Loss: 0.2274
  Epoch 10 Train Summary: Avg Loss: 0.5288, Accuracy: 0.7035
  Validation Summary: Avg Loss: 0.8260, Accuracy: 0.6059, F1 (Macro): 0.6147

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/391]: Loss: 0.7814
  Epoch 11 [Batch 39/391]: Loss: 0.2674
  Epoch 11 [Batch 78/391]: Loss: 0.2804
  Epoch 11 [Batch 117/391]: Loss: 0.3193
  Epoch 11 [Batch 156/391]: Loss: 0.7504
  Epoch 11 [Batch 195/391]: Loss: 0.6997
  Epoch 11 [Batch 234/391]: Loss: 0.3376
  Epoch 11 [Batch 273/391]: Loss: 0.6508
  Epoch 11 [Batch 312/391]: Loss: 0.3774
  Epoch 11 [Batch 351/391]: Loss: 0.3096
  Epoch 11 [Batch 390/391]: Loss: 0.8782
  Epoch 11 Train Summary: Avg Loss: 0.4890, Accuracy: 0.7347
  Validation Summary: Avg Loss: 0.8071, Accuracy: 0.5842, F1 (Macro): 0.5925

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/391]: Loss: 0.6191
  Epoch 12 [Batch 39/391]: Loss: 0.1825
  Epoch 12 [Batch 78/391]: Loss: 0.5000
  Epoch 12 [Batch 117/391]: Loss: 0.4039
  Epoch 12 [Batch 156/391]: Loss: 0.8456
  Epoch 12 [Batch 195/391]: Loss: 0.3261
  Epoch 12 [Batch 234/391]: Loss: 0.2113
  Epoch 12 [Batch 273/391]: Loss: 0.2986
  Epoch 12 [Batch 312/391]: Loss: 0.3212
  Epoch 12 [Batch 351/391]: Loss: 0.6409
  Epoch 12 [Batch 390/391]: Loss: 0.4912
  Epoch 12 Train Summary: Avg Loss: 0.4635, Accuracy: 0.7462
  Validation Summary: Avg Loss: 0.8607, Accuracy: 0.5860, F1 (Macro): 0.6149

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/391]: Loss: 0.5315
  Epoch 13 [Batch 39/391]: Loss: 0.2665
  Epoch 13 [Batch 78/391]: Loss: 0.2067
  Epoch 13 [Batch 117/391]: Loss: 0.4332
  Epoch 13 [Batch 156/391]: Loss: 0.2881
  Epoch 13 [Batch 195/391]: Loss: 0.8902
  Epoch 13 [Batch 234/391]: Loss: 0.4904
  Epoch 13 [Batch 273/391]: Loss: 0.5428
  Epoch 13 [Batch 312/391]: Loss: 0.3740
  Epoch 13 [Batch 351/391]: Loss: 0.3091
  Epoch 13 [Batch 390/391]: Loss: 0.8618
  Epoch 13 Train Summary: Avg Loss: 0.4106, Accuracy: 0.7805
  Validation Summary: Avg Loss: 0.7742, Accuracy: 0.6300, F1 (Macro): 0.6440
  New best model! Val loss improved from 0.7985 to 0.7742. Saving...

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/391]: Loss: 0.3183
  Epoch 14 [Batch 39/391]: Loss: 0.4930
  Epoch 14 [Batch 78/391]: Loss: 0.1799
  Epoch 14 [Batch 117/391]: Loss: 0.1350
  Epoch 14 [Batch 156/391]: Loss: 0.3074
  Epoch 14 [Batch 195/391]: Loss: 0.7347
  Epoch 14 [Batch 234/391]: Loss: 0.4012
  Epoch 14 [Batch 273/391]: Loss: 0.1877
  Epoch 14 [Batch 312/391]: Loss: 0.3471
  Epoch 14 [Batch 351/391]: Loss: 0.1291
  Epoch 14 [Batch 390/391]: Loss: 0.1480
  Epoch 14 Train Summary: Avg Loss: 0.3751, Accuracy: 0.8034
  Validation Summary: Avg Loss: 0.8085, Accuracy: 0.6366, F1 (Macro): 0.6525
Training finished in 35.35 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.7742, Accuracy: 0.6300, F1 (Macro): 0.6440
Final Best Model Stats: Acc: 0.6300, F1: 0.6440, Loss: 0.7742
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=5e-05 drop=0.0 seed=42
================================================================================
Starting experiment: resnet50__224x224__lr-5e-05__drop-0.0__seed-42
Output directory: results_rgb/resnet50__224x224__lr-5e-05__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 3124 images from processed_datasets/rgb_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 390 images from processed_datasets/rgb_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/391]: Loss: 1.1112
  Epoch 0 [Batch 39/391]: Loss: 0.9648
  Epoch 0 [Batch 78/391]: Loss: 0.9664
  Epoch 0 [Batch 117/391]: Loss: 1.1432
  Epoch 0 [Batch 156/391]: Loss: 0.8347
  Epoch 0 [Batch 195/391]: Loss: 1.2072
  Epoch 0 [Batch 234/391]: Loss: 0.9109
  Epoch 0 [Batch 273/391]: Loss: 0.8549
  Epoch 0 [Batch 312/391]: Loss: 0.6899
  Epoch 0 [Batch 351/391]: Loss: 0.7089
  Epoch 0 [Batch 390/391]: Loss: 0.7052
  Epoch 0 Train Summary: Avg Loss: 0.9569, Accuracy: 0.3301
  Validation Summary: Avg Loss: 0.9142, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from inf to 0.9142. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/391]: Loss: 1.0589
  Epoch 1 [Batch 39/391]: Loss: 0.8859
  Epoch 1 [Batch 78/391]: Loss: 0.6117
  Epoch 1 [Batch 117/391]: Loss: 0.7685
  Epoch 1 [Batch 156/391]: Loss: 1.0479
  Epoch 1 [Batch 195/391]: Loss: 0.8252
  Epoch 1 [Batch 234/391]: Loss: 0.8839
  Epoch 1 [Batch 273/391]: Loss: 1.0812
  Epoch 1 [Batch 312/391]: Loss: 0.6326
  Epoch 1 [Batch 351/391]: Loss: 0.8377
  Epoch 1 [Batch 390/391]: Loss: 0.8442
  Epoch 1 Train Summary: Avg Loss: 0.9062, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8975, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9142 to 0.8975. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/391]: Loss: 0.5313
  Epoch 2 [Batch 39/391]: Loss: 1.3520
  Epoch 2 [Batch 78/391]: Loss: 0.7774
  Epoch 2 [Batch 117/391]: Loss: 1.1548
  Epoch 2 [Batch 156/391]: Loss: 0.9026
  Epoch 2 [Batch 195/391]: Loss: 0.6374
  Epoch 2 [Batch 234/391]: Loss: 0.8280
  Epoch 2 [Batch 273/391]: Loss: 1.0663
  Epoch 2 [Batch 312/391]: Loss: 1.1073
  Epoch 2 [Batch 351/391]: Loss: 0.8097
  Epoch 2 [Batch 390/391]: Loss: 1.1896
  Epoch 2 Train Summary: Avg Loss: 0.8875, Accuracy: 0.3346
  Validation Summary: Avg Loss: 0.8817, Accuracy: 0.3417, F1 (Macro): 0.2712
  New best model! Val loss improved from 0.8975 to 0.8817. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/391]: Loss: 1.0530
  Epoch 3 [Batch 39/391]: Loss: 0.8779
  Epoch 3 [Batch 78/391]: Loss: 0.6602
  Epoch 3 [Batch 117/391]: Loss: 0.9459
  Epoch 3 [Batch 156/391]: Loss: 0.6995
  Epoch 3 [Batch 195/391]: Loss: 1.2252
  Epoch 3 [Batch 234/391]: Loss: 0.8409
  Epoch 3 [Batch 273/391]: Loss: 0.6756
  Epoch 3 [Batch 312/391]: Loss: 0.7195
  Epoch 3 [Batch 351/391]: Loss: 0.5931
  Epoch 3 [Batch 390/391]: Loss: 0.6660
  Epoch 3 Train Summary: Avg Loss: 0.8643, Accuracy: 0.3501
  Validation Summary: Avg Loss: 0.8656, Accuracy: 0.3826, F1 (Macro): 0.3479
  New best model! Val loss improved from 0.8817 to 0.8656. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/391]: Loss: 0.8149
  Epoch 4 [Batch 39/391]: Loss: 0.7311
  Epoch 4 [Batch 78/391]: Loss: 1.0152
  Epoch 4 [Batch 117/391]: Loss: 0.6071
  Epoch 4 [Batch 156/391]: Loss: 0.5344
  Epoch 4 [Batch 195/391]: Loss: 0.8130
  Epoch 4 [Batch 234/391]: Loss: 0.8184
  Epoch 4 [Batch 273/391]: Loss: 1.0121
  Epoch 4 [Batch 312/391]: Loss: 0.7078
  Epoch 4 [Batch 351/391]: Loss: 0.8795
  Epoch 4 [Batch 390/391]: Loss: 0.6480
  Epoch 4 Train Summary: Avg Loss: 0.8477, Accuracy: 0.3664
  Validation Summary: Avg Loss: 0.8625, Accuracy: 0.3803, F1 (Macro): 0.3543
  New best model! Val loss improved from 0.8656 to 0.8625. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/391]: Loss: 0.8885
  Epoch 5 [Batch 39/391]: Loss: 0.6367
  Epoch 5 [Batch 78/391]: Loss: 0.7614
  Epoch 5 [Batch 117/391]: Loss: 0.6753
  Epoch 5 [Batch 156/391]: Loss: 0.6973
  Epoch 5 [Batch 195/391]: Loss: 0.6065
  Epoch 5 [Batch 234/391]: Loss: 0.8191
  Epoch 5 [Batch 273/391]: Loss: 0.7545
  Epoch 5 [Batch 312/391]: Loss: 1.0052
  Epoch 5 [Batch 351/391]: Loss: 0.6907
  Epoch 5 [Batch 390/391]: Loss: 0.6040
  Epoch 5 Train Summary: Avg Loss: 0.8291, Accuracy: 0.3940
  Validation Summary: Avg Loss: 0.8516, Accuracy: 0.3846, F1 (Macro): 0.3594
  New best model! Val loss improved from 0.8625 to 0.8516. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/391]: Loss: 0.6107
  Epoch 6 [Batch 39/391]: Loss: 0.7698
  Epoch 6 [Batch 78/391]: Loss: 0.7358
  Epoch 6 [Batch 117/391]: Loss: 0.8110
  Epoch 6 [Batch 156/391]: Loss: 0.6623
  Epoch 6 [Batch 195/391]: Loss: 1.0408
  Epoch 6 [Batch 234/391]: Loss: 0.9408
  Epoch 6 [Batch 273/391]: Loss: 1.8005
  Epoch 6 [Batch 312/391]: Loss: 0.7285
  Epoch 6 [Batch 351/391]: Loss: 0.7291
  Epoch 6 [Batch 390/391]: Loss: 0.7609
  Epoch 6 Train Summary: Avg Loss: 0.8134, Accuracy: 0.4073
  Validation Summary: Avg Loss: 0.8341, Accuracy: 0.4076, F1 (Macro): 0.3830
  New best model! Val loss improved from 0.8516 to 0.8341. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/391]: Loss: 0.7053
  Epoch 7 [Batch 39/391]: Loss: 1.2374
  Epoch 7 [Batch 78/391]: Loss: 0.4937
  Epoch 7 [Batch 117/391]: Loss: 1.1898
  Epoch 7 [Batch 156/391]: Loss: 0.7986
  Epoch 7 [Batch 195/391]: Loss: 0.7755
  Epoch 7 [Batch 234/391]: Loss: 0.8462
  Epoch 7 [Batch 273/391]: Loss: 0.6374
  Epoch 7 [Batch 312/391]: Loss: 0.7688
  Epoch 7 [Batch 351/391]: Loss: 0.6398
  Epoch 7 [Batch 390/391]: Loss: 1.0847
  Epoch 7 Train Summary: Avg Loss: 0.7968, Accuracy: 0.4209
  Validation Summary: Avg Loss: 0.8361, Accuracy: 0.4239, F1 (Macro): 0.3979

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/391]: Loss: 0.7140
  Epoch 8 [Batch 39/391]: Loss: 0.9031
  Epoch 8 [Batch 78/391]: Loss: 0.8638
  Epoch 8 [Batch 117/391]: Loss: 0.7420
  Epoch 8 [Batch 156/391]: Loss: 0.9766
  Epoch 8 [Batch 195/391]: Loss: 0.8063
  Epoch 8 [Batch 234/391]: Loss: 0.6146
  Epoch 8 [Batch 273/391]: Loss: 0.4868
  Epoch 8 [Batch 312/391]: Loss: 1.2450
  Epoch 8 [Batch 351/391]: Loss: 0.8792
  Epoch 8 [Batch 390/391]: Loss: 0.4296
  Epoch 8 Train Summary: Avg Loss: 0.7794, Accuracy: 0.4401
  Validation Summary: Avg Loss: 0.8094, Accuracy: 0.4210, F1 (Macro): 0.3952
  New best model! Val loss improved from 0.8341 to 0.8094. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/391]: Loss: 0.7300
  Epoch 9 [Batch 39/391]: Loss: 0.7107
  Epoch 9 [Batch 78/391]: Loss: 0.4556
  Epoch 9 [Batch 117/391]: Loss: 0.9571
  Epoch 9 [Batch 156/391]: Loss: 0.9286
  Epoch 9 [Batch 195/391]: Loss: 0.8350
  Epoch 9 [Batch 234/391]: Loss: 0.4889
  Epoch 9 [Batch 273/391]: Loss: 1.0752
  Epoch 9 [Batch 312/391]: Loss: 0.7658
  Epoch 9 [Batch 351/391]: Loss: 0.4607
  Epoch 9 [Batch 390/391]: Loss: 0.5447
  Epoch 9 Train Summary: Avg Loss: 0.7515, Accuracy: 0.4607
  Validation Summary: Avg Loss: 0.8072, Accuracy: 0.4286, F1 (Macro): 0.4191
  New best model! Val loss improved from 0.8094 to 0.8072. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/391]: Loss: 0.7096
  Epoch 10 [Batch 39/391]: Loss: 0.7847
  Epoch 10 [Batch 78/391]: Loss: 0.7311
  Epoch 10 [Batch 117/391]: Loss: 1.0315
  Epoch 10 [Batch 156/391]: Loss: 0.5821
  Epoch 10 [Batch 195/391]: Loss: 0.7923
  Epoch 10 [Batch 234/391]: Loss: 0.5088
  Epoch 10 [Batch 273/391]: Loss: 0.7546
  Epoch 10 [Batch 312/391]: Loss: 0.7054
  Epoch 10 [Batch 351/391]: Loss: 0.4024
  Epoch 10 [Batch 390/391]: Loss: 0.5973
  Epoch 10 Train Summary: Avg Loss: 0.7265, Accuracy: 0.4832
  Validation Summary: Avg Loss: 0.8081, Accuracy: 0.4321, F1 (Macro): 0.4233

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/391]: Loss: 0.9115
  Epoch 11 [Batch 39/391]: Loss: 0.9621
  Epoch 11 [Batch 78/391]: Loss: 0.5702
  Epoch 11 [Batch 117/391]: Loss: 0.5341
  Epoch 11 [Batch 156/391]: Loss: 0.5634
  Epoch 11 [Batch 195/391]: Loss: 0.4817
  Epoch 11 [Batch 234/391]: Loss: 0.7080
  Epoch 11 [Batch 273/391]: Loss: 0.5094
  Epoch 11 [Batch 312/391]: Loss: 0.7334
  Epoch 11 [Batch 351/391]: Loss: 1.0988
  Epoch 11 [Batch 390/391]: Loss: 0.3901
  Epoch 11 Train Summary: Avg Loss: 0.6897, Accuracy: 0.5180
  Validation Summary: Avg Loss: 0.8134, Accuracy: 0.4936, F1 (Macro): 0.5066

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/391]: Loss: 0.5449
  Epoch 12 [Batch 39/391]: Loss: 0.9506
  Epoch 12 [Batch 78/391]: Loss: 0.8293
  Epoch 12 [Batch 117/391]: Loss: 0.8961
  Epoch 12 [Batch 156/391]: Loss: 0.7436
  Epoch 12 [Batch 195/391]: Loss: 0.9213
  Epoch 12 [Batch 234/391]: Loss: 0.5448
  Epoch 12 [Batch 273/391]: Loss: 0.6197
  Epoch 12 [Batch 312/391]: Loss: 0.5330
  Epoch 12 [Batch 351/391]: Loss: 0.6233
  Epoch 12 [Batch 390/391]: Loss: 0.6032
  Epoch 12 Train Summary: Avg Loss: 0.6664, Accuracy: 0.5522
  Validation Summary: Avg Loss: 0.8138, Accuracy: 0.5136, F1 (Macro): 0.5310

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/391]: Loss: 0.4186
  Epoch 13 [Batch 39/391]: Loss: 1.0371
  Epoch 13 [Batch 78/391]: Loss: 0.6402
  Epoch 13 [Batch 117/391]: Loss: 0.6241
  Epoch 13 [Batch 156/391]: Loss: 0.4487
  Epoch 13 [Batch 195/391]: Loss: 1.2528
  Epoch 13 [Batch 234/391]: Loss: 0.5893
  Epoch 13 [Batch 273/391]: Loss: 0.8308
  Epoch 13 [Batch 312/391]: Loss: 0.6932
  Epoch 13 [Batch 351/391]: Loss: 0.5766
  Epoch 13 [Batch 390/391]: Loss: 0.9022
  Epoch 13 Train Summary: Avg Loss: 0.6635, Accuracy: 0.5563
  Validation Summary: Avg Loss: 0.7629, Accuracy: 0.5441, F1 (Macro): 0.5668
  New best model! Val loss improved from 0.8072 to 0.7629. Saving...

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/391]: Loss: 0.6203
  Epoch 14 [Batch 39/391]: Loss: 0.8494
  Epoch 14 [Batch 78/391]: Loss: 0.6111
  Epoch 14 [Batch 117/391]: Loss: 0.6644
  Epoch 14 [Batch 156/391]: Loss: 0.5928
  Epoch 14 [Batch 195/391]: Loss: 0.5647
  Epoch 14 [Batch 234/391]: Loss: 0.6754
  Epoch 14 [Batch 273/391]: Loss: 0.6689
  Epoch 14 [Batch 312/391]: Loss: 1.1265
  Epoch 14 [Batch 351/391]: Loss: 0.4708
  Epoch 14 [Batch 390/391]: Loss: 0.5015
  Epoch 14 Train Summary: Avg Loss: 0.6217, Accuracy: 0.5920
  Validation Summary: Avg Loss: 0.8091, Accuracy: 0.5123, F1 (Macro): 0.5341
Training finished in 41.64 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.7629, Accuracy: 0.5441, F1 (Macro): 0.5668
Final Best Model Stats: Acc: 0.5441, F1: 0.5668, Loss: 0.7629
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=5e-05 drop=0.0 seed=123
================================================================================
Starting experiment: resnet50__224x224__lr-5e-05__drop-0.0__seed-123
Output directory: results_rgb/resnet50__224x224__lr-5e-05__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 3124 images from processed_datasets/rgb_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 390 images from processed_datasets/rgb_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/391]: Loss: 1.1092
  Epoch 0 [Batch 39/391]: Loss: 0.9950
  Epoch 0 [Batch 78/391]: Loss: 1.0562
  Epoch 0 [Batch 117/391]: Loss: 0.9699
  Epoch 0 [Batch 156/391]: Loss: 0.8098
  Epoch 0 [Batch 195/391]: Loss: 0.7145
  Epoch 0 [Batch 234/391]: Loss: 1.2175
  Epoch 0 [Batch 273/391]: Loss: 0.7904
  Epoch 0 [Batch 312/391]: Loss: 0.7536
  Epoch 0 [Batch 351/391]: Loss: 1.5149
  Epoch 0 [Batch 390/391]: Loss: 1.0593
  Epoch 0 Train Summary: Avg Loss: 0.9501, Accuracy: 0.3319
  Validation Summary: Avg Loss: 0.9185, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from inf to 0.9185. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/391]: Loss: 0.9102
  Epoch 1 [Batch 39/391]: Loss: 0.9289
  Epoch 1 [Batch 78/391]: Loss: 0.8053
  Epoch 1 [Batch 117/391]: Loss: 0.8273
  Epoch 1 [Batch 156/391]: Loss: 1.0583
  Epoch 1 [Batch 195/391]: Loss: 0.6713
  Epoch 1 [Batch 234/391]: Loss: 0.7002
  Epoch 1 [Batch 273/391]: Loss: 1.1796
  Epoch 1 [Batch 312/391]: Loss: 0.7572
  Epoch 1 [Batch 351/391]: Loss: 0.8295
  Epoch 1 [Batch 390/391]: Loss: 1.1251
  Epoch 1 Train Summary: Avg Loss: 0.9101, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8985, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9185 to 0.8985. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/391]: Loss: 1.0715
  Epoch 2 [Batch 39/391]: Loss: 0.8726
  Epoch 2 [Batch 78/391]: Loss: 0.7758
  Epoch 2 [Batch 117/391]: Loss: 0.8162
  Epoch 2 [Batch 156/391]: Loss: 0.8271
  Epoch 2 [Batch 195/391]: Loss: 0.5548
  Epoch 2 [Batch 234/391]: Loss: 0.6595
  Epoch 2 [Batch 273/391]: Loss: 0.7611
  Epoch 2 [Batch 312/391]: Loss: 0.6611
  Epoch 2 [Batch 351/391]: Loss: 0.9042
  Epoch 2 [Batch 390/391]: Loss: 0.5367
  Epoch 2 Train Summary: Avg Loss: 0.8940, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8847, Accuracy: 0.3289, F1 (Macro): 0.2440
  New best model! Val loss improved from 0.8985 to 0.8847. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/391]: Loss: 1.0070
  Epoch 3 [Batch 39/391]: Loss: 0.7477
  Epoch 3 [Batch 78/391]: Loss: 0.6658
  Epoch 3 [Batch 117/391]: Loss: 0.9754
  Epoch 3 [Batch 156/391]: Loss: 0.7542
  Epoch 3 [Batch 195/391]: Loss: 0.6251
  Epoch 3 [Batch 234/391]: Loss: 0.8110
  Epoch 3 [Batch 273/391]: Loss: 1.2835
  Epoch 3 [Batch 312/391]: Loss: 0.7414
  Epoch 3 [Batch 351/391]: Loss: 1.1781
  Epoch 3 [Batch 390/391]: Loss: 1.2598
  Epoch 3 Train Summary: Avg Loss: 0.8746, Accuracy: 0.3471
  Validation Summary: Avg Loss: 0.8856, Accuracy: 0.3685, F1 (Macro): 0.3264

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/391]: Loss: 0.9431
  Epoch 4 [Batch 39/391]: Loss: 0.8446
  Epoch 4 [Batch 78/391]: Loss: 0.7719
  Epoch 4 [Batch 117/391]: Loss: 1.3842
  Epoch 4 [Batch 156/391]: Loss: 1.0480
  Epoch 4 [Batch 195/391]: Loss: 1.3471
  Epoch 4 [Batch 234/391]: Loss: 0.8069
  Epoch 4 [Batch 273/391]: Loss: 1.2244
  Epoch 4 [Batch 312/391]: Loss: 1.0266
  Epoch 4 [Batch 351/391]: Loss: 0.9224
  Epoch 4 [Batch 390/391]: Loss: 0.5908
  Epoch 4 Train Summary: Avg Loss: 0.8542, Accuracy: 0.3673
  Validation Summary: Avg Loss: 0.8727, Accuracy: 0.3938, F1 (Macro): 0.3657
  New best model! Val loss improved from 0.8847 to 0.8727. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/391]: Loss: 1.4605
  Epoch 5 [Batch 39/391]: Loss: 0.8813
  Epoch 5 [Batch 78/391]: Loss: 0.5381
  Epoch 5 [Batch 117/391]: Loss: 0.6205
  Epoch 5 [Batch 156/391]: Loss: 0.7560
  Epoch 5 [Batch 195/391]: Loss: 1.0638
  Epoch 5 [Batch 234/391]: Loss: 0.8731
  Epoch 5 [Batch 273/391]: Loss: 0.7317
  Epoch 5 [Batch 312/391]: Loss: 1.1487
  Epoch 5 [Batch 351/391]: Loss: 0.5415
  Epoch 5 [Batch 390/391]: Loss: 1.0941
  Epoch 5 Train Summary: Avg Loss: 0.8383, Accuracy: 0.3862
  Validation Summary: Avg Loss: 0.8555, Accuracy: 0.4134, F1 (Macro): 0.3893
  New best model! Val loss improved from 0.8727 to 0.8555. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/391]: Loss: 0.7883
  Epoch 6 [Batch 39/391]: Loss: 0.7687
  Epoch 6 [Batch 78/391]: Loss: 0.9311
  Epoch 6 [Batch 117/391]: Loss: 0.9405
  Epoch 6 [Batch 156/391]: Loss: 0.8890
  Epoch 6 [Batch 195/391]: Loss: 0.9447
  Epoch 6 [Batch 234/391]: Loss: 0.5839
  Epoch 6 [Batch 273/391]: Loss: 0.7889
  Epoch 6 [Batch 312/391]: Loss: 0.9254
  Epoch 6 [Batch 351/391]: Loss: 0.8136
  Epoch 6 [Batch 390/391]: Loss: 0.5787
  Epoch 6 Train Summary: Avg Loss: 0.8198, Accuracy: 0.4070
  Validation Summary: Avg Loss: 0.8537, Accuracy: 0.4104, F1 (Macro): 0.3865
  New best model! Val loss improved from 0.8555 to 0.8537. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/391]: Loss: 1.0166
  Epoch 7 [Batch 39/391]: Loss: 1.2505
  Epoch 7 [Batch 78/391]: Loss: 0.6779
  Epoch 7 [Batch 117/391]: Loss: 0.7927
  Epoch 7 [Batch 156/391]: Loss: 0.7880
  Epoch 7 [Batch 195/391]: Loss: 0.6918
  Epoch 7 [Batch 234/391]: Loss: 0.6857
  Epoch 7 [Batch 273/391]: Loss: 0.5272
  Epoch 7 [Batch 312/391]: Loss: 1.0869
  Epoch 7 [Batch 351/391]: Loss: 0.7046
  Epoch 7 [Batch 390/391]: Loss: 2.0368
  Epoch 7 Train Summary: Avg Loss: 0.8029, Accuracy: 0.4205
  Validation Summary: Avg Loss: 0.8534, Accuracy: 0.4022, F1 (Macro): 0.3765
  New best model! Val loss improved from 0.8537 to 0.8534. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/391]: Loss: 0.7434
  Epoch 8 [Batch 39/391]: Loss: 0.6582
  Epoch 8 [Batch 78/391]: Loss: 1.3219
  Epoch 8 [Batch 117/391]: Loss: 0.8671
  Epoch 8 [Batch 156/391]: Loss: 0.5810
  Epoch 8 [Batch 195/391]: Loss: 1.1961
  Epoch 8 [Batch 234/391]: Loss: 0.5541
  Epoch 8 [Batch 273/391]: Loss: 0.5536
  Epoch 8 [Batch 312/391]: Loss: 0.7918
  Epoch 8 [Batch 351/391]: Loss: 0.5797
  Epoch 8 [Batch 390/391]: Loss: 1.4554
  Epoch 8 Train Summary: Avg Loss: 0.7729, Accuracy: 0.4409
  Validation Summary: Avg Loss: 0.8360, Accuracy: 0.4216, F1 (Macro): 0.3983
  New best model! Val loss improved from 0.8534 to 0.8360. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/391]: Loss: 0.4977
  Epoch 9 [Batch 39/391]: Loss: 1.0866
  Epoch 9 [Batch 78/391]: Loss: 0.5510
  Epoch 9 [Batch 117/391]: Loss: 0.5561
  Epoch 9 [Batch 156/391]: Loss: 0.7072
  Epoch 9 [Batch 195/391]: Loss: 0.7058
  Epoch 9 [Batch 234/391]: Loss: 0.6041
  Epoch 9 [Batch 273/391]: Loss: 0.5457
  Epoch 9 [Batch 312/391]: Loss: 0.9114
  Epoch 9 [Batch 351/391]: Loss: 0.5541
  Epoch 9 [Batch 390/391]: Loss: 0.6324
  Epoch 9 Train Summary: Avg Loss: 0.7586, Accuracy: 0.4533
  Validation Summary: Avg Loss: 0.8279, Accuracy: 0.4538, F1 (Macro): 0.4398
  New best model! Val loss improved from 0.8360 to 0.8279. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/391]: Loss: 0.7137
  Epoch 10 [Batch 39/391]: Loss: 1.0428
  Epoch 10 [Batch 78/391]: Loss: 0.7798
  Epoch 10 [Batch 117/391]: Loss: 1.0331
  Epoch 10 [Batch 156/391]: Loss: 0.8859
  Epoch 10 [Batch 195/391]: Loss: 0.5348
  Epoch 10 [Batch 234/391]: Loss: 0.8282
  Epoch 10 [Batch 273/391]: Loss: 0.5586
  Epoch 10 [Batch 312/391]: Loss: 0.9355
  Epoch 10 [Batch 351/391]: Loss: 0.8815
  Epoch 10 [Batch 390/391]: Loss: 1.2875
  Epoch 10 Train Summary: Avg Loss: 0.7461, Accuracy: 0.4675
  Validation Summary: Avg Loss: 0.8222, Accuracy: 0.4428, F1 (Macro): 0.4186
  New best model! Val loss improved from 0.8279 to 0.8222. Saving...

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/391]: Loss: 0.7143
  Epoch 11 [Batch 39/391]: Loss: 0.5637
  Epoch 11 [Batch 78/391]: Loss: 0.4532
  Epoch 11 [Batch 117/391]: Loss: 0.8428
  Epoch 11 [Batch 156/391]: Loss: 0.8796
  Epoch 11 [Batch 195/391]: Loss: 0.4772
  Epoch 11 [Batch 234/391]: Loss: 0.7652
  Epoch 11 [Batch 273/391]: Loss: 0.8272
  Epoch 11 [Batch 312/391]: Loss: 0.6049
  Epoch 11 [Batch 351/391]: Loss: 0.4433
  Epoch 11 [Batch 390/391]: Loss: 1.5994
  Epoch 11 Train Summary: Avg Loss: 0.7053, Accuracy: 0.4852
  Validation Summary: Avg Loss: 0.8307, Accuracy: 0.4571, F1 (Macro): 0.4470

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/391]: Loss: 0.3311
  Epoch 12 [Batch 39/391]: Loss: 0.7054
  Epoch 12 [Batch 78/391]: Loss: 0.5270
  Epoch 12 [Batch 117/391]: Loss: 0.6531
  Epoch 12 [Batch 156/391]: Loss: 0.7697
  Epoch 12 [Batch 195/391]: Loss: 0.7064
  Epoch 12 [Batch 234/391]: Loss: 0.6492
  Epoch 12 [Batch 273/391]: Loss: 0.4137
  Epoch 12 [Batch 312/391]: Loss: 0.5971
  Epoch 12 [Batch 351/391]: Loss: 1.6425
  Epoch 12 [Batch 390/391]: Loss: 1.1059
  Epoch 12 Train Summary: Avg Loss: 0.6876, Accuracy: 0.5142
  Validation Summary: Avg Loss: 0.8288, Accuracy: 0.4987, F1 (Macro): 0.5073

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/391]: Loss: 0.6148
  Epoch 13 [Batch 39/391]: Loss: 0.9397
  Epoch 13 [Batch 78/391]: Loss: 0.9093
  Epoch 13 [Batch 117/391]: Loss: 0.7819
  Epoch 13 [Batch 156/391]: Loss: 0.6391
  Epoch 13 [Batch 195/391]: Loss: 0.4973
  Epoch 13 [Batch 234/391]: Loss: 0.6439
  Epoch 13 [Batch 273/391]: Loss: 0.5349
  Epoch 13 [Batch 312/391]: Loss: 0.4206
  Epoch 13 [Batch 351/391]: Loss: 0.7924
  Epoch 13 [Batch 390/391]: Loss: 0.6189
  Epoch 13 Train Summary: Avg Loss: 0.6637, Accuracy: 0.5419
  Validation Summary: Avg Loss: 0.8093, Accuracy: 0.5133, F1 (Macro): 0.5249
  New best model! Val loss improved from 0.8222 to 0.8093. Saving...

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/391]: Loss: 0.4218
  Epoch 14 [Batch 39/391]: Loss: 0.5232
  Epoch 14 [Batch 78/391]: Loss: 0.6605
  Epoch 14 [Batch 117/391]: Loss: 0.5200
  Epoch 14 [Batch 156/391]: Loss: 0.6530
  Epoch 14 [Batch 195/391]: Loss: 1.4830
  Epoch 14 [Batch 234/391]: Loss: 0.8433
  Epoch 14 [Batch 273/391]: Loss: 0.6921
  Epoch 14 [Batch 312/391]: Loss: 1.1579
  Epoch 14 [Batch 351/391]: Loss: 0.3957
  Epoch 14 [Batch 390/391]: Loss: 0.5038
  Epoch 14 Train Summary: Avg Loss: 0.6420, Accuracy: 0.5843
  Validation Summary: Avg Loss: 0.8089, Accuracy: 0.5305, F1 (Macro): 0.5457
  New best model! Val loss improved from 0.8093 to 0.8089. Saving...
Training finished in 77.47 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.8089, Accuracy: 0.5305, F1 (Macro): 0.5457
Final Best Model Stats: Acc: 0.5305, F1: 0.5457, Loss: 0.8089
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=5e-05 drop=0.0 seed=999
================================================================================
Starting experiment: resnet50__224x224__lr-5e-05__drop-0.0__seed-999
Output directory: results_rgb/resnet50__224x224__lr-5e-05__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 3124 images from processed_datasets/rgb_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 390 images from processed_datasets/rgb_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/391]: Loss: 1.1444
  Epoch 0 [Batch 39/391]: Loss: 1.0886
  Epoch 0 [Batch 78/391]: Loss: 0.8882
  Epoch 0 [Batch 117/391]: Loss: 0.9214
  Epoch 0 [Batch 156/391]: Loss: 0.9864
  Epoch 0 [Batch 195/391]: Loss: 0.9009
  Epoch 0 [Batch 234/391]: Loss: 1.0722
  Epoch 0 [Batch 273/391]: Loss: 1.1424
  Epoch 0 [Batch 312/391]: Loss: 1.0888
  Epoch 0 [Batch 351/391]: Loss: 0.5657
  Epoch 0 [Batch 390/391]: Loss: 0.7108
  Epoch 0 Train Summary: Avg Loss: 0.9599, Accuracy: 0.3284
  Validation Summary: Avg Loss: 0.9165, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from inf to 0.9165. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/391]: Loss: 1.1640
  Epoch 1 [Batch 39/391]: Loss: 1.0710
  Epoch 1 [Batch 78/391]: Loss: 0.8654
  Epoch 1 [Batch 117/391]: Loss: 0.7792
  Epoch 1 [Batch 156/391]: Loss: 0.7685
  Epoch 1 [Batch 195/391]: Loss: 1.0590
  Epoch 1 [Batch 234/391]: Loss: 0.6324
  Epoch 1 [Batch 273/391]: Loss: 0.8824
  Epoch 1 [Batch 312/391]: Loss: 0.8608
  Epoch 1 [Batch 351/391]: Loss: 1.1440
  Epoch 1 [Batch 390/391]: Loss: 0.8426
  Epoch 1 Train Summary: Avg Loss: 0.9118, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9037, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9165 to 0.9037. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/391]: Loss: 0.8190
  Epoch 2 [Batch 39/391]: Loss: 1.0074
  Epoch 2 [Batch 78/391]: Loss: 0.8110
  Epoch 2 [Batch 117/391]: Loss: 1.0389
  Epoch 2 [Batch 156/391]: Loss: 1.0023
  Epoch 2 [Batch 195/391]: Loss: 0.9113
  Epoch 2 [Batch 234/391]: Loss: 0.7570
  Epoch 2 [Batch 273/391]: Loss: 0.6831
  Epoch 2 [Batch 312/391]: Loss: 0.8586
  Epoch 2 [Batch 351/391]: Loss: 1.0827
  Epoch 2 [Batch 390/391]: Loss: 0.9596
  Epoch 2 Train Summary: Avg Loss: 0.8940, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8935, Accuracy: 0.3333, F1 (Macro): 0.2457
  New best model! Val loss improved from 0.9037 to 0.8935. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/391]: Loss: 0.9784
  Epoch 3 [Batch 39/391]: Loss: 0.9496
  Epoch 3 [Batch 78/391]: Loss: 0.9094
  Epoch 3 [Batch 117/391]: Loss: 1.0097
  Epoch 3 [Batch 156/391]: Loss: 0.9444
  Epoch 3 [Batch 195/391]: Loss: 1.0340
  Epoch 3 [Batch 234/391]: Loss: 0.8701
  Epoch 3 [Batch 273/391]: Loss: 0.6721
  Epoch 3 [Batch 312/391]: Loss: 0.9312
  Epoch 3 [Batch 351/391]: Loss: 0.6891
  Epoch 3 [Batch 390/391]: Loss: 0.9030
  Epoch 3 Train Summary: Avg Loss: 0.8730, Accuracy: 0.3374
  Validation Summary: Avg Loss: 0.9611, Accuracy: 0.3558, F1 (Macro): 0.3031

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/391]: Loss: 0.7898
  Epoch 4 [Batch 39/391]: Loss: 0.8177
  Epoch 4 [Batch 78/391]: Loss: 0.7813
  Epoch 4 [Batch 117/391]: Loss: 1.1226
  Epoch 4 [Batch 156/391]: Loss: 1.2104
  Epoch 4 [Batch 195/391]: Loss: 0.8029
  Epoch 4 [Batch 234/391]: Loss: 0.7912
  Epoch 4 [Batch 273/391]: Loss: 1.0859
  Epoch 4 [Batch 312/391]: Loss: 0.7639
  Epoch 4 [Batch 351/391]: Loss: 0.6086
  Epoch 4 [Batch 390/391]: Loss: 0.5078
  Epoch 4 Train Summary: Avg Loss: 0.8618, Accuracy: 0.3635
  Validation Summary: Avg Loss: 0.8968, Accuracy: 0.3739, F1 (Macro): 0.3383

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/391]: Loss: 0.6161
  Epoch 5 [Batch 39/391]: Loss: 0.6546
  Epoch 5 [Batch 78/391]: Loss: 0.7612
  Epoch 5 [Batch 117/391]: Loss: 0.9608
  Epoch 5 [Batch 156/391]: Loss: 1.3320
  Epoch 5 [Batch 195/391]: Loss: 0.6505
  Epoch 5 [Batch 234/391]: Loss: 0.7166
  Epoch 5 [Batch 273/391]: Loss: 0.5282
  Epoch 5 [Batch 312/391]: Loss: 0.7608
  Epoch 5 [Batch 351/391]: Loss: 1.3683
  Epoch 5 [Batch 390/391]: Loss: 0.7314
  Epoch 5 Train Summary: Avg Loss: 0.8392, Accuracy: 0.3760
  Validation Summary: Avg Loss: 0.8924, Accuracy: 0.3925, F1 (Macro): 0.3615
  New best model! Val loss improved from 0.8935 to 0.8924. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/391]: Loss: 1.0605
  Epoch 6 [Batch 39/391]: Loss: 0.6427
  Epoch 6 [Batch 78/391]: Loss: 0.8198
  Epoch 6 [Batch 117/391]: Loss: 0.9995
  Epoch 6 [Batch 156/391]: Loss: 0.7410
  Epoch 6 [Batch 195/391]: Loss: 0.7442
  Epoch 6 [Batch 234/391]: Loss: 0.7303
  Epoch 6 [Batch 273/391]: Loss: 0.4952
  Epoch 6 [Batch 312/391]: Loss: 0.6798
  Epoch 6 [Batch 351/391]: Loss: 1.2301
  Epoch 6 [Batch 390/391]: Loss: 1.0445
  Epoch 6 Train Summary: Avg Loss: 0.8169, Accuracy: 0.3951
  Validation Summary: Avg Loss: 0.8610, Accuracy: 0.4356, F1 (Macro): 0.4100
  New best model! Val loss improved from 0.8924 to 0.8610. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/391]: Loss: 0.6410
  Epoch 7 [Batch 39/391]: Loss: 0.6982
  Epoch 7 [Batch 78/391]: Loss: 1.0305
  Epoch 7 [Batch 117/391]: Loss: 0.7550
  Epoch 7 [Batch 156/391]: Loss: 0.5320
  Epoch 7 [Batch 195/391]: Loss: 0.7125
  Epoch 7 [Batch 234/391]: Loss: 0.8463
  Epoch 7 [Batch 273/391]: Loss: 0.9973
  Epoch 7 [Batch 312/391]: Loss: 0.6223
  Epoch 7 [Batch 351/391]: Loss: 0.6572
  Epoch 7 [Batch 390/391]: Loss: 0.7370
  Epoch 7 Train Summary: Avg Loss: 0.7994, Accuracy: 0.4251
  Validation Summary: Avg Loss: 0.8498, Accuracy: 0.4314, F1 (Macro): 0.4062
  New best model! Val loss improved from 0.8610 to 0.8498. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/391]: Loss: 0.8123
  Epoch 8 [Batch 39/391]: Loss: 0.6488
  Epoch 8 [Batch 78/391]: Loss: 0.5706
  Epoch 8 [Batch 117/391]: Loss: 0.8532
  Epoch 8 [Batch 156/391]: Loss: 0.6545
  Epoch 8 [Batch 195/391]: Loss: 0.7587
  Epoch 8 [Batch 234/391]: Loss: 0.7725
  Epoch 8 [Batch 273/391]: Loss: 1.0056
  Epoch 8 [Batch 312/391]: Loss: 0.4850
  Epoch 8 [Batch 351/391]: Loss: 0.8770
  Epoch 8 [Batch 390/391]: Loss: 1.0958
  Epoch 8 Train Summary: Avg Loss: 0.7813, Accuracy: 0.4308
  Validation Summary: Avg Loss: 0.8336, Accuracy: 0.4246, F1 (Macro): 0.4004
  New best model! Val loss improved from 0.8498 to 0.8336. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/391]: Loss: 0.7976
  Epoch 9 [Batch 39/391]: Loss: 0.7528
  Epoch 9 [Batch 78/391]: Loss: 0.4673
  Epoch 9 [Batch 117/391]: Loss: 0.4924
  Epoch 9 [Batch 156/391]: Loss: 0.5695
  Epoch 9 [Batch 195/391]: Loss: 0.7740
  Epoch 9 [Batch 234/391]: Loss: 0.8719
  Epoch 9 [Batch 273/391]: Loss: 0.6187
  Epoch 9 [Batch 312/391]: Loss: 0.5899
  Epoch 9 [Batch 351/391]: Loss: 1.4592
  Epoch 9 [Batch 390/391]: Loss: 0.8036
  Epoch 9 Train Summary: Avg Loss: 0.7551, Accuracy: 0.4482
  Validation Summary: Avg Loss: 0.8222, Accuracy: 0.4526, F1 (Macro): 0.4252
  New best model! Val loss improved from 0.8336 to 0.8222. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/391]: Loss: 0.7039
  Epoch 10 [Batch 39/391]: Loss: 0.8898
  Epoch 10 [Batch 78/391]: Loss: 0.4376
  Epoch 10 [Batch 117/391]: Loss: 1.6254
  Epoch 10 [Batch 156/391]: Loss: 0.7610
  Epoch 10 [Batch 195/391]: Loss: 0.7093
  Epoch 10 [Batch 234/391]: Loss: 0.8777
  Epoch 10 [Batch 273/391]: Loss: 0.9688
  Epoch 10 [Batch 312/391]: Loss: 0.7482
  Epoch 10 [Batch 351/391]: Loss: 0.8690
  Epoch 10 [Batch 390/391]: Loss: 0.6624
  Epoch 10 Train Summary: Avg Loss: 0.7316, Accuracy: 0.4745
  Validation Summary: Avg Loss: 0.8219, Accuracy: 0.4672, F1 (Macro): 0.4695
  New best model! Val loss improved from 0.8222 to 0.8219. Saving...

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/391]: Loss: 0.8159
  Epoch 11 [Batch 39/391]: Loss: 0.6252
  Epoch 11 [Batch 78/391]: Loss: 0.6027
  Epoch 11 [Batch 117/391]: Loss: 0.5800
  Epoch 11 [Batch 156/391]: Loss: 0.6063
  Epoch 11 [Batch 195/391]: Loss: 0.7760
  Epoch 11 [Batch 234/391]: Loss: 0.6124
  Epoch 11 [Batch 273/391]: Loss: 0.9479
  Epoch 11 [Batch 312/391]: Loss: 0.4838
  Epoch 11 [Batch 351/391]: Loss: 0.6924
  Epoch 11 [Batch 390/391]: Loss: 1.2687
  Epoch 11 Train Summary: Avg Loss: 0.7103, Accuracy: 0.5142
  Validation Summary: Avg Loss: 0.8402, Accuracy: 0.4732, F1 (Macro): 0.4825

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/391]: Loss: 0.5241
  Epoch 12 [Batch 39/391]: Loss: 0.5762
  Epoch 12 [Batch 78/391]: Loss: 0.4430
  Epoch 12 [Batch 117/391]: Loss: 0.5470
  Epoch 12 [Batch 156/391]: Loss: 0.7491
  Epoch 12 [Batch 195/391]: Loss: 0.5620
  Epoch 12 [Batch 234/391]: Loss: 0.5762
  Epoch 12 [Batch 273/391]: Loss: 0.6274
  Epoch 12 [Batch 312/391]: Loss: 0.4682
  Epoch 12 [Batch 351/391]: Loss: 0.6334
  Epoch 12 [Batch 390/391]: Loss: 0.9825
  Epoch 12 Train Summary: Avg Loss: 0.6881, Accuracy: 0.5466
  Validation Summary: Avg Loss: 0.8319, Accuracy: 0.4697, F1 (Macro): 0.4840

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/391]: Loss: 0.7931
  Epoch 13 [Batch 39/391]: Loss: 0.4906
  Epoch 13 [Batch 78/391]: Loss: 0.6911
  Epoch 13 [Batch 117/391]: Loss: 0.6525
  Epoch 13 [Batch 156/391]: Loss: 0.5183
  Epoch 13 [Batch 195/391]: Loss: 1.2548
  Epoch 13 [Batch 234/391]: Loss: 0.7282
  Epoch 13 [Batch 273/391]: Loss: 0.5501
  Epoch 13 [Batch 312/391]: Loss: 0.6964
  Epoch 13 [Batch 351/391]: Loss: 0.5169
  Epoch 13 [Batch 390/391]: Loss: 0.7922
  Epoch 13 Train Summary: Avg Loss: 0.6575, Accuracy: 0.5764
  Validation Summary: Avg Loss: 0.8027, Accuracy: 0.5291, F1 (Macro): 0.5426
  New best model! Val loss improved from 0.8219 to 0.8027. Saving...

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/391]: Loss: 0.6402
  Epoch 14 [Batch 39/391]: Loss: 0.6698
  Epoch 14 [Batch 78/391]: Loss: 0.5934
  Epoch 14 [Batch 117/391]: Loss: 0.7484
  Epoch 14 [Batch 156/391]: Loss: 0.4000
  Epoch 14 [Batch 195/391]: Loss: 0.6872
  Epoch 14 [Batch 234/391]: Loss: 0.6607
  Epoch 14 [Batch 273/391]: Loss: 0.3030
  Epoch 14 [Batch 312/391]: Loss: 0.5646
  Epoch 14 [Batch 351/391]: Loss: 0.4562
  Epoch 14 [Batch 390/391]: Loss: 0.7157
  Epoch 14 Train Summary: Avg Loss: 0.6294, Accuracy: 0.6078
  Validation Summary: Avg Loss: 0.8035, Accuracy: 0.5281, F1 (Macro): 0.5454
Training finished in 30.94 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.8027, Accuracy: 0.5291, F1 (Macro): 0.5426
Final Best Model Stats: Acc: 0.5291, F1: 0.5426, Loss: 0.8027
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=1e-05 drop=0.0 seed=42
================================================================================
Starting experiment: resnet50__224x224__lr-1e-05__drop-0.0__seed-42
Output directory: results_rgb/resnet50__224x224__lr-1e-05__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 3124 images from processed_datasets/rgb_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 390 images from processed_datasets/rgb_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/391]: Loss: 1.1112
  Epoch 0 [Batch 39/391]: Loss: 1.1096
  Epoch 0 [Batch 78/391]: Loss: 1.0878
  Epoch 0 [Batch 117/391]: Loss: 1.0893
  Epoch 0 [Batch 156/391]: Loss: 1.0303
  Epoch 0 [Batch 195/391]: Loss: 1.1268
  Epoch 0 [Batch 234/391]: Loss: 1.0425
  Epoch 0 [Batch 273/391]: Loss: 0.9915
  Epoch 0 [Batch 312/391]: Loss: 0.9136
  Epoch 0 [Batch 351/391]: Loss: 0.9411
  Epoch 0 [Batch 390/391]: Loss: 0.8914
  Epoch 0 Train Summary: Avg Loss: 1.0457, Accuracy: 0.3368
  Validation Summary: Avg Loss: 0.9974, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from inf to 0.9974. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/391]: Loss: 1.0901
  Epoch 1 [Batch 39/391]: Loss: 0.9891
  Epoch 1 [Batch 78/391]: Loss: 0.8056
  Epoch 1 [Batch 117/391]: Loss: 0.9045
  Epoch 1 [Batch 156/391]: Loss: 0.9755
  Epoch 1 [Batch 195/391]: Loss: 0.9345
  Epoch 1 [Batch 234/391]: Loss: 0.9409
  Epoch 1 [Batch 273/391]: Loss: 1.0563
  Epoch 1 [Batch 312/391]: Loss: 0.7535
  Epoch 1 [Batch 351/391]: Loss: 0.8954
  Epoch 1 [Batch 390/391]: Loss: 0.8963
  Epoch 1 Train Summary: Avg Loss: 0.9585, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9492, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9974 to 0.9492. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/391]: Loss: 0.6437
  Epoch 2 [Batch 39/391]: Loss: 1.2702
  Epoch 2 [Batch 78/391]: Loss: 0.8812
  Epoch 2 [Batch 117/391]: Loss: 1.0967
  Epoch 2 [Batch 156/391]: Loss: 0.9451
  Epoch 2 [Batch 195/391]: Loss: 0.7044
  Epoch 2 [Batch 234/391]: Loss: 0.9267
  Epoch 2 [Batch 273/391]: Loss: 1.0293
  Epoch 2 [Batch 312/391]: Loss: 1.0303
  Epoch 2 [Batch 351/391]: Loss: 0.8215
  Epoch 2 [Batch 390/391]: Loss: 1.2740
  Epoch 2 Train Summary: Avg Loss: 0.9306, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9260, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9492 to 0.9260. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/391]: Loss: 1.0399
  Epoch 3 [Batch 39/391]: Loss: 1.0007
  Epoch 3 [Batch 78/391]: Loss: 0.8007
  Epoch 3 [Batch 117/391]: Loss: 1.0005
  Epoch 3 [Batch 156/391]: Loss: 0.7919
  Epoch 3 [Batch 195/391]: Loss: 1.1011
  Epoch 3 [Batch 234/391]: Loss: 0.7929
  Epoch 3 [Batch 273/391]: Loss: 0.8072
  Epoch 3 [Batch 312/391]: Loss: 0.7797
  Epoch 3 [Batch 351/391]: Loss: 0.7555
  Epoch 3 [Batch 390/391]: Loss: 0.6892
  Epoch 3 Train Summary: Avg Loss: 0.9199, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9260, Accuracy: 0.3333, F1 (Macro): 0.2453

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/391]: Loss: 0.9492
  Epoch 4 [Batch 39/391]: Loss: 0.8686
  Epoch 4 [Batch 78/391]: Loss: 0.9142
  Epoch 4 [Batch 117/391]: Loss: 0.7617
  Epoch 4 [Batch 156/391]: Loss: 0.5933
  Epoch 4 [Batch 195/391]: Loss: 0.8489
  Epoch 4 [Batch 234/391]: Loss: 0.8114
  Epoch 4 [Batch 273/391]: Loss: 0.9876
  Epoch 4 [Batch 312/391]: Loss: 0.6859
  Epoch 4 [Batch 351/391]: Loss: 0.9217
  Epoch 4 [Batch 390/391]: Loss: 0.7357
  Epoch 4 Train Summary: Avg Loss: 0.9159, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9295, Accuracy: 0.3333, F1 (Macro): 0.2453

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/391]: Loss: 1.0105
  Epoch 5 [Batch 39/391]: Loss: 0.7998
  Epoch 5 [Batch 78/391]: Loss: 0.8287
  Epoch 5 [Batch 117/391]: Loss: 0.8809
  Epoch 5 [Batch 156/391]: Loss: 0.7533
  Epoch 5 [Batch 195/391]: Loss: 0.6579
  Epoch 5 [Batch 234/391]: Loss: 0.9100
  Epoch 5 [Batch 273/391]: Loss: 0.9768
  Epoch 5 [Batch 312/391]: Loss: 1.1739
  Epoch 5 [Batch 351/391]: Loss: 0.7870
  Epoch 5 [Batch 390/391]: Loss: 0.8045
  Epoch 5 Train Summary: Avg Loss: 0.9129, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9140, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9260 to 0.9140. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/391]: Loss: 0.7398
  Epoch 6 [Batch 39/391]: Loss: 0.9242
  Epoch 6 [Batch 78/391]: Loss: 0.9181
  Epoch 6 [Batch 117/391]: Loss: 0.7964
  Epoch 6 [Batch 156/391]: Loss: 0.8334
  Epoch 6 [Batch 195/391]: Loss: 1.0845
  Epoch 6 [Batch 234/391]: Loss: 0.8114
  Epoch 6 [Batch 273/391]: Loss: 1.5186
  Epoch 6 [Batch 312/391]: Loss: 0.7898
  Epoch 6 [Batch 351/391]: Loss: 0.7245
  Epoch 6 [Batch 390/391]: Loss: 0.7497
  Epoch 6 Train Summary: Avg Loss: 0.9056, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9102, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9140 to 0.9102. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/391]: Loss: 0.8806
  Epoch 7 [Batch 39/391]: Loss: 1.2006
  Epoch 7 [Batch 78/391]: Loss: 0.6207
  Epoch 7 [Batch 117/391]: Loss: 1.2282
  Epoch 7 [Batch 156/391]: Loss: 0.9335
  Epoch 7 [Batch 195/391]: Loss: 1.0847
  Epoch 7 [Batch 234/391]: Loss: 0.8310
  Epoch 7 [Batch 273/391]: Loss: 0.7047
  Epoch 7 [Batch 312/391]: Loss: 0.8160
  Epoch 7 [Batch 351/391]: Loss: 0.9826
  Epoch 7 [Batch 390/391]: Loss: 0.7795
  Epoch 7 Train Summary: Avg Loss: 0.9046, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9108, Accuracy: 0.3333, F1 (Macro): 0.2453

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/391]: Loss: 0.9157
  Epoch 8 [Batch 39/391]: Loss: 1.0185
  Epoch 8 [Batch 78/391]: Loss: 1.0484
  Epoch 8 [Batch 117/391]: Loss: 1.0529
  Epoch 8 [Batch 156/391]: Loss: 1.1102
  Epoch 8 [Batch 195/391]: Loss: 0.8707
  Epoch 8 [Batch 234/391]: Loss: 0.6595
  Epoch 8 [Batch 273/391]: Loss: 0.5933
  Epoch 8 [Batch 312/391]: Loss: 1.0813
  Epoch 8 [Batch 351/391]: Loss: 0.9949
  Epoch 8 [Batch 390/391]: Loss: 0.7069
  Epoch 8 Train Summary: Avg Loss: 0.9025, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9028, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9102 to 0.9028. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/391]: Loss: 0.7963
  Epoch 9 [Batch 39/391]: Loss: 0.8165
  Epoch 9 [Batch 78/391]: Loss: 0.7258
  Epoch 9 [Batch 117/391]: Loss: 1.0250
  Epoch 9 [Batch 156/391]: Loss: 0.9504
  Epoch 9 [Batch 195/391]: Loss: 0.9217
  Epoch 9 [Batch 234/391]: Loss: 0.6380
  Epoch 9 [Batch 273/391]: Loss: 1.0839
  Epoch 9 [Batch 312/391]: Loss: 0.8931
  Epoch 9 [Batch 351/391]: Loss: 0.5596
  Epoch 9 [Batch 390/391]: Loss: 0.6551
  Epoch 9 Train Summary: Avg Loss: 0.8958, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8997, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9028 to 0.8997. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/391]: Loss: 0.8189
  Epoch 10 [Batch 39/391]: Loss: 1.0795
  Epoch 10 [Batch 78/391]: Loss: 1.0303
  Epoch 10 [Batch 117/391]: Loss: 1.0037
  Epoch 10 [Batch 156/391]: Loss: 0.6918
  Epoch 10 [Batch 195/391]: Loss: 1.0255
  Epoch 10 [Batch 234/391]: Loss: 0.7881
  Epoch 10 [Batch 273/391]: Loss: 0.9161
  Epoch 10 [Batch 312/391]: Loss: 0.8956
  Epoch 10 [Batch 351/391]: Loss: 0.6692
  Epoch 10 [Batch 390/391]: Loss: 1.0010
  Epoch 10 Train Summary: Avg Loss: 0.8963, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8969, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.8997 to 0.8969. Saving...

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/391]: Loss: 1.0386
  Epoch 11 [Batch 39/391]: Loss: 1.0542
  Epoch 11 [Batch 78/391]: Loss: 0.7439
  Epoch 11 [Batch 117/391]: Loss: 0.9576
  Epoch 11 [Batch 156/391]: Loss: 0.7183
  Epoch 11 [Batch 195/391]: Loss: 0.6716
  Epoch 11 [Batch 234/391]: Loss: 0.7053
  Epoch 11 [Batch 273/391]: Loss: 0.7780
  Epoch 11 [Batch 312/391]: Loss: 1.1232
  Epoch 11 [Batch 351/391]: Loss: 1.1262
  Epoch 11 [Batch 390/391]: Loss: 0.5245
  Epoch 11 Train Summary: Avg Loss: 0.8876, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9008, Accuracy: 0.3333, F1 (Macro): 0.2453

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/391]: Loss: 0.5624
  Epoch 12 [Batch 39/391]: Loss: 1.0357
  Epoch 12 [Batch 78/391]: Loss: 0.9619
  Epoch 12 [Batch 117/391]: Loss: 0.9494
  Epoch 12 [Batch 156/391]: Loss: 1.2510
  Epoch 12 [Batch 195/391]: Loss: 1.3423
  Epoch 12 [Batch 234/391]: Loss: 0.5892
  Epoch 12 [Batch 273/391]: Loss: 0.6796
  Epoch 12 [Batch 312/391]: Loss: 0.9877
  Epoch 12 [Batch 351/391]: Loss: 0.6895
  Epoch 12 [Batch 390/391]: Loss: 0.6535
  Epoch 12 Train Summary: Avg Loss: 0.8828, Accuracy: 0.3341
  Validation Summary: Avg Loss: 0.8902, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.8969 to 0.8902. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/391]: Loss: 0.6039
  Epoch 13 [Batch 39/391]: Loss: 1.1646
  Epoch 13 [Batch 78/391]: Loss: 0.8974
  Epoch 13 [Batch 117/391]: Loss: 0.8029
  Epoch 13 [Batch 156/391]: Loss: 0.7512
  Epoch 13 [Batch 195/391]: Loss: 1.3857
  Epoch 13 [Batch 234/391]: Loss: 0.9820
  Epoch 13 [Batch 273/391]: Loss: 1.1512
  Epoch 13 [Batch 312/391]: Loss: 0.9937
  Epoch 13 [Batch 351/391]: Loss: 0.5993
  Epoch 13 [Batch 390/391]: Loss: 0.9037
  Epoch 13 Train Summary: Avg Loss: 0.8806, Accuracy: 0.3355
  Validation Summary: Avg Loss: 0.8880, Accuracy: 0.3318, F1 (Macro): 0.2495
  New best model! Val loss improved from 0.8902 to 0.8880. Saving...

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/391]: Loss: 0.9236
  Epoch 14 [Batch 39/391]: Loss: 1.1511
  Epoch 14 [Batch 78/391]: Loss: 0.6825
  Epoch 14 [Batch 117/391]: Loss: 1.1120
  Epoch 14 [Batch 156/391]: Loss: 1.1517
  Epoch 14 [Batch 195/391]: Loss: 0.7888
  Epoch 14 [Batch 234/391]: Loss: 0.9417
  Epoch 14 [Batch 273/391]: Loss: 0.8697
  Epoch 14 [Batch 312/391]: Loss: 1.0786
  Epoch 14 [Batch 351/391]: Loss: 0.8199
  Epoch 14 [Batch 390/391]: Loss: 0.8883
  Epoch 14 Train Summary: Avg Loss: 0.8772, Accuracy: 0.3357
  Validation Summary: Avg Loss: 0.8838, Accuracy: 0.3318, F1 (Macro): 0.2498
  New best model! Val loss improved from 0.8880 to 0.8838. Saving...
Training finished in 41.67 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.8838, Accuracy: 0.3318, F1 (Macro): 0.2498
Final Best Model Stats: Acc: 0.3318, F1: 0.2498, Loss: 0.8838
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=1e-05 drop=0.0 seed=123
================================================================================
Starting experiment: resnet50__224x224__lr-1e-05__drop-0.0__seed-123
Output directory: results_rgb/resnet50__224x224__lr-1e-05__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 3124 images from processed_datasets/rgb_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 390 images from processed_datasets/rgb_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/391]: Loss: 1.1092
  Epoch 0 [Batch 39/391]: Loss: 1.0822
  Epoch 0 [Batch 78/391]: Loss: 1.0787
  Epoch 0 [Batch 117/391]: Loss: 1.0690
  Epoch 0 [Batch 156/391]: Loss: 0.9988
  Epoch 0 [Batch 195/391]: Loss: 0.9490
  Epoch 0 [Batch 234/391]: Loss: 1.1276
  Epoch 0 [Batch 273/391]: Loss: 0.9489
  Epoch 0 [Batch 312/391]: Loss: 0.8867
  Epoch 0 [Batch 351/391]: Loss: 1.2338
  Epoch 0 [Batch 390/391]: Loss: 1.0371
  Epoch 0 Train Summary: Avg Loss: 1.0243, Accuracy: 0.3366
  Validation Summary: Avg Loss: 0.9832, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from inf to 0.9832. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/391]: Loss: 0.9771
  Epoch 1 [Batch 39/391]: Loss: 0.9923
  Epoch 1 [Batch 78/391]: Loss: 0.9225
  Epoch 1 [Batch 117/391]: Loss: 0.8923
  Epoch 1 [Batch 156/391]: Loss: 1.0268
  Epoch 1 [Batch 195/391]: Loss: 0.7762
  Epoch 1 [Batch 234/391]: Loss: 0.7965
  Epoch 1 [Batch 273/391]: Loss: 1.1368
  Epoch 1 [Batch 312/391]: Loss: 0.8675
  Epoch 1 [Batch 351/391]: Loss: 0.9071
  Epoch 1 [Batch 390/391]: Loss: 1.0998
  Epoch 1 Train Summary: Avg Loss: 0.9499, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9410, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9832 to 0.9410. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/391]: Loss: 1.0482
  Epoch 2 [Batch 39/391]: Loss: 0.9266
  Epoch 2 [Batch 78/391]: Loss: 0.8602
  Epoch 2 [Batch 117/391]: Loss: 0.8352
  Epoch 2 [Batch 156/391]: Loss: 0.9132
  Epoch 2 [Batch 195/391]: Loss: 0.6635
  Epoch 2 [Batch 234/391]: Loss: 0.7236
  Epoch 2 [Batch 273/391]: Loss: 0.8246
  Epoch 2 [Batch 312/391]: Loss: 0.7750
  Epoch 2 [Batch 351/391]: Loss: 1.0409
  Epoch 2 [Batch 390/391]: Loss: 0.5701
  Epoch 2 Train Summary: Avg Loss: 0.9274, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9212, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9410 to 0.9212. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/391]: Loss: 1.0623
  Epoch 3 [Batch 39/391]: Loss: 0.8295
  Epoch 3 [Batch 78/391]: Loss: 0.7709
  Epoch 3 [Batch 117/391]: Loss: 1.0131
  Epoch 3 [Batch 156/391]: Loss: 0.7830
  Epoch 3 [Batch 195/391]: Loss: 0.6825
  Epoch 3 [Batch 234/391]: Loss: 0.9418
  Epoch 3 [Batch 273/391]: Loss: 1.3113
  Epoch 3 [Batch 312/391]: Loss: 0.8060
  Epoch 3 [Batch 351/391]: Loss: 1.1888
  Epoch 3 [Batch 390/391]: Loss: 1.3142
  Epoch 3 Train Summary: Avg Loss: 0.9218, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9178, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9212 to 0.9178. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/391]: Loss: 0.9947
  Epoch 4 [Batch 39/391]: Loss: 0.7851
  Epoch 4 [Batch 78/391]: Loss: 0.9305
  Epoch 4 [Batch 117/391]: Loss: 1.2462
  Epoch 4 [Batch 156/391]: Loss: 0.9046
  Epoch 4 [Batch 195/391]: Loss: 1.3014
  Epoch 4 [Batch 234/391]: Loss: 0.9820
  Epoch 4 [Batch 273/391]: Loss: 1.2103
  Epoch 4 [Batch 312/391]: Loss: 1.0289
  Epoch 4 [Batch 351/391]: Loss: 0.8966
  Epoch 4 [Batch 390/391]: Loss: 0.6952
  Epoch 4 Train Summary: Avg Loss: 0.9177, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9146, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9178 to 0.9146. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/391]: Loss: 1.4701
  Epoch 5 [Batch 39/391]: Loss: 0.9879
  Epoch 5 [Batch 78/391]: Loss: 0.6065
  Epoch 5 [Batch 117/391]: Loss: 0.6383
  Epoch 5 [Batch 156/391]: Loss: 0.7963
  Epoch 5 [Batch 195/391]: Loss: 0.9687
  Epoch 5 [Batch 234/391]: Loss: 0.9045
  Epoch 5 [Batch 273/391]: Loss: 0.9414
  Epoch 5 [Batch 312/391]: Loss: 1.4053
  Epoch 5 [Batch 351/391]: Loss: 0.7587
  Epoch 5 [Batch 390/391]: Loss: 1.1160
  Epoch 5 Train Summary: Avg Loss: 0.9129, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9069, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9146 to 0.9069. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/391]: Loss: 0.9343
  Epoch 6 [Batch 39/391]: Loss: 0.7007
  Epoch 6 [Batch 78/391]: Loss: 0.9978
  Epoch 6 [Batch 117/391]: Loss: 0.8572
  Epoch 6 [Batch 156/391]: Loss: 0.8835
  Epoch 6 [Batch 195/391]: Loss: 0.9502
  Epoch 6 [Batch 234/391]: Loss: 0.6784
  Epoch 6 [Batch 273/391]: Loss: 1.0050
  Epoch 6 [Batch 312/391]: Loss: 1.0058
  Epoch 6 [Batch 351/391]: Loss: 0.7255
  Epoch 6 [Batch 390/391]: Loss: 0.6694
  Epoch 6 Train Summary: Avg Loss: 0.9090, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9083, Accuracy: 0.3333, F1 (Macro): 0.2453

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/391]: Loss: 1.1279
  Epoch 7 [Batch 39/391]: Loss: 1.2321
  Epoch 7 [Batch 78/391]: Loss: 0.7924
  Epoch 7 [Batch 117/391]: Loss: 0.7673
  Epoch 7 [Batch 156/391]: Loss: 0.9388
  Epoch 7 [Batch 195/391]: Loss: 0.6793
  Epoch 7 [Batch 234/391]: Loss: 0.8715
  Epoch 7 [Batch 273/391]: Loss: 0.6887
  Epoch 7 [Batch 312/391]: Loss: 1.2727
  Epoch 7 [Batch 351/391]: Loss: 0.9707
  Epoch 7 [Batch 390/391]: Loss: 1.7798
  Epoch 7 Train Summary: Avg Loss: 0.9060, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9008, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9069 to 0.9008. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/391]: Loss: 0.7875
  Epoch 8 [Batch 39/391]: Loss: 0.8296
  Epoch 8 [Batch 78/391]: Loss: 1.3917
  Epoch 8 [Batch 117/391]: Loss: 0.7712
  Epoch 8 [Batch 156/391]: Loss: 0.8254
  Epoch 8 [Batch 195/391]: Loss: 1.2323
  Epoch 8 [Batch 234/391]: Loss: 0.8206
  Epoch 8 [Batch 273/391]: Loss: 0.7439
  Epoch 8 [Batch 312/391]: Loss: 0.9365
  Epoch 8 [Batch 351/391]: Loss: 0.7250
  Epoch 8 [Batch 390/391]: Loss: 1.4863
  Epoch 8 Train Summary: Avg Loss: 0.9002, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9042, Accuracy: 0.3333, F1 (Macro): 0.2453

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/391]: Loss: 0.7793
  Epoch 9 [Batch 39/391]: Loss: 0.9277
  Epoch 9 [Batch 78/391]: Loss: 0.6689
  Epoch 9 [Batch 117/391]: Loss: 0.9032
  Epoch 9 [Batch 156/391]: Loss: 0.9579
  Epoch 9 [Batch 195/391]: Loss: 0.9274
  Epoch 9 [Batch 234/391]: Loss: 0.9555
  Epoch 9 [Batch 273/391]: Loss: 0.8603
  Epoch 9 [Batch 312/391]: Loss: 0.9235
  Epoch 9 [Batch 351/391]: Loss: 0.7631
  Epoch 9 [Batch 390/391]: Loss: 0.5433
  Epoch 9 Train Summary: Avg Loss: 0.8997, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8988, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9008 to 0.8988. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/391]: Loss: 1.0074
  Epoch 10 [Batch 39/391]: Loss: 1.2369
  Epoch 10 [Batch 78/391]: Loss: 1.0666
  Epoch 10 [Batch 117/391]: Loss: 1.1363
  Epoch 10 [Batch 156/391]: Loss: 0.9264
  Epoch 10 [Batch 195/391]: Loss: 0.8303
  Epoch 10 [Batch 234/391]: Loss: 1.0250
  Epoch 10 [Batch 273/391]: Loss: 0.7950
  Epoch 10 [Batch 312/391]: Loss: 1.1927
  Epoch 10 [Batch 351/391]: Loss: 1.0978
  Epoch 10 [Batch 390/391]: Loss: 1.1216
  Epoch 10 Train Summary: Avg Loss: 0.8948, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9028, Accuracy: 0.3333, F1 (Macro): 0.2453

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/391]: Loss: 0.9864
  Epoch 11 [Batch 39/391]: Loss: 0.9813
  Epoch 11 [Batch 78/391]: Loss: 0.7007
  Epoch 11 [Batch 117/391]: Loss: 0.8433
  Epoch 11 [Batch 156/391]: Loss: 1.0978
  Epoch 11 [Batch 195/391]: Loss: 0.6574
  Epoch 11 [Batch 234/391]: Loss: 0.9385
  Epoch 11 [Batch 273/391]: Loss: 0.9756
  Epoch 11 [Batch 312/391]: Loss: 0.8839
  Epoch 11 [Batch 351/391]: Loss: 0.6627
  Epoch 11 [Batch 390/391]: Loss: 1.8021
  Epoch 11 Train Summary: Avg Loss: 0.8924, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8929, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.8988 to 0.8929. Saving...

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/391]: Loss: 0.6327
  Epoch 12 [Batch 39/391]: Loss: 0.9734
  Epoch 12 [Batch 78/391]: Loss: 0.8938
  Epoch 12 [Batch 117/391]: Loss: 0.9715
  Epoch 12 [Batch 156/391]: Loss: 1.0337
  Epoch 12 [Batch 195/391]: Loss: 0.9142
  Epoch 12 [Batch 234/391]: Loss: 0.8724
  Epoch 12 [Batch 273/391]: Loss: 0.7853
  Epoch 12 [Batch 312/391]: Loss: 0.8723
  Epoch 12 [Batch 351/391]: Loss: 1.5808
  Epoch 12 [Batch 390/391]: Loss: 1.0671
  Epoch 12 Train Summary: Avg Loss: 0.8892, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8922, Accuracy: 0.3319, F1 (Macro): 0.2446
  New best model! Val loss improved from 0.8929 to 0.8922. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/391]: Loss: 1.0514
  Epoch 13 [Batch 39/391]: Loss: 1.1295
  Epoch 13 [Batch 78/391]: Loss: 1.0333
  Epoch 13 [Batch 117/391]: Loss: 0.7162
  Epoch 13 [Batch 156/391]: Loss: 1.0417
  Epoch 13 [Batch 195/391]: Loss: 1.0372
  Epoch 13 [Batch 234/391]: Loss: 0.9634
  Epoch 13 [Batch 273/391]: Loss: 0.9278
  Epoch 13 [Batch 312/391]: Loss: 0.5395
  Epoch 13 [Batch 351/391]: Loss: 0.6514
  Epoch 13 [Batch 390/391]: Loss: 0.7779
  Epoch 13 Train Summary: Avg Loss: 0.8846, Accuracy: 0.3348
  Validation Summary: Avg Loss: 0.8892, Accuracy: 0.3319, F1 (Macro): 0.2450
  New best model! Val loss improved from 0.8922 to 0.8892. Saving...

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/391]: Loss: 0.6711
  Epoch 14 [Batch 39/391]: Loss: 0.6877
  Epoch 14 [Batch 78/391]: Loss: 1.0023
  Epoch 14 [Batch 117/391]: Loss: 0.9074
  Epoch 14 [Batch 156/391]: Loss: 1.0858
  Epoch 14 [Batch 195/391]: Loss: 1.2087
  Epoch 14 [Batch 234/391]: Loss: 1.0319
  Epoch 14 [Batch 273/391]: Loss: 0.8913
  Epoch 14 [Batch 312/391]: Loss: 1.1898
  Epoch 14 [Batch 351/391]: Loss: 0.8717
  Epoch 14 [Batch 390/391]: Loss: 0.9654
  Epoch 14 Train Summary: Avg Loss: 0.8800, Accuracy: 0.3348
  Validation Summary: Avg Loss: 0.8880, Accuracy: 0.3332, F1 (Macro): 0.2499
  New best model! Val loss improved from 0.8892 to 0.8880. Saving...
Training finished in 32.69 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.8880, Accuracy: 0.3332, F1 (Macro): 0.2499
Final Best Model Stats: Acc: 0.3332, F1: 0.2499, Loss: 0.8880
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=224x224 lr=1e-05 drop=0.0 seed=999
================================================================================
Starting experiment: resnet50__224x224__lr-1e-05__drop-0.0__seed-999
Output directory: results_rgb/resnet50__224x224__lr-1e-05__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 3124 images from processed_datasets/rgb_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 390 images from processed_datasets/rgb_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/391]: Loss: 1.1444
  Epoch 0 [Batch 39/391]: Loss: 1.0703
  Epoch 0 [Batch 78/391]: Loss: 1.1114
  Epoch 0 [Batch 117/391]: Loss: 1.0834
  Epoch 0 [Batch 156/391]: Loss: 1.0641
  Epoch 0 [Batch 195/391]: Loss: 1.0541
  Epoch 0 [Batch 234/391]: Loss: 1.0728
  Epoch 0 [Batch 273/391]: Loss: 1.0788
  Epoch 0 [Batch 312/391]: Loss: 1.0684
  Epoch 0 [Batch 351/391]: Loss: 0.8874
  Epoch 0 [Batch 390/391]: Loss: 0.8942
  Epoch 0 Train Summary: Avg Loss: 1.0551, Accuracy: 0.3269
  Validation Summary: Avg Loss: 1.0135, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from inf to 1.0135. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/391]: Loss: 1.0608
  Epoch 1 [Batch 39/391]: Loss: 1.0795
  Epoch 1 [Batch 78/391]: Loss: 0.9441
  Epoch 1 [Batch 117/391]: Loss: 0.9177
  Epoch 1 [Batch 156/391]: Loss: 0.8742
  Epoch 1 [Batch 195/391]: Loss: 1.0235
  Epoch 1 [Batch 234/391]: Loss: 0.7925
  Epoch 1 [Batch 273/391]: Loss: 0.9317
  Epoch 1 [Batch 312/391]: Loss: 0.8922
  Epoch 1 [Batch 351/391]: Loss: 1.1504
  Epoch 1 [Batch 390/391]: Loss: 0.8768
  Epoch 1 Train Summary: Avg Loss: 0.9626, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9540, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 1.0135 to 0.9540. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/391]: Loss: 0.8548
  Epoch 2 [Batch 39/391]: Loss: 1.0710
  Epoch 2 [Batch 78/391]: Loss: 0.9153
  Epoch 2 [Batch 117/391]: Loss: 1.0050
  Epoch 2 [Batch 156/391]: Loss: 1.0429
  Epoch 2 [Batch 195/391]: Loss: 0.9218
  Epoch 2 [Batch 234/391]: Loss: 0.8157
  Epoch 2 [Batch 273/391]: Loss: 0.7510
  Epoch 2 [Batch 312/391]: Loss: 0.9081
  Epoch 2 [Batch 351/391]: Loss: 0.9818
  Epoch 2 [Batch 390/391]: Loss: 1.1296
  Epoch 2 Train Summary: Avg Loss: 0.9350, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9234, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9540 to 0.9234. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/391]: Loss: 0.9345
  Epoch 3 [Batch 39/391]: Loss: 0.9870
  Epoch 3 [Batch 78/391]: Loss: 0.9661
  Epoch 3 [Batch 117/391]: Loss: 1.0874
  Epoch 3 [Batch 156/391]: Loss: 0.9786
  Epoch 3 [Batch 195/391]: Loss: 1.1611
  Epoch 3 [Batch 234/391]: Loss: 0.8709
  Epoch 3 [Batch 273/391]: Loss: 0.8069
  Epoch 3 [Batch 312/391]: Loss: 0.8830
  Epoch 3 [Batch 351/391]: Loss: 0.7977
  Epoch 3 [Batch 390/391]: Loss: 0.8517
  Epoch 3 Train Summary: Avg Loss: 0.9233, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9243, Accuracy: 0.3333, F1 (Macro): 0.2453

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/391]: Loss: 0.9824
  Epoch 4 [Batch 39/391]: Loss: 0.8689
  Epoch 4 [Batch 78/391]: Loss: 0.8679
  Epoch 4 [Batch 117/391]: Loss: 1.1499
  Epoch 4 [Batch 156/391]: Loss: 1.1756
  Epoch 4 [Batch 195/391]: Loss: 0.9247
  Epoch 4 [Batch 234/391]: Loss: 0.8767
  Epoch 4 [Batch 273/391]: Loss: 1.0853
  Epoch 4 [Batch 312/391]: Loss: 0.9026
  Epoch 4 [Batch 351/391]: Loss: 0.5734
  Epoch 4 [Batch 390/391]: Loss: 0.5605
  Epoch 4 Train Summary: Avg Loss: 0.9176, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9187, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9234 to 0.9187. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/391]: Loss: 0.8382
  Epoch 5 [Batch 39/391]: Loss: 0.7718
  Epoch 5 [Batch 78/391]: Loss: 0.9060
  Epoch 5 [Batch 117/391]: Loss: 0.9766
  Epoch 5 [Batch 156/391]: Loss: 1.3638
  Epoch 5 [Batch 195/391]: Loss: 0.6677
  Epoch 5 [Batch 234/391]: Loss: 0.9058
  Epoch 5 [Batch 273/391]: Loss: 0.6068
  Epoch 5 [Batch 312/391]: Loss: 0.8981
  Epoch 5 [Batch 351/391]: Loss: 1.2089
  Epoch 5 [Batch 390/391]: Loss: 0.9343
  Epoch 5 Train Summary: Avg Loss: 0.9150, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9139, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9187 to 0.9139. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/391]: Loss: 0.9307
  Epoch 6 [Batch 39/391]: Loss: 0.7251
  Epoch 6 [Batch 78/391]: Loss: 0.9044
  Epoch 6 [Batch 117/391]: Loss: 1.0006
  Epoch 6 [Batch 156/391]: Loss: 0.8882
  Epoch 6 [Batch 195/391]: Loss: 1.0081
  Epoch 6 [Batch 234/391]: Loss: 0.7153
  Epoch 6 [Batch 273/391]: Loss: 0.6001
  Epoch 6 [Batch 312/391]: Loss: 0.8543
  Epoch 6 [Batch 351/391]: Loss: 1.3040
  Epoch 6 [Batch 390/391]: Loss: 1.1693
  Epoch 6 Train Summary: Avg Loss: 0.9099, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9102, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9139 to 0.9102. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/391]: Loss: 0.7900
  Epoch 7 [Batch 39/391]: Loss: 0.7721
  Epoch 7 [Batch 78/391]: Loss: 1.1438
  Epoch 7 [Batch 117/391]: Loss: 0.9191
  Epoch 7 [Batch 156/391]: Loss: 0.6448
  Epoch 7 [Batch 195/391]: Loss: 0.9248
  Epoch 7 [Batch 234/391]: Loss: 0.9675
  Epoch 7 [Batch 273/391]: Loss: 0.9410
  Epoch 7 [Batch 312/391]: Loss: 0.8497
  Epoch 7 [Batch 351/391]: Loss: 0.7546
  Epoch 7 [Batch 390/391]: Loss: 0.8687
  Epoch 7 Train Summary: Avg Loss: 0.9068, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9059, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9102 to 0.9059. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/391]: Loss: 1.0112
  Epoch 8 [Batch 39/391]: Loss: 0.8534
  Epoch 8 [Batch 78/391]: Loss: 0.6617
  Epoch 8 [Batch 117/391]: Loss: 0.9609
  Epoch 8 [Batch 156/391]: Loss: 0.8316
  Epoch 8 [Batch 195/391]: Loss: 0.9008
  Epoch 8 [Batch 234/391]: Loss: 0.9059
  Epoch 8 [Batch 273/391]: Loss: 0.9636
  Epoch 8 [Batch 312/391]: Loss: 0.6641
  Epoch 8 [Batch 351/391]: Loss: 0.9574
  Epoch 8 [Batch 390/391]: Loss: 1.2424
  Epoch 8 Train Summary: Avg Loss: 0.9071, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9007, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9059 to 0.9007. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/391]: Loss: 1.0484
  Epoch 9 [Batch 39/391]: Loss: 1.0852
  Epoch 9 [Batch 78/391]: Loss: 0.6382
  Epoch 9 [Batch 117/391]: Loss: 0.5455
  Epoch 9 [Batch 156/391]: Loss: 0.6422
  Epoch 9 [Batch 195/391]: Loss: 0.9972
  Epoch 9 [Batch 234/391]: Loss: 1.0243
  Epoch 9 [Batch 273/391]: Loss: 0.8795
  Epoch 9 [Batch 312/391]: Loss: 0.9103
  Epoch 9 [Batch 351/391]: Loss: 1.3664
  Epoch 9 [Batch 390/391]: Loss: 1.2116
  Epoch 9 Train Summary: Avg Loss: 0.9016, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8991, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9007 to 0.8991. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/391]: Loss: 0.9163
  Epoch 10 [Batch 39/391]: Loss: 1.0543
  Epoch 10 [Batch 78/391]: Loss: 0.7913
  Epoch 10 [Batch 117/391]: Loss: 1.3717
  Epoch 10 [Batch 156/391]: Loss: 0.8598
  Epoch 10 [Batch 195/391]: Loss: 0.7585
  Epoch 10 [Batch 234/391]: Loss: 0.9321
  Epoch 10 [Batch 273/391]: Loss: 1.1114
  Epoch 10 [Batch 312/391]: Loss: 0.6696
  Epoch 10 [Batch 351/391]: Loss: 1.0344
  Epoch 10 [Batch 390/391]: Loss: 0.6989
  Epoch 10 Train Summary: Avg Loss: 0.8971, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.9034, Accuracy: 0.3333, F1 (Macro): 0.2453

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/391]: Loss: 0.9342
  Epoch 11 [Batch 39/391]: Loss: 0.9975
  Epoch 11 [Batch 78/391]: Loss: 0.7730
  Epoch 11 [Batch 117/391]: Loss: 0.7983
  Epoch 11 [Batch 156/391]: Loss: 0.6881
  Epoch 11 [Batch 195/391]: Loss: 1.0645
  Epoch 11 [Batch 234/391]: Loss: 0.9873
  Epoch 11 [Batch 273/391]: Loss: 0.9723
  Epoch 11 [Batch 312/391]: Loss: 0.6351
  Epoch 11 [Batch 351/391]: Loss: 0.7348
  Epoch 11 [Batch 390/391]: Loss: 1.3085
  Epoch 11 Train Summary: Avg Loss: 0.8924, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8949, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.8991 to 0.8949. Saving...

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/391]: Loss: 0.5615
  Epoch 12 [Batch 39/391]: Loss: 0.7233
  Epoch 12 [Batch 78/391]: Loss: 0.7063
  Epoch 12 [Batch 117/391]: Loss: 0.9539
  Epoch 12 [Batch 156/391]: Loss: 0.8967
  Epoch 12 [Batch 195/391]: Loss: 1.2092
  Epoch 12 [Batch 234/391]: Loss: 0.6645
  Epoch 12 [Batch 273/391]: Loss: 0.8267
  Epoch 12 [Batch 312/391]: Loss: 1.0002
  Epoch 12 [Batch 351/391]: Loss: 0.8292
  Epoch 12 [Batch 390/391]: Loss: 0.8433
  Epoch 12 Train Summary: Avg Loss: 0.8917, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8932, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.8949 to 0.8932. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/391]: Loss: 1.1153
  Epoch 13 [Batch 39/391]: Loss: 0.6853
  Epoch 13 [Batch 78/391]: Loss: 0.7967
  Epoch 13 [Batch 117/391]: Loss: 1.1313
  Epoch 13 [Batch 156/391]: Loss: 1.1679
  Epoch 13 [Batch 195/391]: Loss: 1.0267
  Epoch 13 [Batch 234/391]: Loss: 1.0517
  Epoch 13 [Batch 273/391]: Loss: 1.0620
  Epoch 13 [Batch 312/391]: Loss: 0.8968
  Epoch 13 [Batch 351/391]: Loss: 0.8630
  Epoch 13 [Batch 390/391]: Loss: 1.0860
  Epoch 13 Train Summary: Avg Loss: 0.8878, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8898, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.8932 to 0.8898. Saving...

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/391]: Loss: 0.8958
  Epoch 14 [Batch 39/391]: Loss: 0.7006
  Epoch 14 [Batch 78/391]: Loss: 0.9217
  Epoch 14 [Batch 117/391]: Loss: 0.9691
  Epoch 14 [Batch 156/391]: Loss: 0.7745
  Epoch 14 [Batch 195/391]: Loss: 0.9879
  Epoch 14 [Batch 234/391]: Loss: 0.9753
  Epoch 14 [Batch 273/391]: Loss: 0.6989
  Epoch 14 [Batch 312/391]: Loss: 0.9511
  Epoch 14 [Batch 351/391]: Loss: 0.9422
  Epoch 14 [Batch 390/391]: Loss: 0.8389
  Epoch 14 Train Summary: Avg Loss: 0.8776, Accuracy: 0.3335
  Validation Summary: Avg Loss: 0.8897, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.8898 to 0.8897. Saving...
Training finished in 37.64 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.8897, Accuracy: 0.3333, F1 (Macro): 0.2453
Final Best Model Stats: Acc: 0.3333, F1: 0.2453, Loss: 0.8897
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=0.0001 drop=0.0 seed=42
================================================================================
Starting experiment: resnet50__384x384__lr-0.0001__drop-0.0__seed-42
Output directory: results_rgb/resnet50__384x384__lr-0.0001__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 3124 images from processed_datasets/rgb_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 390 images from processed_datasets/rgb_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/391]: Loss: 1.1164
  Epoch 0 [Batch 39/391]: Loss: 0.7648
  Epoch 0 [Batch 78/391]: Loss: 0.8768
  Epoch 0 [Batch 117/391]: Loss: 1.2270
  Epoch 0 [Batch 156/391]: Loss: 0.7483
  Epoch 0 [Batch 195/391]: Loss: 1.2033
  Epoch 0 [Batch 234/391]: Loss: 0.8440
  Epoch 0 [Batch 273/391]: Loss: 0.8564
  Epoch 0 [Batch 312/391]: Loss: 0.6633
  Epoch 0 [Batch 351/391]: Loss: 0.7023
  Epoch 0 [Batch 390/391]: Loss: 0.6459
  Epoch 0 Train Summary: Avg Loss: 0.9328, Accuracy: 0.3342
  Validation Summary: Avg Loss: 0.9148, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from inf to 0.9148. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/391]: Loss: 1.1007
  Epoch 1 [Batch 39/391]: Loss: 0.8890
  Epoch 1 [Batch 78/391]: Loss: 0.5584
  Epoch 1 [Batch 117/391]: Loss: 0.8014
  Epoch 1 [Batch 156/391]: Loss: 1.1362
  Epoch 1 [Batch 195/391]: Loss: 0.7959
  Epoch 1 [Batch 234/391]: Loss: 0.9442
  Epoch 1 [Batch 273/391]: Loss: 1.0885
  Epoch 1 [Batch 312/391]: Loss: 0.5921
  Epoch 1 [Batch 351/391]: Loss: 0.7681
  Epoch 1 [Batch 390/391]: Loss: 0.8799
  Epoch 1 Train Summary: Avg Loss: 0.8812, Accuracy: 0.3355
  Validation Summary: Avg Loss: 0.8771, Accuracy: 0.3471, F1 (Macro): 0.2913
  New best model! Val loss improved from 0.9148 to 0.8771. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/391]: Loss: 0.5233
  Epoch 2 [Batch 39/391]: Loss: 1.2039
  Epoch 2 [Batch 78/391]: Loss: 0.7538
  Epoch 2 [Batch 117/391]: Loss: 1.3002
  Epoch 2 [Batch 156/391]: Loss: 0.7930
  Epoch 2 [Batch 195/391]: Loss: 0.6007
  Epoch 2 [Batch 234/391]: Loss: 0.7393
  Epoch 2 [Batch 273/391]: Loss: 1.0599
  Epoch 2 [Batch 312/391]: Loss: 1.0390
  Epoch 2 [Batch 351/391]: Loss: 0.7548
  Epoch 2 [Batch 390/391]: Loss: 1.2397
  Epoch 2 Train Summary: Avg Loss: 0.8442, Accuracy: 0.3731
  Validation Summary: Avg Loss: 0.8637, Accuracy: 0.4086, F1 (Macro): 0.3845
  New best model! Val loss improved from 0.8771 to 0.8637. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/391]: Loss: 0.8977
  Epoch 3 [Batch 39/391]: Loss: 0.8486
  Epoch 3 [Batch 78/391]: Loss: 0.6535
  Epoch 3 [Batch 117/391]: Loss: 0.8469
  Epoch 3 [Batch 156/391]: Loss: 0.7251
  Epoch 3 [Batch 195/391]: Loss: 1.1562
  Epoch 3 [Batch 234/391]: Loss: 1.0538
  Epoch 3 [Batch 273/391]: Loss: 0.6460
  Epoch 3 [Batch 312/391]: Loss: 0.6108
  Epoch 3 [Batch 351/391]: Loss: 0.4669
  Epoch 3 [Batch 390/391]: Loss: 0.5617
  Epoch 3 Train Summary: Avg Loss: 0.8054, Accuracy: 0.4202
  Validation Summary: Avg Loss: 0.8613, Accuracy: 0.4390, F1 (Macro): 0.4087
  New best model! Val loss improved from 0.8637 to 0.8613. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/391]: Loss: 0.7565
  Epoch 4 [Batch 39/391]: Loss: 0.5970
  Epoch 4 [Batch 78/391]: Loss: 0.7004
  Epoch 4 [Batch 117/391]: Loss: 0.5274
  Epoch 4 [Batch 156/391]: Loss: 0.5400
  Epoch 4 [Batch 195/391]: Loss: 0.9396
  Epoch 4 [Batch 234/391]: Loss: 0.8566
  Epoch 4 [Batch 273/391]: Loss: 0.8085
  Epoch 4 [Batch 312/391]: Loss: 0.5522
  Epoch 4 [Batch 351/391]: Loss: 0.7203
  Epoch 4 [Batch 390/391]: Loss: 0.5446
  Epoch 4 Train Summary: Avg Loss: 0.7567, Accuracy: 0.4541
  Validation Summary: Avg Loss: 0.8111, Accuracy: 0.4610, F1 (Macro): 0.4401
  New best model! Val loss improved from 0.8613 to 0.8111. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/391]: Loss: 0.6311
  Epoch 5 [Batch 39/391]: Loss: 0.5161
  Epoch 5 [Batch 78/391]: Loss: 0.7514
  Epoch 5 [Batch 117/391]: Loss: 0.5721
  Epoch 5 [Batch 156/391]: Loss: 0.6717
  Epoch 5 [Batch 195/391]: Loss: 0.4828
  Epoch 5 [Batch 234/391]: Loss: 0.5648
  Epoch 5 [Batch 273/391]: Loss: 0.7028
  Epoch 5 [Batch 312/391]: Loss: 0.9561
  Epoch 5 [Batch 351/391]: Loss: 0.6919
  Epoch 5 [Batch 390/391]: Loss: 0.4603
  Epoch 5 Train Summary: Avg Loss: 0.7017, Accuracy: 0.4926
  Validation Summary: Avg Loss: 0.8191, Accuracy: 0.4774, F1 (Macro): 0.4712

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/391]: Loss: 0.4821
  Epoch 6 [Batch 39/391]: Loss: 0.5702
  Epoch 6 [Batch 78/391]: Loss: 0.5677
  Epoch 6 [Batch 117/391]: Loss: 0.5603
  Epoch 6 [Batch 156/391]: Loss: 0.3083
  Epoch 6 [Batch 195/391]: Loss: 0.7938
  Epoch 6 [Batch 234/391]: Loss: 0.7437
  Epoch 6 [Batch 273/391]: Loss: 1.0357
  Epoch 6 [Batch 312/391]: Loss: 0.4022
  Epoch 6 [Batch 351/391]: Loss: 0.4970
  Epoch 6 [Batch 390/391]: Loss: 0.7924
  Epoch 6 Train Summary: Avg Loss: 0.6483, Accuracy: 0.5718
  Validation Summary: Avg Loss: 0.7817, Accuracy: 0.5323, F1 (Macro): 0.5509
  New best model! Val loss improved from 0.8111 to 0.7817. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/391]: Loss: 0.4262
  Epoch 7 [Batch 39/391]: Loss: 0.6867
  Epoch 7 [Batch 78/391]: Loss: 0.3644
  Epoch 7 [Batch 117/391]: Loss: 1.0668
  Epoch 7 [Batch 156/391]: Loss: 0.5326
  Epoch 7 [Batch 195/391]: Loss: 0.6451
  Epoch 7 [Batch 234/391]: Loss: 0.7859
  Epoch 7 [Batch 273/391]: Loss: 0.4400
  Epoch 7 [Batch 312/391]: Loss: 0.4024
  Epoch 7 [Batch 351/391]: Loss: 0.3864
  Epoch 7 [Batch 390/391]: Loss: 1.3140
  Epoch 7 Train Summary: Avg Loss: 0.6034, Accuracy: 0.6165
  Validation Summary: Avg Loss: 0.8669, Accuracy: 0.5620, F1 (Macro): 0.5472

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/391]: Loss: 0.5164
  Epoch 8 [Batch 39/391]: Loss: 0.4563
  Epoch 8 [Batch 78/391]: Loss: 0.3495
  Epoch 8 [Batch 117/391]: Loss: 0.6080
  Epoch 8 [Batch 156/391]: Loss: 0.7303
  Epoch 8 [Batch 195/391]: Loss: 0.5150
  Epoch 8 [Batch 234/391]: Loss: 0.7485
  Epoch 8 [Batch 273/391]: Loss: 0.4544
  Epoch 8 [Batch 312/391]: Loss: 0.6143
  Epoch 8 [Batch 351/391]: Loss: 0.6626
  Epoch 8 [Batch 390/391]: Loss: 0.6830
  Epoch 8 Train Summary: Avg Loss: 0.5309, Accuracy: 0.6822
  Validation Summary: Avg Loss: 0.7817, Accuracy: 0.6230, F1 (Macro): 0.6378

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/391]: Loss: 0.3212
  Epoch 9 [Batch 39/391]: Loss: 0.4556
  Epoch 9 [Batch 78/391]: Loss: 0.3206
  Epoch 9 [Batch 117/391]: Loss: 1.2179
  Epoch 9 [Batch 156/391]: Loss: 0.4098
  Epoch 9 [Batch 195/391]: Loss: 0.8547
  Epoch 9 [Batch 234/391]: Loss: 0.4051
  Epoch 9 [Batch 273/391]: Loss: 0.7334
  Epoch 9 [Batch 312/391]: Loss: 0.4857
  Epoch 9 [Batch 351/391]: Loss: 0.4393
  Epoch 9 [Batch 390/391]: Loss: 0.1561
  Epoch 9 Train Summary: Avg Loss: 0.4857, Accuracy: 0.7178
  Validation Summary: Avg Loss: 0.7706, Accuracy: 0.6050, F1 (Macro): 0.6089
  New best model! Val loss improved from 0.7817 to 0.7706. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/391]: Loss: 0.2043
  Epoch 10 [Batch 39/391]: Loss: 0.7127
  Epoch 10 [Batch 78/391]: Loss: 0.4454
  Epoch 10 [Batch 117/391]: Loss: 0.2991
  Epoch 10 [Batch 156/391]: Loss: 0.2135
  Epoch 10 [Batch 195/391]: Loss: 0.3610
  Epoch 10 [Batch 234/391]: Loss: 0.3922
  Epoch 10 [Batch 273/391]: Loss: 0.6813
  Epoch 10 [Batch 312/391]: Loss: 0.3600
  Epoch 10 [Batch 351/391]: Loss: 0.4691
  Epoch 10 [Batch 390/391]: Loss: 0.3854
  Epoch 10 Train Summary: Avg Loss: 0.4134, Accuracy: 0.7631
  Validation Summary: Avg Loss: 0.7881, Accuracy: 0.6057, F1 (Macro): 0.6159

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/391]: Loss: 0.6587
  Epoch 11 [Batch 39/391]: Loss: 0.5094
  Epoch 11 [Batch 78/391]: Loss: 0.3494
  Epoch 11 [Batch 117/391]: Loss: 0.3225
  Epoch 11 [Batch 156/391]: Loss: 0.1147
  Epoch 11 [Batch 195/391]: Loss: 0.0834
  Epoch 11 [Batch 234/391]: Loss: 0.3100
  Epoch 11 [Batch 273/391]: Loss: 0.3048
  Epoch 11 [Batch 312/391]: Loss: 1.0113
  Epoch 11 [Batch 351/391]: Loss: 0.4933
  Epoch 11 [Batch 390/391]: Loss: 0.2880
  Epoch 11 Train Summary: Avg Loss: 0.3665, Accuracy: 0.7963
  Validation Summary: Avg Loss: 0.8131, Accuracy: 0.6467, F1 (Macro): 0.6543

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/391]: Loss: 0.3885
  Epoch 12 [Batch 39/391]: Loss: 0.5639
  Epoch 12 [Batch 78/391]: Loss: 0.2140
  Epoch 12 [Batch 117/391]: Loss: 0.2058
  Epoch 12 [Batch 156/391]: Loss: 0.7502
  Epoch 12 [Batch 195/391]: Loss: 0.5167
  Epoch 12 [Batch 234/391]: Loss: 0.2473
  Epoch 12 [Batch 273/391]: Loss: 0.6907
  Epoch 12 [Batch 312/391]: Loss: 0.0928
  Epoch 12 [Batch 351/391]: Loss: 0.2804
  Epoch 12 [Batch 390/391]: Loss: 0.2904
  Epoch 12 Train Summary: Avg Loss: 0.3289, Accuracy: 0.8094
  Validation Summary: Avg Loss: 0.8501, Accuracy: 0.6463, F1 (Macro): 0.6351

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/391]: Loss: 0.2670
  Epoch 13 [Batch 39/391]: Loss: 0.8304
  Epoch 13 [Batch 78/391]: Loss: 0.2207
  Epoch 13 [Batch 117/391]: Loss: 0.1779
  Epoch 13 [Batch 156/391]: Loss: 0.1707
  Epoch 13 [Batch 195/391]: Loss: 0.6212
  Epoch 13 [Batch 234/391]: Loss: 0.1464
  Epoch 13 [Batch 273/391]: Loss: 0.3333
  Epoch 13 [Batch 312/391]: Loss: 0.3165
  Epoch 13 [Batch 351/391]: Loss: 0.1928
  Epoch 13 [Batch 390/391]: Loss: 0.3211
  Epoch 13 Train Summary: Avg Loss: 0.3109, Accuracy: 0.8384
  Validation Summary: Avg Loss: 0.8494, Accuracy: 0.6076, F1 (Macro): 0.6187

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/391]: Loss: 0.2539
  Epoch 14 [Batch 39/391]: Loss: 0.4291
  Epoch 14 [Batch 78/391]: Loss: 0.2079
  Epoch 14 [Batch 117/391]: Loss: 0.8844
  Epoch 14 [Batch 156/391]: Loss: 0.1533
  Epoch 14 [Batch 195/391]: Loss: 0.0457
  Epoch 14 [Batch 234/391]: Loss: 0.3074
  Epoch 14 [Batch 273/391]: Loss: 0.2575
  Epoch 14 [Batch 312/391]: Loss: 0.9844
  Epoch 14 [Batch 351/391]: Loss: 0.2196
  Epoch 14 [Batch 390/391]: Loss: 0.2631
  Epoch 14 Train Summary: Avg Loss: 0.2696, Accuracy: 0.8569
  Validation Summary: Avg Loss: 0.8593, Accuracy: 0.6378, F1 (Macro): 0.6572
Training finished in 121.20 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.7706, Accuracy: 0.6050, F1 (Macro): 0.6089
Final Best Model Stats: Acc: 0.6050, F1: 0.6089, Loss: 0.7706
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=0.0001 drop=0.0 seed=123
================================================================================
Starting experiment: resnet50__384x384__lr-0.0001__drop-0.0__seed-123
Output directory: results_rgb/resnet50__384x384__lr-0.0001__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 3124 images from processed_datasets/rgb_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 390 images from processed_datasets/rgb_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/391]: Loss: 1.1208
  Epoch 0 [Batch 39/391]: Loss: 0.8990
  Epoch 0 [Batch 78/391]: Loss: 1.0625
  Epoch 0 [Batch 117/391]: Loss: 1.0260
  Epoch 0 [Batch 156/391]: Loss: 0.7782
  Epoch 0 [Batch 195/391]: Loss: 0.6944
  Epoch 0 [Batch 234/391]: Loss: 1.2562
  Epoch 0 [Batch 273/391]: Loss: 0.7402
  Epoch 0 [Batch 312/391]: Loss: 0.7384
  Epoch 0 [Batch 351/391]: Loss: 1.4600
  Epoch 0 [Batch 390/391]: Loss: 1.1411
  Epoch 0 Train Summary: Avg Loss: 0.9285, Accuracy: 0.3318
  Validation Summary: Avg Loss: 0.9110, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from inf to 0.9110. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/391]: Loss: 0.9946
  Epoch 1 [Batch 39/391]: Loss: 0.9075
  Epoch 1 [Batch 78/391]: Loss: 0.7390
  Epoch 1 [Batch 117/391]: Loss: 0.7869
  Epoch 1 [Batch 156/391]: Loss: 1.0761
  Epoch 1 [Batch 195/391]: Loss: 0.6321
  Epoch 1 [Batch 234/391]: Loss: 0.7190
  Epoch 1 [Batch 273/391]: Loss: 1.1564
  Epoch 1 [Batch 312/391]: Loss: 0.8430
  Epoch 1 [Batch 351/391]: Loss: 0.8154
  Epoch 1 [Batch 390/391]: Loss: 0.9789
  Epoch 1 Train Summary: Avg Loss: 0.8825, Accuracy: 0.3362
  Validation Summary: Avg Loss: 0.8724, Accuracy: 0.3501, F1 (Macro): 0.2940
  New best model! Val loss improved from 0.9110 to 0.8724. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/391]: Loss: 0.9909
  Epoch 2 [Batch 39/391]: Loss: 0.7505
  Epoch 2 [Batch 78/391]: Loss: 0.6148
  Epoch 2 [Batch 117/391]: Loss: 0.7668
  Epoch 2 [Batch 156/391]: Loss: 0.7917
  Epoch 2 [Batch 195/391]: Loss: 0.5039
  Epoch 2 [Batch 234/391]: Loss: 0.5984
  Epoch 2 [Batch 273/391]: Loss: 0.6828
  Epoch 2 [Batch 312/391]: Loss: 0.7059
  Epoch 2 [Batch 351/391]: Loss: 0.7585
  Epoch 2 [Batch 390/391]: Loss: 0.4826
  Epoch 2 Train Summary: Avg Loss: 0.8489, Accuracy: 0.3730
  Validation Summary: Avg Loss: 0.8501, Accuracy: 0.3988, F1 (Macro): 0.3738
  New best model! Val loss improved from 0.8724 to 0.8501. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/391]: Loss: 1.0577
  Epoch 3 [Batch 39/391]: Loss: 0.6508
  Epoch 3 [Batch 78/391]: Loss: 0.6075
  Epoch 3 [Batch 117/391]: Loss: 1.0300
  Epoch 3 [Batch 156/391]: Loss: 0.7851
  Epoch 3 [Batch 195/391]: Loss: 0.5862
  Epoch 3 [Batch 234/391]: Loss: 0.7251
  Epoch 3 [Batch 273/391]: Loss: 1.2058
  Epoch 3 [Batch 312/391]: Loss: 0.6765
  Epoch 3 [Batch 351/391]: Loss: 1.2041
  Epoch 3 [Batch 390/391]: Loss: 1.3291
  Epoch 3 Train Summary: Avg Loss: 0.7999, Accuracy: 0.4101
  Validation Summary: Avg Loss: 0.8204, Accuracy: 0.4146, F1 (Macro): 0.3907
  New best model! Val loss improved from 0.8501 to 0.8204. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/391]: Loss: 1.0102
  Epoch 4 [Batch 39/391]: Loss: 0.9470
  Epoch 4 [Batch 78/391]: Loss: 0.6122
  Epoch 4 [Batch 117/391]: Loss: 1.1370
  Epoch 4 [Batch 156/391]: Loss: 1.0021
  Epoch 4 [Batch 195/391]: Loss: 1.3289
  Epoch 4 [Batch 234/391]: Loss: 0.5742
  Epoch 4 [Batch 273/391]: Loss: 1.0129
  Epoch 4 [Batch 312/391]: Loss: 0.7525
  Epoch 4 [Batch 351/391]: Loss: 0.8344
  Epoch 4 [Batch 390/391]: Loss: 0.5053
  Epoch 4 Train Summary: Avg Loss: 0.7443, Accuracy: 0.4648
  Validation Summary: Avg Loss: 0.8133, Accuracy: 0.4584, F1 (Macro): 0.4524
  New best model! Val loss improved from 0.8204 to 0.8133. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/391]: Loss: 1.5885
  Epoch 5 [Batch 39/391]: Loss: 0.8780
  Epoch 5 [Batch 78/391]: Loss: 0.4007
  Epoch 5 [Batch 117/391]: Loss: 0.6174
  Epoch 5 [Batch 156/391]: Loss: 0.5569
  Epoch 5 [Batch 195/391]: Loss: 0.7657
  Epoch 5 [Batch 234/391]: Loss: 0.7528
  Epoch 5 [Batch 273/391]: Loss: 0.5220
  Epoch 5 [Batch 312/391]: Loss: 0.8396
  Epoch 5 [Batch 351/391]: Loss: 0.2733
  Epoch 5 [Batch 390/391]: Loss: 0.9248
  Epoch 5 Train Summary: Avg Loss: 0.6866, Accuracy: 0.5294
  Validation Summary: Avg Loss: 0.8284, Accuracy: 0.4653, F1 (Macro): 0.4810

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/391]: Loss: 0.6382
  Epoch 6 [Batch 39/391]: Loss: 0.7969
  Epoch 6 [Batch 78/391]: Loss: 0.8943
  Epoch 6 [Batch 117/391]: Loss: 0.8665
  Epoch 6 [Batch 156/391]: Loss: 0.8599
  Epoch 6 [Batch 195/391]: Loss: 0.7308
  Epoch 6 [Batch 234/391]: Loss: 0.2386
  Epoch 6 [Batch 273/391]: Loss: 0.5699
  Epoch 6 [Batch 312/391]: Loss: 1.0533
  Epoch 6 [Batch 351/391]: Loss: 0.5814
  Epoch 6 [Batch 390/391]: Loss: 0.2556
  Epoch 6 Train Summary: Avg Loss: 0.6295, Accuracy: 0.6000
  Validation Summary: Avg Loss: 0.7691, Accuracy: 0.5334, F1 (Macro): 0.5459
  New best model! Val loss improved from 0.8133 to 0.7691. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/391]: Loss: 1.1764
  Epoch 7 [Batch 39/391]: Loss: 0.7485
  Epoch 7 [Batch 78/391]: Loss: 0.3985
  Epoch 7 [Batch 117/391]: Loss: 0.5720
  Epoch 7 [Batch 156/391]: Loss: 0.7607
  Epoch 7 [Batch 195/391]: Loss: 0.5018
  Epoch 7 [Batch 234/391]: Loss: 0.2363
  Epoch 7 [Batch 273/391]: Loss: 0.4959
  Epoch 7 [Batch 312/391]: Loss: 0.9065
  Epoch 7 [Batch 351/391]: Loss: 0.3255
  Epoch 7 [Batch 390/391]: Loss: 1.6321
  Epoch 7 Train Summary: Avg Loss: 0.5776, Accuracy: 0.6537
  Validation Summary: Avg Loss: 0.7511, Accuracy: 0.5834, F1 (Macro): 0.6051
  New best model! Val loss improved from 0.7691 to 0.7511. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/391]: Loss: 0.3053
  Epoch 8 [Batch 39/391]: Loss: 0.4855
  Epoch 8 [Batch 78/391]: Loss: 0.9355
  Epoch 8 [Batch 117/391]: Loss: 0.7205
  Epoch 8 [Batch 156/391]: Loss: 0.3066
  Epoch 8 [Batch 195/391]: Loss: 0.8558
  Epoch 8 [Batch 234/391]: Loss: 0.3876
  Epoch 8 [Batch 273/391]: Loss: 0.3171
  Epoch 8 [Batch 312/391]: Loss: 0.4250
  Epoch 8 [Batch 351/391]: Loss: 0.3153
  Epoch 8 [Batch 390/391]: Loss: 1.4547
  Epoch 8 Train Summary: Avg Loss: 0.5173, Accuracy: 0.6948
  Validation Summary: Avg Loss: 0.7826, Accuracy: 0.6248, F1 (Macro): 0.6392

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/391]: Loss: 0.3581
  Epoch 9 [Batch 39/391]: Loss: 0.5877
  Epoch 9 [Batch 78/391]: Loss: 0.4028
  Epoch 9 [Batch 117/391]: Loss: 0.2361
  Epoch 9 [Batch 156/391]: Loss: 0.2982
  Epoch 9 [Batch 195/391]: Loss: 0.7319
  Epoch 9 [Batch 234/391]: Loss: 0.2579
  Epoch 9 [Batch 273/391]: Loss: 0.1880
  Epoch 9 [Batch 312/391]: Loss: 0.4478
  Epoch 9 [Batch 351/391]: Loss: 0.3004
  Epoch 9 [Batch 390/391]: Loss: 0.6535
  Epoch 9 Train Summary: Avg Loss: 0.4542, Accuracy: 0.7296
  Validation Summary: Avg Loss: 0.8698, Accuracy: 0.6466, F1 (Macro): 0.6535

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/391]: Loss: 0.2444
  Epoch 10 [Batch 39/391]: Loss: 1.1745
  Epoch 10 [Batch 78/391]: Loss: 0.6681
  Epoch 10 [Batch 117/391]: Loss: 0.4505
  Epoch 10 [Batch 156/391]: Loss: 0.6644
  Epoch 10 [Batch 195/391]: Loss: 0.2703
  Epoch 10 [Batch 234/391]: Loss: 0.3572
  Epoch 10 [Batch 273/391]: Loss: 0.3854
  Epoch 10 [Batch 312/391]: Loss: 0.4194
  Epoch 10 [Batch 351/391]: Loss: 0.4312
  Epoch 10 [Batch 390/391]: Loss: 1.2473
  Epoch 10 Train Summary: Avg Loss: 0.4020, Accuracy: 0.7708
  Validation Summary: Avg Loss: 0.9189, Accuracy: 0.6077, F1 (Macro): 0.6303

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/391]: Loss: 0.3657
  Epoch 11 [Batch 39/391]: Loss: 0.1049
  Epoch 11 [Batch 78/391]: Loss: 0.7328
  Epoch 11 [Batch 117/391]: Loss: 0.7861
  Epoch 11 [Batch 156/391]: Loss: 0.7483
  Epoch 11 [Batch 195/391]: Loss: 0.1906
  Epoch 11 [Batch 234/391]: Loss: 0.3320
  Epoch 11 [Batch 273/391]: Loss: 0.5414
  Epoch 11 [Batch 312/391]: Loss: 0.3251
  Epoch 11 [Batch 351/391]: Loss: 0.3020
  Epoch 11 [Batch 390/391]: Loss: 1.2733
  Epoch 11 Train Summary: Avg Loss: 0.3606, Accuracy: 0.7878
  Validation Summary: Avg Loss: 0.8494, Accuracy: 0.6098, F1 (Macro): 0.6411

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/391]: Loss: 0.1208
  Epoch 12 [Batch 39/391]: Loss: 0.2074
  Epoch 12 [Batch 78/391]: Loss: 0.1099
  Epoch 12 [Batch 117/391]: Loss: 0.2876
  Epoch 12 [Batch 156/391]: Loss: 0.2629
  Epoch 12 [Batch 195/391]: Loss: 0.1381
  Epoch 12 [Batch 234/391]: Loss: 0.4784
  Epoch 12 [Batch 273/391]: Loss: 0.1427
  Epoch 12 [Batch 312/391]: Loss: 0.1376
  Epoch 12 [Batch 351/391]: Loss: 1.0939
  Epoch 12 [Batch 390/391]: Loss: 0.8977
  Epoch 12 Train Summary: Avg Loss: 0.3172, Accuracy: 0.8391
  Validation Summary: Avg Loss: 0.8289, Accuracy: 0.6549, F1 (Macro): 0.6754

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/391]: Loss: 0.2923
  Epoch 13 [Batch 39/391]: Loss: 0.4473
  Epoch 13 [Batch 78/391]: Loss: 0.1471
  Epoch 13 [Batch 117/391]: Loss: 0.2912
  Epoch 13 [Batch 156/391]: Loss: 0.0729
  Epoch 13 [Batch 195/391]: Loss: 0.1390
  Epoch 13 [Batch 234/391]: Loss: 0.0428
  Epoch 13 [Batch 273/391]: Loss: 0.3654
  Epoch 13 [Batch 312/391]: Loss: 0.1654
  Epoch 13 [Batch 351/391]: Loss: 0.1084
  Epoch 13 [Batch 390/391]: Loss: 0.0840
  Epoch 13 Train Summary: Avg Loss: 0.3078, Accuracy: 0.8428
  Validation Summary: Avg Loss: 0.7717, Accuracy: 0.6909, F1 (Macro): 0.6926

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/391]: Loss: 0.1297
  Epoch 14 [Batch 39/391]: Loss: 0.0931
  Epoch 14 [Batch 78/391]: Loss: 0.3934
  Epoch 14 [Batch 117/391]: Loss: 0.1687
  Epoch 14 [Batch 156/391]: Loss: 0.2522
  Epoch 14 [Batch 195/391]: Loss: 1.4607
  Epoch 14 [Batch 234/391]: Loss: 0.3285
  Epoch 14 [Batch 273/391]: Loss: 0.4159
  Epoch 14 [Batch 312/391]: Loss: 0.6549
  Epoch 14 [Batch 351/391]: Loss: 0.1569
  Epoch 14 [Batch 390/391]: Loss: 0.1206
  Epoch 14 Train Summary: Avg Loss: 0.2416, Accuracy: 0.8824
  Validation Summary: Avg Loss: 0.7616, Accuracy: 0.6755, F1 (Macro): 0.6988
Training finished in 85.27 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.7511, Accuracy: 0.5834, F1 (Macro): 0.6051
Final Best Model Stats: Acc: 0.5834, F1: 0.6051, Loss: 0.7511
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=0.0001 drop=0.0 seed=999
================================================================================
Starting experiment: resnet50__384x384__lr-0.0001__drop-0.0__seed-999
Output directory: results_rgb/resnet50__384x384__lr-0.0001__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 3124 images from processed_datasets/rgb_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 390 images from processed_datasets/rgb_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/391]: Loss: 1.1383
  Epoch 0 [Batch 39/391]: Loss: 1.1078
  Epoch 0 [Batch 78/391]: Loss: 0.7459
  Epoch 0 [Batch 117/391]: Loss: 0.9073
  Epoch 0 [Batch 156/391]: Loss: 0.9705
  Epoch 0 [Batch 195/391]: Loss: 0.8524
  Epoch 0 [Batch 234/391]: Loss: 1.1506
  Epoch 0 [Batch 273/391]: Loss: 1.1604
  Epoch 0 [Batch 312/391]: Loss: 1.0980
  Epoch 0 [Batch 351/391]: Loss: 0.5630
  Epoch 0 [Batch 390/391]: Loss: 0.6915
  Epoch 0 Train Summary: Avg Loss: 0.9325, Accuracy: 0.3330
  Validation Summary: Avg Loss: 0.8976, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from inf to 0.8976. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/391]: Loss: 1.1496
  Epoch 1 [Batch 39/391]: Loss: 1.0490
  Epoch 1 [Batch 78/391]: Loss: 0.9393
  Epoch 1 [Batch 117/391]: Loss: 0.7470
  Epoch 1 [Batch 156/391]: Loss: 0.7980
  Epoch 1 [Batch 195/391]: Loss: 0.8786
  Epoch 1 [Batch 234/391]: Loss: 0.6087
  Epoch 1 [Batch 273/391]: Loss: 0.7935
  Epoch 1 [Batch 312/391]: Loss: 0.7500
  Epoch 1 [Batch 351/391]: Loss: 0.9925
  Epoch 1 [Batch 390/391]: Loss: 0.9364
  Epoch 1 Train Summary: Avg Loss: 0.8817, Accuracy: 0.3364
  Validation Summary: Avg Loss: 0.8726, Accuracy: 0.3629, F1 (Macro): 0.3155
  New best model! Val loss improved from 0.8976 to 0.8726. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/391]: Loss: 0.7719
  Epoch 2 [Batch 39/391]: Loss: 0.9365
  Epoch 2 [Batch 78/391]: Loss: 0.7088
  Epoch 2 [Batch 117/391]: Loss: 1.0883
  Epoch 2 [Batch 156/391]: Loss: 1.0447
  Epoch 2 [Batch 195/391]: Loss: 0.8562
  Epoch 2 [Batch 234/391]: Loss: 0.6178
  Epoch 2 [Batch 273/391]: Loss: 0.5809
  Epoch 2 [Batch 312/391]: Loss: 0.7574
  Epoch 2 [Batch 351/391]: Loss: 1.0142
  Epoch 2 [Batch 390/391]: Loss: 0.8134
  Epoch 2 Train Summary: Avg Loss: 0.8462, Accuracy: 0.3645
  Validation Summary: Avg Loss: 0.8678, Accuracy: 0.3865, F1 (Macro): 0.3569
  New best model! Val loss improved from 0.8726 to 0.8678. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/391]: Loss: 0.7918
  Epoch 3 [Batch 39/391]: Loss: 0.8906
  Epoch 3 [Batch 78/391]: Loss: 0.8070
  Epoch 3 [Batch 117/391]: Loss: 0.7178
  Epoch 3 [Batch 156/391]: Loss: 0.9727
  Epoch 3 [Batch 195/391]: Loss: 0.8893
  Epoch 3 [Batch 234/391]: Loss: 0.6469
  Epoch 3 [Batch 273/391]: Loss: 0.5345
  Epoch 3 [Batch 312/391]: Loss: 0.6605
  Epoch 3 [Batch 351/391]: Loss: 0.7862
  Epoch 3 [Batch 390/391]: Loss: 0.6266
  Epoch 3 Train Summary: Avg Loss: 0.8007, Accuracy: 0.4189
  Validation Summary: Avg Loss: 0.8371, Accuracy: 0.4222, F1 (Macro): 0.3958
  New best model! Val loss improved from 0.8678 to 0.8371. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/391]: Loss: 0.6059
  Epoch 4 [Batch 39/391]: Loss: 0.7301
  Epoch 4 [Batch 78/391]: Loss: 0.8068
  Epoch 4 [Batch 117/391]: Loss: 1.2181
  Epoch 4 [Batch 156/391]: Loss: 1.3648
  Epoch 4 [Batch 195/391]: Loss: 0.9920
  Epoch 4 [Batch 234/391]: Loss: 0.6412
  Epoch 4 [Batch 273/391]: Loss: 0.8836
  Epoch 4 [Batch 312/391]: Loss: 0.8018
  Epoch 4 [Batch 351/391]: Loss: 0.6795
  Epoch 4 [Batch 390/391]: Loss: 0.4852
  Epoch 4 Train Summary: Avg Loss: 0.7737, Accuracy: 0.4467
  Validation Summary: Avg Loss: 0.8230, Accuracy: 0.4202, F1 (Macro): 0.3970
  New best model! Val loss improved from 0.8371 to 0.8230. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/391]: Loss: 0.7871
  Epoch 5 [Batch 39/391]: Loss: 0.4263
  Epoch 5 [Batch 78/391]: Loss: 0.7626
  Epoch 5 [Batch 117/391]: Loss: 0.8258
  Epoch 5 [Batch 156/391]: Loss: 1.5786
  Epoch 5 [Batch 195/391]: Loss: 0.5485
  Epoch 5 [Batch 234/391]: Loss: 0.4559
  Epoch 5 [Batch 273/391]: Loss: 0.5450
  Epoch 5 [Batch 312/391]: Loss: 0.6060
  Epoch 5 [Batch 351/391]: Loss: 1.0596
  Epoch 5 [Batch 390/391]: Loss: 0.7266
  Epoch 5 Train Summary: Avg Loss: 0.7026, Accuracy: 0.4923
  Validation Summary: Avg Loss: 0.7586, Accuracy: 0.4797, F1 (Macro): 0.4950
  New best model! Val loss improved from 0.8230 to 0.7586. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/391]: Loss: 1.0307
  Epoch 6 [Batch 39/391]: Loss: 0.5048
  Epoch 6 [Batch 78/391]: Loss: 0.5870
  Epoch 6 [Batch 117/391]: Loss: 0.5265
  Epoch 6 [Batch 156/391]: Loss: 0.3847
  Epoch 6 [Batch 195/391]: Loss: 0.5571
  Epoch 6 [Batch 234/391]: Loss: 0.7580
  Epoch 6 [Batch 273/391]: Loss: 0.4374
  Epoch 6 [Batch 312/391]: Loss: 0.5712
  Epoch 6 [Batch 351/391]: Loss: 1.2488
  Epoch 6 [Batch 390/391]: Loss: 1.0420
  Epoch 6 Train Summary: Avg Loss: 0.6327, Accuracy: 0.5851
  Validation Summary: Avg Loss: 0.8110, Accuracy: 0.6025, F1 (Macro): 0.5986

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/391]: Loss: 0.2884
  Epoch 7 [Batch 39/391]: Loss: 0.4200
  Epoch 7 [Batch 78/391]: Loss: 0.4665
  Epoch 7 [Batch 117/391]: Loss: 0.2980
  Epoch 7 [Batch 156/391]: Loss: 0.4250
  Epoch 7 [Batch 195/391]: Loss: 0.6053
  Epoch 7 [Batch 234/391]: Loss: 0.4973
  Epoch 7 [Batch 273/391]: Loss: 0.4794
  Epoch 7 [Batch 312/391]: Loss: 0.3837
  Epoch 7 [Batch 351/391]: Loss: 0.1926
  Epoch 7 [Batch 390/391]: Loss: 0.6773
  Epoch 7 Train Summary: Avg Loss: 0.5665, Accuracy: 0.6528
  Validation Summary: Avg Loss: 0.7751, Accuracy: 0.6090, F1 (Macro): 0.6103

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/391]: Loss: 0.4111
  Epoch 8 [Batch 39/391]: Loss: 0.4265
  Epoch 8 [Batch 78/391]: Loss: 0.3268
  Epoch 8 [Batch 117/391]: Loss: 0.8822
  Epoch 8 [Batch 156/391]: Loss: 0.6705
  Epoch 8 [Batch 195/391]: Loss: 0.5453
  Epoch 8 [Batch 234/391]: Loss: 0.6070
  Epoch 8 [Batch 273/391]: Loss: 0.6642
  Epoch 8 [Batch 312/391]: Loss: 0.2006
  Epoch 8 [Batch 351/391]: Loss: 0.8219
  Epoch 8 [Batch 390/391]: Loss: 1.0840
  Epoch 8 Train Summary: Avg Loss: 0.5342, Accuracy: 0.6930
  Validation Summary: Avg Loss: 0.7860, Accuracy: 0.5900, F1 (Macro): 0.5966

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/391]: Loss: 0.5646
  Epoch 9 [Batch 39/391]: Loss: 0.2823
  Epoch 9 [Batch 78/391]: Loss: 0.4701
  Epoch 9 [Batch 117/391]: Loss: 0.4455
  Epoch 9 [Batch 156/391]: Loss: 0.4462
  Epoch 9 [Batch 195/391]: Loss: 0.4556
  Epoch 9 [Batch 234/391]: Loss: 0.7243
  Epoch 9 [Batch 273/391]: Loss: 0.3354
  Epoch 9 [Batch 312/391]: Loss: 0.7055
  Epoch 9 [Batch 351/391]: Loss: 0.8202
  Epoch 9 [Batch 390/391]: Loss: 0.5917
  Epoch 9 Train Summary: Avg Loss: 0.4712, Accuracy: 0.7340
  Validation Summary: Avg Loss: 0.7472, Accuracy: 0.6175, F1 (Macro): 0.6160
  New best model! Val loss improved from 0.7586 to 0.7472. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/391]: Loss: 0.4210
  Epoch 10 [Batch 39/391]: Loss: 0.4803
  Epoch 10 [Batch 78/391]: Loss: 0.1087
  Epoch 10 [Batch 117/391]: Loss: 0.9995
  Epoch 10 [Batch 156/391]: Loss: 0.2820
  Epoch 10 [Batch 195/391]: Loss: 0.2557
  Epoch 10 [Batch 234/391]: Loss: 0.8793
  Epoch 10 [Batch 273/391]: Loss: 0.9944
  Epoch 10 [Batch 312/391]: Loss: 0.2892
  Epoch 10 [Batch 351/391]: Loss: 0.3346
  Epoch 10 [Batch 390/391]: Loss: 0.2867
  Epoch 10 Train Summary: Avg Loss: 0.4141, Accuracy: 0.7664
  Validation Summary: Avg Loss: 0.7858, Accuracy: 0.6396, F1 (Macro): 0.6209

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/391]: Loss: 0.3917
  Epoch 11 [Batch 39/391]: Loss: 0.2874
  Epoch 11 [Batch 78/391]: Loss: 0.1100
  Epoch 11 [Batch 117/391]: Loss: 0.2045
  Epoch 11 [Batch 156/391]: Loss: 0.3597
  Epoch 11 [Batch 195/391]: Loss: 0.4484
  Epoch 11 [Batch 234/391]: Loss: 0.2097
  Epoch 11 [Batch 273/391]: Loss: 0.7382
  Epoch 11 [Batch 312/391]: Loss: 0.1320
  Epoch 11 [Batch 351/391]: Loss: 0.3071
  Epoch 11 [Batch 390/391]: Loss: 0.1299
  Epoch 11 Train Summary: Avg Loss: 0.3684, Accuracy: 0.8031
  Validation Summary: Avg Loss: 0.8734, Accuracy: 0.5955, F1 (Macro): 0.6098

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/391]: Loss: 0.5408
  Epoch 12 [Batch 39/391]: Loss: 0.4597
  Epoch 12 [Batch 78/391]: Loss: 0.4502
  Epoch 12 [Batch 117/391]: Loss: 0.1517
  Epoch 12 [Batch 156/391]: Loss: 0.3593
  Epoch 12 [Batch 195/391]: Loss: 0.5085
  Epoch 12 [Batch 234/391]: Loss: 0.1121
  Epoch 12 [Batch 273/391]: Loss: 0.1941
  Epoch 12 [Batch 312/391]: Loss: 0.0967
  Epoch 12 [Batch 351/391]: Loss: 0.6038
  Epoch 12 [Batch 390/391]: Loss: 0.2910
  Epoch 12 Train Summary: Avg Loss: 0.3438, Accuracy: 0.8120
  Validation Summary: Avg Loss: 0.8306, Accuracy: 0.6449, F1 (Macro): 0.6516

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/391]: Loss: 0.3085
  Epoch 13 [Batch 39/391]: Loss: 0.1319
  Epoch 13 [Batch 78/391]: Loss: 0.3812
  Epoch 13 [Batch 117/391]: Loss: 0.3633
  Epoch 13 [Batch 156/391]: Loss: 0.1434
  Epoch 13 [Batch 195/391]: Loss: 0.7470
  Epoch 13 [Batch 234/391]: Loss: 0.3380
  Epoch 13 [Batch 273/391]: Loss: 0.3455
  Epoch 13 [Batch 312/391]: Loss: 0.2244
  Epoch 13 [Batch 351/391]: Loss: 0.1112
  Epoch 13 [Batch 390/391]: Loss: 0.2550
  Epoch 13 Train Summary: Avg Loss: 0.2874, Accuracy: 0.8599
  Validation Summary: Avg Loss: 0.7774, Accuracy: 0.6658, F1 (Macro): 0.6555

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/391]: Loss: 0.1748
  Epoch 14 [Batch 39/391]: Loss: 0.5730
  Epoch 14 [Batch 78/391]: Loss: 0.1367
  Epoch 14 [Batch 117/391]: Loss: 0.1724
  Epoch 14 [Batch 156/391]: Loss: 0.1169
  Epoch 14 [Batch 195/391]: Loss: 0.3145
  Epoch 14 [Batch 234/391]: Loss: 0.2250
  Epoch 14 [Batch 273/391]: Loss: 0.0807
  Epoch 14 [Batch 312/391]: Loss: 0.1861
  Epoch 14 [Batch 351/391]: Loss: 0.0555
  Epoch 14 [Batch 390/391]: Loss: 0.3051
  Epoch 14 Train Summary: Avg Loss: 0.2668, Accuracy: 0.8779
  Validation Summary: Avg Loss: 0.8094, Accuracy: 0.6682, F1 (Macro): 0.6643
Training finished in 85.99 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.7472, Accuracy: 0.6175, F1 (Macro): 0.6160
Final Best Model Stats: Acc: 0.6175, F1: 0.6160, Loss: 0.7472
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=5e-05 drop=0.0 seed=42
================================================================================
Starting experiment: resnet50__384x384__lr-5e-05__drop-0.0__seed-42
Output directory: results_rgb/resnet50__384x384__lr-5e-05__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 3124 images from processed_datasets/rgb_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 390 images from processed_datasets/rgb_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/391]: Loss: 1.1164
  Epoch 0 [Batch 39/391]: Loss: 0.9403
  Epoch 0 [Batch 78/391]: Loss: 0.9511
  Epoch 0 [Batch 117/391]: Loss: 1.1424
  Epoch 0 [Batch 156/391]: Loss: 0.8061
  Epoch 0 [Batch 195/391]: Loss: 1.2367
  Epoch 0 [Batch 234/391]: Loss: 0.8955
  Epoch 0 [Batch 273/391]: Loss: 0.8472
  Epoch 0 [Batch 312/391]: Loss: 0.7046
  Epoch 0 [Batch 351/391]: Loss: 0.7109
  Epoch 0 [Batch 390/391]: Loss: 0.6969
  Epoch 0 Train Summary: Avg Loss: 0.9522, Accuracy: 0.3303
  Validation Summary: Avg Loss: 0.9240, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from inf to 0.9240. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/391]: Loss: 1.0428
  Epoch 1 [Batch 39/391]: Loss: 0.8665
  Epoch 1 [Batch 78/391]: Loss: 0.5894
  Epoch 1 [Batch 117/391]: Loss: 0.7800
  Epoch 1 [Batch 156/391]: Loss: 1.0957
  Epoch 1 [Batch 195/391]: Loss: 0.8581
  Epoch 1 [Batch 234/391]: Loss: 0.9269
  Epoch 1 [Batch 273/391]: Loss: 1.1138
  Epoch 1 [Batch 312/391]: Loss: 0.5849
  Epoch 1 [Batch 351/391]: Loss: 0.8779
  Epoch 1 [Batch 390/391]: Loss: 0.8906
  Epoch 1 Train Summary: Avg Loss: 0.9025, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8961, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9240 to 0.8961. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/391]: Loss: 0.5315
  Epoch 2 [Batch 39/391]: Loss: 1.3534
  Epoch 2 [Batch 78/391]: Loss: 0.8080
  Epoch 2 [Batch 117/391]: Loss: 1.2432
  Epoch 2 [Batch 156/391]: Loss: 0.9150
  Epoch 2 [Batch 195/391]: Loss: 0.6142
  Epoch 2 [Batch 234/391]: Loss: 0.8489
  Epoch 2 [Batch 273/391]: Loss: 1.0864
  Epoch 2 [Batch 312/391]: Loss: 1.1208
  Epoch 2 [Batch 351/391]: Loss: 0.7549
  Epoch 2 [Batch 390/391]: Loss: 1.3783
  Epoch 2 Train Summary: Avg Loss: 0.8795, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8871, Accuracy: 0.3375, F1 (Macro): 0.2620
  New best model! Val loss improved from 0.8961 to 0.8871. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/391]: Loss: 1.0261
  Epoch 3 [Batch 39/391]: Loss: 0.9652
  Epoch 3 [Batch 78/391]: Loss: 0.6719
  Epoch 3 [Batch 117/391]: Loss: 0.8742
  Epoch 3 [Batch 156/391]: Loss: 0.7448
  Epoch 3 [Batch 195/391]: Loss: 1.2013
  Epoch 3 [Batch 234/391]: Loss: 0.9464
  Epoch 3 [Batch 273/391]: Loss: 0.6958
  Epoch 3 [Batch 312/391]: Loss: 0.6697
  Epoch 3 [Batch 351/391]: Loss: 0.5658
  Epoch 3 [Batch 390/391]: Loss: 0.5958
  Epoch 3 Train Summary: Avg Loss: 0.8533, Accuracy: 0.3508
  Validation Summary: Avg Loss: 0.8785, Accuracy: 0.3865, F1 (Macro): 0.3572
  New best model! Val loss improved from 0.8871 to 0.8785. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/391]: Loss: 0.7709
  Epoch 4 [Batch 39/391]: Loss: 0.6394
  Epoch 4 [Batch 78/391]: Loss: 0.8602
  Epoch 4 [Batch 117/391]: Loss: 0.6331
  Epoch 4 [Batch 156/391]: Loss: 0.5339
  Epoch 4 [Batch 195/391]: Loss: 0.7659
  Epoch 4 [Batch 234/391]: Loss: 0.8787
  Epoch 4 [Batch 273/391]: Loss: 0.9017
  Epoch 4 [Batch 312/391]: Loss: 0.5960
  Epoch 4 [Batch 351/391]: Loss: 0.8166
  Epoch 4 [Batch 390/391]: Loss: 0.7067
  Epoch 4 Train Summary: Avg Loss: 0.8337, Accuracy: 0.3729
  Validation Summary: Avg Loss: 0.8746, Accuracy: 0.4074, F1 (Macro): 0.3832
  New best model! Val loss improved from 0.8785 to 0.8746. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/391]: Loss: 0.7605
  Epoch 5 [Batch 39/391]: Loss: 0.6233
  Epoch 5 [Batch 78/391]: Loss: 0.7378
  Epoch 5 [Batch 117/391]: Loss: 0.8438
  Epoch 5 [Batch 156/391]: Loss: 0.6715
  Epoch 5 [Batch 195/391]: Loss: 0.6405
  Epoch 5 [Batch 234/391]: Loss: 0.6556
  Epoch 5 [Batch 273/391]: Loss: 0.7635
  Epoch 5 [Batch 312/391]: Loss: 1.1303
  Epoch 5 [Batch 351/391]: Loss: 0.6787
  Epoch 5 [Batch 390/391]: Loss: 0.5564
  Epoch 5 Train Summary: Avg Loss: 0.8087, Accuracy: 0.3974
  Validation Summary: Avg Loss: 0.8724, Accuracy: 0.4282, F1 (Macro): 0.4021
  New best model! Val loss improved from 0.8746 to 0.8724. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/391]: Loss: 0.6106
  Epoch 6 [Batch 39/391]: Loss: 0.6810
  Epoch 6 [Batch 78/391]: Loss: 0.6261
  Epoch 6 [Batch 117/391]: Loss: 0.8551
  Epoch 6 [Batch 156/391]: Loss: 0.6345
  Epoch 6 [Batch 195/391]: Loss: 1.0091
  Epoch 6 [Batch 234/391]: Loss: 0.8436
  Epoch 6 [Batch 273/391]: Loss: 1.5920
  Epoch 6 [Batch 312/391]: Loss: 0.6047
  Epoch 6 [Batch 351/391]: Loss: 0.6703
  Epoch 6 [Batch 390/391]: Loss: 0.7829
  Epoch 6 Train Summary: Avg Loss: 0.7824, Accuracy: 0.4211
  Validation Summary: Avg Loss: 0.8413, Accuracy: 0.4316, F1 (Macro): 0.4073
  New best model! Val loss improved from 0.8724 to 0.8413. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/391]: Loss: 0.6673
  Epoch 7 [Batch 39/391]: Loss: 1.1938
  Epoch 7 [Batch 78/391]: Loss: 0.4609
  Epoch 7 [Batch 117/391]: Loss: 1.0133
  Epoch 7 [Batch 156/391]: Loss: 0.6767
  Epoch 7 [Batch 195/391]: Loss: 0.8338
  Epoch 7 [Batch 234/391]: Loss: 1.0007
  Epoch 7 [Batch 273/391]: Loss: 0.5425
  Epoch 7 [Batch 312/391]: Loss: 0.6529
  Epoch 7 [Batch 351/391]: Loss: 0.6479
  Epoch 7 [Batch 390/391]: Loss: 0.8902
  Epoch 7 Train Summary: Avg Loss: 0.7576, Accuracy: 0.4468
  Validation Summary: Avg Loss: 0.8376, Accuracy: 0.4453, F1 (Macro): 0.4058
  New best model! Val loss improved from 0.8413 to 0.8376. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/391]: Loss: 0.6131
  Epoch 8 [Batch 39/391]: Loss: 0.8942
  Epoch 8 [Batch 78/391]: Loss: 0.6836
  Epoch 8 [Batch 117/391]: Loss: 0.7539
  Epoch 8 [Batch 156/391]: Loss: 1.0892
  Epoch 8 [Batch 195/391]: Loss: 0.6789
  Epoch 8 [Batch 234/391]: Loss: 0.6311
  Epoch 8 [Batch 273/391]: Loss: 0.5198
  Epoch 8 [Batch 312/391]: Loss: 1.1426
  Epoch 8 [Batch 351/391]: Loss: 0.7783
  Epoch 8 [Batch 390/391]: Loss: 0.4218
  Epoch 8 Train Summary: Avg Loss: 0.7298, Accuracy: 0.4678
  Validation Summary: Avg Loss: 0.8222, Accuracy: 0.4649, F1 (Macro): 0.4400
  New best model! Val loss improved from 0.8376 to 0.8222. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/391]: Loss: 0.6498
  Epoch 9 [Batch 39/391]: Loss: 0.5856
  Epoch 9 [Batch 78/391]: Loss: 0.4437
  Epoch 9 [Batch 117/391]: Loss: 1.0593
  Epoch 9 [Batch 156/391]: Loss: 0.7749
  Epoch 9 [Batch 195/391]: Loss: 0.8433
  Epoch 9 [Batch 234/391]: Loss: 0.4324
  Epoch 9 [Batch 273/391]: Loss: 1.0452
  Epoch 9 [Batch 312/391]: Loss: 0.6398
  Epoch 9 [Batch 351/391]: Loss: 0.5157
  Epoch 9 [Batch 390/391]: Loss: 0.4128
  Epoch 9 Train Summary: Avg Loss: 0.6932, Accuracy: 0.5019
  Validation Summary: Avg Loss: 0.8015, Accuracy: 0.4791, F1 (Macro): 0.4525
  New best model! Val loss improved from 0.8222 to 0.8015. Saving...

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/391]: Loss: 0.7637
  Epoch 10 [Batch 39/391]: Loss: 0.8380
  Epoch 10 [Batch 78/391]: Loss: 0.6590
  Epoch 10 [Batch 117/391]: Loss: 0.9420
  Epoch 10 [Batch 156/391]: Loss: 0.5354
  Epoch 10 [Batch 195/391]: Loss: 0.6310
  Epoch 10 [Batch 234/391]: Loss: 0.5044
  Epoch 10 [Batch 273/391]: Loss: 1.0352
  Epoch 10 [Batch 312/391]: Loss: 0.5863
  Epoch 10 [Batch 351/391]: Loss: 0.3512
  Epoch 10 [Batch 390/391]: Loss: 0.6262
  Epoch 10 Train Summary: Avg Loss: 0.6588, Accuracy: 0.5588
  Validation Summary: Avg Loss: 0.7994, Accuracy: 0.5020, F1 (Macro): 0.5050
  New best model! Val loss improved from 0.8015 to 0.7994. Saving...

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/391]: Loss: 0.9747
  Epoch 11 [Batch 39/391]: Loss: 0.6787
  Epoch 11 [Batch 78/391]: Loss: 0.5001
  Epoch 11 [Batch 117/391]: Loss: 0.4780
  Epoch 11 [Batch 156/391]: Loss: 0.3853
  Epoch 11 [Batch 195/391]: Loss: 0.4059
  Epoch 11 [Batch 234/391]: Loss: 0.6972
  Epoch 11 [Batch 273/391]: Loss: 0.4705
  Epoch 11 [Batch 312/391]: Loss: 0.9893
  Epoch 11 [Batch 351/391]: Loss: 0.6986
  Epoch 11 [Batch 390/391]: Loss: 0.3777
  Epoch 11 Train Summary: Avg Loss: 0.6176, Accuracy: 0.5974
  Validation Summary: Avg Loss: 0.8004, Accuracy: 0.5038, F1 (Macro): 0.5186

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/391]: Loss: 0.4529
  Epoch 12 [Batch 39/391]: Loss: 0.7057
  Epoch 12 [Batch 78/391]: Loss: 0.5538
  Epoch 12 [Batch 117/391]: Loss: 0.6221
  Epoch 12 [Batch 156/391]: Loss: 0.8975
  Epoch 12 [Batch 195/391]: Loss: 0.8075
  Epoch 12 [Batch 234/391]: Loss: 0.3794
  Epoch 12 [Batch 273/391]: Loss: 0.4277
  Epoch 12 [Batch 312/391]: Loss: 0.6360
  Epoch 12 [Batch 351/391]: Loss: 0.3682
  Epoch 12 [Batch 390/391]: Loss: 0.4169
  Epoch 12 Train Summary: Avg Loss: 0.5763, Accuracy: 0.6352
  Validation Summary: Avg Loss: 0.7588, Accuracy: 0.5650, F1 (Macro): 0.5773
  New best model! Val loss improved from 0.7994 to 0.7588. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/391]: Loss: 0.2607
  Epoch 13 [Batch 39/391]: Loss: 1.2110
  Epoch 13 [Batch 78/391]: Loss: 0.5453
  Epoch 13 [Batch 117/391]: Loss: 0.5492
  Epoch 13 [Batch 156/391]: Loss: 0.3731
  Epoch 13 [Batch 195/391]: Loss: 1.2882
  Epoch 13 [Batch 234/391]: Loss: 0.4735
  Epoch 13 [Batch 273/391]: Loss: 1.0105
  Epoch 13 [Batch 312/391]: Loss: 0.6892
  Epoch 13 [Batch 351/391]: Loss: 0.4571
  Epoch 13 [Batch 390/391]: Loss: 0.4731
  Epoch 13 Train Summary: Avg Loss: 0.5667, Accuracy: 0.6490
  Validation Summary: Avg Loss: 0.7414, Accuracy: 0.6055, F1 (Macro): 0.6095
  New best model! Val loss improved from 0.7588 to 0.7414. Saving...

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/391]: Loss: 0.5848
  Epoch 14 [Batch 39/391]: Loss: 0.4983
  Epoch 14 [Batch 78/391]: Loss: 0.5919
  Epoch 14 [Batch 117/391]: Loss: 0.7652
  Epoch 14 [Batch 156/391]: Loss: 0.4323
  Epoch 14 [Batch 195/391]: Loss: 0.4692
  Epoch 14 [Batch 234/391]: Loss: 0.5134
  Epoch 14 [Batch 273/391]: Loss: 0.4672
  Epoch 14 [Batch 312/391]: Loss: 0.9058
  Epoch 14 [Batch 351/391]: Loss: 0.4292
  Epoch 14 [Batch 390/391]: Loss: 0.7479
  Epoch 14 Train Summary: Avg Loss: 0.5214, Accuracy: 0.6894
  Validation Summary: Avg Loss: 0.7875, Accuracy: 0.5482, F1 (Macro): 0.5661
Training finished in 127.32 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.7414, Accuracy: 0.6055, F1 (Macro): 0.6095
Final Best Model Stats: Acc: 0.6055, F1: 0.6095, Loss: 0.7414
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=5e-05 drop=0.0 seed=123
================================================================================
Starting experiment: resnet50__384x384__lr-5e-05__drop-0.0__seed-123
Output directory: results_rgb/resnet50__384x384__lr-5e-05__drop-0.0__seed-123
Loading datasets...
[train set] Loaded 3124 images from processed_datasets/rgb_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 390 images from processed_datasets/rgb_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/391]: Loss: 1.1208
  Epoch 0 [Batch 39/391]: Loss: 1.0023
  Epoch 0 [Batch 78/391]: Loss: 1.0470
  Epoch 0 [Batch 117/391]: Loss: 1.0040
  Epoch 0 [Batch 156/391]: Loss: 0.7811
  Epoch 0 [Batch 195/391]: Loss: 0.7006
  Epoch 0 [Batch 234/391]: Loss: 1.2461
  Epoch 0 [Batch 273/391]: Loss: 0.7495
  Epoch 0 [Batch 312/391]: Loss: 0.7303
  Epoch 0 [Batch 351/391]: Loss: 1.4377
  Epoch 0 [Batch 390/391]: Loss: 1.1662
  Epoch 0 Train Summary: Avg Loss: 0.9472, Accuracy: 0.3314
  Validation Summary: Avg Loss: 0.9149, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from inf to 0.9149. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/391]: Loss: 0.9505
  Epoch 1 [Batch 39/391]: Loss: 0.9289
  Epoch 1 [Batch 78/391]: Loss: 0.7950
  Epoch 1 [Batch 117/391]: Loss: 0.8089
  Epoch 1 [Batch 156/391]: Loss: 1.0811
  Epoch 1 [Batch 195/391]: Loss: 0.6311
  Epoch 1 [Batch 234/391]: Loss: 0.7063
  Epoch 1 [Batch 273/391]: Loss: 1.1639
  Epoch 1 [Batch 312/391]: Loss: 0.7824
  Epoch 1 [Batch 351/391]: Loss: 0.8690
  Epoch 1 [Batch 390/391]: Loss: 1.0099
  Epoch 1 Train Summary: Avg Loss: 0.9018, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8990, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9149 to 0.8990. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/391]: Loss: 1.0512
  Epoch 2 [Batch 39/391]: Loss: 0.8231
  Epoch 2 [Batch 78/391]: Loss: 0.7068
  Epoch 2 [Batch 117/391]: Loss: 0.7647
  Epoch 2 [Batch 156/391]: Loss: 0.8375
  Epoch 2 [Batch 195/391]: Loss: 0.5381
  Epoch 2 [Batch 234/391]: Loss: 0.6266
  Epoch 2 [Batch 273/391]: Loss: 0.7232
  Epoch 2 [Batch 312/391]: Loss: 0.6975
  Epoch 2 [Batch 351/391]: Loss: 0.9369
  Epoch 2 [Batch 390/391]: Loss: 0.5345
  Epoch 2 Train Summary: Avg Loss: 0.8839, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8718, Accuracy: 0.3418, F1 (Macro): 0.2679
  New best model! Val loss improved from 0.8990 to 0.8718. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/391]: Loss: 1.0573
  Epoch 3 [Batch 39/391]: Loss: 0.7524
  Epoch 3 [Batch 78/391]: Loss: 0.6921
  Epoch 3 [Batch 117/391]: Loss: 1.0489
  Epoch 3 [Batch 156/391]: Loss: 0.7210
  Epoch 3 [Batch 195/391]: Loss: 0.6087
  Epoch 3 [Batch 234/391]: Loss: 0.8272
  Epoch 3 [Batch 273/391]: Loss: 1.2605
  Epoch 3 [Batch 312/391]: Loss: 0.6855
  Epoch 3 [Batch 351/391]: Loss: 1.1310
  Epoch 3 [Batch 390/391]: Loss: 1.2720
  Epoch 3 Train Summary: Avg Loss: 0.8596, Accuracy: 0.3471
  Validation Summary: Avg Loss: 0.8650, Accuracy: 0.3685, F1 (Macro): 0.3259
  New best model! Val loss improved from 0.8718 to 0.8650. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/391]: Loss: 0.9390
  Epoch 4 [Batch 39/391]: Loss: 0.8686
  Epoch 4 [Batch 78/391]: Loss: 0.7511
  Epoch 4 [Batch 117/391]: Loss: 1.3821
  Epoch 4 [Batch 156/391]: Loss: 0.9107
  Epoch 4 [Batch 195/391]: Loss: 1.3163
  Epoch 4 [Batch 234/391]: Loss: 0.7676
  Epoch 4 [Batch 273/391]: Loss: 1.1388
  Epoch 4 [Batch 312/391]: Loss: 0.9826
  Epoch 4 [Batch 351/391]: Loss: 0.8570
  Epoch 4 [Batch 390/391]: Loss: 0.6451
  Epoch 4 Train Summary: Avg Loss: 0.8328, Accuracy: 0.3713
  Validation Summary: Avg Loss: 0.8536, Accuracy: 0.4232, F1 (Macro): 0.3992
  New best model! Val loss improved from 0.8650 to 0.8536. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/391]: Loss: 1.5355
  Epoch 5 [Batch 39/391]: Loss: 1.0039
  Epoch 5 [Batch 78/391]: Loss: 0.4799
  Epoch 5 [Batch 117/391]: Loss: 0.5777
  Epoch 5 [Batch 156/391]: Loss: 0.6661
  Epoch 5 [Batch 195/391]: Loss: 0.8913
  Epoch 5 [Batch 234/391]: Loss: 0.8287
  Epoch 5 [Batch 273/391]: Loss: 0.7715
  Epoch 5 [Batch 312/391]: Loss: 1.0572
  Epoch 5 [Batch 351/391]: Loss: 0.5203
  Epoch 5 [Batch 390/391]: Loss: 0.9865
  Epoch 5 Train Summary: Avg Loss: 0.8103, Accuracy: 0.4083
  Validation Summary: Avg Loss: 0.8374, Accuracy: 0.4106, F1 (Macro): 0.3855
  New best model! Val loss improved from 0.8536 to 0.8374. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/391]: Loss: 0.7763
  Epoch 6 [Batch 39/391]: Loss: 0.6410
  Epoch 6 [Batch 78/391]: Loss: 0.9891
  Epoch 6 [Batch 117/391]: Loss: 0.8924
  Epoch 6 [Batch 156/391]: Loss: 0.7349
  Epoch 6 [Batch 195/391]: Loss: 0.8907
  Epoch 6 [Batch 234/391]: Loss: 0.5469
  Epoch 6 [Batch 273/391]: Loss: 0.7417
  Epoch 6 [Batch 312/391]: Loss: 0.9523
  Epoch 6 [Batch 351/391]: Loss: 0.8412
  Epoch 6 [Batch 390/391]: Loss: 0.5620
  Epoch 6 Train Summary: Avg Loss: 0.7772, Accuracy: 0.4353
  Validation Summary: Avg Loss: 0.8359, Accuracy: 0.4279, F1 (Macro): 0.4009
  New best model! Val loss improved from 0.8374 to 0.8359. Saving...

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/391]: Loss: 1.0990
  Epoch 7 [Batch 39/391]: Loss: 1.1793
  Epoch 7 [Batch 78/391]: Loss: 0.7233
  Epoch 7 [Batch 117/391]: Loss: 0.5701
  Epoch 7 [Batch 156/391]: Loss: 0.9158
  Epoch 7 [Batch 195/391]: Loss: 0.5987
  Epoch 7 [Batch 234/391]: Loss: 0.5675
  Epoch 7 [Batch 273/391]: Loss: 0.7135
  Epoch 7 [Batch 312/391]: Loss: 1.0361
  Epoch 7 [Batch 351/391]: Loss: 0.6018
  Epoch 7 [Batch 390/391]: Loss: 2.0424
  Epoch 7 Train Summary: Avg Loss: 0.7483, Accuracy: 0.4552
  Validation Summary: Avg Loss: 0.8290, Accuracy: 0.4355, F1 (Macro): 0.4097
  New best model! Val loss improved from 0.8359 to 0.8290. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/391]: Loss: 0.5369
  Epoch 8 [Batch 39/391]: Loss: 0.4848
  Epoch 8 [Batch 78/391]: Loss: 1.2638
  Epoch 8 [Batch 117/391]: Loss: 0.7985
  Epoch 8 [Batch 156/391]: Loss: 0.4860
  Epoch 8 [Batch 195/391]: Loss: 0.9792
  Epoch 8 [Batch 234/391]: Loss: 0.5115
  Epoch 8 [Batch 273/391]: Loss: 0.6403
  Epoch 8 [Batch 312/391]: Loss: 0.5882
  Epoch 8 [Batch 351/391]: Loss: 0.7598
  Epoch 8 [Batch 390/391]: Loss: 1.8279
  Epoch 8 Train Summary: Avg Loss: 0.7144, Accuracy: 0.4849
  Validation Summary: Avg Loss: 0.8177, Accuracy: 0.4700, F1 (Macro): 0.4503
  New best model! Val loss improved from 0.8290 to 0.8177. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/391]: Loss: 0.4766
  Epoch 9 [Batch 39/391]: Loss: 0.8526
  Epoch 9 [Batch 78/391]: Loss: 0.6451
  Epoch 9 [Batch 117/391]: Loss: 0.5663
  Epoch 9 [Batch 156/391]: Loss: 0.5537
  Epoch 9 [Batch 195/391]: Loss: 0.7564
  Epoch 9 [Batch 234/391]: Loss: 0.4578
  Epoch 9 [Batch 273/391]: Loss: 0.4783
  Epoch 9 [Batch 312/391]: Loss: 0.7132
  Epoch 9 [Batch 351/391]: Loss: 0.4300
  Epoch 9 [Batch 390/391]: Loss: 0.4632
  Epoch 9 Train Summary: Avg Loss: 0.6836, Accuracy: 0.5087
  Validation Summary: Avg Loss: 0.8230, Accuracy: 0.4886, F1 (Macro): 0.4900

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/391]: Loss: 0.5157
  Epoch 10 [Batch 39/391]: Loss: 1.1288
  Epoch 10 [Batch 78/391]: Loss: 0.7003
  Epoch 10 [Batch 117/391]: Loss: 0.7374
  Epoch 10 [Batch 156/391]: Loss: 0.9292
  Epoch 10 [Batch 195/391]: Loss: 0.3778
  Epoch 10 [Batch 234/391]: Loss: 0.7415
  Epoch 10 [Batch 273/391]: Loss: 0.5746
  Epoch 10 [Batch 312/391]: Loss: 0.7590
  Epoch 10 [Batch 351/391]: Loss: 0.7795
  Epoch 10 [Batch 390/391]: Loss: 1.4790
  Epoch 10 Train Summary: Avg Loss: 0.6432, Accuracy: 0.5697
  Validation Summary: Avg Loss: 0.8257, Accuracy: 0.5012, F1 (Macro): 0.5210

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/391]: Loss: 0.5347
  Epoch 11 [Batch 39/391]: Loss: 0.3830
  Epoch 11 [Batch 78/391]: Loss: 0.6241
  Epoch 11 [Batch 117/391]: Loss: 0.7861
  Epoch 11 [Batch 156/391]: Loss: 0.8216
  Epoch 11 [Batch 195/391]: Loss: 0.4235
  Epoch 11 [Batch 234/391]: Loss: 0.7189
  Epoch 11 [Batch 273/391]: Loss: 0.7881
  Epoch 11 [Batch 312/391]: Loss: 0.7459
  Epoch 11 [Batch 351/391]: Loss: 0.4622
  Epoch 11 [Batch 390/391]: Loss: 1.6009
  Epoch 11 Train Summary: Avg Loss: 0.6019, Accuracy: 0.5896
  Validation Summary: Avg Loss: 0.8339, Accuracy: 0.5332, F1 (Macro): 0.5627

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/391]: Loss: 0.3747
  Epoch 12 [Batch 39/391]: Loss: 0.4811
  Epoch 12 [Batch 78/391]: Loss: 0.3637
  Epoch 12 [Batch 117/391]: Loss: 0.4567
  Epoch 12 [Batch 156/391]: Loss: 0.5026
  Epoch 12 [Batch 195/391]: Loss: 0.2841
  Epoch 12 [Batch 234/391]: Loss: 0.9777
  Epoch 12 [Batch 273/391]: Loss: 0.3394
  Epoch 12 [Batch 312/391]: Loss: 0.4952
  Epoch 12 [Batch 351/391]: Loss: 1.1435
  Epoch 12 [Batch 390/391]: Loss: 0.8579
  Epoch 12 Train Summary: Avg Loss: 0.5760, Accuracy: 0.6316
  Validation Summary: Avg Loss: 0.8143, Accuracy: 0.5411, F1 (Macro): 0.5662
  New best model! Val loss improved from 0.8177 to 0.8143. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/391]: Loss: 0.5760
  Epoch 13 [Batch 39/391]: Loss: 0.8240
  Epoch 13 [Batch 78/391]: Loss: 0.5429
  Epoch 13 [Batch 117/391]: Loss: 0.4109
  Epoch 13 [Batch 156/391]: Loss: 0.3583
  Epoch 13 [Batch 195/391]: Loss: 0.5356
  Epoch 13 [Batch 234/391]: Loss: 0.4270
  Epoch 13 [Batch 273/391]: Loss: 0.7561
  Epoch 13 [Batch 312/391]: Loss: 0.4296
  Epoch 13 [Batch 351/391]: Loss: 0.3281
  Epoch 13 [Batch 390/391]: Loss: 0.4648
  Epoch 13 Train Summary: Avg Loss: 0.5402, Accuracy: 0.6535
  Validation Summary: Avg Loss: 0.8157, Accuracy: 0.5765, F1 (Macro): 0.5814

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/391]: Loss: 0.2899
  Epoch 14 [Batch 39/391]: Loss: 0.2746
  Epoch 14 [Batch 78/391]: Loss: 0.3514
  Epoch 14 [Batch 117/391]: Loss: 0.2257
  Epoch 14 [Batch 156/391]: Loss: 0.6041
  Epoch 14 [Batch 195/391]: Loss: 1.3090
  Epoch 14 [Batch 234/391]: Loss: 0.8498
  Epoch 14 [Batch 273/391]: Loss: 0.6163
  Epoch 14 [Batch 312/391]: Loss: 1.1242
  Epoch 14 [Batch 351/391]: Loss: 0.2836
  Epoch 14 [Batch 390/391]: Loss: 0.6150
  Epoch 14 Train Summary: Avg Loss: 0.5117, Accuracy: 0.6791
  Validation Summary: Avg Loss: 0.8079, Accuracy: 0.5770, F1 (Macro): 0.5950
  New best model! Val loss improved from 0.8143 to 0.8079. Saving...
Training finished in 119.41 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.8079, Accuracy: 0.5770, F1 (Macro): 0.5950
Final Best Model Stats: Acc: 0.5770, F1: 0.5950, Loss: 0.8079
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=5e-05 drop=0.0 seed=999
================================================================================
Starting experiment: resnet50__384x384__lr-5e-05__drop-0.0__seed-999
Output directory: results_rgb/resnet50__384x384__lr-5e-05__drop-0.0__seed-999
Loading datasets...
[train set] Loaded 3124 images from processed_datasets/rgb_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 390 images from processed_datasets/rgb_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
  Epoch 0 [Batch 0/391]: Loss: 1.1383
  Epoch 0 [Batch 39/391]: Loss: 1.0926
  Epoch 0 [Batch 78/391]: Loss: 0.8754
  Epoch 0 [Batch 117/391]: Loss: 0.9162
  Epoch 0 [Batch 156/391]: Loss: 0.9992
  Epoch 0 [Batch 195/391]: Loss: 0.9128
  Epoch 0 [Batch 234/391]: Loss: 1.1354
  Epoch 0 [Batch 273/391]: Loss: 1.1788
  Epoch 0 [Batch 312/391]: Loss: 1.1069
  Epoch 0 [Batch 351/391]: Loss: 0.5620
  Epoch 0 [Batch 390/391]: Loss: 0.7303
  Epoch 0 Train Summary: Avg Loss: 0.9533, Accuracy: 0.3321
  Validation Summary: Avg Loss: 0.9207, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from inf to 0.9207. Saving...

--- Epoch 1/14 ---
  Epoch 1 [Batch 0/391]: Loss: 1.1602
  Epoch 1 [Batch 39/391]: Loss: 1.0976
  Epoch 1 [Batch 78/391]: Loss: 0.9217
  Epoch 1 [Batch 117/391]: Loss: 0.7585
  Epoch 1 [Batch 156/391]: Loss: 0.7937
  Epoch 1 [Batch 195/391]: Loss: 0.9653
  Epoch 1 [Batch 234/391]: Loss: 0.6095
  Epoch 1 [Batch 273/391]: Loss: 0.8679
  Epoch 1 [Batch 312/391]: Loss: 0.8104
  Epoch 1 [Batch 351/391]: Loss: 1.1445
  Epoch 1 [Batch 390/391]: Loss: 0.9869
  Epoch 1 Train Summary: Avg Loss: 0.9058, Accuracy: 0.3333
  Validation Summary: Avg Loss: 0.8993, Accuracy: 0.3333, F1 (Macro): 0.2453
  New best model! Val loss improved from 0.9207 to 0.8993. Saving...

--- Epoch 2/14 ---
  Epoch 2 [Batch 0/391]: Loss: 0.7948
  Epoch 2 [Batch 39/391]: Loss: 1.0144
  Epoch 2 [Batch 78/391]: Loss: 0.7777
  Epoch 2 [Batch 117/391]: Loss: 1.0174
  Epoch 2 [Batch 156/391]: Loss: 1.0164
  Epoch 2 [Batch 195/391]: Loss: 0.8305
  Epoch 2 [Batch 234/391]: Loss: 0.7004
  Epoch 2 [Batch 273/391]: Loss: 0.6481
  Epoch 2 [Batch 312/391]: Loss: 0.8393
  Epoch 2 [Batch 351/391]: Loss: 0.9911
  Epoch 2 [Batch 390/391]: Loss: 0.9742
  Epoch 2 Train Summary: Avg Loss: 0.8826, Accuracy: 0.3337
  Validation Summary: Avg Loss: 0.8810, Accuracy: 0.3447, F1 (Macro): 0.2694
  New best model! Val loss improved from 0.8993 to 0.8810. Saving...

--- Epoch 3/14 ---
  Epoch 3 [Batch 0/391]: Loss: 0.9320
  Epoch 3 [Batch 39/391]: Loss: 0.9768
  Epoch 3 [Batch 78/391]: Loss: 0.8669
  Epoch 3 [Batch 117/391]: Loss: 0.8960
  Epoch 3 [Batch 156/391]: Loss: 0.8997
  Epoch 3 [Batch 195/391]: Loss: 0.9735
  Epoch 3 [Batch 234/391]: Loss: 0.7384
  Epoch 3 [Batch 273/391]: Loss: 0.6051
  Epoch 3 [Batch 312/391]: Loss: 0.7867
  Epoch 3 [Batch 351/391]: Loss: 0.6593
  Epoch 3 [Batch 390/391]: Loss: 0.6480
  Epoch 3 Train Summary: Avg Loss: 0.8562, Accuracy: 0.3505
  Validation Summary: Avg Loss: 0.8739, Accuracy: 0.3750, F1 (Macro): 0.3440
  New best model! Val loss improved from 0.8810 to 0.8739. Saving...

--- Epoch 4/14 ---
  Epoch 4 [Batch 0/391]: Loss: 0.7235
  Epoch 4 [Batch 39/391]: Loss: 0.8597
  Epoch 4 [Batch 78/391]: Loss: 0.6914
  Epoch 4 [Batch 117/391]: Loss: 1.1502
  Epoch 4 [Batch 156/391]: Loss: 1.3221
  Epoch 4 [Batch 195/391]: Loss: 0.8115
  Epoch 4 [Batch 234/391]: Loss: 0.7833
  Epoch 4 [Batch 273/391]: Loss: 1.0774
  Epoch 4 [Batch 312/391]: Loss: 0.8836
  Epoch 4 [Batch 351/391]: Loss: 0.5775
  Epoch 4 [Batch 390/391]: Loss: 0.4759
  Epoch 4 Train Summary: Avg Loss: 0.8413, Accuracy: 0.3707
  Validation Summary: Avg Loss: 0.8673, Accuracy: 0.3962, F1 (Macro): 0.3701
  New best model! Val loss improved from 0.8739 to 0.8673. Saving...

--- Epoch 5/14 ---
  Epoch 5 [Batch 0/391]: Loss: 0.7384
  Epoch 5 [Batch 39/391]: Loss: 0.6501
  Epoch 5 [Batch 78/391]: Loss: 0.7929
  Epoch 5 [Batch 117/391]: Loss: 0.9280
  Epoch 5 [Batch 156/391]: Loss: 1.3644
  Epoch 5 [Batch 195/391]: Loss: 0.5880
  Epoch 5 [Batch 234/391]: Loss: 0.6364
  Epoch 5 [Batch 273/391]: Loss: 0.4905
  Epoch 5 [Batch 312/391]: Loss: 0.8467
  Epoch 5 [Batch 351/391]: Loss: 1.0261
  Epoch 5 [Batch 390/391]: Loss: 0.8712
  Epoch 5 Train Summary: Avg Loss: 0.8210, Accuracy: 0.3934
  Validation Summary: Avg Loss: 0.8521, Accuracy: 0.3949, F1 (Macro): 0.3683
  New best model! Val loss improved from 0.8673 to 0.8521. Saving...

--- Epoch 6/14 ---
  Epoch 6 [Batch 0/391]: Loss: 0.9815
  Epoch 6 [Batch 39/391]: Loss: 0.6267
  Epoch 6 [Batch 78/391]: Loss: 0.7375
  Epoch 6 [Batch 117/391]: Loss: 0.9222
  Epoch 6 [Batch 156/391]: Loss: 0.5369
  Epoch 6 [Batch 195/391]: Loss: 0.7257
  Epoch 6 [Batch 234/391]: Loss: 0.7337
  Epoch 6 [Batch 273/391]: Loss: 0.4792
  Epoch 6 [Batch 312/391]: Loss: 0.7076
  Epoch 6 [Batch 351/391]: Loss: 1.1160
  Epoch 6 [Batch 390/391]: Loss: 1.2638
  Epoch 6 Train Summary: Avg Loss: 0.7921, Accuracy: 0.4174
  Validation Summary: Avg Loss: 0.8860, Accuracy: 0.4380, F1 (Macro): 0.3979

--- Epoch 7/14 ---
  Epoch 7 [Batch 0/391]: Loss: 0.6419
  Epoch 7 [Batch 39/391]: Loss: 0.7203
  Epoch 7 [Batch 78/391]: Loss: 0.8161
  Epoch 7 [Batch 117/391]: Loss: 0.5848
  Epoch 7 [Batch 156/391]: Loss: 0.5079
  Epoch 7 [Batch 195/391]: Loss: 0.7489
  Epoch 7 [Batch 234/391]: Loss: 0.9771
  Epoch 7 [Batch 273/391]: Loss: 0.7807
  Epoch 7 [Batch 312/391]: Loss: 0.5438
  Epoch 7 [Batch 351/391]: Loss: 0.5261
  Epoch 7 [Batch 390/391]: Loss: 0.7494
  Epoch 7 Train Summary: Avg Loss: 0.7635, Accuracy: 0.4472
  Validation Summary: Avg Loss: 0.8323, Accuracy: 0.4504, F1 (Macro): 0.4187
  New best model! Val loss improved from 0.8521 to 0.8323. Saving...

--- Epoch 8/14 ---
  Epoch 8 [Batch 0/391]: Loss: 0.7140
  Epoch 8 [Batch 39/391]: Loss: 0.5829
  Epoch 8 [Batch 78/391]: Loss: 0.6019
  Epoch 8 [Batch 117/391]: Loss: 0.8190
  Epoch 8 [Batch 156/391]: Loss: 0.6658
  Epoch 8 [Batch 195/391]: Loss: 0.6558
  Epoch 8 [Batch 234/391]: Loss: 0.7095
  Epoch 8 [Batch 273/391]: Loss: 0.8859
  Epoch 8 [Batch 312/391]: Loss: 0.3838
  Epoch 8 [Batch 351/391]: Loss: 0.9784
  Epoch 8 [Batch 390/391]: Loss: 1.2256
  Epoch 8 Train Summary: Avg Loss: 0.7341, Accuracy: 0.4636
  Validation Summary: Avg Loss: 0.8147, Accuracy: 0.4452, F1 (Macro): 0.4169
  New best model! Val loss improved from 0.8323 to 0.8147. Saving...

--- Epoch 9/14 ---
  Epoch 9 [Batch 0/391]: Loss: 0.7209
  Epoch 9 [Batch 39/391]: Loss: 0.7184
  Epoch 9 [Batch 78/391]: Loss: 0.5173
  Epoch 9 [Batch 117/391]: Loss: 0.3422
  Epoch 9 [Batch 156/391]: Loss: 0.5245
  Epoch 9 [Batch 195/391]: Loss: 0.8505
  Epoch 9 [Batch 234/391]: Loss: 0.8837
  Epoch 9 [Batch 273/391]: Loss: 0.7040
  Epoch 9 [Batch 312/391]: Loss: 0.7361
  Epoch 9 [Batch 351/391]: Loss: 0.9874
  Epoch 9 [Batch 390/391]: Loss: 0.8284
  Epoch 9 Train Summary: Avg Loss: 0.7095, Accuracy: 0.4719
  Validation Summary: Avg Loss: 0.8266, Accuracy: 0.4489, F1 (Macro): 0.4171

--- Epoch 10/14 ---
  Epoch 10 [Batch 0/391]: Loss: 0.7254
  Epoch 10 [Batch 39/391]: Loss: 0.7399
  Epoch 10 [Batch 78/391]: Loss: 0.2936
  Epoch 10 [Batch 117/391]: Loss: 1.4295
  Epoch 10 [Batch 156/391]: Loss: 0.6694
  Epoch 10 [Batch 195/391]: Loss: 0.5987
  Epoch 10 [Batch 234/391]: Loss: 0.7717
  Epoch 10 [Batch 273/391]: Loss: 0.8912
  Epoch 10 [Batch 312/391]: Loss: 0.6668
  Epoch 10 [Batch 351/391]: Loss: 0.6837
  Epoch 10 [Batch 390/391]: Loss: 0.6417
  Epoch 10 Train Summary: Avg Loss: 0.6709, Accuracy: 0.5035
  Validation Summary: Avg Loss: 0.8352, Accuracy: 0.4936, F1 (Macro): 0.4946

--- Epoch 11/14 ---
  Epoch 11 [Batch 0/391]: Loss: 0.6793
  Epoch 11 [Batch 39/391]: Loss: 0.6549
  Epoch 11 [Batch 78/391]: Loss: 0.4141
  Epoch 11 [Batch 117/391]: Loss: 0.5345
  Epoch 11 [Batch 156/391]: Loss: 0.7341
  Epoch 11 [Batch 195/391]: Loss: 0.6805
  Epoch 11 [Batch 234/391]: Loss: 0.7602
  Epoch 11 [Batch 273/391]: Loss: 0.6596
  Epoch 11 [Batch 312/391]: Loss: 0.4975
  Epoch 11 [Batch 351/391]: Loss: 0.4915
  Epoch 11 [Batch 390/391]: Loss: 0.7885
  Epoch 11 Train Summary: Avg Loss: 0.6530, Accuracy: 0.5547
  Validation Summary: Avg Loss: 0.8069, Accuracy: 0.5146, F1 (Macro): 0.5292
  New best model! Val loss improved from 0.8147 to 0.8069. Saving...

--- Epoch 12/14 ---
  Epoch 12 [Batch 0/391]: Loss: 0.3695
  Epoch 12 [Batch 39/391]: Loss: 0.5425
  Epoch 12 [Batch 78/391]: Loss: 0.4791
  Epoch 12 [Batch 117/391]: Loss: 0.6435
  Epoch 12 [Batch 156/391]: Loss: 0.6230
  Epoch 12 [Batch 195/391]: Loss: 0.7816
  Epoch 12 [Batch 234/391]: Loss: 0.4776
  Epoch 12 [Batch 273/391]: Loss: 0.3474
  Epoch 12 [Batch 312/391]: Loss: 0.3585
  Epoch 12 [Batch 351/391]: Loss: 0.6088
  Epoch 12 [Batch 390/391]: Loss: 0.5134
  Epoch 12 Train Summary: Avg Loss: 0.6133, Accuracy: 0.5982
  Validation Summary: Avg Loss: 0.7986, Accuracy: 0.5429, F1 (Macro): 0.5640
  New best model! Val loss improved from 0.8069 to 0.7986. Saving...

--- Epoch 13/14 ---
  Epoch 13 [Batch 0/391]: Loss: 0.6943
  Epoch 13 [Batch 39/391]: Loss: 0.2807
  Epoch 13 [Batch 78/391]: Loss: 0.6526
  Epoch 13 [Batch 117/391]: Loss: 0.6216
  Epoch 13 [Batch 156/391]: Loss: 0.4458
  Epoch 13 [Batch 195/391]: Loss: 0.9545
  Epoch 13 [Batch 234/391]: Loss: 0.5576
  Epoch 13 [Batch 273/391]: Loss: 0.5652
  Epoch 13 [Batch 312/391]: Loss: 0.5662
  Epoch 13 [Batch 351/391]: Loss: 0.2981
  Epoch 13 [Batch 390/391]: Loss: 0.5984
  Epoch 13 Train Summary: Avg Loss: 0.5702, Accuracy: 0.6336
  Validation Summary: Avg Loss: 0.7778, Accuracy: 0.5506, F1 (Macro): 0.5641
  New best model! Val loss improved from 0.7986 to 0.7778. Saving...

--- Epoch 14/14 ---
  Epoch 14 [Batch 0/391]: Loss: 0.4578
  Epoch 14 [Batch 39/391]: Loss: 0.5961
  Epoch 14 [Batch 78/391]: Loss: 0.5017
  Epoch 14 [Batch 117/391]: Loss: 0.6246
  Epoch 14 [Batch 156/391]: Loss: 0.3619
  Epoch 14 [Batch 195/391]: Loss: 0.5873
  Epoch 14 [Batch 234/391]: Loss: 0.6875
  Epoch 14 [Batch 273/391]: Loss: 0.4915
  Epoch 14 [Batch 312/391]: Loss: 0.3850
  Epoch 14 [Batch 351/391]: Loss: 0.4872
  Epoch 14 [Batch 390/391]: Loss: 0.6705
  Epoch 14 Train Summary: Avg Loss: 0.5360, Accuracy: 0.6640
  Validation Summary: Avg Loss: 0.7697, Accuracy: 0.5886, F1 (Macro): 0.6024
  New best model! Val loss improved from 0.7778 to 0.7697. Saving...
Training finished in 201.01 minutes.
Loading best model for final evaluation...
/home/hamzah.al-omairi/miniconda3/envs/ortho-foundation/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  Validation Summary: Avg Loss: 0.7697, Accuracy: 0.5886, F1 (Macro): 0.6024
Final Best Model Stats: Acc: 0.5886, F1: 0.6024, Loss: 0.7697
Matplotlib not available. Skipping plot generation.
================================================================================

STARTING RUN: arch=resnet50 size=384x384 lr=1e-05 drop=0.0 seed=42
================================================================================
Starting experiment: resnet50__384x384__lr-1e-05__drop-0.0__seed-42
Output directory: results_rgb/resnet50__384x384__lr-1e-05__drop-0.0__seed-42
Loading datasets...
[train set] Loaded 3124 images from processed_datasets/rgb_classification.csv.
[train set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
[test set] Loaded 390 images from processed_datasets/rgb_classification.csv.
[test set] 3 classes found: {'Class I': 0, 'Class II': 1, 'Class III': 2}
Discovered 3 classes: ['Class I', 'Class II', 'Class III']
Creating model: resnet50 with 3 classes (pretrained=True, drop_rate=0.0)
Starting training for 15 epochs...

--- Epoch 0/14 ---
slurmstepd-ws-l6-003: error: *** JOB 96947 ON ws-l6-003 CANCELLED AT 2025-11-08T18:18:00 DUE TO TIME LIMIT ***
