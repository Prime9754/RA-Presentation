Resuming public baseline training (only pending runs)...
Scanning existing outputs in: /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs

>>> Checking: arch=resnet50 size=768x512 lr=3e-4 drop=0.0
    âœ“ Already completed. Skipping.

>>> Checking: arch=resnet50 size=768x512 lr=3e-4 drop=0.1
    âœ“ Already completed. Skipping.

>>> Checking: arch=resnet50 size=768x512 lr=3e-4 drop=0.2
    âœ“ Already completed. Skipping.

>>> Checking: arch=resnet50 size=768x512 lr=1e-4 drop=0.0
    âœ“ Already completed. Skipping.

>>> Checking: arch=resnet50 size=768x512 lr=1e-4 drop=0.1
    âœ“ Already completed. Skipping.

>>> Checking: arch=resnet50 size=768x512 lr=1e-4 drop=0.2
    âœ“ Already completed. Skipping.

>>> Checking: arch=resnet50 size=768x512 lr=5e-5 drop=0.0
    âœ“ Already completed. Skipping.

>>> Checking: arch=resnet50 size=768x512 lr=5e-5 drop=0.1
    âœ“ Already completed. Skipping.

>>> Checking: arch=resnet50 size=768x512 lr=5e-5 drop=0.2
    âœ“ Already completed. Skipping.

>>> Checking: arch=efficientnetv2_s size=768x512 lr=3e-4 drop=0.0
    âœ“ Already completed. Skipping.

>>> Checking: arch=efficientnetv2_s size=768x512 lr=3e-4 drop=0.1
    âœ“ Already completed. Skipping.

>>> Checking: arch=efficientnetv2_s size=768x512 lr=3e-4 drop=0.2
    âœ“ Already completed. Skipping.

>>> Checking: arch=efficientnetv2_s size=768x512 lr=1e-4 drop=0.0
    âœ“ Already completed. Skipping.

>>> Checking: arch=efficientnetv2_s size=768x512 lr=1e-4 drop=0.1
    âœ“ Already completed. Skipping.

>>> Checking: arch=efficientnetv2_s size=768x512 lr=1e-4 drop=0.2
    âœ“ Already completed. Skipping.

>>> Checking: arch=efficientnetv2_s size=768x512 lr=5e-5 drop=0.0
    âœ“ Already completed. Skipping.

>>> Checking: arch=efficientnetv2_s size=768x512 lr=5e-5 drop=0.1
    No checkpoint found. Will (re)start this combo.
+ python3 public_baselines_clss.py --train_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train --train_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train/_annotations.csv --test_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test --test_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test/_annotations.csv --outdir /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs --arches efficientnetv2_s --sizes 768x512 --lrs 5e-5 --drops 0.1 --epochs 15 --batch_size 8 --num_workers 2 --early_stop 10 --seed 42 --amp --class_weight --val_split_ratio 0.2
Using device: cuda

================================================================================
STARTING RUN: arch=efficientnetv2_s size=768x512 lr=5e-05 drop=0.1 seed=42
================================================================================
Loaded 8810 samples for train_aug split from _annotations.csv
Discovered 4 classes: ['Implant', 'Fillings', 'Impacted Tooth', 'Cavity']
No validation file provided. Splitting train data (80%/20%) using seed 42.
Split complete: 7048 train, 1762 val samples.
Loaded 473 samples for eval_noaug split from _annotations.csv
Calculating class weights on training split...
Class weights calculated: tensor([0.4771, 0.1591, 1.9033, 1.4606], device='cuda:0')
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.1] E001 | train_loss=1.4798 | val_F1_macro=0.3000
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.1] E002 | train_loss=1.3396 | val_F1_macro=0.2448
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.1] E003 | train_loss=1.2381 | val_F1_macro=0.3028
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.1] E004 | train_loss=1.1856 | val_F1_macro=0.2744
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.1] E005 | train_loss=1.1312 | val_F1_macro=0.2406
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.1] E006 | train_loss=1.1037 | val_F1_macro=0.2679
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.1] E007 | train_loss=1.0425 | val_F1_macro=0.2633
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.1] E008 | train_loss=0.9229 | val_F1_macro=0.2771
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.1] E009 | train_loss=0.8544 | val_F1_macro=0.2558
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.1] E010 | train_loss=0.8460 | val_F1_macro=0.2791
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.1] E011 | train_loss=0.8150 | val_F1_macro=0.2916
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.1] E012 | train_loss=0.7905 | val_F1_macro=0.2725
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.1] E013 | train_loss=0.7697 | val_F1_macro=0.2633
Early stopping at epoch 13 due to no improvement in F1_macro.
Training complete. Loading best model from /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/efficientnetv2_s__768x512__seed=42__lr=5e-05__drop=0.1/best.pt
Running final evaluation on test set...
Test metrics: {'Accuracy_micro': 0.31923890113830566, 'F1_macro': 0.2677740454673767}
ðŸ“ˆ Generated training history plot: /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/efficientnetv2_s__768x512__seed=42__lr=5e-05__drop=0.1/training_history.png
COMPLETED RUN: arch=efficientnetv2_s size=768x512 lr=5e-05 drop=0.1 seed=42

================================================================================

Aggregating results from all runs...
All runs saved to /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/all_runs.csv
+ set +x

>>> Checking: arch=efficientnetv2_s size=768x512 lr=5e-5 drop=0.2
    No checkpoint found. Will (re)start this combo.
+ python3 public_baselines_clss.py --train_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train --train_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train/_annotations.csv --test_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test --test_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test/_annotations.csv --outdir /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs --arches efficientnetv2_s --sizes 768x512 --lrs 5e-5 --drops 0.2 --epochs 15 --batch_size 8 --num_workers 2 --early_stop 10 --seed 42 --amp --class_weight --val_split_ratio 0.2
Using device: cuda

================================================================================
STARTING RUN: arch=efficientnetv2_s size=768x512 lr=5e-05 drop=0.2 seed=42
================================================================================
Loaded 8810 samples for train_aug split from _annotations.csv
Discovered 4 classes: ['Implant', 'Fillings', 'Impacted Tooth', 'Cavity']
No validation file provided. Splitting train data (80%/20%) using seed 42.
Split complete: 7048 train, 1762 val samples.
Loaded 473 samples for eval_noaug split from _annotations.csv
Calculating class weights on training split...
Class weights calculated: tensor([0.4771, 0.1591, 1.9033, 1.4606], device='cuda:0')
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.2] E001 | train_loss=1.5969 | val_F1_macro=0.2046
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.2] E002 | train_loss=1.4182 | val_F1_macro=0.2120
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.2] E003 | train_loss=1.2977 | val_F1_macro=0.3196
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.2] E004 | train_loss=1.2342 | val_F1_macro=0.3028
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.2] E005 | train_loss=1.1793 | val_F1_macro=0.3313
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.2] E006 | train_loss=1.1261 | val_F1_macro=0.2732
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.2] E007 | train_loss=1.0585 | val_F1_macro=0.2500
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.2] E008 | train_loss=1.0171 | val_F1_macro=0.2457
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.2] E009 | train_loss=0.9689 | val_F1_macro=0.2894
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.2] E010 | train_loss=0.8609 | val_F1_macro=0.2943
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.2] E011 | train_loss=0.8125 | val_F1_macro=0.3566
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.2] E012 | train_loss=0.7845 | val_F1_macro=0.3356
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.2] E013 | train_loss=0.7649 | val_F1_macro=0.3326
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.2] E014 | train_loss=0.7399 | val_F1_macro=0.3503
[efficientnetv2_s 768x512 s42 lr=5e-05 d=0.2] E015 | train_loss=0.7274 | val_F1_macro=0.3246
Training complete. Loading best model from /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/efficientnetv2_s__768x512__seed=42__lr=5e-05__drop=0.2/best.pt
Running final evaluation on test set...
Test metrics: {'Accuracy_micro': 0.34038054943084717, 'F1_macro': 0.3289003074169159}
ðŸ“ˆ Generated training history plot: /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/efficientnetv2_s__768x512__seed=42__lr=5e-05__drop=0.2/training_history.png
COMPLETED RUN: arch=efficientnetv2_s size=768x512 lr=5e-05 drop=0.2 seed=42

================================================================================

Aggregating results from all runs...
All runs saved to /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/all_runs.csv
+ set +x

>>> Checking: arch=convnext_tiny size=768x512 lr=3e-4 drop=0.0
    âœ“ Already completed. Skipping.

>>> Checking: arch=convnext_tiny size=768x512 lr=3e-4 drop=0.1
    No checkpoint found. Will (re)start this combo.
+ python3 public_baselines_clss.py --train_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train --train_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train/_annotations.csv --test_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test --test_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test/_annotations.csv --outdir /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs --arches convnext_tiny --sizes 768x512 --lrs 3e-4 --drops 0.1 --epochs 15 --batch_size 8 --num_workers 2 --early_stop 10 --seed 42 --amp --class_weight --val_split_ratio 0.2
Using device: cuda

================================================================================
STARTING RUN: arch=convnext_tiny size=768x512 lr=0.0003 drop=0.1 seed=42
================================================================================
Loaded 8810 samples for train_aug split from _annotations.csv
Discovered 4 classes: ['Implant', 'Fillings', 'Impacted Tooth', 'Cavity']
No validation file provided. Splitting train data (80%/20%) using seed 42.
Split complete: 7048 train, 1762 val samples.
Loaded 473 samples for eval_noaug split from _annotations.csv
Calculating class weights on training split...
Class weights calculated: tensor([0.4771, 0.1591, 1.9033, 1.4606], device='cuda:0')
[convnext_tiny 768x512 s42 lr=0.0003 d=0.1] E001 | train_loss=1.4366 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0003 d=0.1] E002 | train_loss=1.3742 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0003 d=0.1] E003 | train_loss=1.3715 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0003 d=0.1] E004 | train_loss=1.3691 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0003 d=0.1] E005 | train_loss=1.3668 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0003 d=0.1] E006 | train_loss=1.3633 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0003 d=0.1] E007 | train_loss=1.3588 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0003 d=0.1] E008 | train_loss=1.3577 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0003 d=0.1] E009 | train_loss=1.3634 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0003 d=0.1] E010 | train_loss=1.3632 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0003 d=0.1] E011 | train_loss=1.3628 | val_F1_macro=0.1988
Early stopping at epoch 11 due to no improvement in F1_macro.
Training complete. Loading best model from /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/convnext_tiny__768x512__seed=42__lr=0.0003__drop=0.1/best.pt
Running final evaluation on test set...
Test metrics: {'Accuracy_micro': 0.6659619212150574, 'F1_macro': 0.19987308979034424}
ðŸ“ˆ Generated training history plot: /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/convnext_tiny__768x512__seed=42__lr=0.0003__drop=0.1/training_history.png
COMPLETED RUN: arch=convnext_tiny size=768x512 lr=0.0003 drop=0.1 seed=42

================================================================================

Aggregating results from all runs...
All runs saved to /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/all_runs.csv
+ set +x

>>> Checking: arch=convnext_tiny size=768x512 lr=3e-4 drop=0.2
    No checkpoint found. Will (re)start this combo.
+ python3 public_baselines_clss.py --train_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train --train_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train/_annotations.csv --test_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test --test_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test/_annotations.csv --outdir /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs --arches convnext_tiny --sizes 768x512 --lrs 3e-4 --drops 0.2 --epochs 15 --batch_size 8 --num_workers 2 --early_stop 10 --seed 42 --amp --class_weight --val_split_ratio 0.2
Using device: cuda

================================================================================
STARTING RUN: arch=convnext_tiny size=768x512 lr=0.0003 drop=0.2 seed=42
================================================================================
Loaded 8810 samples for train_aug split from _annotations.csv
Discovered 4 classes: ['Implant', 'Fillings', 'Impacted Tooth', 'Cavity']
No validation file provided. Splitting train data (80%/20%) using seed 42.
Split complete: 7048 train, 1762 val samples.
Loaded 473 samples for eval_noaug split from _annotations.csv
Calculating class weights on training split...
Class weights calculated: tensor([0.4771, 0.1591, 1.9033, 1.4606], device='cuda:0')
[convnext_tiny 768x512 s42 lr=0.0003 d=0.2] E001 | train_loss=1.4579 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0003 d=0.2] E002 | train_loss=1.3792 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0003 d=0.2] E003 | train_loss=1.3751 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0003 d=0.2] E004 | train_loss=1.3721 | val_F1_macro=0.0931
[convnext_tiny 768x512 s42 lr=0.0003 d=0.2] E005 | train_loss=1.3688 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0003 d=0.2] E006 | train_loss=1.3643 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0003 d=0.2] E007 | train_loss=1.3586 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0003 d=0.2] E008 | train_loss=1.3598 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0003 d=0.2] E009 | train_loss=1.3632 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0003 d=0.2] E010 | train_loss=1.3639 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0003 d=0.2] E011 | train_loss=1.3628 | val_F1_macro=0.1988
Early stopping at epoch 11 due to no improvement in F1_macro.
Training complete. Loading best model from /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/convnext_tiny__768x512__seed=42__lr=0.0003__drop=0.2/best.pt
Running final evaluation on test set...
Test metrics: {'Accuracy_micro': 0.6659619212150574, 'F1_macro': 0.19987308979034424}
ðŸ“ˆ Generated training history plot: /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/convnext_tiny__768x512__seed=42__lr=0.0003__drop=0.2/training_history.png
COMPLETED RUN: arch=convnext_tiny size=768x512 lr=0.0003 drop=0.2 seed=42

================================================================================

Aggregating results from all runs...
All runs saved to /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/all_runs.csv
+ set +x

>>> Checking: arch=convnext_tiny size=768x512 lr=1e-4 drop=0.0
    No checkpoint found. Will (re)start this combo.
+ python3 public_baselines_clss.py --train_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train --train_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train/_annotations.csv --test_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test --test_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test/_annotations.csv --outdir /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs --arches convnext_tiny --sizes 768x512 --lrs 1e-4 --drops 0.0 --epochs 15 --batch_size 8 --num_workers 2 --early_stop 10 --seed 42 --amp --class_weight --val_split_ratio 0.2
Using device: cuda

================================================================================
STARTING RUN: arch=convnext_tiny size=768x512 lr=0.0001 drop=0.0 seed=42
================================================================================
Loaded 8810 samples for train_aug split from _annotations.csv
Discovered 4 classes: ['Implant', 'Fillings', 'Impacted Tooth', 'Cavity']
No validation file provided. Splitting train data (80%/20%) using seed 42.
Split complete: 7048 train, 1762 val samples.
Loaded 473 samples for eval_noaug split from _annotations.csv
Calculating class weights on training split...
Class weights calculated: tensor([0.4771, 0.1591, 1.9033, 1.4606], device='cuda:0')
[convnext_tiny 768x512 s42 lr=0.0001 d=0.0] E001 | train_loss=1.4129 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.0] E002 | train_loss=1.3733 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.0] E003 | train_loss=1.3738 | val_F1_macro=0.0931
[convnext_tiny 768x512 s42 lr=0.0001 d=0.0] E004 | train_loss=1.3718 | val_F1_macro=0.0931
[convnext_tiny 768x512 s42 lr=0.0001 d=0.0] E005 | train_loss=1.3691 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.0] E006 | train_loss=1.3640 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.0] E007 | train_loss=1.3592 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.0] E008 | train_loss=1.3582 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.0] E009 | train_loss=1.3631 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.0] E010 | train_loss=1.3631 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.0] E011 | train_loss=1.3627 | val_F1_macro=0.1988
Early stopping at epoch 11 due to no improvement in F1_macro.
Training complete. Loading best model from /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/convnext_tiny__768x512__seed=42__lr=0.0001__drop=0.0/best.pt
Running final evaluation on test set...
Test metrics: {'Accuracy_micro': 0.6659619212150574, 'F1_macro': 0.19987308979034424}
ðŸ“ˆ Generated training history plot: /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/convnext_tiny__768x512__seed=42__lr=0.0001__drop=0.0/training_history.png
COMPLETED RUN: arch=convnext_tiny size=768x512 lr=0.0001 drop=0.0 seed=42

================================================================================

Aggregating results from all runs...
All runs saved to /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/all_runs.csv
+ set +x

>>> Checking: arch=convnext_tiny size=768x512 lr=1e-4 drop=0.1
    No checkpoint found. Will (re)start this combo.
+ python3 public_baselines_clss.py --train_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train --train_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train/_annotations.csv --test_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test --test_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test/_annotations.csv --outdir /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs --arches convnext_tiny --sizes 768x512 --lrs 1e-4 --drops 0.1 --epochs 15 --batch_size 8 --num_workers 2 --early_stop 10 --seed 42 --amp --class_weight --val_split_ratio 0.2
Using device: cuda

================================================================================
STARTING RUN: arch=convnext_tiny size=768x512 lr=0.0001 drop=0.1 seed=42
================================================================================
Loaded 8810 samples for train_aug split from _annotations.csv
Discovered 4 classes: ['Implant', 'Fillings', 'Impacted Tooth', 'Cavity']
No validation file provided. Splitting train data (80%/20%) using seed 42.
Split complete: 7048 train, 1762 val samples.
Loaded 473 samples for eval_noaug split from _annotations.csv
Calculating class weights on training split...
Class weights calculated: tensor([0.4771, 0.1591, 1.9033, 1.4606], device='cuda:0')
[convnext_tiny 768x512 s42 lr=0.0001 d=0.1] E001 | train_loss=1.4474 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.1] E002 | train_loss=1.3812 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.1] E003 | train_loss=1.3775 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.1] E004 | train_loss=1.3744 | val_F1_macro=0.0931
[convnext_tiny 768x512 s42 lr=0.0001 d=0.1] E005 | train_loss=1.3727 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.1] E006 | train_loss=1.3650 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.1] E007 | train_loss=1.3600 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.1] E008 | train_loss=1.3606 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.1] E009 | train_loss=1.3656 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.1] E010 | train_loss=1.3650 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.1] E011 | train_loss=1.3636 | val_F1_macro=0.1988
Early stopping at epoch 11 due to no improvement in F1_macro.
Training complete. Loading best model from /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/convnext_tiny__768x512__seed=42__lr=0.0001__drop=0.1/best.pt
Running final evaluation on test set...
Test metrics: {'Accuracy_micro': 0.6659619212150574, 'F1_macro': 0.19987308979034424}
ðŸ“ˆ Generated training history plot: /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/convnext_tiny__768x512__seed=42__lr=0.0001__drop=0.1/training_history.png
COMPLETED RUN: arch=convnext_tiny size=768x512 lr=0.0001 drop=0.1 seed=42

================================================================================

Aggregating results from all runs...
All runs saved to /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/all_runs.csv
+ set +x

>>> Checking: arch=convnext_tiny size=768x512 lr=1e-4 drop=0.2
    No checkpoint found. Will (re)start this combo.
+ python3 public_baselines_clss.py --train_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train --train_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train/_annotations.csv --test_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test --test_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test/_annotations.csv --outdir /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs --arches convnext_tiny --sizes 768x512 --lrs 1e-4 --drops 0.2 --epochs 15 --batch_size 8 --num_workers 2 --early_stop 10 --seed 42 --amp --class_weight --val_split_ratio 0.2
Using device: cuda

================================================================================
STARTING RUN: arch=convnext_tiny size=768x512 lr=0.0001 drop=0.2 seed=42
================================================================================
Loaded 8810 samples for train_aug split from _annotations.csv
Discovered 4 classes: ['Implant', 'Fillings', 'Impacted Tooth', 'Cavity']
No validation file provided. Splitting train data (80%/20%) using seed 42.
Split complete: 7048 train, 1762 val samples.
Loaded 473 samples for eval_noaug split from _annotations.csv
Calculating class weights on training split...
Class weights calculated: tensor([0.4771, 0.1591, 1.9033, 1.4606], device='cuda:0')
[convnext_tiny 768x512 s42 lr=0.0001 d=0.2] E001 | train_loss=1.4390 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.2] E002 | train_loss=1.3830 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.2] E003 | train_loss=1.3794 | val_F1_macro=0.0931
[convnext_tiny 768x512 s42 lr=0.0001 d=0.2] E004 | train_loss=1.3774 | val_F1_macro=0.0931
[convnext_tiny 768x512 s42 lr=0.0001 d=0.2] E005 | train_loss=1.3724 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.2] E006 | train_loss=1.3650 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.2] E007 | train_loss=1.3598 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.2] E008 | train_loss=1.3623 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.2] E009 | train_loss=1.3642 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.2] E010 | train_loss=1.3658 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=0.0001 d=0.2] E011 | train_loss=1.3634 | val_F1_macro=0.1988
Early stopping at epoch 11 due to no improvement in F1_macro.
Training complete. Loading best model from /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/convnext_tiny__768x512__seed=42__lr=0.0001__drop=0.2/best.pt
Running final evaluation on test set...
Test metrics: {'Accuracy_micro': 0.6659619212150574, 'F1_macro': 0.19987308979034424}
ðŸ“ˆ Generated training history plot: /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/convnext_tiny__768x512__seed=42__lr=0.0001__drop=0.2/training_history.png
COMPLETED RUN: arch=convnext_tiny size=768x512 lr=0.0001 drop=0.2 seed=42

================================================================================

Aggregating results from all runs...
All runs saved to /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/all_runs.csv
+ set +x

>>> Checking: arch=convnext_tiny size=768x512 lr=5e-5 drop=0.0
    No checkpoint found. Will (re)start this combo.
+ python3 public_baselines_clss.py --train_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train --train_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train/_annotations.csv --test_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test --test_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test/_annotations.csv --outdir /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs --arches convnext_tiny --sizes 768x512 --lrs 5e-5 --drops 0.0 --epochs 15 --batch_size 8 --num_workers 2 --early_stop 10 --seed 42 --amp --class_weight --val_split_ratio 0.2
Using device: cuda

================================================================================
STARTING RUN: arch=convnext_tiny size=768x512 lr=5e-05 drop=0.0 seed=42
================================================================================
Loaded 8810 samples for train_aug split from _annotations.csv
Discovered 4 classes: ['Implant', 'Fillings', 'Impacted Tooth', 'Cavity']
No validation file provided. Splitting train data (80%/20%) using seed 42.
Split complete: 7048 train, 1762 val samples.
Loaded 473 samples for eval_noaug split from _annotations.csv
Calculating class weights on training split...
Class weights calculated: tensor([0.4771, 0.1591, 1.9033, 1.4606], device='cuda:0')
[convnext_tiny 768x512 s42 lr=5e-05 d=0.0] E001 | train_loss=1.4050 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.0] E002 | train_loss=1.3718 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.0] E003 | train_loss=1.3728 | val_F1_macro=0.0931
[convnext_tiny 768x512 s42 lr=5e-05 d=0.0] E004 | train_loss=1.3719 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.0] E005 | train_loss=1.3688 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.0] E006 | train_loss=1.3640 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.0] E007 | train_loss=1.3592 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.0] E008 | train_loss=1.3582 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.0] E009 | train_loss=1.3630 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.0] E010 | train_loss=1.3629 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.0] E011 | train_loss=1.3622 | val_F1_macro=0.1988
Early stopping at epoch 11 due to no improvement in F1_macro.
Training complete. Loading best model from /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/convnext_tiny__768x512__seed=42__lr=5e-05__drop=0.0/best.pt
Running final evaluation on test set...
Test metrics: {'Accuracy_micro': 0.6659619212150574, 'F1_macro': 0.19987308979034424}
ðŸ“ˆ Generated training history plot: /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/convnext_tiny__768x512__seed=42__lr=5e-05__drop=0.0/training_history.png
COMPLETED RUN: arch=convnext_tiny size=768x512 lr=5e-05 drop=0.0 seed=42

================================================================================

Aggregating results from all runs...
All runs saved to /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/all_runs.csv
+ set +x

>>> Checking: arch=convnext_tiny size=768x512 lr=5e-5 drop=0.1
    No checkpoint found. Will (re)start this combo.
+ python3 public_baselines_clss.py --train_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train --train_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train/_annotations.csv --test_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test --test_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test/_annotations.csv --outdir /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs --arches convnext_tiny --sizes 768x512 --lrs 5e-5 --drops 0.1 --epochs 15 --batch_size 8 --num_workers 2 --early_stop 10 --seed 42 --amp --class_weight --val_split_ratio 0.2
Using device: cuda

================================================================================
STARTING RUN: arch=convnext_tiny size=768x512 lr=5e-05 drop=0.1 seed=42
================================================================================
Loaded 8810 samples for train_aug split from _annotations.csv
Discovered 4 classes: ['Implant', 'Fillings', 'Impacted Tooth', 'Cavity']
No validation file provided. Splitting train data (80%/20%) using seed 42.
Split complete: 7048 train, 1762 val samples.
Loaded 473 samples for eval_noaug split from _annotations.csv
Calculating class weights on training split...
Class weights calculated: tensor([0.4771, 0.1591, 1.9033, 1.4606], device='cuda:0')
[convnext_tiny 768x512 s42 lr=5e-05 d=0.1] E001 | train_loss=1.4040 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.1] E002 | train_loss=1.3696 | val_F1_macro=0.0936
[convnext_tiny 768x512 s42 lr=5e-05 d=0.1] E003 | train_loss=1.3717 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.1] E004 | train_loss=1.3729 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.1] E005 | train_loss=1.3692 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.1] E006 | train_loss=1.3654 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.1] E007 | train_loss=1.3596 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.1] E008 | train_loss=1.3592 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.1] E009 | train_loss=1.3636 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.1] E010 | train_loss=1.3627 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.1] E011 | train_loss=1.3012 | val_F1_macro=0.3341
[convnext_tiny 768x512 s42 lr=5e-05 d=0.1] E012 | train_loss=1.1611 | val_F1_macro=0.3743
[convnext_tiny 768x512 s42 lr=5e-05 d=0.1] E013 | train_loss=1.1015 | val_F1_macro=0.4101
[convnext_tiny 768x512 s42 lr=5e-05 d=0.1] E014 | train_loss=1.0603 | val_F1_macro=0.4187
[convnext_tiny 768x512 s42 lr=5e-05 d=0.1] E015 | train_loss=1.0225 | val_F1_macro=0.4577
Training complete. Loading best model from /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/convnext_tiny__768x512__seed=42__lr=5e-05__drop=0.1/best.pt
Running final evaluation on test set...
Test metrics: {'Accuracy_micro': 0.4693446159362793, 'F1_macro': 0.4330587685108185}
ðŸ“ˆ Generated training history plot: /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/convnext_tiny__768x512__seed=42__lr=5e-05__drop=0.1/training_history.png
COMPLETED RUN: arch=convnext_tiny size=768x512 lr=5e-05 drop=0.1 seed=42

================================================================================

Aggregating results from all runs...
All runs saved to /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/all_runs.csv
+ set +x

>>> Checking: arch=convnext_tiny size=768x512 lr=5e-5 drop=0.2
    No checkpoint found. Will (re)start this combo.
+ python3 public_baselines_clss.py --train_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train --train_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train/_annotations.csv --test_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test --test_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test/_annotations.csv --outdir /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs --arches convnext_tiny --sizes 768x512 --lrs 5e-5 --drops 0.2 --epochs 15 --batch_size 8 --num_workers 2 --early_stop 10 --seed 42 --amp --class_weight --val_split_ratio 0.2
Using device: cuda

================================================================================
STARTING RUN: arch=convnext_tiny size=768x512 lr=5e-05 drop=0.2 seed=42
================================================================================
Loaded 8810 samples for train_aug split from _annotations.csv
Discovered 4 classes: ['Implant', 'Fillings', 'Impacted Tooth', 'Cavity']
No validation file provided. Splitting train data (80%/20%) using seed 42.
Split complete: 7048 train, 1762 val samples.
Loaded 473 samples for eval_noaug split from _annotations.csv
Calculating class weights on training split...
Class weights calculated: tensor([0.4771, 0.1591, 1.9033, 1.4606], device='cuda:0')
[convnext_tiny 768x512 s42 lr=5e-05 d=0.2] E001 | train_loss=1.4180 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.2] E002 | train_loss=1.3728 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.2] E003 | train_loss=1.3749 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.2] E004 | train_loss=1.3738 | val_F1_macro=0.0931
[convnext_tiny 768x512 s42 lr=5e-05 d=0.2] E005 | train_loss=1.3719 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.2] E006 | train_loss=1.3665 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.2] E007 | train_loss=1.3595 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.2] E008 | train_loss=1.3594 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.2] E009 | train_loss=1.3665 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.2] E010 | train_loss=1.3651 | val_F1_macro=0.1988
[convnext_tiny 768x512 s42 lr=5e-05 d=0.2] E011 | train_loss=1.3639 | val_F1_macro=0.1988
Early stopping at epoch 11 due to no improvement in F1_macro.
Training complete. Loading best model from /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/convnext_tiny__768x512__seed=42__lr=5e-05__drop=0.2/best.pt
Running final evaluation on test set...
Test metrics: {'Accuracy_micro': 0.6659619212150574, 'F1_macro': 0.19987308979034424}
ðŸ“ˆ Generated training history plot: /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/convnext_tiny__768x512__seed=42__lr=5e-05__drop=0.2/training_history.png
COMPLETED RUN: arch=convnext_tiny size=768x512 lr=5e-05 drop=0.2 seed=42

================================================================================

Aggregating results from all runs...
All runs saved to /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/all_runs.csv
+ set +x

>>> Checking: arch=densenet121 size=768x512 lr=3e-4 drop=0.0
    No checkpoint found. Will (re)start this combo.
+ python3 public_baselines_clss.py --train_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train --train_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train/_annotations.csv --test_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test --test_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test/_annotations.csv --outdir /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs --arches densenet121 --sizes 768x512 --lrs 3e-4 --drops 0.0 --epochs 15 --batch_size 8 --num_workers 2 --early_stop 10 --seed 42 --amp --class_weight --val_split_ratio 0.2
Using device: cuda

================================================================================
STARTING RUN: arch=densenet121 size=768x512 lr=0.0003 drop=0.0 seed=42
================================================================================
Loaded 8810 samples for train_aug split from _annotations.csv
Discovered 4 classes: ['Implant', 'Fillings', 'Impacted Tooth', 'Cavity']
No validation file provided. Splitting train data (80%/20%) using seed 42.
Split complete: 7048 train, 1762 val samples.
Loaded 473 samples for eval_noaug split from _annotations.csv
Calculating class weights on training split...
Class weights calculated: tensor([0.4771, 0.1591, 1.9033, 1.4606], device='cuda:0')
[densenet121 768x512 s42 lr=0.0003 d=0.0] E001 | train_loss=1.0102 | val_F1_macro=0.4698
[densenet121 768x512 s42 lr=0.0003 d=0.0] E002 | train_loss=0.8986 | val_F1_macro=0.4335
[densenet121 768x512 s42 lr=0.0003 d=0.0] E003 | train_loss=0.8398 | val_F1_macro=0.5487
[densenet121 768x512 s42 lr=0.0003 d=0.0] E004 | train_loss=0.8256 | val_F1_macro=0.4341
[densenet121 768x512 s42 lr=0.0003 d=0.0] E005 | train_loss=0.7819 | val_F1_macro=0.5348
[densenet121 768x512 s42 lr=0.0003 d=0.0] E006 | train_loss=0.7714 | val_F1_macro=0.4840
[densenet121 768x512 s42 lr=0.0003 d=0.0] E007 | train_loss=0.7507 | val_F1_macro=0.4646
[densenet121 768x512 s42 lr=0.0003 d=0.0] E008 | train_loss=0.6748 | val_F1_macro=0.5173
[densenet121 768x512 s42 lr=0.0003 d=0.0] E009 | train_loss=0.6634 | val_F1_macro=0.5454
[densenet121 768x512 s42 lr=0.0003 d=0.0] E010 | train_loss=0.6391 | val_F1_macro=0.5415
[densenet121 768x512 s42 lr=0.0003 d=0.0] E011 | train_loss=0.6279 | val_F1_macro=0.5456
[densenet121 768x512 s42 lr=0.0003 d=0.0] E012 | train_loss=0.6033 | val_F1_macro=0.5358
[densenet121 768x512 s42 lr=0.0003 d=0.0] E013 | train_loss=0.6064 | val_F1_macro=0.5279
Early stopping at epoch 13 due to no improvement in F1_macro.
Training complete. Loading best model from /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/densenet121__768x512__seed=42__lr=0.0003__drop=0.0/best.pt
Running final evaluation on test set...
Test metrics: {'Accuracy_micro': 0.6088795065879822, 'F1_macro': 0.5555732250213623}
ðŸ“ˆ Generated training history plot: /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/densenet121__768x512__seed=42__lr=0.0003__drop=0.0/training_history.png
COMPLETED RUN: arch=densenet121 size=768x512 lr=0.0003 drop=0.0 seed=42

================================================================================

Aggregating results from all runs...
All runs saved to /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/all_runs.csv
+ set +x

>>> Checking: arch=densenet121 size=768x512 lr=3e-4 drop=0.1
    No checkpoint found. Will (re)start this combo.
+ python3 public_baselines_clss.py --train_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train --train_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train/_annotations.csv --test_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test --test_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test/_annotations.csv --outdir /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs --arches densenet121 --sizes 768x512 --lrs 3e-4 --drops 0.1 --epochs 15 --batch_size 8 --num_workers 2 --early_stop 10 --seed 42 --amp --class_weight --val_split_ratio 0.2
Using device: cuda

================================================================================
STARTING RUN: arch=densenet121 size=768x512 lr=0.0003 drop=0.1 seed=42
================================================================================
Loaded 8810 samples for train_aug split from _annotations.csv
Discovered 4 classes: ['Implant', 'Fillings', 'Impacted Tooth', 'Cavity']
No validation file provided. Splitting train data (80%/20%) using seed 42.
Split complete: 7048 train, 1762 val samples.
Loaded 473 samples for eval_noaug split from _annotations.csv
Calculating class weights on training split...
Class weights calculated: tensor([0.4771, 0.1591, 1.9033, 1.4606], device='cuda:0')
[densenet121 768x512 s42 lr=0.0003 d=0.1] E001 | train_loss=1.0250 | val_F1_macro=0.4319
[densenet121 768x512 s42 lr=0.0003 d=0.1] E002 | train_loss=0.9027 | val_F1_macro=0.1933
[densenet121 768x512 s42 lr=0.0003 d=0.1] E003 | train_loss=0.8327 | val_F1_macro=0.5920
[densenet121 768x512 s42 lr=0.0003 d=0.1] E004 | train_loss=0.8309 | val_F1_macro=0.5618
[densenet121 768x512 s42 lr=0.0003 d=0.1] E005 | train_loss=0.7873 | val_F1_macro=0.5722
[densenet121 768x512 s42 lr=0.0003 d=0.1] E006 | train_loss=0.7730 | val_F1_macro=0.4808
[densenet121 768x512 s42 lr=0.0003 d=0.1] E007 | train_loss=0.7659 | val_F1_macro=0.5000
[densenet121 768x512 s42 lr=0.0003 d=0.1] E008 | train_loss=0.6826 | val_F1_macro=0.5368
[densenet121 768x512 s42 lr=0.0003 d=0.1] E009 | train_loss=0.6702 | val_F1_macro=0.5546
[densenet121 768x512 s42 lr=0.0003 d=0.1] E010 | train_loss=0.6499 | val_F1_macro=0.5413
[densenet121 768x512 s42 lr=0.0003 d=0.1] E011 | train_loss=0.6408 | val_F1_macro=0.5494
[densenet121 768x512 s42 lr=0.0003 d=0.1] E012 | train_loss=0.6100 | val_F1_macro=0.5475
[densenet121 768x512 s42 lr=0.0003 d=0.1] E013 | train_loss=0.6157 | val_F1_macro=0.5580
Early stopping at epoch 13 due to no improvement in F1_macro.
Training complete. Loading best model from /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/densenet121__768x512__seed=42__lr=0.0003__drop=0.1/best.pt
Running final evaluation on test set...
Test metrics: {'Accuracy_micro': 0.5813953280448914, 'F1_macro': 0.4871882200241089}
ðŸ“ˆ Generated training history plot: /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/densenet121__768x512__seed=42__lr=0.0003__drop=0.1/training_history.png
COMPLETED RUN: arch=densenet121 size=768x512 lr=0.0003 drop=0.1 seed=42

================================================================================

Aggregating results from all runs...
All runs saved to /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/all_runs.csv
+ set +x

>>> Checking: arch=densenet121 size=768x512 lr=3e-4 drop=0.2
    No checkpoint found. Will (re)start this combo.
+ python3 public_baselines_clss.py --train_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train --train_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train/_annotations.csv --test_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test --test_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test/_annotations.csv --outdir /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs --arches densenet121 --sizes 768x512 --lrs 3e-4 --drops 0.2 --epochs 15 --batch_size 8 --num_workers 2 --early_stop 10 --seed 42 --amp --class_weight --val_split_ratio 0.2
Using device: cuda

================================================================================
STARTING RUN: arch=densenet121 size=768x512 lr=0.0003 drop=0.2 seed=42
================================================================================
Loaded 8810 samples for train_aug split from _annotations.csv
Discovered 4 classes: ['Implant', 'Fillings', 'Impacted Tooth', 'Cavity']
No validation file provided. Splitting train data (80%/20%) using seed 42.
Split complete: 7048 train, 1762 val samples.
Loaded 473 samples for eval_noaug split from _annotations.csv
Calculating class weights on training split...
Class weights calculated: tensor([0.4771, 0.1591, 1.9033, 1.4606], device='cuda:0')
[densenet121 768x512 s42 lr=0.0003 d=0.2] E001 | train_loss=1.0092 | val_F1_macro=0.3839
[densenet121 768x512 s42 lr=0.0003 d=0.2] E002 | train_loss=0.9045 | val_F1_macro=0.4612
[densenet121 768x512 s42 lr=0.0003 d=0.2] E003 | train_loss=0.8356 | val_F1_macro=0.5007
[densenet121 768x512 s42 lr=0.0003 d=0.2] E004 | train_loss=0.8289 | val_F1_macro=0.5780
[densenet121 768x512 s42 lr=0.0003 d=0.2] E005 | train_loss=0.7927 | val_F1_macro=0.6095
[densenet121 768x512 s42 lr=0.0003 d=0.2] E006 | train_loss=0.7768 | val_F1_macro=0.5311
[densenet121 768x512 s42 lr=0.0003 d=0.2] E007 | train_loss=0.7698 | val_F1_macro=0.4529
[densenet121 768x512 s42 lr=0.0003 d=0.2] E008 | train_loss=0.7515 | val_F1_macro=0.4193
[densenet121 768x512 s42 lr=0.0003 d=0.2] E009 | train_loss=0.7516 | val_F1_macro=0.5903
[densenet121 768x512 s42 lr=0.0003 d=0.2] E010 | train_loss=0.6690 | val_F1_macro=0.5652
[densenet121 768x512 s42 lr=0.0003 d=0.2] E011 | train_loss=0.6474 | val_F1_macro=0.5591
[densenet121 768x512 s42 lr=0.0003 d=0.2] E012 | train_loss=0.6222 | val_F1_macro=0.5374
[densenet121 768x512 s42 lr=0.0003 d=0.2] E013 | train_loss=0.6259 | val_F1_macro=0.5470
[densenet121 768x512 s42 lr=0.0003 d=0.2] E014 | train_loss=0.6123 | val_F1_macro=0.5578
[densenet121 768x512 s42 lr=0.0003 d=0.2] E015 | train_loss=0.6085 | val_F1_macro=0.5632
Early stopping at epoch 15 due to no improvement in F1_macro.
Training complete. Loading best model from /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/densenet121__768x512__seed=42__lr=0.0003__drop=0.2/best.pt
Running final evaluation on test set...
Test metrics: {'Accuracy_micro': 0.5983086824417114, 'F1_macro': 0.5577805042266846}
ðŸ“ˆ Generated training history plot: /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/densenet121__768x512__seed=42__lr=0.0003__drop=0.2/training_history.png
COMPLETED RUN: arch=densenet121 size=768x512 lr=0.0003 drop=0.2 seed=42

================================================================================

Aggregating results from all runs...
All runs saved to /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/all_runs.csv
+ set +x

>>> Checking: arch=densenet121 size=768x512 lr=1e-4 drop=0.0
    No checkpoint found. Will (re)start this combo.
+ python3 public_baselines_clss.py --train_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train --train_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train/_annotations.csv --test_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test --test_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test/_annotations.csv --outdir /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs --arches densenet121 --sizes 768x512 --lrs 1e-4 --drops 0.0 --epochs 15 --batch_size 8 --num_workers 2 --early_stop 10 --seed 42 --amp --class_weight --val_split_ratio 0.2
Using device: cuda

================================================================================
STARTING RUN: arch=densenet121 size=768x512 lr=0.0001 drop=0.0 seed=42
================================================================================
Loaded 8810 samples for train_aug split from _annotations.csv
Discovered 4 classes: ['Implant', 'Fillings', 'Impacted Tooth', 'Cavity']
No validation file provided. Splitting train data (80%/20%) using seed 42.
Split complete: 7048 train, 1762 val samples.
Loaded 473 samples for eval_noaug split from _annotations.csv
Calculating class weights on training split...
Class weights calculated: tensor([0.4771, 0.1591, 1.9033, 1.4606], device='cuda:0')
[densenet121 768x512 s42 lr=0.0001 d=0.0] E001 | train_loss=0.9511 | val_F1_macro=0.5602
[densenet121 768x512 s42 lr=0.0001 d=0.0] E002 | train_loss=0.8257 | val_F1_macro=0.5129
[densenet121 768x512 s42 lr=0.0001 d=0.0] E003 | train_loss=0.7756 | val_F1_macro=0.4788
[densenet121 768x512 s42 lr=0.0001 d=0.0] E004 | train_loss=0.7615 | val_F1_macro=0.5696
[densenet121 768x512 s42 lr=0.0001 d=0.0] E005 | train_loss=0.7206 | val_F1_macro=0.5615
[densenet121 768x512 s42 lr=0.0001 d=0.0] E006 | train_loss=0.6996 | val_F1_macro=0.5352
[densenet121 768x512 s42 lr=0.0001 d=0.0] E007 | train_loss=0.6881 | val_F1_macro=0.4921
[densenet121 768x512 s42 lr=0.0001 d=0.0] E008 | train_loss=0.6732 | val_F1_macro=0.4870
[densenet121 768x512 s42 lr=0.0001 d=0.0] E009 | train_loss=0.6295 | val_F1_macro=0.5518
[densenet121 768x512 s42 lr=0.0001 d=0.0] E010 | train_loss=0.5995 | val_F1_macro=0.5425
[densenet121 768x512 s42 lr=0.0001 d=0.0] E011 | train_loss=0.5952 | val_F1_macro=0.5570
[densenet121 768x512 s42 lr=0.0001 d=0.0] E012 | train_loss=0.5722 | val_F1_macro=0.5569
[densenet121 768x512 s42 lr=0.0001 d=0.0] E013 | train_loss=0.5747 | val_F1_macro=0.5543
[densenet121 768x512 s42 lr=0.0001 d=0.0] E014 | train_loss=0.5768 | val_F1_macro=0.5565
Early stopping at epoch 14 due to no improvement in F1_macro.
Training complete. Loading best model from /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/densenet121__768x512__seed=42__lr=0.0001__drop=0.0/best.pt
Running final evaluation on test set...
Test metrics: {'Accuracy_micro': 0.5475687384605408, 'F1_macro': 0.508220374584198}
ðŸ“ˆ Generated training history plot: /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/densenet121__768x512__seed=42__lr=0.0001__drop=0.0/training_history.png
COMPLETED RUN: arch=densenet121 size=768x512 lr=0.0001 drop=0.0 seed=42

================================================================================

Aggregating results from all runs...
All runs saved to /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/all_runs.csv
+ set +x

>>> Checking: arch=densenet121 size=768x512 lr=1e-4 drop=0.1
    No checkpoint found. Will (re)start this combo.
+ python3 public_baselines_clss.py --train_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train --train_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train/_annotations.csv --test_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test --test_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test/_annotations.csv --outdir /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs --arches densenet121 --sizes 768x512 --lrs 1e-4 --drops 0.1 --epochs 15 --batch_size 8 --num_workers 2 --early_stop 10 --seed 42 --amp --class_weight --val_split_ratio 0.2
Using device: cuda

================================================================================
STARTING RUN: arch=densenet121 size=768x512 lr=0.0001 drop=0.1 seed=42
================================================================================
Loaded 8810 samples for train_aug split from _annotations.csv
Discovered 4 classes: ['Implant', 'Fillings', 'Impacted Tooth', 'Cavity']
No validation file provided. Splitting train data (80%/20%) using seed 42.
Split complete: 7048 train, 1762 val samples.
Loaded 473 samples for eval_noaug split from _annotations.csv
Calculating class weights on training split...
Class weights calculated: tensor([0.4771, 0.1591, 1.9033, 1.4606], device='cuda:0')
[densenet121 768x512 s42 lr=0.0001 d=0.1] E001 | train_loss=0.9662 | val_F1_macro=0.5332
[densenet121 768x512 s42 lr=0.0001 d=0.1] E002 | train_loss=0.8211 | val_F1_macro=0.5594
[densenet121 768x512 s42 lr=0.0001 d=0.1] E003 | train_loss=0.7687 | val_F1_macro=0.5495
[densenet121 768x512 s42 lr=0.0001 d=0.1] E004 | train_loss=0.7588 | val_F1_macro=0.5640
[densenet121 768x512 s42 lr=0.0001 d=0.1] E005 | train_loss=0.7143 | val_F1_macro=0.5746
[densenet121 768x512 s42 lr=0.0001 d=0.1] E006 | train_loss=0.6994 | val_F1_macro=0.5692
[densenet121 768x512 s42 lr=0.0001 d=0.1] E007 | train_loss=0.6890 | val_F1_macro=0.5016
[densenet121 768x512 s42 lr=0.0001 d=0.1] E008 | train_loss=0.6712 | val_F1_macro=0.5466
[densenet121 768x512 s42 lr=0.0001 d=0.1] E009 | train_loss=0.6713 | val_F1_macro=0.5709
[densenet121 768x512 s42 lr=0.0001 d=0.1] E010 | train_loss=0.6061 | val_F1_macro=0.5524
[densenet121 768x512 s42 lr=0.0001 d=0.1] E011 | train_loss=0.5922 | val_F1_macro=0.5592
[densenet121 768x512 s42 lr=0.0001 d=0.1] E012 | train_loss=0.5736 | val_F1_macro=0.5657
[densenet121 768x512 s42 lr=0.0001 d=0.1] E013 | train_loss=0.5767 | val_F1_macro=0.5531
[densenet121 768x512 s42 lr=0.0001 d=0.1] E014 | train_loss=0.5668 | val_F1_macro=0.5625
[densenet121 768x512 s42 lr=0.0001 d=0.1] E015 | train_loss=0.5690 | val_F1_macro=0.5599
Early stopping at epoch 15 due to no improvement in F1_macro.
Training complete. Loading best model from /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/densenet121__768x512__seed=42__lr=0.0001__drop=0.1/best.pt
Running final evaluation on test set...
Test metrics: {'Accuracy_micro': 0.5813953280448914, 'F1_macro': 0.5984894037246704}
ðŸ“ˆ Generated training history plot: /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/densenet121__768x512__seed=42__lr=0.0001__drop=0.1/training_history.png
COMPLETED RUN: arch=densenet121 size=768x512 lr=0.0001 drop=0.1 seed=42

================================================================================

Aggregating results from all runs...
All runs saved to /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/all_runs.csv
+ set +x

>>> Checking: arch=densenet121 size=768x512 lr=1e-4 drop=0.2
    No checkpoint found. Will (re)start this combo.
+ python3 public_baselines_clss.py --train_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train --train_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train/_annotations.csv --test_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test --test_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test/_annotations.csv --outdir /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs --arches densenet121 --sizes 768x512 --lrs 1e-4 --drops 0.2 --epochs 15 --batch_size 8 --num_workers 2 --early_stop 10 --seed 42 --amp --class_weight --val_split_ratio 0.2
Using device: cuda

================================================================================
STARTING RUN: arch=densenet121 size=768x512 lr=0.0001 drop=0.2 seed=42
================================================================================
Loaded 8810 samples for train_aug split from _annotations.csv
Discovered 4 classes: ['Implant', 'Fillings', 'Impacted Tooth', 'Cavity']
No validation file provided. Splitting train data (80%/20%) using seed 42.
Split complete: 7048 train, 1762 val samples.
Loaded 473 samples for eval_noaug split from _annotations.csv
Calculating class weights on training split...
Class weights calculated: tensor([0.4771, 0.1591, 1.9033, 1.4606], device='cuda:0')
[densenet121 768x512 s42 lr=0.0001 d=0.2] E001 | train_loss=0.9719 | val_F1_macro=0.4996
[densenet121 768x512 s42 lr=0.0001 d=0.2] E002 | train_loss=0.8281 | val_F1_macro=0.5542
[densenet121 768x512 s42 lr=0.0001 d=0.2] E003 | train_loss=0.7791 | val_F1_macro=0.5254
[densenet121 768x512 s42 lr=0.0001 d=0.2] E004 | train_loss=0.7574 | val_F1_macro=0.5551
[densenet121 768x512 s42 lr=0.0001 d=0.2] E005 | train_loss=0.7219 | val_F1_macro=0.6105
[densenet121 768x512 s42 lr=0.0001 d=0.2] E006 | train_loss=0.7044 | val_F1_macro=0.5567
[densenet121 768x512 s42 lr=0.0001 d=0.2] E007 | train_loss=0.6968 | val_F1_macro=0.5398
[densenet121 768x512 s42 lr=0.0001 d=0.2] E008 | train_loss=0.6767 | val_F1_macro=0.5398
[densenet121 768x512 s42 lr=0.0001 d=0.2] E009 | train_loss=0.6814 | val_F1_macro=0.5813
[densenet121 768x512 s42 lr=0.0001 d=0.2] E010 | train_loss=0.6104 | val_F1_macro=0.5596
[densenet121 768x512 s42 lr=0.0001 d=0.2] E011 | train_loss=0.6031 | val_F1_macro=0.5635
[densenet121 768x512 s42 lr=0.0001 d=0.2] E012 | train_loss=0.5788 | val_F1_macro=0.5650
[densenet121 768x512 s42 lr=0.0001 d=0.2] E013 | train_loss=0.5840 | val_F1_macro=0.5616
[densenet121 768x512 s42 lr=0.0001 d=0.2] E014 | train_loss=0.5751 | val_F1_macro=0.5735
[densenet121 768x512 s42 lr=0.0001 d=0.2] E015 | train_loss=0.5718 | val_F1_macro=0.5703
Early stopping at epoch 15 due to no improvement in F1_macro.
Training complete. Loading best model from /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/densenet121__768x512__seed=42__lr=0.0001__drop=0.2/best.pt
Running final evaluation on test set...
Test metrics: {'Accuracy_micro': 0.6680760979652405, 'F1_macro': 0.5987675786018372}
ðŸ“ˆ Generated training history plot: /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/densenet121__768x512__seed=42__lr=0.0001__drop=0.2/training_history.png
COMPLETED RUN: arch=densenet121 size=768x512 lr=0.0001 drop=0.2 seed=42

================================================================================

Aggregating results from all runs...
All runs saved to /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/all_runs.csv
+ set +x

>>> Checking: arch=densenet121 size=768x512 lr=5e-5 drop=0.0
    No checkpoint found. Will (re)start this combo.
+ python3 public_baselines_clss.py --train_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train --train_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train/_annotations.csv --test_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test --test_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test/_annotations.csv --outdir /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs --arches densenet121 --sizes 768x512 --lrs 5e-5 --drops 0.0 --epochs 15 --batch_size 8 --num_workers 2 --early_stop 10 --seed 42 --amp --class_weight --val_split_ratio 0.2
Using device: cuda

================================================================================
STARTING RUN: arch=densenet121 size=768x512 lr=5e-05 drop=0.0 seed=42
================================================================================
Loaded 8810 samples for train_aug split from _annotations.csv
Discovered 4 classes: ['Implant', 'Fillings', 'Impacted Tooth', 'Cavity']
No validation file provided. Splitting train data (80%/20%) using seed 42.
Split complete: 7048 train, 1762 val samples.
Loaded 473 samples for eval_noaug split from _annotations.csv
Calculating class weights on training split...
Class weights calculated: tensor([0.4771, 0.1591, 1.9033, 1.4606], device='cuda:0')
[densenet121 768x512 s42 lr=5e-05 d=0.0] E001 | train_loss=0.9901 | val_F1_macro=0.5744
[densenet121 768x512 s42 lr=5e-05 d=0.0] E002 | train_loss=0.8179 | val_F1_macro=0.5673
[densenet121 768x512 s42 lr=5e-05 d=0.0] E003 | train_loss=0.7559 | val_F1_macro=0.5043
[densenet121 768x512 s42 lr=5e-05 d=0.0] E004 | train_loss=0.7366 | val_F1_macro=0.5585
[densenet121 768x512 s42 lr=5e-05 d=0.0] E005 | train_loss=0.6925 | val_F1_macro=0.5428
[densenet121 768x512 s42 lr=5e-05 d=0.0] E006 | train_loss=0.6428 | val_F1_macro=0.5764
[densenet121 768x512 s42 lr=5e-05 d=0.0] E007 | train_loss=0.6254 | val_F1_macro=0.5562
[densenet121 768x512 s42 lr=5e-05 d=0.0] E008 | train_loss=0.6160 | val_F1_macro=0.5529
[densenet121 768x512 s42 lr=5e-05 d=0.0] E009 | train_loss=0.6208 | val_F1_macro=0.5640
[densenet121 768x512 s42 lr=5e-05 d=0.0] E010 | train_loss=0.6144 | val_F1_macro=0.5551
[densenet121 768x512 s42 lr=5e-05 d=0.0] E011 | train_loss=0.5960 | val_F1_macro=0.5595
[densenet121 768x512 s42 lr=5e-05 d=0.0] E012 | train_loss=0.5831 | val_F1_macro=0.5576
[densenet121 768x512 s42 lr=5e-05 d=0.0] E013 | train_loss=0.5973 | val_F1_macro=0.5608
[densenet121 768x512 s42 lr=5e-05 d=0.0] E014 | train_loss=0.5988 | val_F1_macro=0.5704
[densenet121 768x512 s42 lr=5e-05 d=0.0] E015 | train_loss=0.5926 | val_F1_macro=0.5773
Training complete. Loading best model from /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/densenet121__768x512__seed=42__lr=5e-05__drop=0.0/best.pt
Running final evaluation on test set...
Test metrics: {'Accuracy_micro': 0.6384778022766113, 'F1_macro': 0.5736721754074097}
ðŸ“ˆ Generated training history plot: /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/densenet121__768x512__seed=42__lr=5e-05__drop=0.0/training_history.png
COMPLETED RUN: arch=densenet121 size=768x512 lr=5e-05 drop=0.0 seed=42

================================================================================

Aggregating results from all runs...
All runs saved to /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/all_runs.csv
+ set +x

>>> Checking: arch=densenet121 size=768x512 lr=5e-5 drop=0.1
    No checkpoint found. Will (re)start this combo.
+ python3 public_baselines_clss.py --train_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train --train_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train/_annotations.csv --test_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test --test_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test/_annotations.csv --outdir /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs --arches densenet121 --sizes 768x512 --lrs 5e-5 --drops 0.1 --epochs 15 --batch_size 8 --num_workers 2 --early_stop 10 --seed 42 --amp --class_weight --val_split_ratio 0.2
Using device: cuda

================================================================================
STARTING RUN: arch=densenet121 size=768x512 lr=5e-05 drop=0.1 seed=42
================================================================================
Loaded 8810 samples for train_aug split from _annotations.csv
Discovered 4 classes: ['Implant', 'Fillings', 'Impacted Tooth', 'Cavity']
No validation file provided. Splitting train data (80%/20%) using seed 42.
Split complete: 7048 train, 1762 val samples.
Loaded 473 samples for eval_noaug split from _annotations.csv
Calculating class weights on training split...
Class weights calculated: tensor([0.4771, 0.1591, 1.9033, 1.4606], device='cuda:0')
[densenet121 768x512 s42 lr=5e-05 d=0.1] E001 | train_loss=0.9937 | val_F1_macro=0.5805
[densenet121 768x512 s42 lr=5e-05 d=0.1] E002 | train_loss=0.8098 | val_F1_macro=0.5757
[densenet121 768x512 s42 lr=5e-05 d=0.1] E003 | train_loss=0.7565 | val_F1_macro=0.5547
[densenet121 768x512 s42 lr=5e-05 d=0.1] E004 | train_loss=0.7379 | val_F1_macro=0.5841
[densenet121 768x512 s42 lr=5e-05 d=0.1] E005 | train_loss=0.6941 | val_F1_macro=0.5849
[densenet121 768x512 s42 lr=5e-05 d=0.1] E006 | train_loss=0.6843 | val_F1_macro=0.5822
[densenet121 768x512 s42 lr=5e-05 d=0.1] E007 | train_loss=0.6757 | val_F1_macro=0.5424
[densenet121 768x512 s42 lr=5e-05 d=0.1] E008 | train_loss=0.6530 | val_F1_macro=0.5354
[densenet121 768x512 s42 lr=5e-05 d=0.1] E009 | train_loss=0.6566 | val_F1_macro=0.5568
[densenet121 768x512 s42 lr=5e-05 d=0.1] E010 | train_loss=0.5995 | val_F1_macro=0.5521
[densenet121 768x512 s42 lr=5e-05 d=0.1] E011 | train_loss=0.5929 | val_F1_macro=0.5656
[densenet121 768x512 s42 lr=5e-05 d=0.1] E012 | train_loss=0.5756 | val_F1_macro=0.5611
[densenet121 768x512 s42 lr=5e-05 d=0.1] E013 | train_loss=0.5818 | val_F1_macro=0.5522
[densenet121 768x512 s42 lr=5e-05 d=0.1] E014 | train_loss=0.5748 | val_F1_macro=0.5706
[densenet121 768x512 s42 lr=5e-05 d=0.1] E015 | train_loss=0.5730 | val_F1_macro=0.5754
Early stopping at epoch 15 due to no improvement in F1_macro.
Training complete. Loading best model from /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/densenet121__768x512__seed=42__lr=5e-05__drop=0.1/best.pt
Running final evaluation on test set...
Test metrics: {'Accuracy_micro': 0.6088795065879822, 'F1_macro': 0.5657906532287598}
ðŸ“ˆ Generated training history plot: /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/densenet121__768x512__seed=42__lr=5e-05__drop=0.1/training_history.png
COMPLETED RUN: arch=densenet121 size=768x512 lr=5e-05 drop=0.1 seed=42

================================================================================

Aggregating results from all runs...
All runs saved to /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/all_runs.csv
+ set +x

>>> Checking: arch=densenet121 size=768x512 lr=5e-5 drop=0.2
    No checkpoint found. Will (re)start this combo.
+ python3 public_baselines_clss.py --train_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train --train_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/train/_annotations.csv --test_dir /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test --test_csv /home/hamzah.al-omairi/Downloads/orthoai-phase0/xrays_classes/test/_annotations.csv --outdir /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs --arches densenet121 --sizes 768x512 --lrs 5e-5 --drops 0.2 --epochs 15 --batch_size 8 --num_workers 2 --early_stop 10 --seed 42 --amp --class_weight --val_split_ratio 0.2
Using device: cuda

================================================================================
STARTING RUN: arch=densenet121 size=768x512 lr=5e-05 drop=0.2 seed=42
================================================================================
Loaded 8810 samples for train_aug split from _annotations.csv
Discovered 4 classes: ['Implant', 'Fillings', 'Impacted Tooth', 'Cavity']
No validation file provided. Splitting train data (80%/20%) using seed 42.
Split complete: 7048 train, 1762 val samples.
Loaded 473 samples for eval_noaug split from _annotations.csv
Calculating class weights on training split...
Class weights calculated: tensor([0.4771, 0.1591, 1.9033, 1.4606], device='cuda:0')
[densenet121 768x512 s42 lr=5e-05 d=0.2] E001 | train_loss=1.0138 | val_F1_macro=0.5851
[densenet121 768x512 s42 lr=5e-05 d=0.2] E002 | train_loss=0.8258 | val_F1_macro=0.5563
[densenet121 768x512 s42 lr=5e-05 d=0.2] E003 | train_loss=0.7622 | val_F1_macro=0.5391
[densenet121 768x512 s42 lr=5e-05 d=0.2] E004 | train_loss=0.7416 | val_F1_macro=0.5569
[densenet121 768x512 s42 lr=5e-05 d=0.2] E005 | train_loss=0.7069 | val_F1_macro=0.5734
[densenet121 768x512 s42 lr=5e-05 d=0.2] E006 | train_loss=0.6613 | val_F1_macro=0.5520
[densenet121 768x512 s42 lr=5e-05 d=0.2] E007 | train_loss=0.6355 | val_F1_macro=0.5492
[densenet121 768x512 s42 lr=5e-05 d=0.2] E008 | train_loss=0.6229 | val_F1_macro=0.5527
[densenet121 768x512 s42 lr=5e-05 d=0.2] E009 | train_loss=0.6278 | val_F1_macro=0.5630
[densenet121 768x512 s42 lr=5e-05 d=0.2] E010 | train_loss=0.6127 | val_F1_macro=0.5521
[densenet121 768x512 s42 lr=5e-05 d=0.2] E011 | train_loss=0.6117 | val_F1_macro=0.5535
Early stopping at epoch 11 due to no improvement in F1_macro.
Training complete. Loading best model from /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/densenet121__768x512__seed=42__lr=5e-05__drop=0.2/best.pt
Running final evaluation on test set...
Test metrics: {'Accuracy_micro': 0.6088795065879822, 'F1_macro': 0.5402606129646301}
ðŸ“ˆ Generated training history plot: /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/densenet121__768x512__seed=42__lr=5e-05__drop=0.2/training_history.png
COMPLETED RUN: arch=densenet121 size=768x512 lr=5e-05 drop=0.2 seed=42

================================================================================

Aggregating results from all runs...
All runs saved to /home/hamzah.al-omairi/Downloads/orthoai-phase0/Baselines/public_runs/all_runs.csv
+ set +x

----
Resume pass finished.
